{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 362800, "timers": {"sample_time_ms": 1383.778, "sample_throughput": 5492.211, "learn_time_ms": 301.223, "learn_throughput": 25230.474, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001, "total_loss": -0.0184724738355726, "policy_loss": -0.02277963027881924, "vf_loss": 0.0031920026522129774, "vf_explained_var": 0.9653856754302979, "kl": 0.001115154125727713, "entropy": -4.08449387550354, "entropy_coeff": 0.0}}, "num_steps_sampled": 362800, "num_steps_trained": 362800}, "done": false, "episodes_total": 352, "training_iteration": 51, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-05", "timestamp": 1617635165, "time_this_iter_s": 1.691955804824829, "time_total_s": 166.47842025756836, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1.691955804824829, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 76.53333333333333, "ram_util_percent": 61.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 370400, "timers": {"sample_time_ms": 1240.817, "sample_throughput": 6124.998, "learn_time_ms": 299.025, "learn_throughput": 25415.961, "update_time_ms": 3.04}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.001, "total_loss": -0.003303937613964081, "policy_loss": -0.014778895681956783, "vf_loss": 0.010727524757385254, "vf_explained_var": 0.9430235624313354, "kl": 0.001494862954132259, "entropy": -4.056815147399902, "entropy_coeff": 0.0}}, "num_steps_sampled": 370400, "num_steps_trained": 370400}, "done": false, "episodes_total": 352, "training_iteration": 52, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-06", "timestamp": 1617635166, "time_this_iter_s": 1.4032065868377686, "time_total_s": 167.88162684440613, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5546032560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.0951623916625977, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 61.6}, "trial_id": "6c840_00000"}
{"episode_reward_max": 12.538019648242441, "episode_reward_min": 3.490159329298221, "episode_reward_mean": 7.7031453748524426, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.42471009464174, "MDD_min": 25.159700119160302, "MDD_max": 37.458399513357236}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1792862264963427, "mean_inference_ms": 1.2521774910194146, "mean_action_processing_ms": 0.05381291950870612, "mean_env_wait_ms": 1.26258813612373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 378000, "timers": {"sample_time_ms": 1237.764, "sample_throughput": 6140.105, "learn_time_ms": 298.058, "learn_throughput": 25498.377, "update_time_ms": 3.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.001, "total_loss": 0.0231015607714653, "policy_loss": 0.0019290095660835505, "vf_loss": 0.020735821686685085, "vf_explained_var": 0.9535540342330933, "kl": 0.0017469162703491747, "entropy": -4.0196919441223145, "entropy_coeff": 0.0}}, "num_steps_sampled": 378000, "num_steps_trained": 378000}, "done": false, "episodes_total": 371, "training_iteration": 53, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-08", "timestamp": 1617635168, "time_this_iter_s": 1.5519275665283203, "time_total_s": 169.43355441093445, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.647089958190918, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 72.25, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 12.538019648242441, "episode_reward_min": 3.490159329298221, "episode_reward_mean": 7.7031453748524426, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.42471009464174, "MDD_min": 25.159700119160302, "MDD_max": 37.458399513357236}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1792862264963427, "mean_inference_ms": 1.2521774910194146, "mean_action_processing_ms": 0.05381291950870612, "mean_env_wait_ms": 1.26258813612373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 385600, "timers": {"sample_time_ms": 1222.56, "sample_throughput": 6216.463, "learn_time_ms": 298.466, "learn_throughput": 25463.535, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.001, "total_loss": -0.014756323304027319, "policy_loss": -0.021433680725749582, "vf_loss": 0.00646997569128871, "vf_explained_var": 0.9605913162231445, "kl": 0.0016590828308835626, "entropy": -4.078216075897217, "entropy_coeff": 0.0}}, "num_steps_sampled": 385600, "num_steps_trained": 385600}, "done": false, "episodes_total": 371, "training_iteration": 54, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-09", "timestamp": 1617635169, "time_this_iter_s": 1.4848246574401855, "time_total_s": 170.91837906837463, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5546032560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.1319146156311035, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 66.4, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 13.45387539882958, "episode_reward_min": 3.490159329298221, "episode_reward_mean": 8.25548680004266, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.98412123130922, "MDD_min": 23.721259091835517, "MDD_max": 40.76403181318897}, "hist_stats": {"episode_reward": [6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1881263256056237, "mean_inference_ms": 1.2584137541596054, "mean_action_processing_ms": 0.054052144850792155, "mean_env_wait_ms": 1.2486281205303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 393200, "timers": {"sample_time_ms": 1225.755, "sample_throughput": 6200.26, "learn_time_ms": 299.335, "learn_throughput": 25389.646, "update_time_ms": 2.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.001, "total_loss": 0.046149992384016514, "policy_loss": 0.012436233460903168, "vf_loss": 0.03363663703203201, "vf_explained_var": 0.9439554214477539, "kl": 0.0012338503147475421, "entropy": -4.013729095458984, "entropy_coeff": 0.0}}, "num_steps_sampled": 393200, "num_steps_trained": 393200}, "done": false, "episodes_total": 390, "training_iteration": 55, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-11", "timestamp": 1617635171, "time_this_iter_s": 1.54998779296875, "time_total_s": 172.46836686134338, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.6819024085998535, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.39999999999999, "ram_util_percent": 61.70000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 13.45387539882958, "episode_reward_min": 3.490159329298221, "episode_reward_mean": 8.255486800042663, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.98412123130922, "MDD_min": 23.721259091835517, "MDD_max": 40.76403181318897}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18812632560562367, "mean_inference_ms": 1.2584137541596052, "mean_action_processing_ms": 0.05405214485079218, "mean_env_wait_ms": 1.2486281205302998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 400800, "timers": {"sample_time_ms": 1205.668, "sample_throughput": 6303.558, "learn_time_ms": 300.584, "learn_throughput": 25284.127, "update_time_ms": 3.035}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.001, "total_loss": -0.004535438221296317, "policy_loss": -0.008288253913633525, "vf_loss": 0.003681914648041129, "vf_explained_var": 0.9676167964935303, "kl": 0.0022688156459480524, "entropy": -4.158181428909302, "entropy_coeff": 0.0}}, "num_steps_sampled": 400800, "num_steps_trained": 400800}, "done": false, "episodes_total": 390, "training_iteration": 56, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-12", "timestamp": 1617635172, "time_this_iter_s": 1.420686960220337, "time_total_s": 173.88905382156372, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55467cacb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.10258936882019, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 73.7, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 13.45387539882958, "episode_reward_min": 3.490159329298221, "episode_reward_mean": 8.255486800042663, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.98412123130922, "MDD_min": 23.721259091835517, "MDD_max": 40.76403181318897}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18812632560562367, "mean_inference_ms": 1.2584137541596052, "mean_action_processing_ms": 0.05405214485079218, "mean_env_wait_ms": 1.2486281205302998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 408400, "timers": {"sample_time_ms": 1193.806, "sample_throughput": 6366.192, "learn_time_ms": 301.247, "learn_throughput": 25228.471, "update_time_ms": 3.016}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.001, "total_loss": 0.015207573771476746, "policy_loss": 0.00010342849418520927, "vf_loss": 0.015068234410136938, "vf_explained_var": 0.9380608797073364, "kl": 0.002298495383001864, "entropy": -4.143237352371216, "entropy_coeff": 0.0}}, "num_steps_sampled": 408400, "num_steps_trained": 408400}, "done": false, "episodes_total": 390, "training_iteration": 57, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-14", "timestamp": 1617635174, "time_this_iter_s": 1.4365272521972656, "time_total_s": 175.325581073761, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345579e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.539116621017456, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 8.801738366830579, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.738880036512647, "MDD_min": 22.963592631562836, "MDD_max": 41.76240748510409}, "hist_stats": {"episode_reward": [15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18892904170841723, "mean_inference_ms": 1.2604616373910629, "mean_action_processing_ms": 0.054078429272227654, "mean_env_wait_ms": 1.236931878769342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 416000, "timers": {"sample_time_ms": 1197.713, "sample_throughput": 6345.425, "learn_time_ms": 300.492, "learn_throughput": 25291.836, "update_time_ms": 2.959}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 0.001, "total_loss": 0.03852602932602167, "policy_loss": 0.0060999272391200066, "vf_loss": 0.0324118547141552, "vf_explained_var": 0.9440807104110718, "kl": 0.0018226977554149926, "entropy": -4.106818914413452, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 409, "training_iteration": 58, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-15", "timestamp": 1617635175, "time_this_iter_s": 1.5286624431610107, "time_total_s": 176.854243516922, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345575f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.067779064178467, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 80.1, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 8.801738366830579, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.738880036512647, "MDD_min": 22.963592631562836, "MDD_max": 41.76240748510409}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1889290417084172, "mean_inference_ms": 1.260461637391063, "mean_action_processing_ms": 0.05407842927222764, "mean_env_wait_ms": 1.236931878769342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 423600, "timers": {"sample_time_ms": 1185.711, "sample_throughput": 6409.659, "learn_time_ms": 300.978, "learn_throughput": 25251.02, "update_time_ms": 2.96}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.001, "total_loss": 0.010089106042869389, "policy_loss": 0.0045215534046292305, "vf_loss": 0.0055618188343942165, "vf_explained_var": 0.9667669534683228, "kl": 0.0014664387563243508, "entropy": -4.172264575958252, "entropy_coeff": 0.0}}, "num_steps_sampled": 423600, "num_steps_trained": 423600}, "done": false, "episodes_total": 409, "training_iteration": 59, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-17", "timestamp": 1617635177, "time_this_iter_s": 1.4033875465393066, "time_total_s": 178.2576310634613, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.471166610717773, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 73.7, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 8.944351650376856, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.759973214058174, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19077628265097327, "mean_inference_ms": 1.2613063657477235, "mean_action_processing_ms": 0.05407471675722707, "mean_env_wait_ms": 1.229233984930627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 431200, "timers": {"sample_time_ms": 1188.681, "sample_throughput": 6393.641, "learn_time_ms": 300.415, "learn_throughput": 25298.296, "update_time_ms": 2.915}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 0.001, "total_loss": 0.028497125022113323, "policy_loss": -0.0068285620072856545, "vf_loss": 0.03532201983034611, "vf_explained_var": 0.9488411545753479, "kl": 0.001875299436505884, "entropy": -4.177894115447998, "entropy_coeff": 0.0}}, "num_steps_sampled": 431200, "num_steps_trained": 431200}, "done": false, "episodes_total": 428, "training_iteration": 60, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-18", "timestamp": 1617635178, "time_this_iter_s": 1.5201785564422607, "time_total_s": 179.77780961990356, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345575f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.991345167160034, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.1, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 8.944351650376857, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.75997321405817, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19077628265097324, "mean_inference_ms": 1.261306365747723, "mean_action_processing_ms": 0.05407471675722706, "mean_env_wait_ms": 1.2292339849306266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 438800, "timers": {"sample_time_ms": 1194.862, "sample_throughput": 6360.566, "learn_time_ms": 299.844, "learn_throughput": 25346.495, "update_time_ms": 2.908}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 0.001, "total_loss": 0.011210632277652621, "policy_loss": 0.00739470636472106, "vf_loss": 0.0038142099510878325, "vf_explained_var": 0.9711446762084961, "kl": 0.0017600335995666683, "entropy": -4.260028123855591, "entropy_coeff": 0.0}}, "num_steps_sampled": 438800, "num_steps_trained": 438800}, "done": false, "episodes_total": 428, "training_iteration": 61, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-20", "timestamp": 1617635180, "time_this_iter_s": 1.7498292922973633, "time_total_s": 181.52763891220093, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345579e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.741174459457397, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 68.66666666666667, "ram_util_percent": 61.70000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 8.944351650376857, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.75997321405817, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19077628265097324, "mean_inference_ms": 1.261306365747723, "mean_action_processing_ms": 0.05407471675722706, "mean_env_wait_ms": 1.2292339849306266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 446400, "timers": {"sample_time_ms": 1196.676, "sample_throughput": 6350.924, "learn_time_ms": 300.556, "learn_throughput": 25286.46, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 0.001, "total_loss": 0.01880580559372902, "policy_loss": 0.0021369890309870243, "vf_loss": 0.016667998395860195, "vf_explained_var": 0.9359229803085327, "kl": 0.0016741928993724287, "entropy": -4.328011989593506, "entropy_coeff": 0.0}}, "num_steps_sampled": 446400, "num_steps_trained": 446400}, "done": false, "episodes_total": 428, "training_iteration": 62, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-21", "timestamp": 1617635181, "time_this_iter_s": 1.430403232574463, "time_total_s": 182.9580421447754, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345575f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.17157769203186, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 74.05000000000001, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 9.29850428627811, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.77633361541838, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19133716869855158, "mean_inference_ms": 1.2743375131009176, "mean_action_processing_ms": 0.05407897010441877, "mean_env_wait_ms": 1.2239215243848331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 454000, "timers": {"sample_time_ms": 1196.065, "sample_throughput": 6354.169, "learn_time_ms": 300.993, "learn_throughput": 25249.762, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000244140625, "cur_lr": 0.001, "total_loss": 0.027092142030596733, "policy_loss": -0.0013943149242550135, "vf_loss": 0.028485874645411968, "vf_explained_var": 0.958378791809082, "kl": 0.00239233928732574, "entropy": -4.240401029586792, "entropy_coeff": 0.0}}, "num_steps_sampled": 454000, "num_steps_trained": 454000}, "done": false, "episodes_total": 447, "training_iteration": 63, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-23", "timestamp": 1617635183, "time_this_iter_s": 1.536057949066162, "time_total_s": 184.49410009384155, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345579e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.707635641098022, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 80.65, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 9.298504286278108, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.776333615418395, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [7.83728705307221, 5.044819820770876, 5.433813894465373, 11.98034286764681, 5.938465201792973, 6.731654580808969, 7.696734973618467, 12.538019648242441, 6.6703320852711165, 4.97414955321492, 7.698961955516561, 10.327394050891359, 7.490227794591476, 7.4533747617599175, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19133716869855155, "mean_inference_ms": 1.2743375131009176, "mean_action_processing_ms": 0.054078970104418755, "mean_env_wait_ms": 1.223921524384833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 461600, "timers": {"sample_time_ms": 1189.835, "sample_throughput": 6387.442, "learn_time_ms": 302.164, "learn_throughput": 25151.928, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001220703125, "cur_lr": 0.001, "total_loss": 0.006362094893120229, "policy_loss": -0.0007537013152614236, "vf_loss": 0.007115592248737812, "vf_explained_var": 0.9639241695404053, "kl": 0.0016852977569215, "entropy": -4.248121500015259, "entropy_coeff": 0.0}}, "num_steps_sampled": 461600, "num_steps_trained": 461600}, "done": false, "episodes_total": 447, "training_iteration": 64, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-24", "timestamp": 1617635184, "time_this_iter_s": 1.435117244720459, "time_total_s": 185.929217338562, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.14275288581848, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 9.925198013747483, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.436481456797264, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19438468758945962, "mean_inference_ms": 1.2846928130641126, "mean_action_processing_ms": 0.05406130905423094, "mean_env_wait_ms": 1.2130273978151191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 469200, "timers": {"sample_time_ms": 1187.447, "sample_throughput": 6400.283, "learn_time_ms": 302.116, "learn_throughput": 25155.885, "update_time_ms": 2.906}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-05, "cur_lr": 0.001, "total_loss": 0.05182451568543911, "policy_loss": 0.004474583314731717, "vf_loss": 0.04734979569911957, "vf_explained_var": 0.9476965665817261, "kl": 0.0022580515360459685, "entropy": -4.34808349609375, "entropy_coeff": 0.0}}, "num_steps_sampled": 469200, "num_steps_trained": 469200}, "done": false, "episodes_total": 466, "training_iteration": 65, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-26", "timestamp": 1617635186, "time_this_iter_s": 1.5267562866210938, "time_total_s": 187.4559736251831, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.669509172439575, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 74.5, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 9.925198013747483, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.436481456797264, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19438468758945962, "mean_inference_ms": 1.2846928130641126, "mean_action_processing_ms": 0.054061309054230955, "mean_env_wait_ms": 1.2130273978151191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 476800, "timers": {"sample_time_ms": 1186.942, "sample_throughput": 6403.008, "learn_time_ms": 301.856, "learn_throughput": 25177.543, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-05, "cur_lr": 0.001, "total_loss": 0.004370379785541445, "policy_loss": -0.0003773260395973921, "vf_loss": 0.004747648956254125, "vf_explained_var": 0.9721428155899048, "kl": 0.002054288925137371, "entropy": -4.354371547698975, "entropy_coeff": 0.0}}, "num_steps_sampled": 476800, "num_steps_trained": 476800}, "done": false, "episodes_total": 466, "training_iteration": 66, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-27", "timestamp": 1617635187, "time_this_iter_s": 1.4142396450042725, "time_total_s": 188.87021327018738, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.083748817443848, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 24.725349865361586, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 9.925198013747483, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.436481456797264, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [9.992929170877037, 3.490159329298221, 9.440945078009321, 6.409815176916605, 9.210335125431767, 6.764494362571677, 5.750651595282391, 13.429403932978385, 9.653688628551608, 5.372578946323481, 4.261757514984885, 11.211443199939907, 7.884051347461066, 13.45387539882958, 4.165963933903439, 8.727279852686683, 11.828866410626892, 10.092423493056831, 9.425903118513334, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19438468758945962, "mean_inference_ms": 1.2846928130641126, "mean_action_processing_ms": 0.054061309054230955, "mean_env_wait_ms": 1.2130273978151191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 484400, "timers": {"sample_time_ms": 1185.382, "sample_throughput": 6411.435, "learn_time_ms": 300.905, "learn_throughput": 25257.174, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-05, "cur_lr": 0.001, "total_loss": 0.016327569261193275, "policy_loss": -0.009407633740920573, "vf_loss": 0.025735178031027317, "vf_explained_var": 0.9280105829238892, "kl": 0.002076383796520531, "entropy": -4.451691150665283, "entropy_coeff": 0.0}}, "num_steps_sampled": 484400, "num_steps_trained": 484400}, "done": false, "episodes_total": 466, "training_iteration": 67, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-29", "timestamp": 1617635189, "time_this_iter_s": 1.4113848209381104, "time_total_s": 190.2815980911255, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.495133638381958, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 28.471162118172053, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 11.146293161292316, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.38530634705551, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19461041092923, "mean_inference_ms": 1.2942346672665739, "mean_action_processing_ms": 0.05406175665495316, "mean_env_wait_ms": 1.205010582920761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 492000, "timers": {"sample_time_ms": 1184.072, "sample_throughput": 6418.528, "learn_time_ms": 301.397, "learn_throughput": 25215.882, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-06, "cur_lr": 0.001, "total_loss": 0.03538612276315689, "policy_loss": -0.011238228296861053, "vf_loss": 0.046624330803751945, "vf_explained_var": 0.9510515928268433, "kl": 0.002985965576954186, "entropy": -4.278444290161133, "entropy_coeff": 0.0}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 485, "training_iteration": 68, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-30", "timestamp": 1617635190, "time_this_iter_s": 1.5216014385223389, "time_total_s": 191.80319952964783, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5546032560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.016735076904297, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 71.6, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 28.471162118172053, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 11.146293161292315, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.385306347055508, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [11.681703426878276, 5.52291882765531, 9.286657919372876, 11.104892950331307, 7.730181419476773, 15.297806670749154, 18.072228091206608, 15.427938453884984, 8.18130022081188, 6.86311696879421, 6.182410525841325, 6.604924540407709, 3.7636510473663245, 24.725349865361586, 4.697948121982376, 7.480279649875973, 10.369345730837885, 7.1089472465819075, 13.012492968896115, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19461041092923004, "mean_inference_ms": 1.2942346672665739, "mean_action_processing_ms": 0.05406175665495315, "mean_env_wait_ms": 1.2050105829207611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 499600, "timers": {"sample_time_ms": 1187.375, "sample_throughput": 6400.675, "learn_time_ms": 300.774, "learn_throughput": 25268.151, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-06, "cur_lr": 0.001, "total_loss": 0.008038050902541727, "policy_loss": -0.00037671299651265144, "vf_loss": 0.008414761628955603, "vf_explained_var": 0.9660412669181824, "kl": 0.0023534882348030806, "entropy": -4.366918325424194, "entropy_coeff": 0.0}}, "num_steps_sampled": 499600, "num_steps_trained": 499600}, "done": false, "episodes_total": 485, "training_iteration": 69, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-32", "timestamp": 1617635192, "time_this_iter_s": 1.430208683013916, "time_total_s": 193.23340821266174, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345579e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.446943759918213, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 72.25, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 28.471162118172053, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 12.03153536661173, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.172168597530494, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19549951424656203, "mean_inference_ms": 1.3022852805399274, "mean_action_processing_ms": 0.05406384802165432, "mean_env_wait_ms": 1.2012009278081797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 507200, "timers": {"sample_time_ms": 1188.678, "sample_throughput": 6393.658, "learn_time_ms": 301.783, "learn_throughput": 25183.683, "update_time_ms": 2.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-06, "cur_lr": 0.001, "total_loss": 0.08369879610836506, "policy_loss": 0.01864610332995653, "vf_loss": 0.06505268812179565, "vf_explained_var": 0.9525693655014038, "kl": 0.0023690625093877316, "entropy": -4.5164079666137695, "entropy_coeff": 0.0}}, "num_steps_sampled": 507200, "num_steps_trained": 507200}, "done": false, "episodes_total": 504, "training_iteration": 70, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-33", "timestamp": 1617635193, "time_this_iter_s": 1.5440032482147217, "time_total_s": 194.77741146087646, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.990947008132935, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.46666666666667, "ram_util_percent": 61.76666666666667}, "trial_id": "6c840_00000"}
{"episode_reward_max": 28.471162118172053, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 12.03153536661173, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.17216859753049, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19549951424656206, "mean_inference_ms": 1.3022852805399274, "mean_action_processing_ms": 0.05406384802165432, "mean_env_wait_ms": 1.2012009278081794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 514800, "timers": {"sample_time_ms": 1153.514, "sample_throughput": 6588.565, "learn_time_ms": 302.832, "learn_throughput": 25096.395, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-07, "cur_lr": 0.001, "total_loss": 0.007597105926834047, "policy_loss": 0.001633775420486927, "vf_loss": 0.005963334580883384, "vf_explained_var": 0.9747952222824097, "kl": 0.0026102749397978187, "entropy": -4.472169399261475, "entropy_coeff": 0.0}}, "num_steps_sampled": 514800, "num_steps_trained": 514800}, "done": false, "episodes_total": 504, "training_iteration": 71, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-35", "timestamp": 1617635195, "time_this_iter_s": 1.4095406532287598, "time_total_s": 196.18695211410522, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345579e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.400487661361694, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 28.471162118172053, "episode_reward_min": 3.2102070118984294, "episode_reward_mean": 12.03153536661173, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.17216859753049, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [8.32023577854489, 16.799489901939765, 3.2102070118984294, 5.331739851344051, 6.541175861396716, 9.495331942068374, 8.243363173716066, 9.162331407965608, 6.015962358556195, 11.130686064869417, 12.101777427262672, 8.770824015132247, 10.200750461221393, 5.7811440474845455, 8.476608540030842, 8.66079638782052, 5.9770249117166925, 17.184711645362125, 6.406265189818272, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19549951424656206, "mean_inference_ms": 1.3022852805399274, "mean_action_processing_ms": 0.05406384802165432, "mean_env_wait_ms": 1.2012009278081794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 522400, "timers": {"sample_time_ms": 1151.57, "sample_throughput": 6599.686, "learn_time_ms": 302.802, "learn_throughput": 25098.916, "update_time_ms": 2.86}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-07, "cur_lr": 0.001, "total_loss": 0.018629335332661867, "policy_loss": -0.011485503637231886, "vf_loss": 0.030114836990833282, "vf_explained_var": 0.9382814168930054, "kl": 0.002041158906649798, "entropy": -4.677764654159546, "entropy_coeff": 0.0}}, "num_steps_sampled": 522400, "num_steps_trained": 522400}, "done": false, "episodes_total": 504, "training_iteration": 72, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-36", "timestamp": 1617635196, "time_this_iter_s": 1.4091782569885254, "time_total_s": 197.59613037109375, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a29e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.80966591835022, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 73.7, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.008268306528855, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 13.735399874095055, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.64110160439475, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19578323580172718, "mean_inference_ms": 1.3091527072078555, "mean_action_processing_ms": 0.054070713218234395, "mean_env_wait_ms": 1.1988073669309531, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 530000, "timers": {"sample_time_ms": 1150.468, "sample_throughput": 6606.005, "learn_time_ms": 303.129, "learn_throughput": 25071.845, "update_time_ms": 2.838}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-07, "cur_lr": 0.001, "total_loss": 0.062071872875094414, "policy_loss": -0.006468517938628793, "vf_loss": 0.06854038685560226, "vf_explained_var": 0.9532375335693359, "kl": 0.0026342221535742283, "entropy": -4.375753164291382, "entropy_coeff": 0.0}}, "num_steps_sampled": 530000, "num_steps_trained": 530000}, "done": false, "episodes_total": 523, "training_iteration": 73, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-38", "timestamp": 1617635198, "time_this_iter_s": 1.5276412963867188, "time_total_s": 199.12377166748047, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.33730721473694, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 80.9, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.008268306528855, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 13.735399874095055, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.64110160439475, "MDD_min": 21.400768814043715, "MDD_max": 44.785116110848904}, "hist_stats": {"episode_reward": [5.4832578963790874, 10.001363913240612, 11.063602121122006, 16.39685740423998, 7.518979611291455, 7.979564365134314, 13.364980624330963, 17.01924734577893, 10.172419500765033, 9.601675199688696, 10.872895906760382, 13.966096408846973, 9.853758102755197, 9.709338851949386, 8.838839638396921, 6.879994694480552, 10.882991949414583, 9.577577673144196, 6.354533418290445, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19578323580172718, "mean_inference_ms": 1.3091527072078555, "mean_action_processing_ms": 0.0540707132182344, "mean_env_wait_ms": 1.1988073669309534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 537600, "timers": {"sample_time_ms": 1149.614, "sample_throughput": 6610.915, "learn_time_ms": 302.087, "learn_throughput": 25158.333, "update_time_ms": 2.855}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078125e-07, "cur_lr": 0.001, "total_loss": -0.0004465291276574135, "policy_loss": -0.01097766135353595, "vf_loss": 0.010531128384172916, "vf_explained_var": 0.9716336727142334, "kl": 0.002115546492859721, "entropy": -4.530766010284424, "entropy_coeff": 0.0}}, "num_steps_sampled": 537600, "num_steps_trained": 537600}, "done": false, "episodes_total": 523, "training_iteration": 74, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-39", "timestamp": 1617635199, "time_this_iter_s": 1.4161856174468994, "time_total_s": 200.53995728492737, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2c20>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.75349283218384, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.57874584811019, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 15.084467331702868, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.595310750508055, "MDD_min": 20.616356751636914, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19653638132812307, "mean_inference_ms": 1.3063145756229064, "mean_action_processing_ms": 0.05407048121596829, "mean_env_wait_ms": 1.197110608363442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 545200, "timers": {"sample_time_ms": 1152.128, "sample_throughput": 6596.49, "learn_time_ms": 301.79, "learn_throughput": 25183.055, "update_time_ms": 2.847}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-08, "cur_lr": 0.001, "total_loss": 0.09529482573270798, "policy_loss": -0.0030527758644893765, "vf_loss": 0.09834760427474976, "vf_explained_var": 0.9519122838973999, "kl": 0.002471979008987546, "entropy": -4.6664650440216064, "entropy_coeff": 0.0}}, "num_steps_sampled": 545200, "num_steps_trained": 545200}, "done": false, "episodes_total": 542, "training_iteration": 75, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-41", "timestamp": 1617635201, "time_this_iter_s": 1.5489583015441895, "time_total_s": 202.08891558647156, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55467cacb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.30245113372803, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 72.05, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.57874584811019, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 15.084467331702863, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.595310750508062, "MDD_min": 20.616356751636914, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19653638132812304, "mean_inference_ms": 1.3063145756229064, "mean_action_processing_ms": 0.05407048121596829, "mean_env_wait_ms": 1.197110608363442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 552800, "timers": {"sample_time_ms": 1151.683, "sample_throughput": 6599.039, "learn_time_ms": 301.313, "learn_throughput": 25222.921, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695312e-08, "cur_lr": 0.001, "total_loss": 0.006915039528394118, "policy_loss": -0.0003806122113019228, "vf_loss": 0.007295648101717234, "vf_explained_var": 0.9808796048164368, "kl": 0.002568479743786156, "entropy": -4.692214250564575, "entropy_coeff": 0.0}}, "num_steps_sampled": 552800, "num_steps_trained": 552800}, "done": false, "episodes_total": 542, "training_iteration": 76, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-42", "timestamp": 1617635202, "time_this_iter_s": 1.4045491218566895, "time_total_s": 203.49346470832825, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.70700025558472, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 70.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.57874584811019, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 15.084467331702863, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.595310750508062, "MDD_min": 20.616356751636914, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [18.681310000178556, 4.066944644865484, 7.848293236234815, 18.030836189280887, 9.885884017482988, 7.3025077263742535, 12.826743399793687, 9.747104345475266, 11.735613735156782, 8.627137333968527, 9.924929355375236, 11.671972983484892, 9.81207211804776, 15.058144713383463, 8.049545998172945, 12.44561441368815, 7.595331409915271, 9.398612451659194, 19.995229895703055, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19653638132812304, "mean_inference_ms": 1.3063145756229064, "mean_action_processing_ms": 0.05407048121596829, "mean_env_wait_ms": 1.197110608363442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 560400, "timers": {"sample_time_ms": 1151.993, "sample_throughput": 6597.265, "learn_time_ms": 302.668, "learn_throughput": 25110.035, "update_time_ms": 2.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847656e-08, "cur_lr": 0.001, "total_loss": 0.03740793466567993, "policy_loss": -0.007423417642712593, "vf_loss": 0.044831350445747375, "vf_explained_var": 0.9337215423583984, "kl": 0.0015189767582342029, "entropy": -4.855176687240601, "entropy_coeff": 0.0}}, "num_steps_sampled": 560400, "num_steps_trained": 560400}, "done": false, "episodes_total": 542, "training_iteration": 77, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-44", "timestamp": 1617635204, "time_this_iter_s": 1.4283461570739746, "time_total_s": 204.92181086540222, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345ace60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.13534641265869, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 72.65, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.57874584811019, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 16.738323625857376, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.910360570420092, "MDD_min": 19.73082228968353, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966060046734791, "mean_inference_ms": 1.3011069044346046, "mean_action_processing_ms": 0.054060846594750724, "mean_env_wait_ms": 1.195635031571306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 568000, "timers": {"sample_time_ms": 1153.202, "sample_throughput": 6590.348, "learn_time_ms": 303.0, "learn_throughput": 25082.516, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923828e-09, "cur_lr": 0.001, "total_loss": 0.0981525331735611, "policy_loss": -0.0013785299379378557, "vf_loss": 0.09953106194734573, "vf_explained_var": 0.9554004669189453, "kl": 0.0025835548294708133, "entropy": -4.575630187988281, "entropy_coeff": 0.0}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 561, "training_iteration": 78, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-45", "timestamp": 1617635205, "time_this_iter_s": 1.5378947257995605, "time_total_s": 206.45970559120178, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a29e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.67324113845825, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 65.06666666666666, "ram_util_percent": 61.70000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 36.57874584811019, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 16.738323625857376, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.910360570420092, "MDD_min": 19.73082228968353, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [15.227344332580742, 15.01398423862896, 6.17042077042985, 12.584944418855915, 13.790218779297348, 17.3139727497638, 11.972958533570349, 18.050461065026717, 19.321634796272107, 12.229430298705473, 13.206138030245754, 16.670719792030958, 11.131960263314364, 14.50723877355344, 12.325794769464078, 28.471162118172053, 12.272411366903977, 24.80965629625388, 11.44700270214197, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966060046734792, "mean_inference_ms": 1.3011069044346046, "mean_action_processing_ms": 0.05406084659475074, "mean_env_wait_ms": 1.195635031571306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 575600, "timers": {"sample_time_ms": 1151.961, "sample_throughput": 6597.447, "learn_time_ms": 303.721, "learn_throughput": 25023.001, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.725290298461914e-09, "cur_lr": 0.001, "total_loss": 0.0046227925922721624, "policy_loss": -0.009141402741079219, "vf_loss": 0.013764197938144207, "vf_explained_var": 0.970166802406311, "kl": 0.002739082556217909, "entropy": -4.716468572616577, "entropy_coeff": 0.0}}, "num_steps_sampled": 575600, "num_steps_trained": 575600}, "done": false, "episodes_total": 561, "training_iteration": 79, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-47", "timestamp": 1617635207, "time_this_iter_s": 1.4252300262451172, "time_total_s": 207.8849356174469, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345e9f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.09847116470337, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 74.05, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 38.79355287859822, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 18.351051869980775, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.375187133492386, "MDD_min": 19.001415592975263, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19721110615770837, "mean_inference_ms": 1.2972534107898965, "mean_action_processing_ms": 0.05406692549436892, "mean_env_wait_ms": 1.1946223947737302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 583200, "timers": {"sample_time_ms": 1151.193, "sample_throughput": 6601.847, "learn_time_ms": 303.73, "learn_throughput": 25022.221, "update_time_ms": 2.866}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.862645149230957e-09, "cur_lr": 0.001, "total_loss": 0.13030977547168732, "policy_loss": -0.01890104147605598, "vf_loss": 0.1492108255624771, "vf_explained_var": 0.9559323787689209, "kl": 0.0031282128766179085, "entropy": -4.879073143005371, "entropy_coeff": 0.0}}, "num_steps_sampled": 583200, "num_steps_trained": 583200}, "done": false, "episodes_total": 580, "training_iteration": 80, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-48", "timestamp": 1617635208, "time_this_iter_s": 1.53587007522583, "time_total_s": 209.42080569267273, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2c20>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.6343412399292, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 80.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 38.79355287859822, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 18.351051869980775, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.375187133492386, "MDD_min": 19.001415592975263, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19721110615770832, "mean_inference_ms": 1.2972534107898965, "mean_action_processing_ms": 0.05406692549436891, "mean_env_wait_ms": 1.1946223947737302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 590800, "timers": {"sample_time_ms": 1153.268, "sample_throughput": 6589.971, "learn_time_ms": 303.279, "learn_throughput": 25059.411, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154785e-10, "cur_lr": 0.001, "total_loss": 0.012105359928682446, "policy_loss": 0.0027010575868189335, "vf_loss": 0.009404303971678019, "vf_explained_var": 0.9839744567871094, "kl": 0.0025386258494108915, "entropy": -4.8789143562316895, "entropy_coeff": 0.0}}, "num_steps_sampled": 590800, "num_steps_trained": 590800}, "done": false, "episodes_total": 580, "training_iteration": 81, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-50", "timestamp": 1617635210, "time_this_iter_s": 1.4253923892974854, "time_total_s": 210.84619808197021, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.059733629226685, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 38.79355287859822, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 18.351051869980775, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.375187133492386, "MDD_min": 19.001415592975263, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [14.792980966368345, 10.185869639157934, 10.725683325475611, 10.546177290445145, 12.694827593860241, 15.2081479093622, 15.077998854432213, 15.761247270897407, 11.246097882707504, 11.77879040678756, 22.891201723539098, 18.34075124044942, 14.157281836325593, 16.635699308577177, 13.284035417192346, 19.39724204584493, 18.089988482769776, 11.701840848280119, 14.095262575054646, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19721110615770832, "mean_inference_ms": 1.2972534107898965, "mean_action_processing_ms": 0.05406692549436891, "mean_env_wait_ms": 1.1946223947737302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 598400, "timers": {"sample_time_ms": 1154.724, "sample_throughput": 6581.657, "learn_time_ms": 303.671, "learn_throughput": 25027.087, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-10, "cur_lr": 0.001, "total_loss": 0.0796488169580698, "policy_loss": 0.01623146142810583, "vf_loss": 0.06341735646128654, "vf_explained_var": 0.9337248206138611, "kl": 0.0016724187298677862, "entropy": -5.016822576522827, "entropy_coeff": 0.0}}, "num_steps_sampled": 598400, "num_steps_trained": 598400}, "done": false, "episodes_total": 580, "training_iteration": 82, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-51", "timestamp": 1617635211, "time_this_iter_s": 1.428260326385498, "time_total_s": 212.2744584083557, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a29e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.48799395561218, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 41.04631782908942, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 20.027763200056064, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.655540145849095, "MDD_min": 17.333031932858958, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19717083228281537, "mean_inference_ms": 1.2940290076001884, "mean_action_processing_ms": 0.05407560775429293, "mean_env_wait_ms": 1.1938506062750542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 606000, "timers": {"sample_time_ms": 1156.865, "sample_throughput": 6569.479, "learn_time_ms": 303.282, "learn_throughput": 25059.204, "update_time_ms": 2.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386963e-10, "cur_lr": 0.001, "total_loss": 0.12992140278220177, "policy_loss": 0.004701313795521855, "vf_loss": 0.12522009387612343, "vf_explained_var": 0.9662884473800659, "kl": 0.002625246881507337, "entropy": -4.726335763931274, "entropy_coeff": 0.0}}, "num_steps_sampled": 606000, "num_steps_trained": 606000}, "done": false, "episodes_total": 599, "training_iteration": 83, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-53", "timestamp": 1617635213, "time_this_iter_s": 1.5453860759735107, "time_total_s": 213.81984448432922, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.03338003158569, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 75.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 41.04631782908942, "episode_reward_min": 3.499932251755216, "episode_reward_mean": 20.027763200056068, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.655540145849095, "MDD_min": 17.333031932858958, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [15.962242542606123, 12.063956360298215, 15.136381889324419, 3.499932251755216, 17.31021633205017, 11.965921964602972, 15.994714425957923, 20.043912035166812, 36.008268306528855, 14.93642924874036, 7.9531411603410795, 11.097652641314813, 15.253830162051404, 16.209064346026377, 20.90791046076508, 34.31618941829551, 12.988039020679627, 15.082975761239307, 19.020420531465128, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19717083228281546, "mean_inference_ms": 1.2940290076001881, "mean_action_processing_ms": 0.05407560775429293, "mean_env_wait_ms": 1.1938506062750542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 613600, "timers": {"sample_time_ms": 1156.807, "sample_throughput": 6569.807, "learn_time_ms": 303.796, "learn_throughput": 25016.791, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693481e-10, "cur_lr": 0.001, "total_loss": 0.019385192543268204, "policy_loss": 0.0038356762379407883, "vf_loss": 0.015549518633633852, "vf_explained_var": 0.9745761752128601, "kl": 0.002030058763921261, "entropy": -4.833479881286621, "entropy_coeff": 0.0}}, "num_steps_sampled": 613600, "num_steps_trained": 613600}, "done": false, "episodes_total": 599, "training_iteration": 84, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-54", "timestamp": 1617635214, "time_this_iter_s": 1.4213643074035645, "time_total_s": 215.2412087917328, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451def0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.45474433898926, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.569394323487195, "episode_reward_min": 7.156916074477735, "episode_reward_mean": 21.27918226932015, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.659246271015874, "MDD_min": 17.333031932858958, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19764016980498564, "mean_inference_ms": 1.2917348502528665, "mean_action_processing_ms": 0.054089280660539696, "mean_env_wait_ms": 1.1935751206432241, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 621200, "timers": {"sample_time_ms": 1154.804, "sample_throughput": 6581.204, "learn_time_ms": 305.025, "learn_throughput": 24916.023, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-11, "cur_lr": 0.001, "total_loss": 0.14965283870697021, "policy_loss": -0.0013246800808701664, "vf_loss": 0.1509775146842003, "vf_explained_var": 0.9690383076667786, "kl": 0.0035024707904085517, "entropy": -4.998398780822754, "entropy_coeff": 0.0}}, "num_steps_sampled": 621200, "num_steps_trained": 621200}, "done": false, "episodes_total": 618, "training_iteration": 85, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-56", "timestamp": 1617635216, "time_this_iter_s": 1.5419707298278809, "time_total_s": 216.78317952156067, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345ace60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.99671506881714, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 71.45, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.569394323487195, "episode_reward_min": 7.156916074477735, "episode_reward_mean": 21.27918226932015, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.659246271015878, "MDD_min": 17.333031932858958, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1976401698049856, "mean_inference_ms": 1.2917348502528663, "mean_action_processing_ms": 0.05408928066053971, "mean_env_wait_ms": 1.1935751206432241, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 628800, "timers": {"sample_time_ms": 1157.55, "sample_throughput": 6565.591, "learn_time_ms": 305.793, "learn_throughput": 24853.418, "update_time_ms": 2.942}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733704e-11, "cur_lr": 0.001, "total_loss": 0.021030341944424435, "policy_loss": 0.011288530193269253, "vf_loss": 0.009741809219121933, "vf_explained_var": 0.9883350133895874, "kl": 0.002555590821430087, "entropy": -5.048058986663818, "entropy_coeff": 0.0}}, "num_steps_sampled": 628800, "num_steps_trained": 628800}, "done": false, "episodes_total": 618, "training_iteration": 86, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-57", "timestamp": 1617635217, "time_this_iter_s": 1.4393541812896729, "time_total_s": 218.22253370285034, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a29e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.43606925010681, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.569394323487195, "episode_reward_min": 7.156916074477735, "episode_reward_mean": 21.27918226932015, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.659246271015878, "MDD_min": 17.333031932858958, "MDD_max": 43.688138465249224}, "hist_stats": {"episode_reward": [15.99157282069254, 11.60114818230126, 13.942192785552784, 23.506500904316482, 21.37699255044312, 29.60654484879275, 29.08733056157062, 20.410197059039746, 15.963600171400746, 7.156916074477735, 9.3736141207349, 8.7844952928395, 15.876417002177924, 36.57874584811019, 11.142846174065783, 11.269949789686082, 20.723246484955315, 12.374171497812947, 17.212526660419122, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1976401698049856, "mean_inference_ms": 1.2917348502528663, "mean_action_processing_ms": 0.05408928066053971, "mean_env_wait_ms": 1.1935751206432241, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 636400, "timers": {"sample_time_ms": 1156.447, "sample_throughput": 6571.854, "learn_time_ms": 304.819, "learn_throughput": 24932.793, "update_time_ms": 2.926}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366852e-11, "cur_lr": 0.001, "total_loss": 0.03723038453608751, "policy_loss": -0.018268724670633674, "vf_loss": 0.05549911595880985, "vf_explained_var": 0.9628487825393677, "kl": 0.001833420421462506, "entropy": -5.134965896606445, "entropy_coeff": 0.0}}, "num_steps_sampled": 636400, "num_steps_trained": 636400}, "done": false, "episodes_total": 618, "training_iteration": 87, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-06-58", "timestamp": 1617635218, "time_this_iter_s": 1.407909870147705, "time_total_s": 219.63044357299805, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a2050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.84397912025452, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 70.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.569394323487195, "episode_reward_min": 7.351102804871326, "episode_reward_mean": 22.62736274397446, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.799343706333353, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19755708136588881, "mean_inference_ms": 1.2897455142994898, "mean_action_processing_ms": 0.0540990852201047, "mean_env_wait_ms": 1.193243354762495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 644000, "timers": {"sample_time_ms": 1155.42, "sample_throughput": 6577.697, "learn_time_ms": 304.62, "learn_throughput": 24949.107, "update_time_ms": 2.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-12, "cur_lr": 0.001, "total_loss": 0.14417237043380737, "policy_loss": 0.01613624906167388, "vf_loss": 0.12803610414266586, "vf_explained_var": 0.9746440052986145, "kl": 0.002064369386062026, "entropy": -4.857954502105713, "entropy_coeff": 0.0}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 637, "training_iteration": 88, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-00", "timestamp": 1617635220, "time_this_iter_s": 1.5248613357543945, "time_total_s": 221.15530490875244, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451ddd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.36884045600891, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 71.06666666666668, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.569394323487195, "episode_reward_min": 7.351102804871326, "episode_reward_mean": 22.62736274397446, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.799343706333353, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [16.90004767876904, 11.307178983530342, 14.983439469212199, 19.705219591324372, 21.98823307787123, 17.780717052151363, 18.1056846591468, 26.203406701609953, 16.078936721857573, 16.630339172244966, 19.973406712982555, 13.437986948104738, 9.38972300573465, 20.612112444768094, 19.677496049643253, 25.693707936085747, 29.417195432941092, 30.2961504682707, 14.608314534253, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19755708136588881, "mean_inference_ms": 1.2897455142994898, "mean_action_processing_ms": 0.05409908522010468, "mean_env_wait_ms": 1.1932433547624948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 651600, "timers": {"sample_time_ms": 1157.012, "sample_throughput": 6568.645, "learn_time_ms": 304.444, "learn_throughput": 24963.581, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-12, "cur_lr": 0.001, "total_loss": 0.01723270444199443, "policy_loss": 0.00168263865634799, "vf_loss": 0.015550065785646439, "vf_explained_var": 0.9760761260986328, "kl": 0.002479923889040947, "entropy": -4.981661081314087, "entropy_coeff": 0.0}}, "num_steps_sampled": 651600, "num_steps_trained": 651600}, "done": false, "episodes_total": 637, "training_iteration": 89, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-01", "timestamp": 1617635221, "time_this_iter_s": 1.4392454624176025, "time_total_s": 222.59455037117004, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.808085918426514, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.60923390298467, "episode_reward_min": 7.351102804871326, "episode_reward_mean": 23.46432109645676, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.487250408368727, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19784731478159695, "mean_inference_ms": 1.2882394746311263, "mean_action_processing_ms": 0.05410870286909019, "mean_env_wait_ms": 1.193016786070867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 659200, "timers": {"sample_time_ms": 1157.827, "sample_throughput": 6564.019, "learn_time_ms": 304.279, "learn_throughput": 24977.097, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458565e-12, "cur_lr": 0.001, "total_loss": 0.19606520980596542, "policy_loss": 0.016703195637091994, "vf_loss": 0.17936202883720398, "vf_explained_var": 0.9695385098457336, "kl": 0.003922908334061503, "entropy": -5.121309995651245, "entropy_coeff": 0.0}}, "num_steps_sampled": 659200, "num_steps_trained": 659200}, "done": false, "episodes_total": 656, "training_iteration": 90, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-03", "timestamp": 1617635223, "time_this_iter_s": 1.5424578189849854, "time_total_s": 224.13700819015503, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 59.3505437374115, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 80.69999999999999, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.60923390298467, "episode_reward_min": 7.351102804871326, "episode_reward_mean": 23.464321096456764, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.48725040836873, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19784731478159692, "mean_inference_ms": 1.2882394746311263, "mean_action_processing_ms": 0.05410870286909019, "mean_env_wait_ms": 1.1930167860708671, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 666800, "timers": {"sample_time_ms": 1158.434, "sample_throughput": 6560.578, "learn_time_ms": 305.183, "learn_throughput": 24903.067, "update_time_ms": 2.951}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729282e-13, "cur_lr": 0.001, "total_loss": 0.03369061078410596, "policy_loss": 0.023228425066918135, "vf_loss": 0.010462179780006409, "vf_explained_var": 0.9895483255386353, "kl": 0.0024125565541908145, "entropy": -5.177009105682373, "entropy_coeff": 0.0}}, "num_steps_sampled": 666800, "num_steps_trained": 666800}, "done": false, "episodes_total": 656, "training_iteration": 91, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-04", "timestamp": 1617635224, "time_this_iter_s": 1.4407038688659668, "time_total_s": 225.577712059021, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 60.791247606277466, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.60923390298467, "episode_reward_min": 7.351102804871326, "episode_reward_mean": 23.464321096456764, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.48725040836873, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [7.351102804871326, 12.452339516419599, 18.93394215392507, 29.524749526218905, 31.922145542462978, 14.202782632730045, 35.77176248359804, 38.79355287859822, 22.73782931822624, 10.97733095001058, 22.7232271574706, 23.225486307031662, 25.288349154618636, 25.8135325363322, 15.972594692027624, 15.52031845025041, 22.75584281755899, 33.845193601352044, 23.29116692022426, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19784731478159692, "mean_inference_ms": 1.2882394746311263, "mean_action_processing_ms": 0.05410870286909019, "mean_env_wait_ms": 1.1930167860708671, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 674400, "timers": {"sample_time_ms": 1159.149, "sample_throughput": 6556.533, "learn_time_ms": 305.22, "learn_throughput": 24900.068, "update_time_ms": 2.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.547473508864641e-13, "cur_lr": 0.001, "total_loss": 0.06710919551551342, "policy_loss": 0.006950554205104709, "vf_loss": 0.06015864200890064, "vf_explained_var": 0.9664026498794556, "kl": 0.002316436846740544, "entropy": -5.191789865493774, "entropy_coeff": 0.0}}, "num_steps_sampled": 674400, "num_steps_trained": 674400}, "done": false, "episodes_total": 656, "training_iteration": 92, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-06", "timestamp": 1617635226, "time_this_iter_s": 1.4356353282928467, "time_total_s": 227.01334738731384, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451df80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 62.22688293457031, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 70.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.60923390298467, "episode_reward_min": 9.379050443465834, "episode_reward_mean": 23.890935989570895, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.407843797059996, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1977557991799267, "mean_inference_ms": 1.2869336387307397, "mean_action_processing_ms": 0.05411640047940797, "mean_env_wait_ms": 1.1928159458172798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 682000, "timers": {"sample_time_ms": 1157.508, "sample_throughput": 6565.827, "learn_time_ms": 306.4, "learn_throughput": 24804.148, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323206e-13, "cur_lr": 0.001, "total_loss": 0.14617636054754257, "policy_loss": -0.012343763723038137, "vf_loss": 0.15852012485265732, "vf_explained_var": 0.9731477499008179, "kl": 0.0028881909092888236, "entropy": -4.931703090667725, "entropy_coeff": 0.0}}, "num_steps_sampled": 682000, "num_steps_trained": 682000}, "done": false, "episodes_total": 675, "training_iteration": 93, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-07", "timestamp": 1617635227, "time_this_iter_s": 1.5413987636566162, "time_total_s": 228.55474615097046, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 63.76828169822693, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 48.60923390298467, "episode_reward_min": 9.379050443465834, "episode_reward_mean": 23.890935989570895, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.407843797059986, "MDD_min": 17.333031932858958, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [17.490222364523614, 31.085186668283868, 21.744599035424926, 22.602529897339817, 23.948770641950308, 17.064278590293387, 9.379050443465834, 24.993167682534104, 25.324222302822836, 24.58424657031067, 27.233045348746675, 30.505745888724206, 17.74828330841114, 13.593673769771797, 19.148337628010765, 37.017011573787705, 18.044995563168513, 11.514902430812484, 23.769058332332783, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1977557991799267, "mean_inference_ms": 1.2869336387307397, "mean_action_processing_ms": 0.054116400479407974, "mean_env_wait_ms": 1.1928159458172796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 689600, "timers": {"sample_time_ms": 1157.007, "sample_throughput": 6568.673, "learn_time_ms": 306.047, "learn_throughput": 24832.823, "update_time_ms": 2.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161603e-13, "cur_lr": 0.001, "total_loss": 0.01427428750321269, "policy_loss": -0.001986530507565476, "vf_loss": 0.01626081671565771, "vf_explained_var": 0.9791075587272644, "kl": 0.001711664313916117, "entropy": -5.097660303115845, "entropy_coeff": 0.0}}, "num_steps_sampled": 689600, "num_steps_trained": 689600}, "done": false, "episodes_total": 675, "training_iteration": 94, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-09", "timestamp": 1617635229, "time_this_iter_s": 1.4121861457824707, "time_total_s": 229.96693229675293, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451ddd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 65.1804678440094, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 57.59367275465739, "episode_reward_min": 10.129541250186623, "episode_reward_mean": 25.10194623386296, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.33848151823323, "MDD_min": 19.885046870752667, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19797373486534017, "mean_inference_ms": 1.2857770278755358, "mean_action_processing_ms": 0.05411307002375721, "mean_env_wait_ms": 1.1925462677690637, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 697200, "timers": {"sample_time_ms": 1156.447, "sample_throughput": 6571.853, "learn_time_ms": 305.325, "learn_throughput": 24891.483, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-14, "cur_lr": 0.001, "total_loss": 0.18618686497211456, "policy_loss": -0.006271029531490058, "vf_loss": 0.192457877099514, "vf_explained_var": 0.9745466709136963, "kl": 0.0030872493516653776, "entropy": -5.212557792663574, "entropy_coeff": 0.0}}, "num_steps_sampled": 697200, "num_steps_trained": 697200}, "done": false, "episodes_total": 694, "training_iteration": 95, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-10", "timestamp": 1617635230, "time_this_iter_s": 1.5287251472473145, "time_total_s": 231.49565744400024, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 66.70919299125671, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 68.13333333333333, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 57.59367275465739, "episode_reward_min": 10.129541250186623, "episode_reward_mean": 25.101946233862954, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.33848151823323, "MDD_min": 19.885046870752667, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1979737348653402, "mean_inference_ms": 1.2857770278755358, "mean_action_processing_ms": 0.05411307002375722, "mean_env_wait_ms": 1.192546267769064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 704800, "timers": {"sample_time_ms": 1156.283, "sample_throughput": 6572.787, "learn_time_ms": 304.666, "learn_throughput": 24945.364, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-14, "cur_lr": 0.001, "total_loss": -0.004233659710735083, "policy_loss": -0.016521029639989138, "vf_loss": 0.012287377379834652, "vf_explained_var": 0.9906394481658936, "kl": 0.00208917394047603, "entropy": -5.238225698471069, "entropy_coeff": 0.0}}, "num_steps_sampled": 704800, "num_steps_trained": 704800}, "done": false, "episodes_total": 694, "training_iteration": 96, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-12", "timestamp": 1617635232, "time_this_iter_s": 1.4314732551574707, "time_total_s": 232.92713069915771, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451df80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 68.14066624641418, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 57.59367275465739, "episode_reward_min": 10.129541250186623, "episode_reward_mean": 25.101946233862954, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.33848151823323, "MDD_min": 19.885046870752667, "MDD_max": 41.49626769240888}, "hist_stats": {"episode_reward": [18.012202748996696, 30.197514641706334, 38.30614249903982, 16.800060473031152, 41.04631782908942, 25.404512706183173, 30.541868802109878, 20.808122373679996, 28.0715829100268, 19.025187950446046, 24.616739564596127, 10.129541250186623, 14.262777300097849, 14.997006079592667, 25.266627662193265, 16.454879749761933, 18.578783582013667, 19.055516048100383, 48.569394323487195, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1979737348653402, "mean_inference_ms": 1.2857770278755358, "mean_action_processing_ms": 0.05411307002375722, "mean_env_wait_ms": 1.192546267769064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 712400, "timers": {"sample_time_ms": 1158.528, "sample_throughput": 6560.051, "learn_time_ms": 305.281, "learn_throughput": 24895.134, "update_time_ms": 2.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202004e-14, "cur_lr": 0.001, "total_loss": 0.07377779856324196, "policy_loss": -0.008768468804191798, "vf_loss": 0.08254627138376236, "vf_explained_var": 0.9642742872238159, "kl": 0.002295653452165425, "entropy": -5.329421043395996, "entropy_coeff": 0.0}}, "num_steps_sampled": 712400, "num_steps_trained": 712400}, "done": false, "episodes_total": 694, "training_iteration": 97, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-13", "timestamp": 1617635233, "time_this_iter_s": 1.436786413192749, "time_total_s": 234.36391711235046, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 69.57745265960693, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 74.30000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 69.09636903121067, "episode_reward_min": 11.314232287469952, "episode_reward_mean": 26.185521131568994, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.792603956697643, "MDD_min": 18.372379770964738, "MDD_max": 36.90423534353143}, "hist_stats": {"episode_reward": [42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19784191512737642, "mean_inference_ms": 1.284742895155786, "mean_action_processing_ms": 0.054112103753762374, "mean_env_wait_ms": 1.1922370783235725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 720000, "timers": {"sample_time_ms": 1160.376, "sample_throughput": 6549.604, "learn_time_ms": 305.513, "learn_throughput": 24876.186, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-15, "cur_lr": 0.001, "total_loss": 0.20982424169778824, "policy_loss": -0.005669597128871828, "vf_loss": 0.2154938355088234, "vf_explained_var": 0.9720767736434937, "kl": 0.0028764117741957307, "entropy": -5.019657850265503, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 713, "training_iteration": 98, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-15", "timestamp": 1617635235, "time_this_iter_s": 1.545557975769043, "time_total_s": 235.9094750881195, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 71.12301063537598, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 80.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 69.09636903121067, "episode_reward_min": 11.314232287469952, "episode_reward_mean": 26.185521131568994, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.79260395669764, "MDD_min": 18.372379770964738, "MDD_max": 36.90423534353143}, "hist_stats": {"episode_reward": [36.62562249830093, 27.09238646050526, 14.787288161823403, 24.41967959797651, 22.185588764536302, 29.184329632996427, 32.72013463302141, 11.314232287469952, 19.35168906838471, 14.24422954980836, 28.93172126990752, 32.85824005548157, 16.966980310362896, 46.720100497855064, 29.662248146778083, 22.722116146969963, 19.650580436321803, 37.88450068454495, 25.701613689434577, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1978419151273764, "mean_inference_ms": 1.284742895155786, "mean_action_processing_ms": 0.054112103753762374, "mean_env_wait_ms": 1.1922370783235723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 727600, "timers": {"sample_time_ms": 1157.811, "sample_throughput": 6564.114, "learn_time_ms": 305.595, "learn_throughput": 24869.479, "update_time_ms": 2.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-15, "cur_lr": 0.001, "total_loss": 0.02851843973621726, "policy_loss": 0.008468771120533347, "vf_loss": 0.020049668848514557, "vf_explained_var": 0.9789184927940369, "kl": 0.0023958784295246005, "entropy": -5.189043760299683, "entropy_coeff": 0.0}}, "num_steps_sampled": 727600, "num_steps_trained": 727600}, "done": false, "episodes_total": 713, "training_iteration": 99, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-16", "timestamp": 1617635236, "time_this_iter_s": 1.4144670963287354, "time_total_s": 237.32394218444824, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 72.53747773170471, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 73.65, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 11.734050907736401, "episode_reward_mean": 27.316279383906654, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.463828030939734, "MDD_min": 18.372379770964738, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1980279130120587, "mean_inference_ms": 1.2839443628078349, "mean_action_processing_ms": 0.05411701316344329, "mean_env_wait_ms": 1.1920347326866556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 735200, "timers": {"sample_time_ms": 1157.692, "sample_throughput": 6564.786, "learn_time_ms": 305.65, "learn_throughput": 24865.025, "update_time_ms": 2.918}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002505e-15, "cur_lr": 0.001, "total_loss": 0.2564995661377907, "policy_loss": 0.013144137803465128, "vf_loss": 0.24335545301437378, "vf_explained_var": 0.9764987230300903, "kl": 0.0034660602686926723, "entropy": -5.290969371795654, "entropy_coeff": 0.0}}, "num_steps_sampled": 735200, "num_steps_trained": 735200}, "done": false, "episodes_total": 732, "training_iteration": 100, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-18", "timestamp": 1617635238, "time_this_iter_s": 1.5420811176300049, "time_total_s": 238.86602330207825, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451df80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 74.07955884933472, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 11.734050907736401, "episode_reward_mean": 27.316279383906654, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.46382803093973, "MDD_min": 18.372379770964738, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1980279130120587, "mean_inference_ms": 1.2839443628078349, "mean_action_processing_ms": 0.0541170131634433, "mean_env_wait_ms": 1.1920347326866556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 742800, "timers": {"sample_time_ms": 1157.024, "sample_throughput": 6568.577, "learn_time_ms": 304.967, "learn_throughput": 24920.737, "update_time_ms": 2.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.881784197001252e-16, "cur_lr": 0.001, "total_loss": -0.005670530721545219, "policy_loss": -0.01919678784906864, "vf_loss": 0.01352625759318471, "vf_explained_var": 0.9923467636108398, "kl": 0.002586150309070945, "entropy": -5.294939756393433, "entropy_coeff": 0.0}}, "num_steps_sampled": 742800, "num_steps_trained": 742800}, "done": false, "episodes_total": 732, "training_iteration": 101, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-19", "timestamp": 1617635239, "time_this_iter_s": 1.42684006690979, "time_total_s": 240.29286336898804, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553451d560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 75.5063989162445, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 70.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 11.734050907736401, "episode_reward_mean": 27.316279383906654, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.46382803093973, "MDD_min": 18.372379770964738, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [16.79323476757647, 21.901472152793488, 21.177669511460927, 18.926675190022802, 20.08528826362947, 15.502828533089609, 31.57620074474024, 20.37004339943203, 20.250817436974447, 14.499986933427754, 25.53305043950528, 30.7337871440659, 19.64510020707067, 12.53361161801778, 22.29394734359994, 27.06987777095031, 36.620210738422045, 33.20887158389993, 17.370799145947252, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1980279130120587, "mean_inference_ms": 1.2839443628078349, "mean_action_processing_ms": 0.0541170131634433, "mean_env_wait_ms": 1.1920347326866556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 750400, "timers": {"sample_time_ms": 1155.652, "sample_throughput": 6576.375, "learn_time_ms": 303.919, "learn_throughput": 25006.698, "update_time_ms": 2.942}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.440892098500626e-16, "cur_lr": 0.001, "total_loss": 0.07045023515820503, "policy_loss": -0.008011665689991787, "vf_loss": 0.0784618966281414, "vf_explained_var": 0.9742937684059143, "kl": 0.0018873114604502916, "entropy": -5.356496810913086, "entropy_coeff": 0.0}}, "num_steps_sampled": 750400, "num_steps_trained": 750400}, "done": false, "episodes_total": 732, "training_iteration": 102, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-21", "timestamp": 1617635241, "time_this_iter_s": 1.4121124744415283, "time_total_s": 241.70497584342957, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 76.91851139068604, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 71.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 11.734050907736401, "episode_reward_mean": 28.65043489229225, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.940375003515534, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19790050028017434, "mean_inference_ms": 1.2830872887284017, "mean_action_processing_ms": 0.054113758002951026, "mean_env_wait_ms": 1.1917657672747408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 758000, "timers": {"sample_time_ms": 1156.122, "sample_throughput": 6573.701, "learn_time_ms": 302.976, "learn_throughput": 25084.536, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.220446049250313e-16, "cur_lr": 0.001, "total_loss": 0.1546756811439991, "policy_loss": -0.037238209042698145, "vf_loss": 0.191913902759552, "vf_explained_var": 0.9791602492332458, "kl": 0.0017948761815205216, "entropy": -5.080796003341675, "entropy_coeff": 0.0}}, "num_steps_sampled": 758000, "num_steps_trained": 758000}, "done": false, "episodes_total": 751, "training_iteration": 103, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-22", "timestamp": 1617635242, "time_this_iter_s": 1.5361971855163574, "time_total_s": 243.24117302894592, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55467cacb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 78.45470857620239, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 72.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 11.734050907736401, "episode_reward_mean": 28.650434892292246, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.94037500351554, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [48.60923390298467, 17.531426860016325, 13.704348856102495, 23.262067835848256, 16.168921394636985, 43.26370627556951, 42.63883343539273, 13.87267361305414, 16.5335094097235, 11.734050907736401, 13.923771507526599, 29.981878193813458, 13.949619208997603, 19.833790210638448, 13.584967094061986, 25.601083342920436, 35.386289841703196, 27.836730118149557, 27.81528756180742, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19790050028017436, "mean_inference_ms": 1.2830872887284017, "mean_action_processing_ms": 0.05411375800295102, "mean_env_wait_ms": 1.1917657672747406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 765600, "timers": {"sample_time_ms": 1157.238, "sample_throughput": 6567.358, "learn_time_ms": 302.821, "learn_throughput": 25097.312, "update_time_ms": 2.92}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251565e-16, "cur_lr": 0.001, "total_loss": 0.013996353838592768, "policy_loss": -0.00696804269682616, "vf_loss": 0.020964395254850388, "vf_explained_var": 0.979523777961731, "kl": 0.001897601003292948, "entropy": -5.213178873062134, "entropy_coeff": 0.0}}, "num_steps_sampled": 765600, "num_steps_trained": 765600}, "done": false, "episodes_total": 751, "training_iteration": 104, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-24", "timestamp": 1617635244, "time_this_iter_s": 1.4217040538787842, "time_total_s": 244.6628770828247, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345579e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 79.87641263008118, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 66.66666666666667, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 29.963462681673082, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.951088131831874, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19811800387370718, "mean_inference_ms": 1.2824536091933996, "mean_action_processing_ms": 0.0541147978594042, "mean_env_wait_ms": 1.1916301576608341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 773200, "timers": {"sample_time_ms": 1157.519, "sample_throughput": 6565.769, "learn_time_ms": 304.147, "learn_throughput": 24987.944, "update_time_ms": 2.917}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-17, "cur_lr": 0.001, "total_loss": 0.2316223382949829, "policy_loss": -0.006069696857593954, "vf_loss": 0.23769204318523407, "vf_explained_var": 0.9797679781913757, "kl": 0.0030281039653345942, "entropy": -5.307784080505371, "entropy_coeff": 0.0}}, "num_steps_sampled": 773200, "num_steps_trained": 773200}, "done": false, "episodes_total": 770, "training_iteration": 105, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-25", "timestamp": 1617635245, "time_this_iter_s": 1.5447320938110352, "time_total_s": 246.20760917663574, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 81.42114472389221, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 29.96346268167309, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.951088131831874, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19811800387370723, "mean_inference_ms": 1.2824536091933998, "mean_action_processing_ms": 0.0541147978594042, "mean_env_wait_ms": 1.1916301576608341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 780800, "timers": {"sample_time_ms": 1155.44, "sample_throughput": 6577.58, "learn_time_ms": 303.64, "learn_throughput": 25029.622, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7755575615628914e-17, "cur_lr": 0.001, "total_loss": 0.021483538090251386, "policy_loss": 0.007683765608817339, "vf_loss": 0.013799775391817093, "vf_explained_var": 0.9925206303596497, "kl": 0.002488506492227316, "entropy": -5.378998041152954, "entropy_coeff": 0.0}}, "num_steps_sampled": 780800, "num_steps_trained": 780800}, "done": false, "episodes_total": 770, "training_iteration": 106, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-27", "timestamp": 1617635247, "time_this_iter_s": 1.4054880142211914, "time_total_s": 247.61309719085693, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 82.8266327381134, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 74.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 29.96346268167309, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.951088131831874, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [23.101005199167012, 27.03856538478081, 28.858641731550417, 18.73235436732007, 40.07798135142669, 21.184304608730148, 37.338365457009026, 17.762989036734247, 27.538699487094245, 16.21808895797899, 38.352800060934285, 26.792018956998163, 38.268767560174624, 28.66016031660935, 57.59367275465739, 28.518859673827055, 29.220573983394264, 15.390817247940518, 26.038047749825225, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19811800387370723, "mean_inference_ms": 1.2824536091933998, "mean_action_processing_ms": 0.0541147978594042, "mean_env_wait_ms": 1.1916301576608341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 788400, "timers": {"sample_time_ms": 1153.882, "sample_throughput": 6586.462, "learn_time_ms": 303.793, "learn_throughput": 25017.04, "update_time_ms": 2.829}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3877787807814457e-17, "cur_lr": 0.001, "total_loss": 0.1014532521367073, "policy_loss": 0.019043230917304754, "vf_loss": 0.08241001889109612, "vf_explained_var": 0.9763418436050415, "kl": 0.0019302847795188427, "entropy": -5.405807971954346, "entropy_coeff": 0.0}}, "num_steps_sampled": 788400, "num_steps_trained": 788400}, "done": false, "episodes_total": 770, "training_iteration": 107, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-28", "timestamp": 1617635248, "time_this_iter_s": 1.422128677368164, "time_total_s": 249.0352258682251, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 84.24876141548157, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 30.999921668535556, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.558996041712714, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19806238673721321, "mean_inference_ms": 1.2818130091020083, "mean_action_processing_ms": 0.05411740907001537, "mean_env_wait_ms": 1.191531757124655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 796000, "timers": {"sample_time_ms": 1152.978, "sample_throughput": 6591.628, "learn_time_ms": 303.75, "learn_throughput": 25020.583, "update_time_ms": 2.814}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.938893903907228e-18, "cur_lr": 0.001, "total_loss": 0.2290690690279007, "policy_loss": -0.0005737314349971712, "vf_loss": 0.2296428084373474, "vf_explained_var": 0.9786932468414307, "kl": 0.0026596056995913386, "entropy": -5.161339521408081, "entropy_coeff": 0.0}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 789, "training_iteration": 108, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-30", "timestamp": 1617635250, "time_this_iter_s": 1.536100149154663, "time_total_s": 250.57132601737976, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 85.78486156463623, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 77.5, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 30.99992166853555, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.558996041712714, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [20.165598990331805, 25.283615104164095, 23.16631523763045, 32.94072519732661, 27.45793208856138, 42.112726793644185, 38.66218973091966, 19.141321618093215, 12.585848770981166, 24.525255568081754, 28.462025429139796, 49.48594959041127, 24.978000590187886, 19.63118041082658, 24.432788147419597, 22.306616382024583, 69.09636903121067, 18.840293424524976, 27.99857006849435, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19806238673721321, "mean_inference_ms": 1.2818130091020083, "mean_action_processing_ms": 0.05411740907001537, "mean_env_wait_ms": 1.1915317571246553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 803600, "timers": {"sample_time_ms": 1155.105, "sample_throughput": 6579.491, "learn_time_ms": 303.773, "learn_throughput": 25018.678, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.469446951953614e-18, "cur_lr": 0.001, "total_loss": 0.023059776052832603, "policy_loss": 0.001328848535194993, "vf_loss": 0.021730929613113403, "vf_explained_var": 0.9810817241668701, "kl": 0.002644869266077876, "entropy": -5.349223852157593, "entropy_coeff": 0.0}}, "num_steps_sampled": 803600, "num_steps_trained": 803600}, "done": false, "episodes_total": 789, "training_iteration": 109, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-31", "timestamp": 1617635251, "time_this_iter_s": 1.4371097087860107, "time_total_s": 252.00843572616577, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 87.22197127342224, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 72.45, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 31.758984084917987, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.92420992025974, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19824706821275273, "mean_inference_ms": 1.281149697665089, "mean_action_processing_ms": 0.05411563527741227, "mean_env_wait_ms": 1.1914322758544085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 811200, "timers": {"sample_time_ms": 1153.025, "sample_throughput": 6591.357, "learn_time_ms": 303.741, "learn_throughput": 25021.357, "update_time_ms": 2.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.734723475976807e-18, "cur_lr": 0.001, "total_loss": 0.24437536299228668, "policy_loss": -0.014679596293717623, "vf_loss": 0.2590549886226654, "vf_explained_var": 0.9814978241920471, "kl": 0.0032791736302897334, "entropy": -5.447049140930176, "entropy_coeff": 0.0}}, "num_steps_sampled": 811200, "num_steps_trained": 811200}, "done": false, "episodes_total": 808, "training_iteration": 110, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-33", "timestamp": 1617635253, "time_this_iter_s": 1.520892858505249, "time_total_s": 253.52932858467102, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534580440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 88.74286413192749, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 71.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 31.758984084917987, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.924209920259738, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982470682127527, "mean_inference_ms": 1.281149697665089, "mean_action_processing_ms": 0.05411563527741227, "mean_env_wait_ms": 1.1914322758544083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 818800, "timers": {"sample_time_ms": 1153.468, "sample_throughput": 6588.826, "learn_time_ms": 303.622, "learn_throughput": 25031.13, "update_time_ms": 2.815}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.673617379884035e-19, "cur_lr": 0.001, "total_loss": 0.0055069876834750175, "policy_loss": -0.010378178994869813, "vf_loss": 0.01588517101481557, "vf_explained_var": 0.9925075769424438, "kl": 0.001575463858898729, "entropy": -5.55619740486145, "entropy_coeff": 0.0}}, "num_steps_sampled": 818800, "num_steps_trained": 818800}, "done": false, "episodes_total": 808, "training_iteration": 111, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-34", "timestamp": 1617635254, "time_this_iter_s": 1.4303219318389893, "time_total_s": 254.95965051651, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 90.17318606376648, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 71.65, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 75.87026608175834, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 31.758984084917987, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.924209920259738, "MDD_min": 12.244411019328538, "MDD_max": 37.0221916254648}, "hist_stats": {"episode_reward": [33.113637849431015, 25.5882453120618, 27.248893158047437, 24.19012829342227, 36.10222809602065, 29.924967883192057, 29.532635459131292, 28.894071858912202, 36.36068401729946, 23.294113314140798, 29.013240711659215, 29.218528665391425, 37.88729825774422, 28.600377424408766, 38.21771042682266, 22.170991865230697, 33.85239194358938, 29.281072322344308, 34.814438486000675, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982470682127527, "mean_inference_ms": 1.281149697665089, "mean_action_processing_ms": 0.05411563527741227, "mean_env_wait_ms": 1.1914322758544083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 826400, "timers": {"sample_time_ms": 1153.808, "sample_throughput": 6586.886, "learn_time_ms": 304.309, "learn_throughput": 24974.614, "update_time_ms": 2.815}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-19, "cur_lr": 0.001, "total_loss": 0.12265124544501305, "policy_loss": -0.000706058581272373, "vf_loss": 0.12335732206702232, "vf_explained_var": 0.9735694527626038, "kl": 0.002229598117992282, "entropy": -5.578641891479492, "entropy_coeff": 0.0}}, "num_steps_sampled": 826400, "num_steps_trained": 826400}, "done": false, "episodes_total": 808, "training_iteration": 112, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-36", "timestamp": 1617635256, "time_this_iter_s": 1.4221782684326172, "time_total_s": 256.3818287849426, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 91.5953643321991, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 72.05, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 32.96893384022041, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.77982043432975, "MDD_min": 12.244411019328538, "MDD_max": 36.472627713032026}, "hist_stats": {"episode_reward": [28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19816259683016177, "mean_inference_ms": 1.28056533479852, "mean_action_processing_ms": 0.05411436240492992, "mean_env_wait_ms": 1.1913898800630383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 834000, "timers": {"sample_time_ms": 1153.078, "sample_throughput": 6591.055, "learn_time_ms": 304.377, "learn_throughput": 24969.046, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.168404344971009e-19, "cur_lr": 0.001, "total_loss": 0.3425484597682953, "policy_loss": -0.028020216152071953, "vf_loss": 0.3705686777830124, "vf_explained_var": 0.9717422127723694, "kl": 0.0019085714011453092, "entropy": -5.358128309249878, "entropy_coeff": 0.0}}, "num_steps_sampled": 834000, "num_steps_trained": 834000}, "done": false, "episodes_total": 827, "training_iteration": 113, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-37", "timestamp": 1617635257, "time_this_iter_s": 1.5291545391082764, "time_total_s": 257.9109833240509, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 93.12451887130737, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 69.39999999999999, "ram_util_percent": 61.76666666666667}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 32.96893384022041, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.779820434329753, "MDD_min": 12.244411019328538, "MDD_max": 36.472627713032026}, "hist_stats": {"episode_reward": [75.87026608175834, 35.56758042098234, 18.283775966682185, 24.59230679548952, 20.72265522546599, 30.72278255202243, 22.008125689583373, 27.472058534187944, 20.63422097719946, 17.760927984110687, 46.92802851695875, 26.260445933960817, 41.847014048267056, 22.97138515054539, 62.23087043520514, 48.82418866730876, 18.834535131598262, 19.771825056398683, 34.20908249762135, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19816259683016177, "mean_inference_ms": 1.28056533479852, "mean_action_processing_ms": 0.05411436240492991, "mean_env_wait_ms": 1.1913898800630383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 841600, "timers": {"sample_time_ms": 1152.597, "sample_throughput": 6593.807, "learn_time_ms": 304.418, "learn_throughput": 24965.704, "update_time_ms": 2.85}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0842021724855044e-19, "cur_lr": 0.001, "total_loss": 0.0027175378054380417, "policy_loss": -0.023737878538668156, "vf_loss": 0.02645542100071907, "vf_explained_var": 0.9791472554206848, "kl": 0.002513527637347579, "entropy": -5.500483751296997, "entropy_coeff": 0.0}}, "num_steps_sampled": 841600, "num_steps_trained": 841600}, "done": false, "episodes_total": 827, "training_iteration": 114, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-39", "timestamp": 1617635259, "time_this_iter_s": 1.417301893234253, "time_total_s": 259.32828521728516, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534580440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 94.54182076454163, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 74.45, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 34.91108618404548, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.52263129297635, "MDD_min": 15.975154515885432, "MDD_max": 36.472627713032026}, "hist_stats": {"episode_reward": [53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19831224577306383, "mean_inference_ms": 1.2800714641884425, "mean_action_processing_ms": 0.05411437177618435, "mean_env_wait_ms": 1.1913864041392006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 849200, "timers": {"sample_time_ms": 1152.189, "sample_throughput": 6596.141, "learn_time_ms": 303.223, "learn_throughput": 25064.055, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.421010862427522e-20, "cur_lr": 0.001, "total_loss": 0.45670533180236816, "policy_loss": 0.023992233909666538, "vf_loss": 0.4327131062746048, "vf_explained_var": 0.9741761088371277, "kl": 0.004136802861467004, "entropy": -5.568385124206543, "entropy_coeff": 0.0}}, "num_steps_sampled": 849200, "num_steps_trained": 849200}, "done": false, "episodes_total": 846, "training_iteration": 115, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-40", "timestamp": 1617635260, "time_this_iter_s": 1.5285677909851074, "time_total_s": 260.85685300827026, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 96.07038855552673, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 34.91108618404547, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.52263129297635, "MDD_min": 15.975154515885432, "MDD_max": 36.472627713032026}, "hist_stats": {"episode_reward": [28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19831224577306383, "mean_inference_ms": 1.2800714641884423, "mean_action_processing_ms": 0.05411437177618435, "mean_env_wait_ms": 1.1913864041392004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 856800, "timers": {"sample_time_ms": 1151.943, "sample_throughput": 6597.55, "learn_time_ms": 304.344, "learn_throughput": 24971.722, "update_time_ms": 2.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.710505431213761e-20, "cur_lr": 0.001, "total_loss": 0.0021125185303390026, "policy_loss": -0.01348774996586144, "vf_loss": 0.01560027152299881, "vf_explained_var": 0.9933912754058838, "kl": 0.0019633216434158385, "entropy": -5.656966924667358, "entropy_coeff": 0.0}}, "num_steps_sampled": 856800, "num_steps_trained": 856800}, "done": false, "episodes_total": 846, "training_iteration": 116, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-42", "timestamp": 1617635262, "time_this_iter_s": 1.4136385917663574, "time_total_s": 262.2704916000366, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 97.48402714729309, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 73.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 12.000008784650799, "episode_reward_mean": 34.91108618404547, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.52263129297635, "MDD_min": 15.975154515885432, "MDD_max": 36.472627713032026}, "hist_stats": {"episode_reward": [28.597595714010268, 15.171614365603727, 36.0634616096314, 14.542821796335586, 24.658039102637233, 12.000008784650799, 41.113163960818596, 37.858728307752926, 28.523087955267155, 34.42990868541561, 21.99009586640784, 33.525862778637894, 23.587085709026308, 32.317396356747444, 46.53910775816441, 44.154775098308114, 20.633588052201354, 22.79868988202096, 40.971507496107044, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19831224577306383, "mean_inference_ms": 1.2800714641884423, "mean_action_processing_ms": 0.05411437177618435, "mean_env_wait_ms": 1.1913864041392004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 864400, "timers": {"sample_time_ms": 1152.58, "sample_throughput": 6593.904, "learn_time_ms": 304.401, "learn_throughput": 24967.089, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3552527156068805e-20, "cur_lr": 0.001, "total_loss": 0.11827727779746056, "policy_loss": 0.00753738428466022, "vf_loss": 0.11073989421129227, "vf_explained_var": 0.9775848984718323, "kl": 0.0030576925491914153, "entropy": -5.6084818840026855, "entropy_coeff": 0.0}}, "num_steps_sampled": 864400, "num_steps_trained": 864400}, "done": false, "episodes_total": 846, "training_iteration": 117, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-43", "timestamp": 1617635263, "time_this_iter_s": 1.429337739944458, "time_total_s": 263.6998293399811, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534557950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 98.91336488723755, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 15.279725244444741, "episode_reward_mean": 37.03333285481793, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.205008225519624, "MDD_min": 15.975154515885432, "MDD_max": 33.93275005123384}, "hist_stats": {"episode_reward": [24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982429024161673, "mean_inference_ms": 1.279532722842346, "mean_action_processing_ms": 0.0541152699682892, "mean_env_wait_ms": 1.1913123328817132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 872000, "timers": {"sample_time_ms": 1152.878, "sample_throughput": 6592.2, "learn_time_ms": 305.622, "learn_throughput": 24867.306, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.776263578034403e-21, "cur_lr": 0.001, "total_loss": 0.30625298619270325, "policy_loss": -0.015535047743469477, "vf_loss": 0.3217880427837372, "vf_explained_var": 0.9772506952285767, "kl": 0.002667495980858803, "entropy": -5.456133842468262, "entropy_coeff": 0.0}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 865, "training_iteration": 118, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-45", "timestamp": 1617635265, "time_this_iter_s": 1.5513691902160645, "time_total_s": 265.25119853019714, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 100.46473407745361, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 15.279725244444741, "episode_reward_mean": 37.03333285481794, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.20500822551963, "MDD_min": 15.975154515885432, "MDD_max": 33.93275005123384}, "hist_stats": {"episode_reward": [19.93219417346382, 39.87571164153476, 49.026803537174516, 16.325317989430733, 20.93193447563664, 23.701800493530662, 33.92484226369717, 24.68558984398443, 49.22735932054304, 24.815144824592437, 34.06260273872171, 27.460954920247573, 42.123495970102695, 37.73182793456302, 22.67621607306519, 15.335281236728104, 30.454455765459926, 20.44834446782783, 48.9243453288478, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19824290241616727, "mean_inference_ms": 1.279532722842346, "mean_action_processing_ms": 0.05411526996828919, "mean_env_wait_ms": 1.1913123328817132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 879600, "timers": {"sample_time_ms": 1152.73, "sample_throughput": 6593.044, "learn_time_ms": 305.279, "learn_throughput": 24895.26, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3881317890172014e-21, "cur_lr": 0.001, "total_loss": 0.00858527421951294, "policy_loss": -0.0167450956068933, "vf_loss": 0.02533036842942238, "vf_explained_var": 0.9829512238502502, "kl": 0.0019274370861239731, "entropy": -5.573713302612305, "entropy_coeff": 0.0}}, "num_steps_sampled": 879600, "num_steps_trained": 879600}, "done": false, "episodes_total": 865, "training_iteration": 119, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-46", "timestamp": 1617635266, "time_this_iter_s": 1.4311466217041016, "time_total_s": 266.68234515190125, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5546032560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 101.89588069915771, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 71.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 15.279725244444741, "episode_reward_mean": 38.139005554794295, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.81352441498301, "MDD_min": 15.975154515885432, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19842391871291223, "mean_inference_ms": 1.2790548852295471, "mean_action_processing_ms": 0.05411859359693487, "mean_env_wait_ms": 1.1912413271616913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 887200, "timers": {"sample_time_ms": 1154.579, "sample_throughput": 6582.485, "learn_time_ms": 306.183, "learn_throughput": 24821.757, "update_time_ms": 2.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6940658945086007e-21, "cur_lr": 0.001, "total_loss": 0.33828650414943695, "policy_loss": 0.011897468939423561, "vf_loss": 0.32638905942440033, "vf_explained_var": 0.9816582202911377, "kl": 0.003317293827421963, "entropy": -5.63276481628418, "entropy_coeff": 0.0}}, "num_steps_sampled": 887200, "num_steps_trained": 887200}, "done": false, "episodes_total": 884, "training_iteration": 120, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-48", "timestamp": 1617635268, "time_this_iter_s": 1.5488512516021729, "time_total_s": 268.2311964035034, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa3b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 103.44473195075989, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 64.96666666666665, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 15.279725244444741, "episode_reward_mean": 38.139005554794295, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.81352441498301, "MDD_min": 15.975154515885432, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19842391871291223, "mean_inference_ms": 1.2790548852295471, "mean_action_processing_ms": 0.05411859359693486, "mean_env_wait_ms": 1.1912413271616913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 894800, "timers": {"sample_time_ms": 1153.512, "sample_throughput": 6588.575, "learn_time_ms": 305.447, "learn_throughput": 24881.545, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.470329472543003e-22, "cur_lr": 0.001, "total_loss": 0.027985805179923773, "policy_loss": 0.012480961624532938, "vf_loss": 0.015504841692745686, "vf_explained_var": 0.9943566918373108, "kl": 0.0013669469044543803, "entropy": -5.756234407424927, "entropy_coeff": 0.0}}, "num_steps_sampled": 894800, "num_steps_trained": 894800}, "done": false, "episodes_total": 884, "training_iteration": 121, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-49", "timestamp": 1617635269, "time_this_iter_s": 1.412123203277588, "time_total_s": 269.643319606781, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 104.85685515403748, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 15.279725244444741, "episode_reward_mean": 38.139005554794295, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.81352441498301, "MDD_min": 15.975154515885432, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [38.06763003339982, 51.4894468868538, 50.24991168769157, 32.21002574666613, 42.74333703587611, 32.747841998587944, 28.947443012631172, 28.620473939167233, 31.70223985822416, 44.97124231105423, 24.546570499726414, 23.021440441656875, 35.516275498985515, 26.264504825398024, 39.003374507041684, 34.88175766029072, 27.1751401554159, 38.25358761449281, 26.953686687727238, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19842391871291223, "mean_inference_ms": 1.2790548852295471, "mean_action_processing_ms": 0.05411859359693486, "mean_env_wait_ms": 1.1912413271616913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 902400, "timers": {"sample_time_ms": 1153.517, "sample_throughput": 6588.546, "learn_time_ms": 305.741, "learn_throughput": 24857.674, "update_time_ms": 2.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.235164736271502e-22, "cur_lr": 0.001, "total_loss": 0.12095458805561066, "policy_loss": -0.0020334398141130805, "vf_loss": 0.1229880303144455, "vf_explained_var": 0.9795578718185425, "kl": 0.0020450978772714734, "entropy": -5.629863023757935, "entropy_coeff": 0.0}}, "num_steps_sampled": 902400, "num_steps_trained": 902400}, "done": false, "episodes_total": 884, "training_iteration": 122, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-50", "timestamp": 1617635270, "time_this_iter_s": 1.4244823455810547, "time_total_s": 271.06780195236206, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aab90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 106.28133749961853, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 38.80482825398977, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.978216541548395, "MDD_min": 15.968792275832355, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19836573681312228, "mean_inference_ms": 1.2785955053480138, "mean_action_processing_ms": 0.05412146203397256, "mean_env_wait_ms": 1.1911862874575307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 910000, "timers": {"sample_time_ms": 1153.849, "sample_throughput": 6586.649, "learn_time_ms": 305.843, "learn_throughput": 24849.38, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.117582368135751e-22, "cur_lr": 0.001, "total_loss": 0.37045738101005554, "policy_loss": 0.028552469797432423, "vf_loss": 0.3419049382209778, "vf_explained_var": 0.9785388708114624, "kl": 0.0031238707015290856, "entropy": -5.5269553661346436, "entropy_coeff": 0.0}}, "num_steps_sampled": 910000, "num_steps_trained": 910000}, "done": false, "episodes_total": 903, "training_iteration": 123, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-52", "timestamp": 1617635272, "time_this_iter_s": 1.534407138824463, "time_total_s": 272.6022090911865, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 107.815744638443, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 38.80482825398977, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.97821654154839, "MDD_min": 15.968792275832355, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [47.21078478197104, 39.21083004734764, 47.083479413551004, 31.48413154719512, 19.5847590117531, 28.695371807692, 24.96039831329523, 26.32781831722794, 63.11872263094568, 40.456258852561355, 31.517714371295618, 40.030279266143936, 16.806247008138694, 51.252087390607635, 37.45203987394328, 19.975085111603708, 46.89335680649866, 31.258405130443116, 23.482955444076264, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19836573681312228, "mean_inference_ms": 1.2785955053480136, "mean_action_processing_ms": 0.05412146203397256, "mean_env_wait_ms": 1.1911862874575307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 917600, "timers": {"sample_time_ms": 1153.09, "sample_throughput": 6590.989, "learn_time_ms": 306.198, "learn_throughput": 24820.525, "update_time_ms": 2.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0587911840678754e-22, "cur_lr": 0.001, "total_loss": 0.00028696097433567047, "policy_loss": -0.024443964241072536, "vf_loss": 0.024730924516916275, "vf_explained_var": 0.9834539890289307, "kl": 0.0017507969751022756, "entropy": -5.623157501220703, "entropy_coeff": 0.0}}, "num_steps_sampled": 917600, "num_steps_trained": 917600}, "done": false, "episodes_total": 903, "training_iteration": 124, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-53", "timestamp": 1617635273, "time_this_iter_s": 1.4128947257995605, "time_total_s": 274.0151038169861, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa3b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 109.22863936424255, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 74.05000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 39.461316058111976, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.591442947920935, "MDD_min": 15.968792275832355, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19852347620200406, "mean_inference_ms": 1.2782047482723764, "mean_action_processing_ms": 0.054124255921330494, "mean_env_wait_ms": 1.1911543772440514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 925200, "timers": {"sample_time_ms": 1154.576, "sample_throughput": 6582.504, "learn_time_ms": 305.628, "learn_throughput": 24866.858, "update_time_ms": 2.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.293955920339377e-23, "cur_lr": 0.001, "total_loss": 0.32447339594364166, "policy_loss": -0.011662273318506777, "vf_loss": 0.336135670542717, "vf_explained_var": 0.9828332662582397, "kl": 0.0025407132925465703, "entropy": -5.671118974685669, "entropy_coeff": 0.0}}, "num_steps_sampled": 925200, "num_steps_trained": 925200}, "done": false, "episodes_total": 922, "training_iteration": 125, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-55", "timestamp": 1617635275, "time_this_iter_s": 1.537449836730957, "time_total_s": 275.55255365371704, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 110.76608920097351, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 78.30000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 39.461316058111976, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.59144294792093, "MDD_min": 15.968792275832355, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19852347620200408, "mean_inference_ms": 1.2782047482723768, "mean_action_processing_ms": 0.0541242559213305, "mean_env_wait_ms": 1.1911543772440516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 932800, "timers": {"sample_time_ms": 1154.649, "sample_throughput": 6582.088, "learn_time_ms": 304.775, "learn_throughput": 24936.425, "update_time_ms": 2.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6469779601696886e-23, "cur_lr": 0.001, "total_loss": 0.03188550379127264, "policy_loss": 0.01576220989227295, "vf_loss": 0.016123298555612564, "vf_explained_var": 0.9942578077316284, "kl": 0.0022961755748838186, "entropy": -5.867229223251343, "entropy_coeff": 0.0}}, "num_steps_sampled": 932800, "num_steps_trained": 932800}, "done": false, "episodes_total": 922, "training_iteration": 126, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-56", "timestamp": 1617635276, "time_this_iter_s": 1.4060778617858887, "time_total_s": 276.95863151550293, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 112.1721670627594, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.67836050144247, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 39.461316058111976, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.59144294792093, "MDD_min": 15.968792275832355, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [33.598873370188926, 29.344547357319364, 39.48076586178959, 88.67836050144247, 24.97134345987898, 53.53272093595205, 28.262526040583747, 36.219049586819494, 41.82182688660366, 42.45177539709529, 20.940606329989983, 32.51771648246444, 43.33628412120844, 53.15155917697031, 38.48184426619137, 28.34212163541427, 54.16304507283733, 28.409775012884985, 35.03769857591254, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19852347620200408, "mean_inference_ms": 1.2782047482723768, "mean_action_processing_ms": 0.0541242559213305, "mean_env_wait_ms": 1.1911543772440516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 940400, "timers": {"sample_time_ms": 1153.727, "sample_throughput": 6587.347, "learn_time_ms": 303.713, "learn_throughput": 25023.617, "update_time_ms": 2.825}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3234889800848443e-23, "cur_lr": 0.001, "total_loss": 0.16637618839740753, "policy_loss": 0.013189806137233973, "vf_loss": 0.1531863734126091, "vf_explained_var": 0.975968599319458, "kl": 0.0034210680751129985, "entropy": -5.680937051773071, "entropy_coeff": 0.0}}, "num_steps_sampled": 940400, "num_steps_trained": 940400}, "done": false, "episodes_total": 922, "training_iteration": 127, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-58", "timestamp": 1617635278, "time_this_iter_s": 1.4099462032318115, "time_total_s": 278.36857771873474, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 113.58211326599121, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 72.5, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.28121199079133, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 40.508802192706405, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.405890881882286, "MDD_min": 11.900166932003156, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19847284263758014, "mean_inference_ms": 1.277782721285358, "mean_action_processing_ms": 0.054124774842157636, "mean_env_wait_ms": 1.1910799510346868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 948000, "timers": {"sample_time_ms": 1153.509, "sample_throughput": 6588.592, "learn_time_ms": 302.855, "learn_throughput": 25094.544, "update_time_ms": 2.814}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.617444900424222e-24, "cur_lr": 0.001, "total_loss": 0.3770028352737427, "policy_loss": 0.002185232238844037, "vf_loss": 0.3748176246881485, "vf_explained_var": 0.9789873361587524, "kl": 0.002138394396752119, "entropy": -5.605301856994629, "entropy_coeff": 0.0}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 941, "training_iteration": 128, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-07-59", "timestamp": 1617635279, "time_this_iter_s": 1.5418298244476318, "time_total_s": 279.9104075431824, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa3b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 115.12394309043884, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 72.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.28121199079133, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 40.508802192706405, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.405890881882286, "MDD_min": 11.900166932003156, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [46.449998649870075, 21.67221220228768, 80.05258254062498, 87.01888810002151, 37.86507903412143, 24.614320687772423, 42.19978891732821, 26.53698374398038, 15.279725244444741, 50.663033870876596, 34.09950179749611, 35.3783509313654, 87.28121199079133, 35.04928830917046, 35.89166330909847, 28.236996384521934, 43.24623976305643, 50.523738182119885, 43.12589878634591, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19847284263758014, "mean_inference_ms": 1.277782721285358, "mean_action_processing_ms": 0.05412477484215763, "mean_env_wait_ms": 1.1910799510346868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 955600, "timers": {"sample_time_ms": 1152.072, "sample_throughput": 6596.812, "learn_time_ms": 303.25, "learn_throughput": 25061.802, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.308722450212111e-24, "cur_lr": 0.001, "total_loss": -0.0019105393439531326, "policy_loss": -0.026950150495395064, "vf_loss": 0.025039605796337128, "vf_explained_var": 0.9832152128219604, "kl": 0.0019047565292567015, "entropy": -5.69684910774231, "entropy_coeff": 0.0}}, "num_steps_sampled": 955600, "num_steps_trained": 955600}, "done": false, "episodes_total": 941, "training_iteration": 129, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-01", "timestamp": 1617635281, "time_this_iter_s": 1.421044111251831, "time_total_s": 281.3314516544342, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 116.54498720169067, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 71.55, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 40.69677152095362, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.31340603237252, "MDD_min": 11.900166932003156, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19860502741286037, "mean_inference_ms": 1.277470544630193, "mean_action_processing_ms": 0.05412641648723522, "mean_env_wait_ms": 1.1910898915039025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 963200, "timers": {"sample_time_ms": 1152.012, "sample_throughput": 6597.151, "learn_time_ms": 302.056, "learn_throughput": 25160.861, "update_time_ms": 2.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6543612251060553e-24, "cur_lr": 0.001, "total_loss": 0.48968780040740967, "policy_loss": 0.00998822064138949, "vf_loss": 0.47969959676265717, "vf_explained_var": 0.9790136814117432, "kl": 0.00257141818292439, "entropy": -5.746178865432739, "entropy_coeff": 0.0}}, "num_steps_sampled": 963200, "num_steps_trained": 963200}, "done": false, "episodes_total": 960, "training_iteration": 130, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-02", "timestamp": 1617635282, "time_this_iter_s": 1.5359525680541992, "time_total_s": 282.8674042224884, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 118.08093976974487, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 67.96666666666667, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 40.696771520953625, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.31340603237252, "MDD_min": 11.900166932003156, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986050274128604, "mean_inference_ms": 1.2774705446301933, "mean_action_processing_ms": 0.05412641648723523, "mean_env_wait_ms": 1.1910898915039023, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 970800, "timers": {"sample_time_ms": 1151.951, "sample_throughput": 6597.501, "learn_time_ms": 302.877, "learn_throughput": 25092.671, "update_time_ms": 2.874}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.271806125530277e-25, "cur_lr": 0.001, "total_loss": 0.027139292564243078, "policy_loss": 0.011827133130282164, "vf_loss": 0.015312154777348042, "vf_explained_var": 0.9951192736625671, "kl": 0.002165992511436343, "entropy": -5.967707395553589, "entropy_coeff": 0.0}}, "num_steps_sampled": 970800, "num_steps_trained": 970800}, "done": false, "episodes_total": 960, "training_iteration": 131, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-04", "timestamp": 1617635284, "time_this_iter_s": 1.4196460247039795, "time_total_s": 284.2870502471924, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 119.50058579444885, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 74.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 40.696771520953625, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.31340603237252, "MDD_min": 11.900166932003156, "MDD_max": 39.01427194574256}, "hist_stats": {"episode_reward": [43.60618453779007, 37.922737157205674, 29.891625000896752, 31.004226266434856, 77.14969147629506, 58.891415966218545, 43.62184573364118, 55.28042238644509, 31.30861912781193, 23.76667691509708, 36.50441834499605, 26.576155344282956, 22.934178538008553, 32.834505740655715, 34.94563518556177, 32.579598910772155, 43.6621695684973, 19.742423378672864, 24.081493005267312, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986050274128604, "mean_inference_ms": 1.2774705446301933, "mean_action_processing_ms": 0.05412641648723523, "mean_env_wait_ms": 1.1910898915039023, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 978400, "timers": {"sample_time_ms": 1153.021, "sample_throughput": 6591.382, "learn_time_ms": 302.241, "learn_throughput": 25145.491, "update_time_ms": 2.869}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651384e-25, "cur_lr": 0.001, "total_loss": 0.12940983474254608, "policy_loss": 0.0006129683170001954, "vf_loss": 0.12879687175154686, "vf_explained_var": 0.9816290140151978, "kl": 0.0026320467004552484, "entropy": -5.769951105117798, "entropy_coeff": 0.0}}, "num_steps_sampled": 978400, "num_steps_trained": 978400}, "done": false, "episodes_total": 960, "training_iteration": 132, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-05", "timestamp": 1617635285, "time_this_iter_s": 1.428330898284912, "time_total_s": 285.7153811454773, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa3b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 120.92891669273376, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 73.7, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 42.4164773898288, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.120649723874045, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19852432476424922, "mean_inference_ms": 1.2771768203548335, "mean_action_processing_ms": 0.05412902554533497, "mean_env_wait_ms": 1.1910402803006803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 986000, "timers": {"sample_time_ms": 1152.662, "sample_throughput": 6593.434, "learn_time_ms": 302.381, "learn_throughput": 25133.847, "update_time_ms": 2.874}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0679515313825692e-25, "cur_lr": 0.001, "total_loss": 0.34096379578113556, "policy_loss": -0.019709833664819598, "vf_loss": 0.3606736660003662, "vf_explained_var": 0.9794885516166687, "kl": 0.0026937330840155482, "entropy": -5.729910135269165, "entropy_coeff": 0.0}}, "num_steps_sampled": 986000, "num_steps_trained": 986000}, "done": false, "episodes_total": 979, "training_iteration": 133, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-07", "timestamp": 1617635287, "time_this_iter_s": 1.5316076278686523, "time_total_s": 287.24698877334595, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 122.46052432060242, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 81.05000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 42.416477389828785, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.12064972387404, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [23.319965515567414, 42.57653577979075, 46.55166396247762, 54.133197778795484, 38.920571814228, 25.47192529349362, 45.53389904549395, 50.303302201274555, 60.26439195696376, 19.93935076675821, 40.5182907353498, 25.737459528801974, 51.79757293855889, 27.67047174178434, 61.882571797188774, 53.10082149784877, 33.91825391857106, 63.46080369343383, 30.079426868322376, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19852432476424922, "mean_inference_ms": 1.2771768203548333, "mean_action_processing_ms": 0.05412902554533497, "mean_env_wait_ms": 1.1910402803006803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 993600, "timers": {"sample_time_ms": 1154.264, "sample_throughput": 6584.284, "learn_time_ms": 301.54, "learn_throughput": 25203.989, "update_time_ms": 2.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912846e-25, "cur_lr": 0.001, "total_loss": 0.03926316276192665, "policy_loss": 0.0069937193766236305, "vf_loss": 0.032269442453980446, "vf_explained_var": 0.9794135093688965, "kl": 0.0020144908921793103, "entropy": -5.795813798904419, "entropy_coeff": 0.0}}, "num_steps_sampled": 993600, "num_steps_trained": 993600}, "done": false, "episodes_total": 979, "training_iteration": 134, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-08", "timestamp": 1617635288, "time_this_iter_s": 1.421184778213501, "time_total_s": 288.66817355155945, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 123.88170909881592, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 74.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 44.52028548978328, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.295844529204878, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986643257158851, "mean_inference_ms": 1.27688080895975, "mean_action_processing_ms": 0.054128021005140796, "mean_env_wait_ms": 1.1909559250789783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1001200, "timers": {"sample_time_ms": 1153.061, "sample_throughput": 6591.15, "learn_time_ms": 301.5, "learn_throughput": 25207.29, "update_time_ms": 2.934}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.169878828456423e-26, "cur_lr": 0.001, "total_loss": 0.6876750588417053, "policy_loss": 0.001950485457200557, "vf_loss": 0.6857245862483978, "vf_explained_var": 0.9712343215942383, "kl": 0.0033499663695693016, "entropy": -5.800610542297363, "entropy_coeff": 0.0}}, "num_steps_sampled": 1001200, "num_steps_trained": 1001200}, "done": false, "episodes_total": 998, "training_iteration": 135, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-10", "timestamp": 1617635290, "time_this_iter_s": 1.5253868103027344, "time_total_s": 290.1935603618622, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 125.40709590911865, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 44.52028548978328, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.295844529204892, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986643257158851, "mean_inference_ms": 1.27688080895975, "mean_action_processing_ms": 0.054128021005140796, "mean_env_wait_ms": 1.1909559250789783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1008800, "timers": {"sample_time_ms": 1152.981, "sample_throughput": 6591.606, "learn_time_ms": 301.919, "learn_throughput": 25172.338, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5849394142282115e-26, "cur_lr": 0.001, "total_loss": 0.00998669135151431, "policy_loss": -0.007667634403333068, "vf_loss": 0.01765432581305504, "vf_explained_var": 0.9942163228988647, "kl": 0.0017727963859215379, "entropy": -6.036118745803833, "entropy_coeff": 0.0}}, "num_steps_sampled": 1008800, "num_steps_trained": 1008800}, "done": false, "episodes_total": 998, "training_iteration": 136, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-11", "timestamp": 1617635291, "time_this_iter_s": 1.4103329181671143, "time_total_s": 291.6038932800293, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 126.81742882728577, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 72.45, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 14.69936460452114, "episode_reward_mean": 44.52028548978328, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.295844529204892, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [23.950576494880607, 23.34731463242126, 39.60408021869949, 32.66832238606821, 14.69936460452114, 55.56959344645565, 31.350273037026533, 25.881583037127754, 30.273056035841417, 22.90870636396306, 52.6083598716715, 41.75864228821547, 21.146132517399813, 29.835213930218682, 28.125821370367813, 33.82794659639081, 35.84158525305446, 43.33903642311704, 46.33134396891152, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986643257158851, "mean_inference_ms": 1.27688080895975, "mean_action_processing_ms": 0.054128021005140796, "mean_env_wait_ms": 1.1909559250789783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1016400, "timers": {"sample_time_ms": 1156.186, "sample_throughput": 6573.335, "learn_time_ms": 303.199, "learn_throughput": 25066.057, "update_time_ms": 2.919}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2924697071141057e-26, "cur_lr": 0.001, "total_loss": 0.1557193100452423, "policy_loss": 0.01190110354218632, "vf_loss": 0.143818199634552, "vf_explained_var": 0.9824419021606445, "kl": 0.0033616836881265044, "entropy": -5.851544380187988, "entropy_coeff": 0.0}}, "num_steps_sampled": 1016400, "num_steps_trained": 1016400}, "done": false, "episodes_total": 998, "training_iteration": 137, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-13", "timestamp": 1617635293, "time_this_iter_s": 1.4544475078582764, "time_total_s": 293.0583407878876, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 128.27187633514404, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 21.167491928355336, "episode_reward_mean": 46.8678537169115, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.25075335399452, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19863169478849996, "mean_inference_ms": 1.2766608934498367, "mean_action_processing_ms": 0.05412981118318744, "mean_env_wait_ms": 1.1908935393991391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1024000, "timers": {"sample_time_ms": 1155.526, "sample_throughput": 6577.089, "learn_time_ms": 302.728, "learn_throughput": 25105.052, "update_time_ms": 2.961}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.462348535570529e-27, "cur_lr": 0.001, "total_loss": 0.36958813667297363, "policy_loss": -0.0019703455036506057, "vf_loss": 0.37155845761299133, "vf_explained_var": 0.981743574142456, "kl": 0.0032563538989052176, "entropy": -5.895699501037598, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 1017, "training_iteration": 138, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-14", "timestamp": 1617635294, "time_this_iter_s": 1.5292258262634277, "time_total_s": 294.587566614151, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aab90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 129.80110216140747, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 70.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 21.167491928355336, "episode_reward_mean": 46.86785371691148, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.25075335399452, "MDD_min": 11.900166932003156, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [46.65800784887487, 33.180775274018856, 58.92795809794749, 67.68871101941834, 27.19675915849076, 21.167491928355336, 42.325909640546165, 34.41538571183746, 49.69762352040748, 48.1262390781756, 49.38069680165312, 36.462399767279926, 31.649505990619133, 75.30723058348835, 39.33958719604692, 46.16247867377353, 42.20576138379123, 49.55713925953721, 65.54987593581212, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986316947885, "mean_inference_ms": 1.2766608934498367, "mean_action_processing_ms": 0.054129811183187444, "mean_env_wait_ms": 1.1908935393991391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1031600, "timers": {"sample_time_ms": 1155.599, "sample_throughput": 6576.675, "learn_time_ms": 302.918, "learn_throughput": 25089.272, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2311742677852644e-27, "cur_lr": 0.001, "total_loss": 0.04588653706014156, "policy_loss": 0.016798388678580523, "vf_loss": 0.02908814698457718, "vf_explained_var": 0.9817764163017273, "kl": 0.002361843944527209, "entropy": -5.9154744148254395, "entropy_coeff": 0.0}}, "num_steps_sampled": 1031600, "num_steps_trained": 1031600}, "done": false, "episodes_total": 1017, "training_iteration": 139, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-16", "timestamp": 1617635296, "time_this_iter_s": 1.4236223697662354, "time_total_s": 296.01118898391724, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 131.2247245311737, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 66.33333333333333, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 46.63055443442845, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.512676658297583, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19877703013721465, "mean_inference_ms": 1.276427062477931, "mean_action_processing_ms": 0.05413100444609643, "mean_env_wait_ms": 1.1908284782269634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1039200, "timers": {"sample_time_ms": 1156.324, "sample_throughput": 6572.552, "learn_time_ms": 303.501, "learn_throughput": 25041.13, "update_time_ms": 2.908}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6155871338926322e-27, "cur_lr": 0.001, "total_loss": 0.4662950783967972, "policy_loss": -0.009551005205139518, "vf_loss": 0.4758460968732834, "vf_explained_var": 0.9811241030693054, "kl": 0.0045005917781963944, "entropy": -5.927174806594849, "entropy_coeff": 0.0}}, "num_steps_sampled": 1039200, "num_steps_trained": 1039200}, "done": false, "episodes_total": 1036, "training_iteration": 140, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-17", "timestamp": 1617635297, "time_this_iter_s": 1.5486361980438232, "time_total_s": 297.55982518196106, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 132.77336072921753, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 81.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 46.63055443442845, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.51267665829758, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19877703013721468, "mean_inference_ms": 1.276427062477931, "mean_action_processing_ms": 0.054131004446096434, "mean_env_wait_ms": 1.1908284782269634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1046800, "timers": {"sample_time_ms": 1155.483, "sample_throughput": 6577.339, "learn_time_ms": 302.878, "learn_throughput": 25092.631, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.077935669463161e-28, "cur_lr": 0.001, "total_loss": 0.02033284306526184, "policy_loss": 0.0017107345629483461, "vf_loss": 0.018622109666466713, "vf_explained_var": 0.9936375021934509, "kl": 0.0013683814322575927, "entropy": -6.10392951965332, "entropy_coeff": 0.0}}, "num_steps_sampled": 1046800, "num_steps_trained": 1046800}, "done": false, "episodes_total": 1036, "training_iteration": 141, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-19", "timestamp": 1617635299, "time_this_iter_s": 1.4056262969970703, "time_total_s": 298.96545147895813, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 134.1789870262146, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.26378628861656, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 46.63055443442845, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.51267665829758, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [45.62366049176643, 58.10018443040257, 32.74476944664425, 52.01240069613823, 37.66271299471494, 40.76674920626351, 62.3963911024241, 50.26790822846492, 52.98864585986171, 28.2900267865048, 43.9108865891027, 37.982932791146546, 30.732741005134155, 45.352640183230335, 54.3934804120883, 43.35319522518537, 95.26378628861656, 50.04716579040761, 36.53276705672286, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19877703013721468, "mean_inference_ms": 1.276427062477931, "mean_action_processing_ms": 0.054131004446096434, "mean_env_wait_ms": 1.1908284782269634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1054400, "timers": {"sample_time_ms": 1153.696, "sample_throughput": 6587.524, "learn_time_ms": 303.035, "learn_throughput": 25079.588, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.0389678347315804e-28, "cur_lr": 0.001, "total_loss": 0.18153927475214005, "policy_loss": 0.018343059811741114, "vf_loss": 0.16319622099399567, "vf_explained_var": 0.9818835854530334, "kl": 0.0024602391058579087, "entropy": -5.87475323677063, "entropy_coeff": 0.0}}, "num_steps_sampled": 1054400, "num_steps_trained": 1054400}, "done": false, "episodes_total": 1036, "training_iteration": 142, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-20", "timestamp": 1617635300, "time_this_iter_s": 1.4122438430786133, "time_total_s": 300.37769532203674, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 135.5912308692932, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 84.21630987704522, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 45.998084522508044, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.136220561256124, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19875405744327565, "mean_inference_ms": 1.276240944661655, "mean_action_processing_ms": 0.054133941107816864, "mean_env_wait_ms": 1.190825020077045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1062000, "timers": {"sample_time_ms": 1154.52, "sample_throughput": 6582.823, "learn_time_ms": 303.388, "learn_throughput": 25050.44, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0194839173657902e-28, "cur_lr": 0.001, "total_loss": 0.4007117450237274, "policy_loss": 0.01912798872217536, "vf_loss": 0.3815837800502777, "vf_explained_var": 0.9813439249992371, "kl": 0.0016167827416211367, "entropy": -5.971566915512085, "entropy_coeff": 0.0}}, "num_steps_sampled": 1062000, "num_steps_trained": 1062000}, "done": false, "episodes_total": 1055, "training_iteration": 143, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-22", "timestamp": 1617635302, "time_this_iter_s": 1.5437521934509277, "time_total_s": 301.92144751548767, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 137.13498306274414, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 79.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 84.21630987704522, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 45.99808452250804, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.136220561256113, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [27.498989815193383, 37.470424580161136, 42.45317460777806, 31.508394653181313, 32.772135088548005, 59.56585112726329, 29.488471552710546, 69.96919356765875, 43.16250612722261, 56.53307044050573, 52.94548170173512, 28.11674759449331, 40.20902820814845, 34.881367354489676, 43.04848650097708, 27.626838267281446, 28.95306047562713, 69.19957460834289, 25.08905139711747, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19875405744327568, "mean_inference_ms": 1.276240944661655, "mean_action_processing_ms": 0.054133941107816864, "mean_env_wait_ms": 1.190825020077045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1069600, "timers": {"sample_time_ms": 1154.787, "sample_throughput": 6581.3, "learn_time_ms": 304.008, "learn_throughput": 24999.369, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0097419586828951e-28, "cur_lr": 0.001, "total_loss": 0.00451767910271883, "policy_loss": -0.024366956669837236, "vf_loss": 0.028884638100862503, "vf_explained_var": 0.9829533100128174, "kl": 0.0013599595404230058, "entropy": -5.993022918701172, "entropy_coeff": 0.0}}, "num_steps_sampled": 1069600, "num_steps_trained": 1069600}, "done": false, "episodes_total": 1055, "training_iteration": 144, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-23", "timestamp": 1617635303, "time_this_iter_s": 1.4305338859558105, "time_total_s": 303.3519814014435, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aab90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 138.56551694869995, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 84.21630987704522, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 47.670623956502716, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.082196421527836, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19888076987164002, "mean_inference_ms": 1.2760611703444291, "mean_action_processing_ms": 0.05413318553710114, "mean_env_wait_ms": 1.1908288048858702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1077200, "timers": {"sample_time_ms": 1155.26, "sample_throughput": 6578.605, "learn_time_ms": 304.55, "learn_throughput": 24954.849, "update_time_ms": 2.871}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.048709793414476e-29, "cur_lr": 0.001, "total_loss": 0.5511579215526581, "policy_loss": -0.012534847017377615, "vf_loss": 0.5636927783489227, "vf_explained_var": 0.9784930944442749, "kl": 0.0020754608558490872, "entropy": -5.946893930435181, "entropy_coeff": 0.0}}, "num_steps_sampled": 1077200, "num_steps_trained": 1077200}, "done": false, "episodes_total": 1074, "training_iteration": 145, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-25", "timestamp": 1617635305, "time_this_iter_s": 1.535057544708252, "time_total_s": 304.88703894615173, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 140.1005744934082, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 84.21630987704522, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 47.670623956502716, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.082196421527836, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19888076987164, "mean_inference_ms": 1.2760611703444291, "mean_action_processing_ms": 0.054133185537101135, "mean_env_wait_ms": 1.1908288048858702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1084800, "timers": {"sample_time_ms": 1156.084, "sample_throughput": 6573.917, "learn_time_ms": 304.333, "learn_throughput": 24972.64, "update_time_ms": 2.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.524354896707238e-29, "cur_lr": 0.001, "total_loss": 0.007505394052714109, "policy_loss": -0.01060944577329792, "vf_loss": 0.018114841543138027, "vf_explained_var": 0.9937142133712769, "kl": 0.001166209694929421, "entropy": -6.217332124710083, "entropy_coeff": 0.0}}, "num_steps_sampled": 1084800, "num_steps_trained": 1084800}, "done": false, "episodes_total": 1074, "training_iteration": 146, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-26", "timestamp": 1617635306, "time_this_iter_s": 1.4163126945495605, "time_total_s": 306.3033516407013, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aab90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 141.51688718795776, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 72.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 84.21630987704522, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 47.670623956502716, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.082196421527836, "MDD_min": 15.639833709976767, "MDD_max": 33.53942849198413}, "hist_stats": {"episode_reward": [45.1622131068858, 25.3943129991942, 66.76091660123059, 60.63973921576808, 71.52869862541588, 67.48606835105886, 46.27455506752414, 38.851782190690855, 23.8606011609491, 43.116520711789754, 48.24987267148471, 34.56317535285508, 51.44445939218385, 78.34038486221692, 78.37882998258483, 42.040190177370214, 69.07449782225723, 36.02853385797872, 84.21630987704522, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19888076987164, "mean_inference_ms": 1.2760611703444291, "mean_action_processing_ms": 0.054133185537101135, "mean_env_wait_ms": 1.1908288048858702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1092400, "timers": {"sample_time_ms": 1153.842, "sample_throughput": 6586.689, "learn_time_ms": 303.884, "learn_throughput": 25009.554, "update_time_ms": 2.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.262177448353619e-29, "cur_lr": 0.001, "total_loss": 0.16018079966306686, "policy_loss": -0.015589979710057378, "vf_loss": 0.17577078938484192, "vf_explained_var": 0.9824001789093018, "kl": 0.0032603824511170387, "entropy": -5.954852104187012, "entropy_coeff": 0.0}}, "num_steps_sampled": 1092400, "num_steps_trained": 1092400}, "done": false, "episodes_total": 1074, "training_iteration": 147, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-27", "timestamp": 1617635307, "time_this_iter_s": 1.426971673965454, "time_total_s": 307.73032331466675, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 142.94385886192322, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 73.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 46.917020119052125, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.97206432376895, "MDD_min": 15.322117818670305, "MDD_max": 33.42667437712578}, "hist_stats": {"episode_reward": [38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1988424325651792, "mean_inference_ms": 1.2758673702540144, "mean_action_processing_ms": 0.0541297554632622, "mean_env_wait_ms": 1.1907970717760592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1100000, "timers": {"sample_time_ms": 1154.464, "sample_throughput": 6583.139, "learn_time_ms": 304.538, "learn_throughput": 24955.818, "update_time_ms": 2.785}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.310887241768095e-30, "cur_lr": 0.001, "total_loss": 0.47497138381004333, "policy_loss": -0.0007378106820397079, "vf_loss": 0.4757092148065567, "vf_explained_var": 0.9755527973175049, "kl": 0.0025203574914485216, "entropy": -5.997416019439697, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 1093, "training_iteration": 148, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-29", "timestamp": 1617635309, "time_this_iter_s": 1.5419058799743652, "time_total_s": 309.2722291946411, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 144.48576474189758, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 68.10000000000001, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 46.917020119052125, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.972064323768958, "MDD_min": 15.322117818670305, "MDD_max": 33.42667437712578}, "hist_stats": {"episode_reward": [71.83518256777896, 42.04388815295926, 38.030685671121084, 52.75140205838499, 58.97434690191761, 63.22705265882533, 29.71557234705817, 44.47078813920069, 32.92428173848455, 47.76505203048362, 58.195100876573434, 40.66370658612573, 33.803639345598434, 33.33109416323421, 55.3843313626039, 64.31721306768313, 32.82954770144007, 29.683445503984245, 42.50932209239971, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1988424325651792, "mean_inference_ms": 1.2758673702540144, "mean_action_processing_ms": 0.05412975546326221, "mean_env_wait_ms": 1.1907970717760592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1107600, "timers": {"sample_time_ms": 1155.779, "sample_throughput": 6575.654, "learn_time_ms": 304.316, "learn_throughput": 24974.015, "update_time_ms": 2.785}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1554436208840472e-30, "cur_lr": 0.001, "total_loss": 0.029350601136684418, "policy_loss": -0.007037345669232309, "vf_loss": 0.03638794831931591, "vf_explained_var": 0.9785207509994507, "kl": 0.0013206523726694286, "entropy": -6.0676727294921875, "entropy_coeff": 0.0}}, "num_steps_sampled": 1107600, "num_steps_trained": 1107600}, "done": false, "episodes_total": 1093, "training_iteration": 149, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-30", "timestamp": 1617635310, "time_this_iter_s": 1.4346282482147217, "time_total_s": 310.70685744285583, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 145.9203929901123, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 47.431303006172605, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.600649748061507, "MDD_min": 15.322117818670305, "MDD_max": 33.42667437712578}, "hist_stats": {"episode_reward": [62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19894104479693372, "mean_inference_ms": 1.2757193845227441, "mean_action_processing_ms": 0.05412819685529236, "mean_env_wait_ms": 1.1908012491878168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1115200, "timers": {"sample_time_ms": 1154.398, "sample_throughput": 6583.521, "learn_time_ms": 304.887, "learn_throughput": 24927.291, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5777218104420236e-30, "cur_lr": 0.001, "total_loss": 0.49947479367256165, "policy_loss": -0.00392688371357508, "vf_loss": 0.5034016668796539, "vf_explained_var": 0.9814535975456238, "kl": 0.003040239680558443, "entropy": -5.9594950675964355, "entropy_coeff": 0.0}}, "num_steps_sampled": 1115200, "num_steps_trained": 1115200}, "done": false, "episodes_total": 1112, "training_iteration": 150, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-32", "timestamp": 1617635312, "time_this_iter_s": 1.540694236755371, "time_total_s": 312.2475516796112, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aa710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 147.46108722686768, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 81.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 47.431303006172605, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.6006497480615, "MDD_min": 15.322117818670305, "MDD_max": 33.42667437712578}, "hist_stats": {"episode_reward": [67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19894104479693372, "mean_inference_ms": 1.2757193845227441, "mean_action_processing_ms": 0.05412819685529235, "mean_env_wait_ms": 1.1908012491878168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1122800, "timers": {"sample_time_ms": 1155.107, "sample_throughput": 6579.479, "learn_time_ms": 305.61, "learn_throughput": 24868.305, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.888609052210118e-31, "cur_lr": 0.001, "total_loss": 0.022923029959201813, "policy_loss": 0.003619930474087596, "vf_loss": 0.019303099252283573, "vf_explained_var": 0.9924655556678772, "kl": 0.001708411262370646, "entropy": -6.249540567398071, "entropy_coeff": 0.0}}, "num_steps_sampled": 1122800, "num_steps_trained": 1122800}, "done": false, "episodes_total": 1112, "training_iteration": 151, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-33", "timestamp": 1617635313, "time_this_iter_s": 1.4199998378753662, "time_total_s": 313.6675515174866, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 148.88108706474304, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 21.975572690157016, "episode_reward_mean": 47.431303006172605, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.6006497480615, "MDD_min": 15.322117818670305, "MDD_max": 33.42667437712578}, "hist_stats": {"episode_reward": [67.07592550858449, 68.40812177672368, 29.376777648580102, 50.15676813176711, 43.986034509823405, 59.59707359775858, 64.49769872477938, 51.04457127605286, 33.352956967724765, 25.094384548924225, 40.58308210886222, 28.16028490785997, 47.229764071507184, 33.39616430543235, 22.483594045514135, 40.451999846004064, 63.2419975592222, 57.794059205894634, 21.975572690157016, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19894104479693372, "mean_inference_ms": 1.2757193845227441, "mean_action_processing_ms": 0.05412819685529235, "mean_env_wait_ms": 1.1908012491878168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1130400, "timers": {"sample_time_ms": 1156.219, "sample_throughput": 6573.15, "learn_time_ms": 306.445, "learn_throughput": 24800.539, "update_time_ms": 2.796}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.944304526105059e-31, "cur_lr": 0.001, "total_loss": 0.16931794583797455, "policy_loss": 0.0007478043844457716, "vf_loss": 0.1685701310634613, "vf_explained_var": 0.9834938645362854, "kl": 0.0023750803666189313, "entropy": -5.981467008590698, "entropy_coeff": 0.0}}, "num_steps_sampled": 1130400, "num_steps_trained": 1130400}, "done": false, "episodes_total": 1112, "training_iteration": 152, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-35", "timestamp": 1617635315, "time_this_iter_s": 1.4315361976623535, "time_total_s": 315.0990877151489, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 150.3126232624054, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 73.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 23.331806530515703, "episode_reward_mean": 48.342218007049986, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.39509049294041, "MDD_min": 13.578316657835327, "MDD_max": 33.859316608235574}, "hist_stats": {"episode_reward": [42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1988769083692319, "mean_inference_ms": 1.2755294367430055, "mean_action_processing_ms": 0.05412603229470915, "mean_env_wait_ms": 1.1907630553001702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1138000, "timers": {"sample_time_ms": 1157.089, "sample_throughput": 6568.208, "learn_time_ms": 305.992, "learn_throughput": 24837.271, "update_time_ms": 2.796}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9721522630525295e-31, "cur_lr": 0.001, "total_loss": 0.39461249113082886, "policy_loss": -0.012816285016015172, "vf_loss": 0.4074287861585617, "vf_explained_var": 0.9798672199249268, "kl": 0.0023645254550501704, "entropy": -5.992171049118042, "entropy_coeff": 0.0}}, "num_steps_sampled": 1138000, "num_steps_trained": 1138000}, "done": false, "episodes_total": 1131, "training_iteration": 153, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-36", "timestamp": 1617635316, "time_this_iter_s": 1.5471761226654053, "time_total_s": 316.64626383781433, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 151.8597993850708, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 72.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 23.331806530515703, "episode_reward_mean": 48.34221800704999, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.39509049294041, "MDD_min": 13.578316657835327, "MDD_max": 33.859316608235574}, "hist_stats": {"episode_reward": [42.50717866368535, 59.19722089643876, 30.264782720815177, 61.60495331879668, 58.79226916633944, 79.79321468675272, 69.37969117963473, 42.05409968609048, 36.64195235885, 25.073647467512757, 36.72164057463051, 34.567497873649145, 71.6674310483824, 45.683658711154, 44.26974368631527, 32.47807891829929, 26.87303527102126, 50.323144493986696, 23.331806530515703, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1988769083692318, "mean_inference_ms": 1.2755294367430052, "mean_action_processing_ms": 0.05412603229470915, "mean_env_wait_ms": 1.19076305530017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1145600, "timers": {"sample_time_ms": 1157.563, "sample_throughput": 6565.516, "learn_time_ms": 307.671, "learn_throughput": 24701.671, "update_time_ms": 2.766}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.860761315262648e-32, "cur_lr": 0.001, "total_loss": 0.024839887395501137, "policy_loss": -0.01552731660194695, "vf_loss": 0.04036720655858517, "vf_explained_var": 0.9786407947540283, "kl": 0.0020564267761074007, "entropy": -6.1230223178863525, "entropy_coeff": 0.0}}, "num_steps_sampled": 1145600, "num_steps_trained": 1145600}, "done": false, "episodes_total": 1131, "training_iteration": 154, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-38", "timestamp": 1617635318, "time_this_iter_s": 1.4512407779693604, "time_total_s": 318.0975046157837, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 153.31104016304016, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 18.161893514480933, "episode_reward_mean": 48.244063053031844, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.266557194638814, "MDD_min": 13.578316657835327, "MDD_max": 33.859316608235574}, "hist_stats": {"episode_reward": [40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19896963202814066, "mean_inference_ms": 1.2753634017650723, "mean_action_processing_ms": 0.054123853241394085, "mean_env_wait_ms": 1.1907016996159872, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1153200, "timers": {"sample_time_ms": 1156.549, "sample_throughput": 6571.274, "learn_time_ms": 307.891, "learn_throughput": 24684.082, "update_time_ms": 2.773}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.930380657631324e-32, "cur_lr": 0.001, "total_loss": 0.5292380750179291, "policy_loss": -0.015980196185410023, "vf_loss": 0.545218288898468, "vf_explained_var": 0.9791872501373291, "kl": 0.0024881474673748016, "entropy": -6.002091646194458, "entropy_coeff": 0.0}}, "num_steps_sampled": 1153200, "num_steps_trained": 1153200}, "done": false, "episodes_total": 1150, "training_iteration": 155, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-39", "timestamp": 1617635319, "time_this_iter_s": 1.5275285243988037, "time_total_s": 319.6250331401825, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 154.83856868743896, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 65.56666666666666, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 18.161893514480933, "episode_reward_mean": 48.244063053031844, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.266557194638807, "MDD_min": 13.578316657835327, "MDD_max": 33.859316608235574}, "hist_stats": {"episode_reward": [35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19896963202814072, "mean_inference_ms": 1.2753634017650726, "mean_action_processing_ms": 0.054123853241394085, "mean_env_wait_ms": 1.1907016996159874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1160800, "timers": {"sample_time_ms": 1165.868, "sample_throughput": 6518.746, "learn_time_ms": 309.079, "learn_throughput": 24589.167, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.465190328815662e-32, "cur_lr": 0.001, "total_loss": 0.026752689853310585, "policy_loss": 0.0077368635684251785, "vf_loss": 0.01901582721620798, "vf_explained_var": 0.9921174645423889, "kl": 0.0015921458252705634, "entropy": -6.378410339355469, "entropy_coeff": 0.0}}, "num_steps_sampled": 1160800, "num_steps_trained": 1160800}, "done": false, "episodes_total": 1150, "training_iteration": 156, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-41", "timestamp": 1617635321, "time_this_iter_s": 1.5209324359893799, "time_total_s": 321.1459655761719, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345168c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 156.35950112342834, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 76.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 18.161893514480933, "episode_reward_mean": 48.244063053031844, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.266557194638807, "MDD_min": 13.578316657835327, "MDD_max": 33.859316608235574}, "hist_stats": {"episode_reward": [35.69925951399635, 75.27138681440368, 39.46765491977935, 24.165667986969403, 41.7134416708361, 27.26402609239722, 51.33286781298383, 55.736376217790486, 60.380320334208534, 43.131801330371786, 46.80872792182648, 49.175593333275316, 49.08568226110254, 74.86509258619127, 46.243122820021554, 39.81581475848265, 53.131557356767615, 72.88239886841409, 79.24322250710385, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19896963202814072, "mean_inference_ms": 1.2753634017650726, "mean_action_processing_ms": 0.054123853241394085, "mean_env_wait_ms": 1.1907016996159874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1168400, "timers": {"sample_time_ms": 1165.186, "sample_throughput": 6522.563, "learn_time_ms": 309.656, "learn_throughput": 24543.355, "update_time_ms": 2.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.232595164407831e-32, "cur_lr": 0.001, "total_loss": 0.14073258638381958, "policy_loss": -0.005383760202676058, "vf_loss": 0.14611633867025375, "vf_explained_var": 0.9857951402664185, "kl": 0.0034466086653992534, "entropy": -6.052133560180664, "entropy_coeff": 0.0}}, "num_steps_sampled": 1168400, "num_steps_trained": 1168400}, "done": false, "episodes_total": 1150, "training_iteration": 157, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-42", "timestamp": 1617635322, "time_this_iter_s": 1.4263691902160645, "time_total_s": 322.57233476638794, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 157.7858703136444, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 74.65, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 46.92493615068594, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.677408614764953, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19891603250443687, "mean_inference_ms": 1.275221603379317, "mean_action_processing_ms": 0.05412403463624656, "mean_env_wait_ms": 1.190663269997174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1176000, "timers": {"sample_time_ms": 1163.407, "sample_throughput": 6532.539, "learn_time_ms": 309.832, "learn_throughput": 24529.403, "update_time_ms": 2.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.162975822039155e-33, "cur_lr": 0.001, "total_loss": 0.34429678320884705, "policy_loss": -0.0054310418490786105, "vf_loss": 0.3497278094291687, "vf_explained_var": 0.9822899103164673, "kl": 0.0020273032132536173, "entropy": -6.090933084487915, "entropy_coeff": 0.0}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 1169, "training_iteration": 158, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-44", "timestamp": 1617635324, "time_this_iter_s": 1.525848150253296, "time_total_s": 324.09818291664124, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345168c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 159.3117184638977, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 80.6, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 94.50334368443065, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 46.92493615068594, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.677408614764953, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [39.21736763810446, 36.86218036968136, 53.715860399626294, 40.34655362036475, 28.507224839189206, 38.3764890510554, 43.484800768178694, 62.56395342430747, 36.6095733720924, 70.38878801705383, 27.20180960132861, 75.16845934231753, 94.50334368443065, 39.08373300135632, 68.2143547274411, 53.731132589463506, 58.33450498724989, 38.825503990547766, 34.41377221263749, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19891603250443685, "mean_inference_ms": 1.275221603379317, "mean_action_processing_ms": 0.054124034636246564, "mean_env_wait_ms": 1.190663269997174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1183600, "timers": {"sample_time_ms": 1164.764, "sample_throughput": 6524.929, "learn_time_ms": 310.852, "learn_throughput": 24448.954, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0814879110195774e-33, "cur_lr": 0.001, "total_loss": 0.05476345308125019, "policy_loss": 0.0224155867472291, "vf_loss": 0.032347869127988815, "vf_explained_var": 0.985504150390625, "kl": 0.0014875316410325468, "entropy": -6.233402490615845, "entropy_coeff": 0.0}}, "num_steps_sampled": 1183600, "num_steps_trained": 1183600}, "done": false, "episodes_total": 1169, "training_iteration": 159, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-45", "timestamp": 1617635325, "time_this_iter_s": 1.4578781127929688, "time_total_s": 325.5560610294342, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 160.76959657669067, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 72.45, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 85.19291699666923, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 47.23376328987153, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.77709514060417, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19899753316389165, "mean_inference_ms": 1.2750874941436459, "mean_action_processing_ms": 0.05412528615560487, "mean_env_wait_ms": 1.190619035010659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1191200, "timers": {"sample_time_ms": 1165.665, "sample_throughput": 6519.884, "learn_time_ms": 312.049, "learn_throughput": 24355.186, "update_time_ms": 2.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5407439555097887e-33, "cur_lr": 0.001, "total_loss": 0.572282075881958, "policy_loss": 0.007195215905085206, "vf_loss": 0.5650868713855743, "vf_explained_var": 0.9801347255706787, "kl": 0.0033379558008164167, "entropy": -6.112255096435547, "entropy_coeff": 0.0}}, "num_steps_sampled": 1191200, "num_steps_trained": 1191200}, "done": false, "episodes_total": 1188, "training_iteration": 160, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-47", "timestamp": 1617635327, "time_this_iter_s": 1.5617778301239014, "time_total_s": 327.1178388595581, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 162.33137440681458, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 69.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 85.19291699666923, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 47.23376328987151, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.77709514060417, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19899753316389165, "mean_inference_ms": 1.275087494143646, "mean_action_processing_ms": 0.054125286155604885, "mean_env_wait_ms": 1.190619035010659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1198800, "timers": {"sample_time_ms": 1167.162, "sample_throughput": 6511.522, "learn_time_ms": 314.715, "learn_throughput": 24148.869, "update_time_ms": 2.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.703719777548943e-34, "cur_lr": 0.001, "total_loss": 0.01576587976887822, "policy_loss": -0.004856192943407223, "vf_loss": 0.020622067153453827, "vf_explained_var": 0.9916509389877319, "kl": 0.0011320796329528093, "entropy": -6.426618337631226, "entropy_coeff": 0.0}}, "num_steps_sampled": 1198800, "num_steps_trained": 1198800}, "done": false, "episodes_total": 1188, "training_iteration": 161, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-48", "timestamp": 1617635328, "time_this_iter_s": 1.4614968299865723, "time_total_s": 328.5793356895447, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 163.79287123680115, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 69.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 85.19291699666923, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 47.23376328987151, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.77709514060417, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [39.807653543982646, 35.15602112360314, 28.476589720131802, 67.07131242639984, 24.639482697846116, 62.79038989784717, 38.8938051573761, 43.41697344613723, 53.73965468349764, 37.595188732560885, 59.46705780639301, 44.628164477432406, 36.41316047375359, 57.537070264891, 45.75206137156616, 68.21929078547288, 42.47026135198884, 59.69409872705423, 55.331574172299, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19899753316389165, "mean_inference_ms": 1.275087494143646, "mean_action_processing_ms": 0.054125286155604885, "mean_env_wait_ms": 1.190619035010659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1206400, "timers": {"sample_time_ms": 1166.941, "sample_throughput": 6512.752, "learn_time_ms": 316.286, "learn_throughput": 24028.855, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.851859888774472e-34, "cur_lr": 0.001, "total_loss": 0.19232618063688278, "policy_loss": 0.014776889467611909, "vf_loss": 0.17754929512739182, "vf_explained_var": 0.9838588237762451, "kl": 0.0019127210834994912, "entropy": -6.13476824760437, "entropy_coeff": 0.0}}, "num_steps_sampled": 1206400, "num_steps_trained": 1206400}, "done": false, "episodes_total": 1188, "training_iteration": 162, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-50", "timestamp": 1617635330, "time_this_iter_s": 1.4460556507110596, "time_total_s": 330.02539134025574, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 165.2389268875122, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 63.833333333333336, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 89.22461452461337, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 48.329072964116314, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.6454888542906, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892704129442762, "mean_inference_ms": 1.2749290620467908, "mean_action_processing_ms": 0.0541304814000936, "mean_env_wait_ms": 1.1905514786403704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1214000, "timers": {"sample_time_ms": 1164.305, "sample_throughput": 6527.499, "learn_time_ms": 318.771, "learn_throughput": 23841.593, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.925929944387236e-34, "cur_lr": 0.001, "total_loss": 0.5232864916324615, "policy_loss": 0.012468983652070165, "vf_loss": 0.5108175128698349, "vf_explained_var": 0.975044846534729, "kl": 0.0031351082725450397, "entropy": -6.183628082275391, "entropy_coeff": 0.0}}, "num_steps_sampled": 1214000, "num_steps_trained": 1214000}, "done": false, "episodes_total": 1207, "training_iteration": 163, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-51", "timestamp": 1617635331, "time_this_iter_s": 1.5461757183074951, "time_total_s": 331.57156705856323, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 166.7851026058197, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 80.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 89.22461452461337, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 48.32907296411631, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.6454888542906, "MDD_min": 13.578316657835327, "MDD_max": 34.23241163548027}, "hist_stats": {"episode_reward": [49.680322933803076, 37.510501758911616, 30.88141434820803, 49.571837914398024, 50.291113374314854, 42.671867659293405, 43.59641418148494, 59.14485458911147, 38.7169114999909, 42.55495495725263, 35.59221617228995, 54.59667406927927, 37.94214482735682, 79.38453320323072, 67.77465889719775, 31.506900830108833, 25.748884835979318, 62.70790805626429, 58.65987512152442, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892704129442762, "mean_inference_ms": 1.2749290620467908, "mean_action_processing_ms": 0.054130481400093605, "mean_env_wait_ms": 1.1905514786403704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1221600, "timers": {"sample_time_ms": 1163.326, "sample_throughput": 6532.994, "learn_time_ms": 319.747, "learn_throughput": 23768.809, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.62964972193618e-35, "cur_lr": 0.001, "total_loss": 0.06425225548446178, "policy_loss": 0.025740206241607666, "vf_loss": 0.038512036204338074, "vf_explained_var": 0.9832130670547485, "kl": 0.0015226927353069186, "entropy": -6.240486145019531, "entropy_coeff": 0.0}}, "num_steps_sampled": 1221600, "num_steps_trained": 1221600}, "done": false, "episodes_total": 1207, "training_iteration": 164, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-53", "timestamp": 1617635333, "time_this_iter_s": 1.4514539241790771, "time_total_s": 333.0230209827423, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345168c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 168.23655652999878, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 75.1, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 48.9147245629109, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.66967448352964, "MDD_min": 13.578316657835327, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989893810545174, "mean_inference_ms": 1.27487252946779, "mean_action_processing_ms": 0.05413796979946576, "mean_env_wait_ms": 1.190582472800203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1229200, "timers": {"sample_time_ms": 1164.141, "sample_throughput": 6528.419, "learn_time_ms": 324.676, "learn_throughput": 23407.935, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.81482486096809e-35, "cur_lr": 0.001, "total_loss": 0.8101547360420227, "policy_loss": -0.014611941762268543, "vf_loss": 0.8247666358947754, "vf_explained_var": 0.9713993072509766, "kl": 0.006572982296347618, "entropy": -6.163036346435547, "entropy_coeff": 0.0}}, "num_steps_sampled": 1229200, "num_steps_trained": 1229200}, "done": false, "episodes_total": 1226, "training_iteration": 165, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-55", "timestamp": 1617635335, "time_this_iter_s": 1.584669828414917, "time_total_s": 334.6076908111572, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 169.8212263584137, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 78.6, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 48.9147245629109, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.66967448352964, "MDD_min": 13.578316657835327, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989893810545174, "mean_inference_ms": 1.2748725294677898, "mean_action_processing_ms": 0.054137969799465765, "mean_env_wait_ms": 1.190582472800203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1236800, "timers": {"sample_time_ms": 1155.576, "sample_throughput": 6576.804, "learn_time_ms": 328.105, "learn_throughput": 23163.342, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.81482486096809e-35, "cur_lr": 0.001, "total_loss": -0.012318511493504047, "policy_loss": -0.03235972626134753, "vf_loss": 0.02004121243953705, "vf_explained_var": 0.9924546480178833, "kl": 0.0014799650525674224, "entropy": -6.4840943813323975, "entropy_coeff": 0.0}}, "num_steps_sampled": 1236800, "num_steps_trained": 1236800}, "done": false, "episodes_total": 1226, "training_iteration": 166, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-56", "timestamp": 1617635336, "time_this_iter_s": 1.4702208042144775, "time_total_s": 336.0779116153717, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 171.29144716262817, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 69.35, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 48.9147245629109, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.66967448352964, "MDD_min": 13.578316657835327, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [37.29879023638453, 51.83992824549867, 65.9802835532954, 61.61933841525091, 41.66119216811639, 40.339815344005665, 78.34305336935884, 36.32815538927933, 50.252455776607505, 40.309394368453674, 70.20149441443553, 40.6274002945663, 80.71553392280447, 38.75300995870356, 18.161893514480933, 46.03161984655102, 51.58768037772778, 21.50013921071564, 41.81050731483845, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989893810545174, "mean_inference_ms": 1.2748725294677898, "mean_action_processing_ms": 0.054137969799465765, "mean_env_wait_ms": 1.190582472800203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1244400, "timers": {"sample_time_ms": 1158.354, "sample_throughput": 6561.035, "learn_time_ms": 332.379, "learn_throughput": 22865.467, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.407412430484045e-35, "cur_lr": 0.001, "total_loss": 0.15805482864379883, "policy_loss": 0.008170168730430305, "vf_loss": 0.1498846560716629, "vf_explained_var": 0.9865851998329163, "kl": 0.002628802671097219, "entropy": -6.281255483627319, "entropy_coeff": 0.0}}, "num_steps_sampled": 1244400, "num_steps_trained": 1244400}, "done": false, "episodes_total": 1226, "training_iteration": 167, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-58", "timestamp": 1617635338, "time_this_iter_s": 1.4964725971221924, "time_total_s": 337.5743842124939, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 172.78791975975037, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 67.69999999999999, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 49.00415757875648, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.986242636759815, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892003343356315, "mean_inference_ms": 1.2747729710429994, "mean_action_processing_ms": 0.05414502941360344, "mean_env_wait_ms": 1.190576584309788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1252000, "timers": {"sample_time_ms": 1158.764, "sample_throughput": 6558.712, "learn_time_ms": 335.711, "learn_throughput": 22638.494, "update_time_ms": 2.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2037062152420224e-35, "cur_lr": 0.001, "total_loss": 0.40587562322616577, "policy_loss": -0.030017507262527943, "vf_loss": 0.43589311838150024, "vf_explained_var": 0.9785808324813843, "kl": 0.002921238192357123, "entropy": -6.28685736656189, "entropy_coeff": 0.0}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 1245, "training_iteration": 168, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-08-59", "timestamp": 1617635339, "time_this_iter_s": 1.5642015933990479, "time_total_s": 339.13858580589294, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ed40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 174.3521213531494, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 66.3, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 14.90098599714172, "episode_reward_mean": 49.004157578756484, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.986242636759826, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [41.67821533441287, 27.041951068816505, 29.033737676239614, 53.63204742008996, 55.061447248967546, 14.90098599714172, 43.920979290222505, 54.30936763276586, 44.421675022788236, 46.80554813992405, 55.95474335118246, 38.29979914421699, 22.874437998205476, 68.74092601206196, 51.97612766704049, 26.403863090178568, 35.911031143476784, 38.37504231863284, 38.65439392427807, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892003343356318, "mean_inference_ms": 1.2747729710429994, "mean_action_processing_ms": 0.054145029413603434, "mean_env_wait_ms": 1.190576584309788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1259600, "timers": {"sample_time_ms": 1156.715, "sample_throughput": 6570.333, "learn_time_ms": 339.067, "learn_throughput": 22414.48, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.018531076210112e-36, "cur_lr": 0.001, "total_loss": 0.03537482023239136, "policy_loss": 0.0005586352199316025, "vf_loss": 0.0348161906003952, "vf_explained_var": 0.9853255748748779, "kl": 0.0013550069998018444, "entropy": -6.302234411239624, "entropy_coeff": 0.0}}, "num_steps_sampled": 1259600, "num_steps_trained": 1259600}, "done": false, "episodes_total": 1245, "training_iteration": 169, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-01", "timestamp": 1617635341, "time_this_iter_s": 1.4710137844085693, "time_total_s": 340.6095995903015, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 175.82313513755798, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 74.55000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 50.45635573991372, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.541590784167123, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19897543393947148, "mean_inference_ms": 1.2746655882290716, "mean_action_processing_ms": 0.05415125036660888, "mean_env_wait_ms": 1.1905555415505302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1267200, "timers": {"sample_time_ms": 1156.072, "sample_throughput": 6573.984, "learn_time_ms": 341.325, "learn_throughput": 22266.15, "update_time_ms": 2.801}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.009265538105056e-36, "cur_lr": 0.001, "total_loss": 0.51174396276474, "policy_loss": -0.004496393550653011, "vf_loss": 0.5162403285503387, "vf_explained_var": 0.9819363355636597, "kl": 0.0037801286671310663, "entropy": -6.216578006744385, "entropy_coeff": 0.0}}, "num_steps_sampled": 1267200, "num_steps_trained": 1267200}, "done": false, "episodes_total": 1264, "training_iteration": 170, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-02", "timestamp": 1617635342, "time_this_iter_s": 1.5783424377441406, "time_total_s": 342.18794202804565, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ea70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 177.40147757530212, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 80.55000000000001, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 50.456355739913704, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.541590784167127, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19897543393947145, "mean_inference_ms": 1.2746655882290714, "mean_action_processing_ms": 0.054151250366608894, "mean_env_wait_ms": 1.1905555415505302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1274800, "timers": {"sample_time_ms": 1154.491, "sample_throughput": 6582.986, "learn_time_ms": 343.32, "learn_throughput": 22136.784, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.504632769052528e-36, "cur_lr": 0.001, "total_loss": 0.02210266888141632, "policy_loss": 0.0027102120220661163, "vf_loss": 0.019392454996705055, "vf_explained_var": 0.9924541711807251, "kl": 0.0017570051131770015, "entropy": -6.569473028182983, "entropy_coeff": 0.0}}, "num_steps_sampled": 1274800, "num_steps_trained": 1274800}, "done": false, "episodes_total": 1264, "training_iteration": 171, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-04", "timestamp": 1617635344, "time_this_iter_s": 1.4653644561767578, "time_total_s": 343.6533064842224, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 178.86684203147888, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 50.456355739913704, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.541590784167127, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [41.76915766650306, 43.94862313374371, 54.79714391517157, 69.19672802691179, 42.240751397884836, 27.827315379441163, 50.248637730876105, 36.52578375046419, 37.85675621531461, 32.99094447991137, 62.39031587036789, 52.13078400899531, 74.24859280656133, 28.92265648487986, 79.82959119749381, 62.066961959946156, 85.19291699666923, 47.71582742367457, 59.629882428918, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19897543393947145, "mean_inference_ms": 1.2746655882290714, "mean_action_processing_ms": 0.054151250366608894, "mean_env_wait_ms": 1.1905555415505302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1282400, "timers": {"sample_time_ms": 1153.131, "sample_throughput": 6590.753, "learn_time_ms": 346.236, "learn_throughput": 21950.366, "update_time_ms": 2.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.52316384526264e-37, "cur_lr": 0.001, "total_loss": 0.177146777510643, "policy_loss": -0.00012348487507551908, "vf_loss": 0.17727025598287582, "vf_explained_var": 0.9846097230911255, "kl": 0.0015758366789668798, "entropy": -6.300151348114014, "entropy_coeff": 0.0}}, "num_steps_sampled": 1282400, "num_steps_trained": 1282400}, "done": false, "episodes_total": 1264, "training_iteration": 172, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-05", "timestamp": 1617635345, "time_this_iter_s": 1.461371898651123, "time_total_s": 345.11467838287354, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ecb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 180.32821393013, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 69.5, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 50.02629644230186, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.831792446728514, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890642271172287, "mean_inference_ms": 1.2745307259546186, "mean_action_processing_ms": 0.054154522563847, "mean_env_wait_ms": 1.1905198521901148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1290000, "timers": {"sample_time_ms": 1155.514, "sample_throughput": 6577.157, "learn_time_ms": 348.606, "learn_throughput": 21801.089, "update_time_ms": 2.879}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.76158192263132e-37, "cur_lr": 0.001, "total_loss": 0.4340059906244278, "policy_loss": 0.014815533999353647, "vf_loss": 0.4191904664039612, "vf_explained_var": 0.9800649881362915, "kl": 0.0027870286721736193, "entropy": -6.375165939331055, "entropy_coeff": 0.0}}, "num_steps_sampled": 1290000, "num_steps_trained": 1290000}, "done": false, "episodes_total": 1283, "training_iteration": 173, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-07", "timestamp": 1617635347, "time_this_iter_s": 1.5942192077636719, "time_total_s": 346.7088975906372, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 181.92243313789368, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 50.026296442301856, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.83179244672851, "MDD_min": 15.362262473621554, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [53.64997926975593, 54.847430612704215, 32.56610521388328, 47.168362126418835, 44.623275598709725, 32.1372179389711, 70.56199100543013, 49.76001227233996, 82.19624580120308, 54.04596788033264, 28.887353928330814, 65.81550413403922, 43.55495518193916, 36.76747856161006, 48.18290943928144, 89.22461452461337, 66.89204164450126, 56.7879537242293, 57.671634438238534, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989064227117229, "mean_inference_ms": 1.2745307259546186, "mean_action_processing_ms": 0.054154522563846993, "mean_env_wait_ms": 1.1905198521901148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1297600, "timers": {"sample_time_ms": 1154.893, "sample_throughput": 6580.697, "learn_time_ms": 350.045, "learn_throughput": 21711.501, "update_time_ms": 2.847}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.88079096131566e-37, "cur_lr": 0.001, "total_loss": -0.00871700793504715, "policy_loss": -0.041194172110408545, "vf_loss": 0.03247716650366783, "vf_explained_var": 0.9865676164627075, "kl": 0.0013295549433678389, "entropy": -6.388382196426392, "entropy_coeff": 0.0}}, "num_steps_sampled": 1297600, "num_steps_trained": 1297600}, "done": false, "episodes_total": 1283, "training_iteration": 174, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-08", "timestamp": 1617635348, "time_this_iter_s": 1.459226369857788, "time_total_s": 348.168123960495, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ed40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 183.38165950775146, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 74.44999999999999, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 49.08409383501291, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.343361034075816, "MDD_min": 17.118165760246715, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19896579038023357, "mean_inference_ms": 1.2744609595799132, "mean_action_processing_ms": 0.05415702714357576, "mean_env_wait_ms": 1.1905374149322663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1305200, "timers": {"sample_time_ms": 1156.845, "sample_throughput": 6569.592, "learn_time_ms": 349.645, "learn_throughput": 21736.339, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.4039548065783e-38, "cur_lr": 0.001, "total_loss": 0.5157963931560516, "policy_loss": 0.018302529118955135, "vf_loss": 0.4974938631057739, "vf_explained_var": 0.9826327562332153, "kl": 0.002811184385791421, "entropy": -6.312223434448242, "entropy_coeff": 0.0}}, "num_steps_sampled": 1305200, "num_steps_trained": 1305200}, "done": false, "episodes_total": 1302, "training_iteration": 175, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-10", "timestamp": 1617635350, "time_this_iter_s": 1.6001684665679932, "time_total_s": 349.768292427063, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 184.98182797431946, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 80.6, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 49.08409383501291, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.343361034075823, "MDD_min": 17.118165760246715, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19896579038023351, "mean_inference_ms": 1.2744609595799135, "mean_action_processing_ms": 0.05415702714357575, "mean_env_wait_ms": 1.1905374149322665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1312800, "timers": {"sample_time_ms": 1156.183, "sample_throughput": 6573.356, "learn_time_ms": 349.927, "learn_throughput": 21718.788, "update_time_ms": 2.91}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.70197740328915e-38, "cur_lr": 0.001, "total_loss": 0.012011438433546573, "policy_loss": -0.0086469198577106, "vf_loss": 0.020658358931541443, "vf_explained_var": 0.9911870956420898, "kl": 0.000826235074782744, "entropy": -6.608472108840942, "entropy_coeff": 0.0}}, "num_steps_sampled": 1312800, "num_steps_trained": 1312800}, "done": false, "episodes_total": 1302, "training_iteration": 176, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-11", "timestamp": 1617635351, "time_this_iter_s": 1.466400146484375, "time_total_s": 351.23469257354736, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ea70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 186.44822812080383, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 122.49396118327336, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 49.08409383501291, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.343361034075823, "MDD_min": 17.118165760246715, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [51.57219234728294, 38.40515763780206, 41.983246245028, 35.186658241538396, 60.99764333800202, 84.23558596985991, 62.22923523688377, 44.10903389992875, 49.24990499162551, 28.452422102650743, 51.03713394243727, 40.670945009689085, 48.580857318139735, 59.52196941062893, 35.30238836829804, 122.49396118327336, 37.32796214676478, 49.54776978106208, 54.053852679754456, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19896579038023351, "mean_inference_ms": 1.2744609595799135, "mean_action_processing_ms": 0.05415702714357575, "mean_env_wait_ms": 1.1905374149322665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1320400, "timers": {"sample_time_ms": 1153.425, "sample_throughput": 6589.074, "learn_time_ms": 350.122, "learn_throughput": 21706.749, "update_time_ms": 2.96}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.350988701644575e-38, "cur_lr": 0.001, "total_loss": 0.18130283802747726, "policy_loss": 0.004379658377729356, "vf_loss": 0.17692318558692932, "vf_explained_var": 0.9841841459274292, "kl": 0.002329040435142815, "entropy": -6.379823684692383, "entropy_coeff": 0.0}}, "num_steps_sampled": 1320400, "num_steps_trained": 1320400}, "done": false, "episodes_total": 1302, "training_iteration": 177, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-13", "timestamp": 1617635353, "time_this_iter_s": 1.4715354442596436, "time_total_s": 352.706228017807, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 187.91976356506348, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 69.65, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 101.79875576849832, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 49.01588892296538, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.71811944128618, "MDD_min": 17.118165760246715, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19891181570809874, "mean_inference_ms": 1.2743574096887071, "mean_action_processing_ms": 0.05415630535639376, "mean_env_wait_ms": 1.1905277385813076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1328000, "timers": {"sample_time_ms": 1154.709, "sample_throughput": 6581.744, "learn_time_ms": 350.444, "learn_throughput": 21686.746, "update_time_ms": 2.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1754943508222875e-38, "cur_lr": 0.001, "total_loss": 0.4937462657690048, "policy_loss": -0.003553052374627441, "vf_loss": 0.49729928374290466, "vf_explained_var": 0.976010799407959, "kl": 0.0021713791647925973, "entropy": -6.42540717124939, "entropy_coeff": 0.0}}, "num_steps_sampled": 1328000, "num_steps_trained": 1328000}, "done": false, "episodes_total": 1321, "training_iteration": 178, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-14", "timestamp": 1617635354, "time_this_iter_s": 1.5799200534820557, "time_total_s": 354.28614807128906, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ecb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 189.49968361854553, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 68.45, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 101.79875576849832, "episode_reward_min": 21.704952889772848, "episode_reward_mean": 49.01588892296537, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.71811944128618, "MDD_min": 17.118165760246715, "MDD_max": 39.88511523897747}, "hist_stats": {"episode_reward": [21.704952889772848, 56.933355216685996, 29.703343233511507, 43.321538474729955, 38.62293725376245, 36.92929030632132, 76.43473597129582, 52.11600005089559, 73.96215906718811, 30.70831265207863, 26.570713091752012, 45.03901237049335, 44.69388072189215, 31.35067405205212, 53.69700104357044, 37.642409538065884, 66.79403852998252, 41.475896379653804, 33.12775445018026, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19891181570809877, "mean_inference_ms": 1.2743574096887074, "mean_action_processing_ms": 0.054156305356393764, "mean_env_wait_ms": 1.1905277385813076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1335600, "timers": {"sample_time_ms": 1154.576, "sample_throughput": 6582.504, "learn_time_ms": 350.584, "learn_throughput": 21678.127, "update_time_ms": 2.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.877471754111438e-39, "cur_lr": 0.001, "total_loss": 0.03292777016758919, "policy_loss": -0.00795306422514841, "vf_loss": 0.04088083282113075, "vf_explained_var": 0.9832618236541748, "kl": 0.0014782712678425014, "entropy": -6.469559907913208, "entropy_coeff": 0.0}}, "num_steps_sampled": 1335600, "num_steps_trained": 1335600}, "done": false, "episodes_total": 1321, "training_iteration": 179, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-16", "timestamp": 1617635356, "time_this_iter_s": 1.4709749221801758, "time_total_s": 355.75712299346924, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 190.9706585407257, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 64.13333333333334, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 22.645522571037652, "episode_reward_mean": 50.69933204594366, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.82355637744363, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989713840236861, "mean_inference_ms": 1.2742509471879182, "mean_action_processing_ms": 0.05415551147973947, "mean_env_wait_ms": 1.190496896431909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1343200, "timers": {"sample_time_ms": 1153.272, "sample_throughput": 6589.944, "learn_time_ms": 350.817, "learn_throughput": 21663.695, "update_time_ms": 2.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.938735877055719e-39, "cur_lr": 0.001, "total_loss": 0.7324957847595215, "policy_loss": 0.011844113701954484, "vf_loss": 0.7206516265869141, "vf_explained_var": 0.975989818572998, "kl": 0.004252297105267644, "entropy": -6.363852262496948, "entropy_coeff": 0.0}}, "num_steps_sampled": 1343200, "num_steps_trained": 1343200}, "done": false, "episodes_total": 1340, "training_iteration": 180, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-18", "timestamp": 1617635358, "time_this_iter_s": 1.5668251514434814, "time_total_s": 357.3239481449127, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ea70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 192.5374836921692, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 80.80000000000001, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 22.645522571037652, "episode_reward_mean": 50.69933204594366, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.823556377443623, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989713840236861, "mean_inference_ms": 1.2742509471879182, "mean_action_processing_ms": 0.05415551147973946, "mean_env_wait_ms": 1.190496896431909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1350800, "timers": {"sample_time_ms": 1154.789, "sample_throughput": 6581.289, "learn_time_ms": 350.108, "learn_throughput": 21707.584, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4693679385278594e-39, "cur_lr": 0.001, "total_loss": -0.004536681808531284, "policy_loss": -0.024401336442679167, "vf_loss": 0.019864654168486595, "vf_explained_var": 0.9912499189376831, "kl": 0.0013437483576126397, "entropy": -6.703185558319092, "entropy_coeff": 0.0}}, "num_steps_sampled": 1350800, "num_steps_trained": 1350800}, "done": false, "episodes_total": 1340, "training_iteration": 181, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-19", "timestamp": 1617635359, "time_this_iter_s": 1.4730098247528076, "time_total_s": 358.7969579696655, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 194.010493516922, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 22.645522571037652, "episode_reward_mean": 50.69933204594366, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.823556377443623, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [54.64149638930325, 54.47299586350609, 59.08530544348159, 50.678648109541285, 52.8846632743776, 39.198074347148626, 33.507222029123355, 50.351117053486384, 84.19400459403572, 22.645522571037652, 26.36483474282031, 45.41007785196378, 42.07222247354528, 67.9097627380449, 62.70471901560059, 57.921880477183976, 36.6407202273316, 48.39731117341341, 71.1622381619527, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989713840236861, "mean_inference_ms": 1.2742509471879182, "mean_action_processing_ms": 0.05415551147973946, "mean_env_wait_ms": 1.190496896431909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1358400, "timers": {"sample_time_ms": 1156.314, "sample_throughput": 6572.606, "learn_time_ms": 349.935, "learn_throughput": 21718.296, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.346839692639297e-40, "cur_lr": 0.001, "total_loss": 0.16239099949598312, "policy_loss": 0.006213861517608166, "vf_loss": 0.1561771109700203, "vf_explained_var": 0.9860532283782959, "kl": 0.0013941926881670952, "entropy": -6.4743053913116455, "entropy_coeff": 0.0}}, "num_steps_sampled": 1358400, "num_steps_trained": 1358400}, "done": false, "episodes_total": 1340, "training_iteration": 182, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-20", "timestamp": 1617635360, "time_this_iter_s": 1.474168062210083, "time_total_s": 360.2711260318756, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ecb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 195.48466157913208, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 72.6, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 50.493951831515304, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.28787287109217, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989242062164305, "mean_inference_ms": 1.2741284420460497, "mean_action_processing_ms": 0.05415401242621039, "mean_env_wait_ms": 1.1904563215340376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1366000, "timers": {"sample_time_ms": 1156.218, "sample_throughput": 6573.156, "learn_time_ms": 349.838, "learn_throughput": 21724.319, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.6734198463196485e-40, "cur_lr": 0.001, "total_loss": 0.5492215156555176, "policy_loss": -0.0029355266597121954, "vf_loss": 0.5521569848060608, "vf_explained_var": 0.9760966300964355, "kl": 0.0021056286059319973, "entropy": -6.4354002475738525, "entropy_coeff": 0.0}}, "num_steps_sampled": 1366000, "num_steps_trained": 1366000}, "done": false, "episodes_total": 1359, "training_iteration": 183, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-22", "timestamp": 1617635362, "time_this_iter_s": 1.5920324325561523, "time_total_s": 361.86315846443176, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345150e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 197.07669401168823, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 68.45, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 50.493951831515325, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.287872871092176, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [35.2308403584785, 56.28214757584607, 73.87114474455134, 50.58604196320586, 28.76625349759519, 60.44656579988733, 27.799521582307037, 33.38907300832433, 65.01891529510475, 69.51600761591503, 41.594888459344524, 68.27846099833097, 60.44359717017874, 44.598554745638594, 47.58031470115771, 41.8964099626473, 49.71462149822299, 68.85815448242131, 40.23016039567021, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19892420621643056, "mean_inference_ms": 1.2741284420460497, "mean_action_processing_ms": 0.05415401242621038, "mean_env_wait_ms": 1.1904563215340378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1373600, "timers": {"sample_time_ms": 1155.989, "sample_throughput": 6574.458, "learn_time_ms": 350.979, "learn_throughput": 21653.734, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8367099231598242e-40, "cur_lr": 0.001, "total_loss": 0.038888853043317795, "policy_loss": -0.005826313572470099, "vf_loss": 0.04471517354249954, "vf_explained_var": 0.9825865030288696, "kl": 0.0015242269146256149, "entropy": -6.498423337936401, "entropy_coeff": 0.0}}, "num_steps_sampled": 1373600, "num_steps_trained": 1373600}, "done": false, "episodes_total": 1359, "training_iteration": 184, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-24", "timestamp": 1617635364, "time_this_iter_s": 1.4687981605529785, "time_total_s": 363.33195662498474, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 198.5454921722412, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 68.55000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.49771993922511, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.030396385001175, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19898647291947547, "mean_inference_ms": 1.2740109986861172, "mean_action_processing_ms": 0.05415362912814261, "mean_env_wait_ms": 1.1904353446558904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1381200, "timers": {"sample_time_ms": 1153.948, "sample_throughput": 6586.087, "learn_time_ms": 351.987, "learn_throughput": 21591.727, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.183549615799121e-41, "cur_lr": 0.001, "total_loss": 0.9475758671760559, "policy_loss": 0.002031007781624794, "vf_loss": 0.9455448389053345, "vf_explained_var": 0.970278263092041, "kl": 0.009715785272419453, "entropy": -6.360492944717407, "entropy_coeff": 0.0}}, "num_steps_sampled": 1381200, "num_steps_trained": 1381200}, "done": false, "episodes_total": 1378, "training_iteration": 185, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-25", "timestamp": 1617635365, "time_this_iter_s": 1.5900344848632812, "time_total_s": 364.921991109848, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 200.1355266571045, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 69.63333333333333, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.497719939225114, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.030396385001183, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19898647291947552, "mean_inference_ms": 1.2740109986861172, "mean_action_processing_ms": 0.05415362912814261, "mean_env_wait_ms": 1.1904353446558904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1388800, "timers": {"sample_time_ms": 1152.835, "sample_throughput": 6592.443, "learn_time_ms": 352.669, "learn_throughput": 21549.969, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.183549615799121e-41, "cur_lr": 0.001, "total_loss": 0.0018311282619833946, "policy_loss": -0.017916328040882945, "vf_loss": 0.01974745374172926, "vf_explained_var": 0.9909646511077881, "kl": 0.001965293427929282, "entropy": -6.705195665359497, "entropy_coeff": 0.0}}, "num_steps_sampled": 1388800, "num_steps_trained": 1388800}, "done": false, "episodes_total": 1378, "training_iteration": 186, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-27", "timestamp": 1617635367, "time_this_iter_s": 1.4610841274261475, "time_total_s": 366.38307523727417, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 201.59661078453064, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 74.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.497719939225114, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.030396385001183, "MDD_min": 17.238662139649573, "MDD_max": 38.92002896420019}, "hist_stats": {"episode_reward": [40.945998998154245, 54.751580429288, 45.66690118662337, 43.51861444825566, 42.27510033507107, 40.163919232535434, 33.52155374887646, 49.85603756382899, 42.37506929626289, 42.87946861923106, 70.948099611905, 65.08773709039909, 56.728621505703124, 31.77184068441266, 53.530603646899834, 40.640749948180414, 60.94349833799959, 74.28891388251354, 55.05370686122055, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19898647291947552, "mean_inference_ms": 1.2740109986861172, "mean_action_processing_ms": 0.05415362912814261, "mean_env_wait_ms": 1.1904353446558904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1396400, "timers": {"sample_time_ms": 1153.151, "sample_throughput": 6590.64, "learn_time_ms": 352.774, "learn_throughput": 21543.535, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.591774807899561e-41, "cur_lr": 0.001, "total_loss": 0.18177656084299088, "policy_loss": 0.011345757404342294, "vf_loss": 0.17043080180883408, "vf_explained_var": 0.9862719178199768, "kl": 0.002456961548887193, "entropy": -6.481556415557861, "entropy_coeff": 0.0}}, "num_steps_sampled": 1396400, "num_steps_trained": 1396400}, "done": false, "episodes_total": 1378, "training_iteration": 187, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-28", "timestamp": 1617635368, "time_this_iter_s": 1.4759798049926758, "time_total_s": 367.85905504226685, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345150e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 203.07259058952332, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.91745763401227, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.843151539458486, "MDD_min": 13.365765365788047, "MDD_max": 37.04792116101225}, "hist_stats": {"episode_reward": [27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19894616086892714, "mean_inference_ms": 1.2738818565933838, "mean_action_processing_ms": 0.05415264724730462, "mean_env_wait_ms": 1.1904086997531362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1404000, "timers": {"sample_time_ms": 1152.594, "sample_throughput": 6593.823, "learn_time_ms": 352.351, "learn_throughput": 21569.424, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2958874039497803e-41, "cur_lr": 0.001, "total_loss": 0.5127899348735809, "policy_loss": 0.004544492927379906, "vf_loss": 0.5082454532384872, "vf_explained_var": 0.978652834892273, "kl": 0.002456488669849932, "entropy": -6.4608986377716064, "entropy_coeff": 0.0}}, "num_steps_sampled": 1404000, "num_steps_trained": 1404000}, "done": false, "episodes_total": 1397, "training_iteration": 188, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-30", "timestamp": 1617635370, "time_this_iter_s": 1.5699665546417236, "time_total_s": 369.42902159690857, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 204.64255714416504, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 70.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.91745763401227, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.843151539458486, "MDD_min": 13.365765365788047, "MDD_max": 37.04792116101225}, "hist_stats": {"episode_reward": [37.67925946506976, 31.899418632203407, 56.34510805745026, 31.741602173211405, 45.66556420973444, 32.78158025015385, 62.821551561511285, 71.10829338494018, 31.920604557296805, 41.158770456990716, 45.13229033036145, 27.56516682399165, 58.81738627614549, 60.08311299505381, 31.34610300719693, 50.22400721086121, 43.06299566669737, 28.78313392760754, 39.62971652602239, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19894616086892714, "mean_inference_ms": 1.2738818565933836, "mean_action_processing_ms": 0.05415264724730461, "mean_env_wait_ms": 1.1904086997531362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1411600, "timers": {"sample_time_ms": 1152.977, "sample_throughput": 6591.629, "learn_time_ms": 351.746, "learn_throughput": 21606.488, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1479437019748901e-41, "cur_lr": 0.001, "total_loss": 0.020324968732893467, "policy_loss": -0.01715016458183527, "vf_loss": 0.03747512958943844, "vf_explained_var": 0.9857927560806274, "kl": 0.0009486099006608129, "entropy": -6.498271703720093, "entropy_coeff": 0.0}}, "num_steps_sampled": 1411600, "num_steps_trained": 1411600}, "done": false, "episodes_total": 1397, "training_iteration": 189, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-31", "timestamp": 1617635371, "time_this_iter_s": 1.4688117504119873, "time_total_s": 370.89783334732056, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 206.11136889457703, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 68.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 53.9068590499507, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.882422143154, "MDD_min": 13.365765365788047, "MDD_max": 34.67820666700756}, "hist_stats": {"episode_reward": [62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901513761026557, "mean_inference_ms": 1.2737845568369444, "mean_action_processing_ms": 0.05415368772888418, "mean_env_wait_ms": 1.1903988958253446, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1419200, "timers": {"sample_time_ms": 1154.017, "sample_throughput": 6585.693, "learn_time_ms": 351.246, "learn_throughput": 21637.238, "update_time_ms": 2.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.739718509874451e-42, "cur_lr": 0.001, "total_loss": 0.5005546510219574, "policy_loss": 0.00020429037977010012, "vf_loss": 0.5003503412008286, "vf_explained_var": 0.9838469624519348, "kl": 0.0027258775662630796, "entropy": -6.359005928039551, "entropy_coeff": 0.0}}, "num_steps_sampled": 1419200, "num_steps_trained": 1419200}, "done": false, "episodes_total": 1416, "training_iteration": 190, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-33", "timestamp": 1617635373, "time_this_iter_s": 1.572845697402954, "time_total_s": 372.4706790447235, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 207.68421459197998, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 67.3, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 53.9068590499507, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.882422143154002, "MDD_min": 13.365765365788047, "MDD_max": 34.67820666700756}, "hist_stats": {"episode_reward": [81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901513761026554, "mean_inference_ms": 1.2737845568369444, "mean_action_processing_ms": 0.054153687728884174, "mean_env_wait_ms": 1.190398895825345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1426800, "timers": {"sample_time_ms": 1152.103, "sample_throughput": 6596.634, "learn_time_ms": 347.175, "learn_throughput": 21890.971, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8698592549372254e-42, "cur_lr": 0.001, "total_loss": 0.025532647036015987, "policy_loss": 0.003216436511138454, "vf_loss": 0.022316213697195053, "vf_explained_var": 0.9894506931304932, "kl": 0.0017308652750216424, "entropy": -6.667424440383911, "entropy_coeff": 0.0}}, "num_steps_sampled": 1426800, "num_steps_trained": 1426800}, "done": false, "episodes_total": 1416, "training_iteration": 191, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-34", "timestamp": 1617635374, "time_this_iter_s": 1.4135701656341553, "time_total_s": 373.88424921035767, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345150e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 209.09778475761414, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 109.70294565475585, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 53.9068590499507, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.882422143154002, "MDD_min": 13.365765365788047, "MDD_max": 34.67820666700756}, "hist_stats": {"episode_reward": [81.15767901121765, 70.99401097662228, 101.79875576849832, 51.696462693827925, 58.055807220898956, 34.48664719059089, 36.20404702939099, 40.837009006895684, 35.882653503476, 51.6109101762683, 70.589220835234, 35.9348349904081, 81.5179803420368, 47.061641193373234, 63.997149199884475, 109.70294565475585, 69.32125952707281, 72.51727526047912, 52.61212716317245, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901513761026554, "mean_inference_ms": 1.2737845568369444, "mean_action_processing_ms": 0.054153687728884174, "mean_env_wait_ms": 1.190398895825345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1434400, "timers": {"sample_time_ms": 1151.72, "sample_throughput": 6598.825, "learn_time_ms": 342.297, "learn_throughput": 22202.95, "update_time_ms": 2.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4349296274686127e-42, "cur_lr": 0.001, "total_loss": 0.20971132814884186, "policy_loss": 0.005895823996979743, "vf_loss": 0.2038154974579811, "vf_explained_var": 0.9834023118019104, "kl": 0.002942836144939065, "entropy": -6.527307748794556, "entropy_coeff": 0.0}}, "num_steps_sampled": 1434400, "num_steps_trained": 1434400}, "done": false, "episodes_total": 1416, "training_iteration": 192, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-36", "timestamp": 1617635376, "time_this_iter_s": 1.4220976829528809, "time_total_s": 375.30634689331055, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 210.51988244056702, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.6151891558274, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.56013762486716, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19898155483253743, "mean_inference_ms": 1.2736539636368382, "mean_action_processing_ms": 0.05415161687044132, "mean_env_wait_ms": 1.1903520966169368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1442000, "timers": {"sample_time_ms": 1150.588, "sample_throughput": 6605.317, "learn_time_ms": 336.991, "learn_throughput": 22552.552, "update_time_ms": 2.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.174648137343064e-43, "cur_lr": 0.001, "total_loss": 0.6016252040863037, "policy_loss": -0.00737750472035259, "vf_loss": 0.6090027093887329, "vf_explained_var": 0.9746358394622803, "kl": 0.002352975308895111, "entropy": -6.413693189620972, "entropy_coeff": 0.0}}, "num_steps_sampled": 1442000, "num_steps_trained": 1442000}, "done": false, "episodes_total": 1435, "training_iteration": 193, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-37", "timestamp": 1617635377, "time_this_iter_s": 1.5274097919464111, "time_total_s": 376.83375668525696, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 212.04729223251343, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 80.7, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 24.30547576729215, "episode_reward_mean": 52.6151891558274, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.560137624867156, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [50.11717065677747, 35.11377846111976, 33.63399908673677, 62.56015322423368, 25.47151508980853, 47.19260128209209, 54.500084693198986, 50.4103988294286, 24.30547576729215, 39.89027587402118, 50.27581733478314, 65.25672785806057, 73.84276029124244, 57.44356191866375, 25.80702508045259, 42.189705772514095, 35.19079637453665, 36.57605429274885, 64.29020692001973, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19898155483253746, "mean_inference_ms": 1.2736539636368382, "mean_action_processing_ms": 0.05415161687044133, "mean_env_wait_ms": 1.1903520966169368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1449600, "timers": {"sample_time_ms": 1151.819, "sample_throughput": 6598.262, "learn_time_ms": 331.858, "learn_throughput": 22901.337, "update_time_ms": 2.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.587324068671532e-43, "cur_lr": 0.001, "total_loss": 0.035415664315223694, "policy_loss": -0.0007170406388468109, "vf_loss": 0.036132700741291046, "vf_explained_var": 0.9862017631530762, "kl": 0.0010540364601183683, "entropy": -6.551633596420288, "entropy_coeff": 0.0}}, "num_steps_sampled": 1449600, "num_steps_trained": 1449600}, "done": false, "episodes_total": 1435, "training_iteration": 194, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-39", "timestamp": 1617635379, "time_this_iter_s": 1.4303045272827148, "time_total_s": 378.2640612125397, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 213.47759675979614, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 73.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.170532506049856, "episode_reward_mean": 52.5424097622785, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.422235945187495, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990476962148361, "mean_inference_ms": 1.2735657713738342, "mean_action_processing_ms": 0.05415042630182104, "mean_env_wait_ms": 1.1903287233463713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1457200, "timers": {"sample_time_ms": 1154.06, "sample_throughput": 6585.449, "learn_time_ms": 326.281, "learn_throughput": 23292.82, "update_time_ms": 2.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.793662034335766e-43, "cur_lr": 0.001, "total_loss": 0.477164626121521, "policy_loss": -0.01858760043978691, "vf_loss": 0.4957522451877594, "vf_explained_var": 0.9842603206634521, "kl": 0.002935529570095241, "entropy": -6.405965805053711, "entropy_coeff": 0.0}}, "num_steps_sampled": 1457200, "num_steps_trained": 1457200}, "done": false, "episodes_total": 1454, "training_iteration": 195, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-40", "timestamp": 1617635380, "time_this_iter_s": 1.5568957328796387, "time_total_s": 379.8209569454193, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345150e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 215.03449249267578, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 70.7, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.170532506049856, "episode_reward_mean": 52.542409762278496, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.422235945187495, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19904769621483603, "mean_inference_ms": 1.2735657713738344, "mean_action_processing_ms": 0.054150426301821056, "mean_env_wait_ms": 1.1903287233463713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1464800, "timers": {"sample_time_ms": 1155.638, "sample_throughput": 6576.452, "learn_time_ms": 321.139, "learn_throughput": 23665.756, "update_time_ms": 2.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.96831017167883e-44, "cur_lr": 0.001, "total_loss": 0.029979564249515533, "policy_loss": 0.00982033065520227, "vf_loss": 0.020159238018095493, "vf_explained_var": 0.9911024570465088, "kl": 0.0015773210325278342, "entropy": -6.7503156661987305, "entropy_coeff": 0.0}}, "num_steps_sampled": 1464800, "num_steps_trained": 1464800}, "done": false, "episodes_total": 1454, "training_iteration": 196, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-42", "timestamp": 1617635382, "time_this_iter_s": 1.4262681007385254, "time_total_s": 381.24722504615784, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450eef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 216.4607605934143, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 71.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.170532506049856, "episode_reward_mean": 52.542409762278496, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.422235945187495, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [43.339170425085115, 39.86484821140559, 32.822183303892515, 109.08332867656814, 47.423772188056205, 85.33005841733764, 30.56322295001425, 45.35763628060861, 85.01867897677506, 55.434682903904196, 86.34988543188553, 50.50307842572331, 67.91748634299095, 69.91251299187176, 42.491676874129574, 65.49209027776169, 33.14506040254937, 55.64577494048555, 58.87482910457232, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19904769621483603, "mean_inference_ms": 1.2735657713738344, "mean_action_processing_ms": 0.054150426301821056, "mean_env_wait_ms": 1.1903287233463713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1472400, "timers": {"sample_time_ms": 1156.742, "sample_throughput": 6570.175, "learn_time_ms": 316.351, "learn_throughput": 24023.96, "update_time_ms": 2.847}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.484155085839415e-44, "cur_lr": 0.001, "total_loss": 0.15558750182390213, "policy_loss": -0.0014939475222490728, "vf_loss": 0.1570814549922943, "vf_explained_var": 0.9876720309257507, "kl": 0.0018981975154019892, "entropy": -6.535480260848999, "entropy_coeff": 0.0}}, "num_steps_sampled": 1472400, "num_steps_trained": 1472400}, "done": false, "episodes_total": 1454, "training_iteration": 197, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-43", "timestamp": 1617635383, "time_this_iter_s": 1.4385128021240234, "time_total_s": 382.68573784828186, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 217.89927339553833, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 50.91034043180038, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.94980961932741, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901473521152335, "mean_inference_ms": 1.2734718559945393, "mean_action_processing_ms": 0.05415003467981592, "mean_env_wait_ms": 1.190305095315584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1480000, "timers": {"sample_time_ms": 1156.527, "sample_throughput": 6571.401, "learn_time_ms": 312.725, "learn_throughput": 24302.527, "update_time_ms": 2.833}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2420775429197073e-44, "cur_lr": 0.001, "total_loss": 0.41514919698238373, "policy_loss": -0.018108443589881063, "vf_loss": 0.4332576394081116, "vf_explained_var": 0.9813541173934937, "kl": 0.0016361552407033741, "entropy": -6.465106010437012, "entropy_coeff": 0.0}}, "num_steps_sampled": 1480000, "num_steps_trained": 1480000}, "done": false, "episodes_total": 1473, "training_iteration": 198, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-45", "timestamp": 1617635385, "time_this_iter_s": 1.5318913459777832, "time_total_s": 384.21762919425964, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 219.4311647415161, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 67.43333333333332, "ram_util_percent": 61.833333333333336}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 50.91034043180039, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.94980961932741, "MDD_min": 13.365765365788047, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [79.43675482666562, 51.51328342843463, 50.145364973493955, 46.13153794867283, 105.214869127931, 27.48360224999295, 53.469930138936824, 61.61723472400362, 65.9079146253547, 37.70963354339652, 64.20720411919179, 51.963573791257794, 60.26894622157412, 66.49017918573334, 45.3794886625927, 91.10378027785517, 59.555828333680765, 53.61474368406731, 51.640192115614944, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990147352115234, "mean_inference_ms": 1.273471855994539, "mean_action_processing_ms": 0.05415003467981592, "mean_env_wait_ms": 1.1903050953155843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1487600, "timers": {"sample_time_ms": 1158.371, "sample_throughput": 6560.939, "learn_time_ms": 310.003, "learn_throughput": 24515.875, "update_time_ms": 2.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1210387714598537e-44, "cur_lr": 0.001, "total_loss": 0.0392009150236845, "policy_loss": -0.000620441438513808, "vf_loss": 0.039821356534957886, "vf_explained_var": 0.9837489724159241, "kl": 0.0012089458177797496, "entropy": -6.570231914520264, "entropy_coeff": 0.0}}, "num_steps_sampled": 1487600, "num_steps_trained": 1487600}, "done": false, "episodes_total": 1473, "training_iteration": 199, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-46", "timestamp": 1617635386, "time_this_iter_s": 1.4610509872436523, "time_total_s": 385.6786801815033, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345150e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 220.89221572875977, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 75.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 49.35012134845257, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.285616361675743, "MDD_min": 15.576126086614519, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19907873177498714, "mean_inference_ms": 1.2733892633483241, "mean_action_processing_ms": 0.0541494625624844, "mean_env_wait_ms": 1.1902783724259032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1495200, "timers": {"sample_time_ms": 1157.997, "sample_throughput": 6563.058, "learn_time_ms": 306.51, "learn_throughput": 24795.278, "update_time_ms": 2.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.605193857299268e-45, "cur_lr": 0.001, "total_loss": 0.5814315378665924, "policy_loss": -0.012203290592879057, "vf_loss": 0.5936348140239716, "vf_explained_var": 0.9815076589584351, "kl": 0.003668044344522059, "entropy": -6.4353086948394775, "entropy_coeff": 0.0}}, "num_steps_sampled": 1495200, "num_steps_trained": 1495200}, "done": false, "episodes_total": 1492, "training_iteration": 200, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-48", "timestamp": 1617635388, "time_this_iter_s": 1.5342817306518555, "time_total_s": 387.21296191215515, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450edd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 222.42649745941162, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 80.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 49.35012134845257, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.285616361675743, "MDD_min": 15.576126086614519, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19907873177498714, "mean_inference_ms": 1.2733892633483241, "mean_action_processing_ms": 0.05414946256248439, "mean_env_wait_ms": 1.1902783724259032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1502800, "timers": {"sample_time_ms": 1158.37, "sample_throughput": 6560.943, "learn_time_ms": 306.752, "learn_throughput": 24775.752, "update_time_ms": 2.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.802596928649634e-45, "cur_lr": 0.001, "total_loss": 0.03940023388713598, "policy_loss": 0.01991358958184719, "vf_loss": 0.019486645236611366, "vf_explained_var": 0.9906340837478638, "kl": 0.001170552335679531, "entropy": -6.700703382492065, "entropy_coeff": 0.0}}, "num_steps_sampled": 1502800, "num_steps_trained": 1502800}, "done": false, "episodes_total": 1492, "training_iteration": 201, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-49", "timestamp": 1617635389, "time_this_iter_s": 1.419529676437378, "time_total_s": 388.63249158859253, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 223.846027135849, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 49.35012134845257, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.285616361675743, "MDD_min": 15.576126086614519, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [48.36830321011018, 33.19772008362173, 27.170532506049856, 35.78520970867718, 51.98776772436524, 62.03258443982301, 27.32473994769862, 35.80303285773513, 50.237718839048625, 75.38517703762156, 31.741207884599206, 54.43746172071178, 37.7616921663542, 53.15217390442912, 40.358552122613204, 44.17421421289803, 44.04317515341183, 39.29257609630182, 36.64138787252837, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19907873177498714, "mean_inference_ms": 1.2733892633483241, "mean_action_processing_ms": 0.05414946256248439, "mean_env_wait_ms": 1.1902783724259032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1510400, "timers": {"sample_time_ms": 1158.874, "sample_throughput": 6558.088, "learn_time_ms": 306.201, "learn_throughput": 24820.309, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.401298464324817e-45, "cur_lr": 0.001, "total_loss": 0.1807105764746666, "policy_loss": 0.004726923070847988, "vf_loss": 0.17598364502191544, "vf_explained_var": 0.9873447418212891, "kl": 0.0022130575962364674, "entropy": -6.508286476135254, "entropy_coeff": 0.0}}, "num_steps_sampled": 1510400, "num_steps_trained": 1510400}, "done": false, "episodes_total": 1492, "training_iteration": 202, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-51", "timestamp": 1617635391, "time_this_iter_s": 1.4215445518493652, "time_total_s": 390.0540361404419, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 225.26757168769836, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 51.05222884491992, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.92752609793029, "MDD_min": 17.403819527117474, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990278232637253, "mean_inference_ms": 1.273320816404722, "mean_action_processing_ms": 0.05415050911709751, "mean_env_wait_ms": 1.1902731532235338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1518000, "timers": {"sample_time_ms": 1160.096, "sample_throughput": 6551.183, "learn_time_ms": 306.469, "learn_throughput": 24798.594, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.006492321624085e-46, "cur_lr": 0.001, "total_loss": 0.5148498117923737, "policy_loss": -0.005925798817770556, "vf_loss": 0.5207755863666534, "vf_explained_var": 0.9775038957595825, "kl": 0.0017399329226464033, "entropy": -6.528705358505249, "entropy_coeff": 0.0}}, "num_steps_sampled": 1518000, "num_steps_trained": 1518000}, "done": false, "episodes_total": 1511, "training_iteration": 203, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-52", "timestamp": 1617635392, "time_this_iter_s": 1.5416285991668701, "time_total_s": 391.59566473960876, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 226.80920028686523, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 27.120968871490515, "episode_reward_mean": 51.05222884491993, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.927526097930286, "MDD_min": 17.403819527117474, "MDD_max": 35.36856395114042}, "hist_stats": {"episode_reward": [40.492616826870474, 43.9171800352773, 67.32790188100003, 56.76948831836496, 85.81292578905567, 57.68822744089816, 43.65566708985804, 75.13916469976185, 38.14130528302633, 37.7553465125352, 49.40537741507006, 36.5331042796439, 59.941824347969785, 46.415457446175004, 35.41071132940629, 76.18276351035877, 62.033851739209574, 49.22260635792948, 57.57773628280568, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19902782326372537, "mean_inference_ms": 1.273320816404722, "mean_action_processing_ms": 0.05415050911709753, "mean_env_wait_ms": 1.1902731532235338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1525600, "timers": {"sample_time_ms": 1158.055, "sample_throughput": 6562.726, "learn_time_ms": 306.325, "learn_throughput": 24810.275, "update_time_ms": 2.822}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.503246160812043e-46, "cur_lr": 0.001, "total_loss": 0.03427266702055931, "policy_loss": -0.003507263165374752, "vf_loss": 0.037779923528432846, "vf_explained_var": 0.9836300611495972, "kl": 0.0016648508026264608, "entropy": -6.587400197982788, "entropy_coeff": 0.0}}, "num_steps_sampled": 1525600, "num_steps_trained": 1525600}, "done": false, "episodes_total": 1511, "training_iteration": 204, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-54", "timestamp": 1617635394, "time_this_iter_s": 1.4076251983642578, "time_total_s": 393.003289937973, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 228.2168254852295, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 50.213628068166365, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.842105077960937, "MDD_min": 17.403819527117474, "MDD_max": 34.75824805532121}, "hist_stats": {"episode_reward": [43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19907030579753382, "mean_inference_ms": 1.273251319922579, "mean_action_processing_ms": 0.05415093506744087, "mean_env_wait_ms": 1.1902666595997315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1533200, "timers": {"sample_time_ms": 1156.152, "sample_throughput": 6573.528, "learn_time_ms": 305.709, "learn_throughput": 24860.221, "update_time_ms": 2.897}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7516230804060213e-46, "cur_lr": 0.001, "total_loss": 0.6255030035972595, "policy_loss": 0.012181803467683494, "vf_loss": 0.6133211851119995, "vf_explained_var": 0.9816205501556396, "kl": 0.0028706450248137116, "entropy": -6.484211683273315, "entropy_coeff": 0.0}}, "num_steps_sampled": 1533200, "num_steps_trained": 1533200}, "done": false, "episodes_total": 1530, "training_iteration": 205, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-55", "timestamp": 1617635395, "time_this_iter_s": 1.5318818092346191, "time_total_s": 394.53517174720764, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 229.7487072944641, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 72.15, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 50.213628068166344, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.84210507796094, "MDD_min": 17.403819527117474, "MDD_max": 34.75824805532121}, "hist_stats": {"episode_reward": [37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990703057975338, "mean_inference_ms": 1.2732513199225792, "mean_action_processing_ms": 0.05415093506744089, "mean_env_wait_ms": 1.1902666595997318, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1540800, "timers": {"sample_time_ms": 1157.454, "sample_throughput": 6566.137, "learn_time_ms": 305.443, "learn_throughput": 24881.889, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.758115402030107e-47, "cur_lr": 0.001, "total_loss": 0.004522446542978287, "policy_loss": -0.015095841372385621, "vf_loss": 0.01961828861385584, "vf_explained_var": 0.9903859496116638, "kl": 0.002407313557341695, "entropy": -6.741382598876953, "entropy_coeff": 0.0}}, "num_steps_sampled": 1540800, "num_steps_trained": 1540800}, "done": false, "episodes_total": 1530, "training_iteration": 206, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-57", "timestamp": 1617635397, "time_this_iter_s": 1.436328411102295, "time_total_s": 395.97150015830994, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450edd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 231.1850357055664, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 71.35, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 113.81567233710284, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 50.213628068166344, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.84210507796094, "MDD_min": 17.403819527117474, "MDD_max": 34.75824805532121}, "hist_stats": {"episode_reward": [37.0085481502177, 113.81567233710284, 57.04584941658549, 41.883702284249544, 61.954511408970355, 38.98789027918836, 77.78666411358255, 62.426800477357816, 61.97256090678121, 68.11087918039746, 36.2171359384523, 51.43216723511186, 54.73290863157759, 27.422010924719608, 32.51989829071951, 41.82018034838522, 37.1377215131038, 34.98351343630477, 49.032331706465385, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990703057975338, "mean_inference_ms": 1.2732513199225792, "mean_action_processing_ms": 0.05415093506744089, "mean_env_wait_ms": 1.1902666595997318, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1548400, "timers": {"sample_time_ms": 1155.512, "sample_throughput": 6577.172, "learn_time_ms": 305.309, "learn_throughput": 24892.819, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.3790577010150533e-47, "cur_lr": 0.001, "total_loss": 0.2596702203154564, "policy_loss": 0.0061256702756509185, "vf_loss": 0.25354456901550293, "vf_explained_var": 0.981645941734314, "kl": 0.00279376155231148, "entropy": -6.576155662536621, "entropy_coeff": 0.0}}, "num_steps_sampled": 1548400, "num_steps_trained": 1548400}, "done": false, "episodes_total": 1530, "training_iteration": 207, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-09-58", "timestamp": 1617635398, "time_this_iter_s": 1.4180681705474854, "time_total_s": 397.3895683288574, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 232.6031038761139, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 66.89999999999999, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 51.06340861006172, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.812812815056112, "MDD_min": 17.403819527117474, "MDD_max": 34.75824805532121}, "hist_stats": {"episode_reward": [33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901551429424555, "mean_inference_ms": 1.2731894120892517, "mean_action_processing_ms": 0.05415127535496784, "mean_env_wait_ms": 1.1902717375933412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1556000, "timers": {"sample_time_ms": 1157.632, "sample_throughput": 6565.126, "learn_time_ms": 304.814, "learn_throughput": 24933.263, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1895288505075267e-47, "cur_lr": 0.001, "total_loss": 0.6757189929485321, "policy_loss": 0.010547916521318257, "vf_loss": 0.6651710569858551, "vf_explained_var": 0.9698666930198669, "kl": 0.0068876114673912525, "entropy": -6.5174596309661865, "entropy_coeff": 0.0}}, "num_steps_sampled": 1556000, "num_steps_trained": 1556000}, "done": false, "episodes_total": 1549, "training_iteration": 208, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-00", "timestamp": 1617635400, "time_this_iter_s": 1.5473480224609375, "time_total_s": 398.93691635131836, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 234.15045189857483, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 80.9, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 51.06340861006174, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.81281281505612, "MDD_min": 17.403819527117474, "MDD_max": 34.75824805532121}, "hist_stats": {"episode_reward": [34.95254538480004, 42.76767981867979, 32.141586564202484, 34.50959778894122, 47.83609691407076, 62.175790385593324, 51.22360769524952, 53.54438136569279, 27.120968871490515, 80.3799826130208, 51.64524078567672, 49.554008692898584, 40.73080647566468, 50.991968620580934, 62.74620509452169, 45.60502861723428, 35.09799520515643, 49.23309330783224, 60.5116461565136, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901551429424547, "mean_inference_ms": 1.2731894120892517, "mean_action_processing_ms": 0.05415127535496783, "mean_env_wait_ms": 1.1902717375933412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1563600, "timers": {"sample_time_ms": 1155.262, "sample_throughput": 6578.595, "learn_time_ms": 303.002, "learn_throughput": 25082.331, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1895288505075267e-47, "cur_lr": 0.001, "total_loss": 0.050100693479180336, "policy_loss": 0.004203019896522164, "vf_loss": 0.045897677540779114, "vf_explained_var": 0.9792002439498901, "kl": 0.0009735826752148569, "entropy": -6.617751598358154, "entropy_coeff": 0.0}}, "num_steps_sampled": 1563600, "num_steps_trained": 1563600}, "done": false, "episodes_total": 1549, "training_iteration": 209, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-01", "timestamp": 1617635401, "time_this_iter_s": 1.41871976852417, "time_total_s": 400.35563611984253, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 235.569171667099, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 53.14065415746595, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.24979080059917, "MDD_min": 17.403819527117474, "MDD_max": 32.39703570830232}, "hist_stats": {"episode_reward": [67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19906011967073078, "mean_inference_ms": 1.2731341251404689, "mean_action_processing_ms": 0.05415101732756209, "mean_env_wait_ms": 1.1902778726941456, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1571200, "timers": {"sample_time_ms": 1156.534, "sample_throughput": 6571.36, "learn_time_ms": 302.456, "learn_throughput": 25127.586, "update_time_ms": 2.842}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0947644252537633e-47, "cur_lr": 0.001, "total_loss": 0.7784706056118011, "policy_loss": 0.011515984660945833, "vf_loss": 0.7669546008110046, "vf_explained_var": 0.9771913886070251, "kl": 0.003988270182162523, "entropy": -6.490219593048096, "entropy_coeff": 0.0}}, "num_steps_sampled": 1571200, "num_steps_trained": 1571200}, "done": false, "episodes_total": 1568, "training_iteration": 210, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-03", "timestamp": 1617635403, "time_this_iter_s": 1.5414891242980957, "time_total_s": 401.8971252441406, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 237.1106607913971, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 78.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 53.14065415746595, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.249790800599158, "MDD_min": 17.403819527117474, "MDD_max": 32.39703570830232}, "hist_stats": {"episode_reward": [57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990601196707308, "mean_inference_ms": 1.273134125140469, "mean_action_processing_ms": 0.054151017327562105, "mean_env_wait_ms": 1.1902778726941454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1578800, "timers": {"sample_time_ms": 1158.136, "sample_throughput": 6562.272, "learn_time_ms": 302.055, "learn_throughput": 25160.963, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.473822126268817e-48, "cur_lr": 0.001, "total_loss": 0.017643228638917208, "policy_loss": -0.003535988391377032, "vf_loss": 0.021179220639169216, "vf_explained_var": 0.9888608455657959, "kl": 0.0014167143090162426, "entropy": -6.758910894393921, "entropy_coeff": 0.0}}, "num_steps_sampled": 1578800, "num_steps_trained": 1578800}, "done": false, "episodes_total": 1568, "training_iteration": 211, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-04", "timestamp": 1617635404, "time_this_iter_s": 1.4316885471343994, "time_total_s": 403.328813791275, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 238.5423493385315, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 71.65, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 23.711195572480154, "episode_reward_mean": 53.14065415746595, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.249790800599158, "MDD_min": 17.403819527117474, "MDD_max": 32.39703570830232}, "hist_stats": {"episode_reward": [57.57921331129299, 45.68741342847883, 47.154801367903, 41.71244107094931, 28.668451012055723, 41.73213445364594, 51.59125212041871, 37.90980927662987, 45.9872319103396, 54.721948594161816, 33.825902744240686, 36.29034138185633, 64.34721506030408, 67.86607827105281, 59.522019829784256, 65.32710014030481, 34.019959675557715, 46.30114226780388, 60.44994819761441, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990601196707308, "mean_inference_ms": 1.273134125140469, "mean_action_processing_ms": 0.054151017327562105, "mean_env_wait_ms": 1.1902778726941454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1586400, "timers": {"sample_time_ms": 1157.473, "sample_throughput": 6566.026, "learn_time_ms": 302.664, "learn_throughput": 25110.364, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7369110631344083e-48, "cur_lr": 0.001, "total_loss": 0.25703129917383194, "policy_loss": 0.01678149215877056, "vf_loss": 0.24024981260299683, "vf_explained_var": 0.9824551343917847, "kl": 0.0015066330088302493, "entropy": -6.617355585098267, "entropy_coeff": 0.0}}, "num_steps_sampled": 1586400, "num_steps_trained": 1586400}, "done": false, "episodes_total": 1568, "training_iteration": 212, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-05", "timestamp": 1617635405, "time_this_iter_s": 1.4204912185668945, "time_total_s": 404.7493050098419, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 239.9628405570984, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 71.4, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 54.81704642727095, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.125552998105903, "MDD_min": 17.403819527117474, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901557855070326, "mean_inference_ms": 1.2730646824586442, "mean_action_processing_ms": 0.05415012689888181, "mean_env_wait_ms": 1.1902760994356563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1594000, "timers": {"sample_time_ms": 1156.459, "sample_throughput": 6571.785, "learn_time_ms": 302.402, "learn_throughput": 25132.121, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3684555315672042e-48, "cur_lr": 0.001, "total_loss": 0.7697685658931732, "policy_loss": -0.006028767675161362, "vf_loss": 0.7757973372936249, "vf_explained_var": 0.968199610710144, "kl": 0.0037161444779485464, "entropy": -6.530397415161133, "entropy_coeff": 0.0}}, "num_steps_sampled": 1594000, "num_steps_trained": 1594000}, "done": false, "episodes_total": 1587, "training_iteration": 213, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-07", "timestamp": 1617635407, "time_this_iter_s": 1.53000807762146, "time_total_s": 406.2793130874634, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 241.49284863471985, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 71.55, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 54.81704642727095, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.125552998105903, "MDD_min": 17.403819527117474, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [30.225098222331614, 93.55043212900598, 44.162067726622226, 68.1607862365437, 30.841685405449745, 50.83399910938072, 65.01721843460471, 59.3205000391867, 32.02857709746451, 47.72278529979211, 60.7381930961609, 59.225800119241086, 35.232258049803946, 57.25605240119451, 48.05868956844767, 58.792459394590814, 51.045685910549025, 52.250780857667316, 53.9681609732193, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19901557855070326, "mean_inference_ms": 1.2730646824586442, "mean_action_processing_ms": 0.05415012689888181, "mean_env_wait_ms": 1.1902760994356563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1601600, "timers": {"sample_time_ms": 1156.97, "sample_throughput": 6568.88, "learn_time_ms": 302.301, "learn_throughput": 25140.472, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.842277657836021e-49, "cur_lr": 0.001, "total_loss": 0.02118221204727888, "policy_loss": -0.028385998215526342, "vf_loss": 0.049568213522434235, "vf_explained_var": 0.9782588481903076, "kl": 0.001723035704344511, "entropy": -6.640326738357544, "entropy_coeff": 0.0}}, "num_steps_sampled": 1601600, "num_steps_trained": 1601600}, "done": false, "episodes_total": 1587, "training_iteration": 214, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-08", "timestamp": 1617635408, "time_this_iter_s": 1.4123797416687012, "time_total_s": 407.6916928291321, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 242.90522837638855, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 55.51736398073364, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.112013908216856, "MDD_min": 17.403819527117474, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19907161402742665, "mean_inference_ms": 1.272991403903776, "mean_action_processing_ms": 0.054148860195475344, "mean_env_wait_ms": 1.1902686126578297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1609200, "timers": {"sample_time_ms": 1157.718, "sample_throughput": 6564.636, "learn_time_ms": 301.804, "learn_throughput": 25181.911, "update_time_ms": 2.832}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4211388289180104e-49, "cur_lr": 0.001, "total_loss": 0.8052291572093964, "policy_loss": -0.0028532613068819046, "vf_loss": 0.8080824315547943, "vf_explained_var": 0.9765097498893738, "kl": 0.004266343428753316, "entropy": -6.469573736190796, "entropy_coeff": 0.0}}, "num_steps_sampled": 1609200, "num_steps_trained": 1609200}, "done": false, "episodes_total": 1606, "training_iteration": 215, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-10", "timestamp": 1617635410, "time_this_iter_s": 1.5343680381774902, "time_total_s": 409.22606086730957, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 244.43959641456604, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 67.89999999999999, "ram_util_percent": 61.833333333333336}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 55.517363980733634, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.112013908216863, "MDD_min": 17.403819527117474, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990716140274267, "mean_inference_ms": 1.272991403903776, "mean_action_processing_ms": 0.05414886019547535, "mean_env_wait_ms": 1.1902686126578295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1616800, "timers": {"sample_time_ms": 1155.69, "sample_throughput": 6576.159, "learn_time_ms": 301.747, "learn_throughput": 25186.678, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7105694144590052e-49, "cur_lr": 0.001, "total_loss": 0.015135998837649822, "policy_loss": -0.006381350103765726, "vf_loss": 0.021517347544431686, "vf_explained_var": 0.9889427423477173, "kl": 0.0026444396935403347, "entropy": -6.823951721191406, "entropy_coeff": 0.0}}, "num_steps_sampled": 1616800, "num_steps_trained": 1616800}, "done": false, "episodes_total": 1606, "training_iteration": 216, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-11", "timestamp": 1617635411, "time_this_iter_s": 1.4151384830474854, "time_total_s": 410.64119935035706, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 245.85473489761353, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 73.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 129.1707547900131, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 55.517363980733634, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.112013908216863, "MDD_min": 17.403819527117474, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [38.16233262654602, 44.322708096052146, 102.35520153467125, 38.02080644072802, 44.753768086032906, 43.79945360845304, 58.3513225433714, 97.0659261501703, 32.66751159579697, 72.8422716908748, 42.552720829741496, 23.711195572480154, 46.44324156154791, 66.85225020807589, 64.6989191889329, 32.109989595649225, 46.98922482542133, 55.207569048244615, 45.92022849230773, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990716140274267, "mean_inference_ms": 1.272991403903776, "mean_action_processing_ms": 0.05414886019547535, "mean_env_wait_ms": 1.1902686126578295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1624400, "timers": {"sample_time_ms": 1157.059, "sample_throughput": 6568.375, "learn_time_ms": 302.04, "learn_throughput": 25162.24, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.552847072295026e-50, "cur_lr": 0.001, "total_loss": 0.28041377663612366, "policy_loss": 0.009223941480740905, "vf_loss": 0.2711898237466812, "vf_explained_var": 0.9801766872406006, "kl": 0.0016966693219728768, "entropy": -6.629391431808472, "entropy_coeff": 0.0}}, "num_steps_sampled": 1624400, "num_steps_trained": 1624400}, "done": false, "episodes_total": 1606, "training_iteration": 217, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-13", "timestamp": 1617635413, "time_this_iter_s": 1.4343960285186768, "time_total_s": 412.07559537887573, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345164d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 247.2891309261322, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 74.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.85699190603811, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.222800074773126, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19903591690636432, "mean_inference_ms": 1.272935205679034, "mean_action_processing_ms": 0.054148228988661326, "mean_env_wait_ms": 1.1902654489625513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1632000, "timers": {"sample_time_ms": 1154.824, "sample_throughput": 6581.088, "learn_time_ms": 303.229, "learn_throughput": 25063.58, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.276423536147513e-50, "cur_lr": 0.001, "total_loss": 0.6540788114070892, "policy_loss": -0.004620535997673869, "vf_loss": 0.6586993932723999, "vf_explained_var": 0.9726277589797974, "kl": 0.0030885296873748302, "entropy": -6.558002948760986, "entropy_coeff": 0.0}}, "num_steps_sampled": 1632000, "num_steps_trained": 1632000}, "done": false, "episodes_total": 1625, "training_iteration": 218, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-14", "timestamp": 1617635414, "time_this_iter_s": 1.5380220413208008, "time_total_s": 413.61361742019653, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 248.827152967453, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 80.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.85699190603813, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.222800074773122, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [34.819411034784146, 49.721404384453635, 51.7369142501005, 37.334955657195266, 32.738668672258534, 33.836958596605825, 64.76240378986941, 58.8595924804846, 50.56683854676455, 25.018109921138283, 54.10594685675386, 75.68737490774309, 51.31902395511675, 57.82697390475133, 63.63059308735431, 29.20142616529945, 129.1707547900131, 65.81846800991745, 75.5545395033506, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19903591690636432, "mean_inference_ms": 1.2729352056790337, "mean_action_processing_ms": 0.05414822898866132, "mean_env_wait_ms": 1.1902654489625515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1639600, "timers": {"sample_time_ms": 1154.78, "sample_throughput": 6581.342, "learn_time_ms": 303.747, "learn_throughput": 25020.809, "update_time_ms": 2.942}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1382117680737565e-50, "cur_lr": 0.001, "total_loss": 0.017555165104568005, "policy_loss": -0.027695469092577696, "vf_loss": 0.04525063745677471, "vf_explained_var": 0.980731725692749, "kl": 0.001686811272520572, "entropy": -6.637407064437866, "entropy_coeff": 0.0}}, "num_steps_sampled": 1639600, "num_steps_trained": 1639600}, "done": false, "episodes_total": 1625, "training_iteration": 219, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-16", "timestamp": 1617635416, "time_this_iter_s": 1.4236586093902588, "time_total_s": 415.0372760295868, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 250.25081157684326, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.99749710430793, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.203117654220673, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909655779549953, "mean_inference_ms": 1.2728513413476266, "mean_action_processing_ms": 0.0541468848730468, "mean_env_wait_ms": 1.1902400025061974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1647200, "timers": {"sample_time_ms": 1153.777, "sample_throughput": 6587.059, "learn_time_ms": 303.466, "learn_throughput": 25043.985, "update_time_ms": 2.981}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0691058840368783e-50, "cur_lr": 0.001, "total_loss": 0.8309560418128967, "policy_loss": 0.005405545583926141, "vf_loss": 0.8255504667758942, "vf_explained_var": 0.9771081209182739, "kl": 0.0050613246858119965, "entropy": -6.518702268600464, "entropy_coeff": 0.0}}, "num_steps_sampled": 1647200, "num_steps_trained": 1647200}, "done": false, "episodes_total": 1644, "training_iteration": 220, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-17", "timestamp": 1617635417, "time_this_iter_s": 1.528517246246338, "time_total_s": 416.56579327583313, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 251.7793288230896, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 72.80000000000001, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.99749710430793, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.203117654220673, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909655779549953, "mean_inference_ms": 1.2728513413476268, "mean_action_processing_ms": 0.0541468848730468, "mean_env_wait_ms": 1.1902400025061974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1654800, "timers": {"sample_time_ms": 1153.66, "sample_throughput": 6587.728, "learn_time_ms": 303.501, "learn_throughput": 25041.124, "update_time_ms": 2.983}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0691058840368783e-50, "cur_lr": 0.001, "total_loss": 0.010667521390132606, "policy_loss": -0.010576651198789477, "vf_loss": 0.0212441710755229, "vf_explained_var": 0.9893134832382202, "kl": 0.0016970361466519535, "entropy": -6.834664344787598, "entropy_coeff": 0.0}}, "num_steps_sampled": 1654800, "num_steps_trained": 1654800}, "done": false, "episodes_total": 1644, "training_iteration": 221, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-19", "timestamp": 1617635419, "time_this_iter_s": 1.4310994148254395, "time_total_s": 417.99689269065857, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 253.21042823791504, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.99749710430793, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.203117654220673, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [31.8179709771113, 35.704497565529735, 41.04970812099321, 36.64916997469469, 90.6886496153199, 67.81027974319872, 48.6445187011686, 120.97220595454475, 34.24556852981344, 53.1500920411221, 60.045271331049406, 54.20200636812433, 43.875136528689616, 79.2290254056084, 47.679629136619674, 50.350668715593926, 93.17378230418909, 46.11719895111444, 55.39348405789451, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909655779549953, "mean_inference_ms": 1.2728513413476268, "mean_action_processing_ms": 0.0541468848730468, "mean_env_wait_ms": 1.1902400025061974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1662400, "timers": {"sample_time_ms": 1153.995, "sample_throughput": 6585.815, "learn_time_ms": 304.324, "learn_throughput": 24973.41, "update_time_ms": 2.983}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.345529420184391e-51, "cur_lr": 0.001, "total_loss": 0.19474656879901886, "policy_loss": 0.0022654090425930917, "vf_loss": 0.1924811601638794, "vf_explained_var": 0.9851447343826294, "kl": 0.0015484741888940334, "entropy": -6.614681243896484, "entropy_coeff": 0.0}}, "num_steps_sampled": 1662400, "num_steps_trained": 1662400}, "done": false, "episodes_total": 1644, "training_iteration": 222, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-20", "timestamp": 1617635420, "time_this_iter_s": 1.432100534439087, "time_total_s": 419.42899322509766, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 254.64252877235413, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 71.55, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.030558681323775, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.95416388783147, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19906546966116104, "mean_inference_ms": 1.2727831645234877, "mean_action_processing_ms": 0.05414592017225008, "mean_env_wait_ms": 1.190217794381663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1670000, "timers": {"sample_time_ms": 1154.168, "sample_throughput": 6584.829, "learn_time_ms": 305.141, "learn_throughput": 24906.525, "update_time_ms": 2.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6727647100921956e-51, "cur_lr": 0.001, "total_loss": 0.5034542083740234, "policy_loss": -0.006692484603263438, "vf_loss": 0.5101466774940491, "vf_explained_var": 0.9774746298789978, "kl": 0.0033073086524382234, "entropy": -6.628075122833252, "entropy_coeff": 0.0}}, "num_steps_sampled": 1670000, "num_steps_trained": 1670000}, "done": false, "episodes_total": 1663, "training_iteration": 223, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-22", "timestamp": 1617635422, "time_this_iter_s": 1.539917230606079, "time_total_s": 420.96891045570374, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345164d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 256.1824460029602, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 65.83333333333333, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 56.030558681323754, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.95416388783147, "MDD_min": 15.956139413616672, "MDD_max": 35.61841951070029}, "hist_stats": {"episode_reward": [58.98234078680448, 32.74433175624913, 52.079969469746835, 59.646772184902495, 62.150503131807625, 119.39704216182595, 75.0914188899653, 61.99173934252374, 46.64394333685632, 41.61900970539162, 44.86347476740158, 32.11784667201015, 76.73823464248956, 103.43123682546306, 77.48820720165482, 37.4367745042515, 48.37615141954256, 36.750544843312845, 65.90144439129989, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19906546966116107, "mean_inference_ms": 1.2727831645234877, "mean_action_processing_ms": 0.05414592017225007, "mean_env_wait_ms": 1.190217794381663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1677600, "timers": {"sample_time_ms": 1155.804, "sample_throughput": 6575.512, "learn_time_ms": 305.103, "learn_throughput": 24909.627, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3363823550460978e-51, "cur_lr": 0.001, "total_loss": 0.03742648847401142, "policy_loss": -0.00041959952795878053, "vf_loss": 0.03784608654677868, "vf_explained_var": 0.9844650030136108, "kl": 0.0019386876374483109, "entropy": -6.643732070922852, "entropy_coeff": 0.0}}, "num_steps_sampled": 1677600, "num_steps_trained": 1677600}, "done": false, "episodes_total": 1663, "training_iteration": 224, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-23", "timestamp": 1617635423, "time_this_iter_s": 1.427513599395752, "time_total_s": 422.3964240550995, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 257.60995960235596, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 73.8, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 54.48754199921096, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.002870530191558, "MDD_min": 15.956139413616672, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19911649453302696, "mean_inference_ms": 1.272717631334393, "mean_action_processing_ms": 0.054144630761872294, "mean_env_wait_ms": 1.1901862307087827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1685200, "timers": {"sample_time_ms": 1156.883, "sample_throughput": 6569.374, "learn_time_ms": 306.156, "learn_throughput": 24823.925, "update_time_ms": 3.019}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.681911775230489e-52, "cur_lr": 0.001, "total_loss": 0.7031639814376831, "policy_loss": 0.031875624088570476, "vf_loss": 0.6712882816791534, "vf_explained_var": 0.9789764881134033, "kl": 0.005605278303846717, "entropy": -6.556875705718994, "entropy_coeff": 0.0}}, "num_steps_sampled": 1685200, "num_steps_trained": 1685200}, "done": false, "episodes_total": 1682, "training_iteration": 225, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-25", "timestamp": 1617635425, "time_this_iter_s": 1.5560009479522705, "time_total_s": 423.95242500305176, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 259.1659605503082, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 80.65, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 54.48754199921098, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.002870530191558, "MDD_min": 15.956139413616672, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991164945330269, "mean_inference_ms": 1.2727176313343929, "mean_action_processing_ms": 0.0541446307618723, "mean_env_wait_ms": 1.1901862307087827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1692800, "timers": {"sample_time_ms": 1157.616, "sample_throughput": 6565.216, "learn_time_ms": 306.51, "learn_throughput": 24795.307, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.681911775230489e-52, "cur_lr": 0.001, "total_loss": 0.022997718304395676, "policy_loss": 0.004103932147700107, "vf_loss": 0.018893783912062645, "vf_explained_var": 0.9901958107948303, "kl": 0.0018945063347928226, "entropy": -6.870846748352051, "entropy_coeff": 0.0}}, "num_steps_sampled": 1692800, "num_steps_trained": 1692800}, "done": false, "episodes_total": 1682, "training_iteration": 226, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-26", "timestamp": 1617635426, "time_this_iter_s": 1.425995111465454, "time_total_s": 425.3784201145172, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 260.5919556617737, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 74.30000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 20.480074114579757, "episode_reward_mean": 54.48754199921098, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.002870530191558, "MDD_min": 15.956139413616672, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [47.66186326752941, 59.4428281976311, 20.480074114579757, 50.802253290656665, 42.09954352050962, 65.91337913577028, 71.8494606471855, 45.35399127581564, 69.0934162556745, 57.71500183825708, 76.2832198997823, 62.32719303111621, 62.85253850675643, 33.77488442404428, 74.6721220832379, 55.922152048936326, 41.10248964897778, 54.88977371969366, 57.26577580178035, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991164945330269, "mean_inference_ms": 1.2727176313343929, "mean_action_processing_ms": 0.0541446307618723, "mean_env_wait_ms": 1.1901862307087827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1700400, "timers": {"sample_time_ms": 1157.929, "sample_throughput": 6563.444, "learn_time_ms": 305.637, "learn_throughput": 24866.138, "update_time_ms": 3.012}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3409558876152446e-52, "cur_lr": 0.001, "total_loss": 0.1619417816400528, "policy_loss": -0.003203200009011198, "vf_loss": 0.16514498740434647, "vf_explained_var": 0.9877370595932007, "kl": 0.0013938333140686154, "entropy": -6.625252723693848, "entropy_coeff": 0.0}}, "num_steps_sampled": 1700400, "num_steps_trained": 1700400}, "done": false, "episodes_total": 1682, "training_iteration": 227, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-28", "timestamp": 1617635428, "time_this_iter_s": 1.4283297061920166, "time_total_s": 426.80674982070923, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 262.0202853679657, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 74.55000000000001, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 53.04125117045968, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.05381152120923, "MDD_min": 15.956139413616672, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19908683747655284, "mean_inference_ms": 1.2726663540287086, "mean_action_processing_ms": 0.054146014976700456, "mean_env_wait_ms": 1.1901660031700494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1708000, "timers": {"sample_time_ms": 1157.943, "sample_throughput": 6563.364, "learn_time_ms": 305.219, "learn_throughput": 24900.192, "update_time_ms": 2.98}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6704779438076223e-52, "cur_lr": 0.001, "total_loss": 0.42028726637363434, "policy_loss": -0.011750001925975084, "vf_loss": 0.43203726410865784, "vf_explained_var": 0.9805847406387329, "kl": 0.0015080870944075286, "entropy": -6.667083501815796, "entropy_coeff": 0.0}}, "num_steps_sampled": 1708000, "num_steps_trained": 1708000}, "done": false, "episodes_total": 1701, "training_iteration": 228, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-29", "timestamp": 1617635429, "time_this_iter_s": 1.532958984375, "time_total_s": 428.33970880508423, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345153b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 263.5532443523407, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 133.86007785434714, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 53.04125117045967, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.05381152120923, "MDD_min": 15.956139413616672, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [24.81975409360106, 55.48291026946949, 59.82089519374248, 32.6544423044291, 66.6695852392552, 41.62318206363333, 133.86007785434714, 78.4203070227215, 48.598360805770454, 52.36454820951806, 50.10532012382604, 48.530916912094625, 58.07276176039409, 66.19514651804101, 58.18087078678125, 45.438739310368895, 68.04304786874941, 66.82671094714593, 68.34084586819803, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990868374765528, "mean_inference_ms": 1.2726663540287086, "mean_action_processing_ms": 0.05414601497670045, "mean_env_wait_ms": 1.1901660031700492, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1715600, "timers": {"sample_time_ms": 1157.557, "sample_throughput": 6565.553, "learn_time_ms": 305.564, "learn_throughput": 24872.032, "update_time_ms": 2.91}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.352389719038111e-53, "cur_lr": 0.001, "total_loss": 0.04027494788169861, "policy_loss": -0.002727557613980025, "vf_loss": 0.04300250671803951, "vf_explained_var": 0.9822841882705688, "kl": 0.0011173422681167722, "entropy": -6.689235687255859, "entropy_coeff": 0.0}}, "num_steps_sampled": 1715600, "num_steps_trained": 1715600}, "done": false, "episodes_total": 1701, "training_iteration": 229, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-31", "timestamp": 1617635431, "time_this_iter_s": 1.4223029613494873, "time_total_s": 429.7620117664337, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 264.9755473136902, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 71.94999999999999, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.81291301085936, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 51.996684906709035, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.023438628245017, "MDD_min": 16.533941940598375, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991450170613294, "mean_inference_ms": 1.272617428696898, "mean_action_processing_ms": 0.05414709191121302, "mean_env_wait_ms": 1.1901464133018054, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1723200, "timers": {"sample_time_ms": 1157.177, "sample_throughput": 6567.709, "learn_time_ms": 305.381, "learn_throughput": 24886.912, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.176194859519056e-53, "cur_lr": 0.001, "total_loss": 0.7524730563163757, "policy_loss": 0.007865652441978455, "vf_loss": 0.7446074485778809, "vf_explained_var": 0.9769982099533081, "kl": 0.002820041263476014, "entropy": -6.630596876144409, "entropy_coeff": 0.0}}, "num_steps_sampled": 1723200, "num_steps_trained": 1723200}, "done": false, "episodes_total": 1720, "training_iteration": 230, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-32", "timestamp": 1617635432, "time_this_iter_s": 1.5228877067565918, "time_total_s": 431.2848994731903, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 266.4984350204468, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 72.55, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.81291301085936, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 51.996684906709035, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.02343862824502, "MDD_min": 16.533941940598375, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991450170613294, "mean_inference_ms": 1.2726174286968985, "mean_action_processing_ms": 0.05414709191121304, "mean_env_wait_ms": 1.1901464133018052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1730800, "timers": {"sample_time_ms": 1155.364, "sample_throughput": 6578.016, "learn_time_ms": 305.094, "learn_throughput": 24910.371, "update_time_ms": 2.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.088097429759528e-53, "cur_lr": 0.001, "total_loss": 0.016371351666748524, "policy_loss": -0.004125615116208792, "vf_loss": 0.020496970042586327, "vf_explained_var": 0.9891489148139954, "kl": 0.0010672287899069488, "entropy": -6.8780012130737305, "entropy_coeff": 0.0}}, "num_steps_sampled": 1730800, "num_steps_trained": 1730800}, "done": false, "episodes_total": 1720, "training_iteration": 231, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-34", "timestamp": 1617635434, "time_this_iter_s": 1.409928321838379, "time_total_s": 432.6948277950287, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 267.90836334228516, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.81291301085936, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 51.996684906709035, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.02343862824502, "MDD_min": 16.533941940598375, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [43.80570465251831, 27.15554834455956, 56.411747000018885, 63.70712264543553, 55.10847553142413, 51.04976576473427, 35.6323830844711, 31.741793130839852, 65.45397926358447, 79.51695044205184, 74.71002304891721, 34.388066224978566, 54.67855327040594, 39.55560267408716, 43.761017854498654, 53.703001306807415, 27.93720824474543, 70.17919716030734, 63.46948425538771, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991450170613294, "mean_inference_ms": 1.2726174286968985, "mean_action_processing_ms": 0.05414709191121304, "mean_env_wait_ms": 1.1901464133018052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1738400, "timers": {"sample_time_ms": 1154.64, "sample_throughput": 6582.135, "learn_time_ms": 303.171, "learn_throughput": 25068.399, "update_time_ms": 2.833}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.044048714879764e-53, "cur_lr": 0.001, "total_loss": 0.17840629816055298, "policy_loss": -0.00029490518500097096, "vf_loss": 0.17870121449232101, "vf_explained_var": 0.987148642539978, "kl": 0.0018151310505345464, "entropy": -6.701418161392212, "entropy_coeff": 0.0}}, "num_steps_sampled": 1738400, "num_steps_trained": 1738400}, "done": false, "episodes_total": 1720, "training_iteration": 232, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-35", "timestamp": 1617635435, "time_this_iter_s": 1.4063117504119873, "time_total_s": 434.1011395454407, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 269.31467509269714, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.81291301085936, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 51.91579678105122, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.914652425700247, "MDD_min": 13.598343599265416, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19910365807381258, "mean_inference_ms": 1.2725762698484262, "mean_action_processing_ms": 0.05414912450121214, "mean_env_wait_ms": 1.1901306479415976, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1746000, "timers": {"sample_time_ms": 1155.437, "sample_throughput": 6577.6, "learn_time_ms": 303.351, "learn_throughput": 25053.496, "update_time_ms": 2.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.22024357439882e-54, "cur_lr": 0.001, "total_loss": 0.4972813129425049, "policy_loss": -0.00797365396283567, "vf_loss": 0.5052549540996552, "vf_explained_var": 0.9759371876716614, "kl": 0.0026712147518992424, "entropy": -6.717071771621704, "entropy_coeff": 0.0}}, "num_steps_sampled": 1746000, "num_steps_trained": 1746000}, "done": false, "episodes_total": 1739, "training_iteration": 233, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-37", "timestamp": 1617635437, "time_this_iter_s": 1.548577070236206, "time_total_s": 435.6497166156769, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 270.86325216293335, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 70.60000000000001, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.81291301085936, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 51.91579678105122, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.91465242570025, "MDD_min": 13.598343599265416, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [51.64921375076217, 78.03671801482325, 44.12912707458673, 113.32090174618999, 42.847892028756036, 39.27435147934818, 38.39266463990366, 84.14386461274795, 79.5341260889768, 37.18519186432037, 42.034038649337596, 31.12657027583571, 50.31780414462229, 36.84540971180706, 47.53898521416628, 70.17837776712054, 45.78786518849635, 46.04227561950849, 46.49366236574656, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19910365807381253, "mean_inference_ms": 1.2725762698484262, "mean_action_processing_ms": 0.05414912450121214, "mean_env_wait_ms": 1.1901306479415978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1753600, "timers": {"sample_time_ms": 1154.102, "sample_throughput": 6585.207, "learn_time_ms": 303.302, "learn_throughput": 25057.504, "update_time_ms": 2.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.61012178719941e-54, "cur_lr": 0.001, "total_loss": 0.039779236540198326, "policy_loss": -0.0076710800640285015, "vf_loss": 0.04745032079517841, "vf_explained_var": 0.9807661771774292, "kl": 0.0011479560635052621, "entropy": -6.713205814361572, "entropy_coeff": 0.0}}, "num_steps_sampled": 1753600, "num_steps_trained": 1753600}, "done": false, "episodes_total": 1739, "training_iteration": 234, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-38", "timestamp": 1617635438, "time_this_iter_s": 1.4143242835998535, "time_total_s": 437.06404089927673, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 272.2775764465332, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 52.20220122389362, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.851085539781643, "MDD_min": 13.598343599265416, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19915613137147187, "mean_inference_ms": 1.272538809925649, "mean_action_processing_ms": 0.054152470564863026, "mean_env_wait_ms": 1.1901216601996072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1761200, "timers": {"sample_time_ms": 1152.374, "sample_throughput": 6595.079, "learn_time_ms": 302.671, "learn_throughput": 25109.784, "update_time_ms": 2.722}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.305060893599705e-54, "cur_lr": 0.001, "total_loss": 0.8744410872459412, "policy_loss": -2.387608401477337e-05, "vf_loss": 0.8744650185108185, "vf_explained_var": 0.9739751815795898, "kl": 0.002617291989736259, "entropy": -6.589898347854614, "entropy_coeff": 0.0}}, "num_steps_sampled": 1761200, "num_steps_trained": 1761200}, "done": false, "episodes_total": 1758, "training_iteration": 235, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-40", "timestamp": 1617635440, "time_this_iter_s": 1.5315804481506348, "time_total_s": 438.59562134742737, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 273.80915689468384, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 52.20220122389362, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.85108553978164, "MDD_min": 13.598343599265416, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19915613137147192, "mean_inference_ms": 1.272538809925649, "mean_action_processing_ms": 0.054152470564863026, "mean_env_wait_ms": 1.190121660199607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1768800, "timers": {"sample_time_ms": 1150.847, "sample_throughput": 6603.834, "learn_time_ms": 302.249, "learn_throughput": 25144.849, "update_time_ms": 2.684}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.525304467998525e-55, "cur_lr": 0.001, "total_loss": 0.0308924512937665, "policy_loss": 0.009755030972883105, "vf_loss": 0.02113741636276245, "vf_explained_var": 0.98860102891922, "kl": 0.0015422432334162295, "entropy": -6.8865132331848145, "entropy_coeff": 0.0}}, "num_steps_sampled": 1768800, "num_steps_trained": 1768800}, "done": false, "episodes_total": 1758, "training_iteration": 236, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-41", "timestamp": 1617635441, "time_this_iter_s": 1.4065446853637695, "time_total_s": 440.00216603279114, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 275.2157015800476, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 52.20220122389362, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.85108553978164, "MDD_min": 13.598343599265416, "MDD_max": 36.827677672997666}, "hist_stats": {"episode_reward": [82.58314592014293, 35.710034855942716, 36.762080061953576, 68.01579760293765, 76.13877566104838, 54.15526110696554, 75.96738410526078, 71.81548790940597, 59.25721145497388, 34.053138014048045, 47.155053918598966, 40.882939674181124, 63.49903822940513, 64.8420184586529, 27.857121200049825, 84.60202691853938, 32.41484485754156, 74.06717973575756, 39.972262611335175, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19915613137147192, "mean_inference_ms": 1.272538809925649, "mean_action_processing_ms": 0.054152470564863026, "mean_env_wait_ms": 1.190121660199607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1776400, "timers": {"sample_time_ms": 1149.44, "sample_throughput": 6611.915, "learn_time_ms": 302.336, "learn_throughput": 25137.555, "update_time_ms": 2.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2626522339992623e-55, "cur_lr": 0.001, "total_loss": 0.18019964545965195, "policy_loss": -0.0007462648136424832, "vf_loss": 0.18094591051340103, "vf_explained_var": 0.9875423908233643, "kl": 0.002981937606818974, "entropy": -6.771483659744263, "entropy_coeff": 0.0}}, "num_steps_sampled": 1776400, "num_steps_trained": 1776400}, "done": false, "episodes_total": 1758, "training_iteration": 237, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-42", "timestamp": 1617635442, "time_this_iter_s": 1.4154462814331055, "time_total_s": 441.41761231422424, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345159e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 276.6311478614807, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 61.7}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 50.6858231438934, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.971141086337035, "MDD_min": 13.598343599265416, "MDD_max": 37.690118074702845}, "hist_stats": {"episode_reward": [24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19912325286473428, "mean_inference_ms": 1.2724729319059507, "mean_action_processing_ms": 0.054155093863179626, "mean_env_wait_ms": 1.1900855540414674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1784000, "timers": {"sample_time_ms": 1150.186, "sample_throughput": 6607.629, "learn_time_ms": 301.799, "learn_throughput": 25182.314, "update_time_ms": 2.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6313261169996311e-55, "cur_lr": 0.001, "total_loss": 0.5219454169273376, "policy_loss": -0.015949741238728166, "vf_loss": 0.5378951728343964, "vf_explained_var": 0.975822389125824, "kl": 0.001601872849278152, "entropy": -6.68836236000061, "entropy_coeff": 0.0}}, "num_steps_sampled": 1784000, "num_steps_trained": 1784000}, "done": false, "episodes_total": 1777, "training_iteration": 238, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-44", "timestamp": 1617635444, "time_this_iter_s": 1.5358009338378906, "time_total_s": 442.95341324806213, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5546032560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 278.1669487953186, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 73.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.00318087894364, "episode_reward_mean": 50.6858231438934, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.971141086337038, "MDD_min": 13.598343599265416, "MDD_max": 37.690118074702845}, "hist_stats": {"episode_reward": [21.00318087894364, 33.433490177427814, 46.02728135591826, 52.59784818163797, 55.54654903357717, 40.523536188758385, 40.867290836875426, 54.57544502342451, 29.4216553601746, 46.26088755635698, 59.151836601214306, 73.5796954280249, 49.88834282409509, 47.200272171026796, 64.86393608073517, 45.484441970160404, 27.6685887239439, 45.6152412295449, 47.827237044919066, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19912325286473428, "mean_inference_ms": 1.2724729319059507, "mean_action_processing_ms": 0.054155093863179626, "mean_env_wait_ms": 1.1900855540414674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1791600, "timers": {"sample_time_ms": 1151.628, "sample_throughput": 6599.352, "learn_time_ms": 302.49, "learn_throughput": 25124.806, "update_time_ms": 2.715}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.156630584998156e-56, "cur_lr": 0.001, "total_loss": 0.020696982741355896, "policy_loss": -0.011294775176793337, "vf_loss": 0.031991759315133095, "vf_explained_var": 0.9856096506118774, "kl": 0.0018242495134472847, "entropy": -6.7310779094696045, "entropy_coeff": 0.0}}, "num_steps_sampled": 1791600, "num_steps_trained": 1791600}, "done": false, "episodes_total": 1777, "training_iteration": 239, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-45", "timestamp": 1617635445, "time_this_iter_s": 1.4440290927886963, "time_total_s": 444.39744234085083, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 279.6109778881073, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 49.74388009434198, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.276474057067468, "MDD_min": 13.598343599265416, "MDD_max": 37.690118074702845}, "hist_stats": {"episode_reward": [37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19917274149115965, "mean_inference_ms": 1.272415281325892, "mean_action_processing_ms": 0.05415773206357313, "mean_env_wait_ms": 1.1900712628101686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1799200, "timers": {"sample_time_ms": 1153.702, "sample_throughput": 6587.487, "learn_time_ms": 302.408, "learn_throughput": 25131.632, "update_time_ms": 2.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.078315292499078e-56, "cur_lr": 0.001, "total_loss": 0.44596101343631744, "policy_loss": 0.002768085803836584, "vf_loss": 0.44319291412830353, "vf_explained_var": 0.9866839647293091, "kl": 0.0027931437361985445, "entropy": -6.629523277282715, "entropy_coeff": 0.0}}, "num_steps_sampled": 1799200, "num_steps_trained": 1799200}, "done": false, "episodes_total": 1796, "training_iteration": 240, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-47", "timestamp": 1617635447, "time_this_iter_s": 1.5429484844207764, "time_total_s": 445.9403908252716, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 281.1539263725281, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 70.5, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 49.743880094341996, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.276474057067468, "MDD_min": 13.598343599265416, "MDD_max": 37.690118074702845}, "hist_stats": {"episode_reward": [29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19917274149115965, "mean_inference_ms": 1.2724152813258922, "mean_action_processing_ms": 0.054157732063573126, "mean_env_wait_ms": 1.1900712628101688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1806800, "timers": {"sample_time_ms": 1153.594, "sample_throughput": 6588.105, "learn_time_ms": 303.487, "learn_throughput": 25042.25, "update_time_ms": 2.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.039157646249539e-56, "cur_lr": 0.001, "total_loss": 0.03916366118937731, "policy_loss": 0.016976690851151943, "vf_loss": 0.02218697313219309, "vf_explained_var": 0.9890589714050293, "kl": 0.001335892651695758, "entropy": -6.891571044921875, "entropy_coeff": 0.0}}, "num_steps_sampled": 1806800, "num_steps_trained": 1806800}, "done": false, "episodes_total": 1796, "training_iteration": 241, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-48", "timestamp": 1617635448, "time_this_iter_s": 1.4192383289337158, "time_total_s": 447.3596291542053, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 282.5731647014618, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 66.3, "ram_util_percent": 61.73333333333333}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 49.743880094341996, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.276474057067468, "MDD_min": 13.598343599265416, "MDD_max": 37.690118074702845}, "hist_stats": {"episode_reward": [29.56383823850541, 58.881067056487694, 38.19595301590658, 43.3884537994985, 61.915158683151624, 82.2804978019675, 48.148197064057115, 118.81291301085936, 40.0557474695376, 62.65195802811093, 58.95017247176274, 41.99724643124634, 53.251351769337184, 40.671187430287084, 48.3073256811869, 53.28317377339033, 44.602667776815345, 51.21700273450833, 36.548361856979355, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19917274149115965, "mean_inference_ms": 1.2724152813258922, "mean_action_processing_ms": 0.054157732063573126, "mean_env_wait_ms": 1.1900712628101688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1814400, "timers": {"sample_time_ms": 1154.482, "sample_throughput": 6583.039, "learn_time_ms": 303.745, "learn_throughput": 25021.023, "update_time_ms": 2.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0195788231247695e-56, "cur_lr": 0.001, "total_loss": 0.2367365062236786, "policy_loss": -0.0029672894161194563, "vf_loss": 0.23970379680395126, "vf_explained_var": 0.9833469390869141, "kl": 0.0021060837316326797, "entropy": -6.769591331481934, "entropy_coeff": 0.0}}, "num_steps_sampled": 1814400, "num_steps_trained": 1814400}, "done": false, "episodes_total": 1796, "training_iteration": 242, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-50", "timestamp": 1617635450, "time_this_iter_s": 1.417510747909546, "time_total_s": 448.77713990211487, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 283.99067544937134, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 50.46400729716856, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.585326067066916, "MDD_min": 13.598343599265416, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19912832682739956, "mean_inference_ms": 1.2723602017477718, "mean_action_processing_ms": 0.054158753664277096, "mean_env_wait_ms": 1.1900598155746502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1822000, "timers": {"sample_time_ms": 1154.256, "sample_throughput": 6584.325, "learn_time_ms": 303.125, "learn_throughput": 25072.177, "update_time_ms": 2.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.0978941156238473e-57, "cur_lr": 0.001, "total_loss": 0.6407298147678375, "policy_loss": 0.017776471562683582, "vf_loss": 0.622953325510025, "vf_explained_var": 0.9714877009391785, "kl": 0.0017014714539982378, "entropy": -6.648658990859985, "entropy_coeff": 0.0}}, "num_steps_sampled": 1822000, "num_steps_trained": 1822000}, "done": false, "episodes_total": 1815, "training_iteration": 243, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-51", "timestamp": 1617635451, "time_this_iter_s": 1.5407793521881104, "time_total_s": 450.317919254303, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 285.53145480155945, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 80.4, "ram_util_percent": 61.75}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 50.46400729716856, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.585326067066912, "MDD_min": 13.598343599265416, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [54.46877051951192, 59.60925141907378, 51.69412787958587, 30.1324423684784, 42.90940129032782, 34.21859644573064, 30.66127924492951, 36.2993689473685, 27.952011401004285, 30.633367934442425, 43.20699347121746, 62.6994888553738, 100.034528493668, 51.33449243173125, 59.36286756360119, 48.50033838767667, 71.1827703080294, 45.7030521164205, 77.20209392796588, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19912832682739962, "mean_inference_ms": 1.2723602017477718, "mean_action_processing_ms": 0.05415875366427708, "mean_env_wait_ms": 1.1900598155746502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1829600, "timers": {"sample_time_ms": 1155.554, "sample_throughput": 6576.93, "learn_time_ms": 302.711, "learn_throughput": 25106.448, "update_time_ms": 2.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5489470578119236e-57, "cur_lr": 0.001, "total_loss": 0.015203853137791157, "policy_loss": -0.01792822009883821, "vf_loss": 0.033132072538137436, "vf_explained_var": 0.985334038734436, "kl": 0.0015864888555370271, "entropy": -6.697461128234863, "entropy_coeff": 0.0}}, "num_steps_sampled": 1829600, "num_steps_trained": 1829600}, "done": false, "episodes_total": 1815, "training_iteration": 244, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-53", "timestamp": 1617635453, "time_this_iter_s": 1.4225199222564697, "time_total_s": 451.74043917655945, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 286.9539747238159, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 75.3, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 49.75475746539986, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.209757232219285, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916378906736365, "mean_inference_ms": 1.272333822921389, "mean_action_processing_ms": 0.054160261253370166, "mean_env_wait_ms": 1.1900756273000834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1837200, "timers": {"sample_time_ms": 1156.704, "sample_throughput": 6570.395, "learn_time_ms": 302.863, "learn_throughput": 25093.86, "update_time_ms": 2.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2744735289059618e-57, "cur_lr": 0.001, "total_loss": 0.5732281506061554, "policy_loss": -0.01219386188313365, "vf_loss": 0.5854220390319824, "vf_explained_var": 0.9814856052398682, "kl": 0.0022324485471472144, "entropy": -6.5914247035980225, "entropy_coeff": 0.0}}, "num_steps_sampled": 1837200, "num_steps_trained": 1837200}, "done": false, "episodes_total": 1834, "training_iteration": 245, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-54", "timestamp": 1617635454, "time_this_iter_s": 1.5441029071807861, "time_total_s": 453.28454208374023, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 288.4980776309967, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 77.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 49.75475746539986, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.20975723221928, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916378906736362, "mean_inference_ms": 1.272333822921389, "mean_action_processing_ms": 0.05416026125337017, "mean_env_wait_ms": 1.1900756273000834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1844800, "timers": {"sample_time_ms": 1157.267, "sample_throughput": 6567.195, "learn_time_ms": 303.884, "learn_throughput": 25009.505, "update_time_ms": 2.773}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.372367644529809e-58, "cur_lr": 0.001, "total_loss": 0.017711692489683628, "policy_loss": -0.0004821440379600972, "vf_loss": 0.018193836323916912, "vf_explained_var": 0.9902659058570862, "kl": 0.0019832320977002382, "entropy": -6.859660863876343, "entropy_coeff": 0.0}}, "num_steps_sampled": 1844800, "num_steps_trained": 1844800}, "done": false, "episodes_total": 1834, "training_iteration": 246, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-56", "timestamp": 1617635456, "time_this_iter_s": 1.4231491088867188, "time_total_s": 454.70769119262695, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345ace60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 289.9212267398834, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 71.6, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 147.9486379216469, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 49.75475746539986, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.20975723221928, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [47.66488779825595, 62.74075583088594, 42.655632001115805, 51.11504452051123, 40.70924165406342, 53.168948445627315, 35.792889498330275, 58.80857470912964, 41.92242200532137, 59.14165249879966, 54.544494691996434, 68.31450499924684, 42.90921070011198, 36.44645883304604, 55.86590447137138, 43.95601378641833, 27.728926201990717, 37.23704422184856, 147.9486379216469, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916378906736362, "mean_inference_ms": 1.272333822921389, "mean_action_processing_ms": 0.05416026125337017, "mean_env_wait_ms": 1.1900756273000834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1852400, "timers": {"sample_time_ms": 1158.185, "sample_throughput": 6561.992, "learn_time_ms": 303.519, "learn_throughput": 25039.647, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1861838222649046e-58, "cur_lr": 0.001, "total_loss": 0.1351652294397354, "policy_loss": -0.01816862472333014, "vf_loss": 0.1533338651061058, "vf_explained_var": 0.9893010854721069, "kl": 0.0017780209891498089, "entropy": -6.716619968414307, "entropy_coeff": 0.0}}, "num_steps_sampled": 1852400, "num_steps_trained": 1852400}, "done": false, "episodes_total": 1834, "training_iteration": 247, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-57", "timestamp": 1617635457, "time_this_iter_s": 1.4208264350891113, "time_total_s": 456.12851762771606, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 291.34205317497253, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 47.91908029213423, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.115310843466517, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19913009037293591, "mean_inference_ms": 1.2722992566542002, "mean_action_processing_ms": 0.05416128393893045, "mean_env_wait_ms": 1.1900861769160427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1860000, "timers": {"sample_time_ms": 1157.258, "sample_throughput": 6567.248, "learn_time_ms": 302.468, "learn_throughput": 25126.659, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5930919111324523e-58, "cur_lr": 0.001, "total_loss": 0.3764825612306595, "policy_loss": 0.004310147254727781, "vf_loss": 0.37217240035533905, "vf_explained_var": 0.9811121225357056, "kl": 0.0016041185590438545, "entropy": -6.666648864746094, "entropy_coeff": 0.0}}, "num_steps_sampled": 1860000, "num_steps_trained": 1860000}, "done": false, "episodes_total": 1853, "training_iteration": 248, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-10-59", "timestamp": 1617635459, "time_this_iter_s": 1.5159809589385986, "time_total_s": 457.64449858665466, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345ace60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 292.85803413391113, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 47.919080292134225, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.115310843466517, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [57.06508140325801, 100.33654979831135, 32.95772304114475, 51.34372573741149, 48.030721556284284, 24.516336723837483, 47.93831312305608, 50.10876207386133, 64.07338332523216, 29.96159516001301, 33.2728197839222, 30.75216565704936, 24.0632531871966, 49.71585452031973, 33.270835800523884, 34.49189725970528, 92.61118323535649, 68.3256829266957, 39.8295045772019, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991300903729359, "mean_inference_ms": 1.2722992566542002, "mean_action_processing_ms": 0.05416128393893044, "mean_env_wait_ms": 1.190086176916043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1867600, "timers": {"sample_time_ms": 1156.197, "sample_throughput": 6573.275, "learn_time_ms": 302.324, "learn_throughput": 25138.568, "update_time_ms": 2.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.965459555662261e-59, "cur_lr": 0.001, "total_loss": 0.044280096888542175, "policy_loss": 0.0009988261735998094, "vf_loss": 0.04328127019107342, "vf_explained_var": 0.9800222516059875, "kl": 0.0013666802551597357, "entropy": -6.698544979095459, "entropy_coeff": 0.0}}, "num_steps_sampled": 1867600, "num_steps_trained": 1867600}, "done": false, "episodes_total": 1853, "training_iteration": 249, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-00", "timestamp": 1617635460, "time_this_iter_s": 1.4322550296783447, "time_total_s": 459.076753616333, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 294.2902891635895, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 47.43551545125616, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.343692603896496, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916972749265252, "mean_inference_ms": 1.2722736850995704, "mean_action_processing_ms": 0.05416204345542579, "mean_env_wait_ms": 1.190105508017482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1875200, "timers": {"sample_time_ms": 1155.552, "sample_throughput": 6576.945, "learn_time_ms": 303.166, "learn_throughput": 25068.748, "update_time_ms": 2.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.982729777831131e-59, "cur_lr": 0.001, "total_loss": 0.6551096141338348, "policy_loss": 0.011017969809472561, "vf_loss": 0.6440916657447815, "vf_explained_var": 0.9799758791923523, "kl": 0.002438749885186553, "entropy": -6.534312009811401, "entropy_coeff": 0.0}}, "num_steps_sampled": 1875200, "num_steps_trained": 1875200}, "done": false, "episodes_total": 1872, "training_iteration": 250, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-02", "timestamp": 1617635462, "time_this_iter_s": 1.5446381568908691, "time_total_s": 460.6213917732239, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 295.83492732048035, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 68.66666666666667, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 47.43551545125616, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.343692603896503, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916972749265252, "mean_inference_ms": 1.2722736850995704, "mean_action_processing_ms": 0.05416204345542579, "mean_env_wait_ms": 1.190105508017482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1882800, "timers": {"sample_time_ms": 1156.374, "sample_throughput": 6572.266, "learn_time_ms": 302.667, "learn_throughput": 25110.138, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9913648889155653e-59, "cur_lr": 0.001, "total_loss": 0.018939734436571598, "policy_loss": 0.0008310636039823294, "vf_loss": 0.0181086715310812, "vf_explained_var": 0.9903602004051208, "kl": 0.0015403240686282516, "entropy": -6.8664939403533936, "entropy_coeff": 0.0}}, "num_steps_sampled": 1882800, "num_steps_trained": 1882800}, "done": false, "episodes_total": 1872, "training_iteration": 251, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-03", "timestamp": 1617635463, "time_this_iter_s": 1.4226336479187012, "time_total_s": 462.0440254211426, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 297.25756096839905, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 21.936392936621317, "episode_reward_mean": 47.43551545125616, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.343692603896503, "MDD_min": 15.258647504437178, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [88.93286692896184, 59.54706761985108, 32.71919609105858, 73.05619475509558, 40.92608154778137, 37.278160988166775, 33.54090525817226, 22.923126872043966, 31.041029590476548, 36.98409443917057, 33.811247390857, 21.936392936621317, 53.86476565549484, 40.730207622851786, 64.8095695863053, 34.548095770528356, 34.63893666891324, 67.58972158263182, 83.61020580920939, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916972749265252, "mean_inference_ms": 1.2722736850995704, "mean_action_processing_ms": 0.05416204345542579, "mean_env_wait_ms": 1.190105508017482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1890400, "timers": {"sample_time_ms": 1156.624, "sample_throughput": 6570.847, "learn_time_ms": 302.983, "learn_throughput": 25083.955, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.956824444577827e-60, "cur_lr": 0.001, "total_loss": 0.1625051125884056, "policy_loss": -0.016446551540866494, "vf_loss": 0.1789516881108284, "vf_explained_var": 0.9878393411636353, "kl": 0.0017773512518033385, "entropy": -6.711452960968018, "entropy_coeff": 0.0}}, "num_steps_sampled": 1890400, "num_steps_trained": 1890400}, "done": false, "episodes_total": 1872, "training_iteration": 252, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-05", "timestamp": 1617635465, "time_this_iter_s": 1.4233334064483643, "time_total_s": 463.46735882759094, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 298.6808943748474, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 24.00508357980581, "episode_reward_mean": 48.32767990821998, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.92055802320147, "MDD_min": 16.20870328955276, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19913232013258708, "mean_inference_ms": 1.2722362568351135, "mean_action_processing_ms": 0.05416178455364669, "mean_env_wait_ms": 1.190100746882796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1898000, "timers": {"sample_time_ms": 1155.986, "sample_throughput": 6574.474, "learn_time_ms": 302.092, "learn_throughput": 25157.916, "update_time_ms": 2.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.9784122222889134e-60, "cur_lr": 0.001, "total_loss": 0.5404027700424194, "policy_loss": 0.004570229328237474, "vf_loss": 0.5358325839042664, "vf_explained_var": 0.9744988679885864, "kl": 0.002189776860177517, "entropy": -6.662618398666382, "entropy_coeff": 0.0}}, "num_steps_sampled": 1898000, "num_steps_trained": 1898000}, "done": false, "episodes_total": 1891, "training_iteration": 253, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-06", "timestamp": 1617635466, "time_this_iter_s": 1.5255703926086426, "time_total_s": 464.9929292201996, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 300.20646476745605, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 24.00508357980581, "episode_reward_mean": 48.32767990821998, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.920558023201465, "MDD_min": 16.20870328955276, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [35.077007840444494, 36.548611893154614, 55.4394830698023, 29.90099939652405, 33.06988934025015, 60.308423066127, 82.67415769074884, 43.939266752275984, 66.09039705903008, 42.43956079330564, 70.13924314216581, 88.28565700288583, 41.125592207909804, 58.67383655360474, 35.515671163673844, 46.24437034972681, 42.111908154483494, 53.68427881466656, 58.68668978169963, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19913232013258703, "mean_inference_ms": 1.2722362568351135, "mean_action_processing_ms": 0.05416178455364671, "mean_env_wait_ms": 1.190100746882796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1905600, "timers": {"sample_time_ms": 1154.328, "sample_throughput": 6583.916, "learn_time_ms": 303.069, "learn_throughput": 25076.822, "update_time_ms": 2.866}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4892061111444567e-60, "cur_lr": 0.001, "total_loss": 0.042623622342944145, "policy_loss": 0.004987220163457096, "vf_loss": 0.0376364029943943, "vf_explained_var": 0.9815506935119629, "kl": 0.0016108189010992646, "entropy": -6.728830099105835, "entropy_coeff": 0.0}}, "num_steps_sampled": 1905600, "num_steps_trained": 1905600}, "done": false, "episodes_total": 1891, "training_iteration": 254, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-08", "timestamp": 1617635468, "time_this_iter_s": 1.4163379669189453, "time_total_s": 466.40926718711853, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 301.622802734375, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 47.862293430670185, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.31192847880337, "MDD_min": 17.122746062060536, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991724008103061, "mean_inference_ms": 1.2722125073300499, "mean_action_processing_ms": 0.0541615991574361, "mean_env_wait_ms": 1.190110712595204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1913200, "timers": {"sample_time_ms": 1152.631, "sample_throughput": 6593.613, "learn_time_ms": 302.747, "learn_throughput": 25103.484, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2446030555722283e-60, "cur_lr": 0.001, "total_loss": 0.612214982509613, "policy_loss": -0.008718355908058584, "vf_loss": 0.6209334135055542, "vf_explained_var": 0.9805232286453247, "kl": 0.0030892820795997977, "entropy": -6.565263986587524, "entropy_coeff": 0.0}}, "num_steps_sampled": 1913200, "num_steps_trained": 1913200}, "done": false, "episodes_total": 1910, "training_iteration": 255, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-09", "timestamp": 1617635469, "time_this_iter_s": 1.5245354175567627, "time_total_s": 467.9338026046753, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 303.14733815193176, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 47.862293430670185, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.31192847880337, "MDD_min": 17.122746062060536, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19917240081030615, "mean_inference_ms": 1.2722125073300496, "mean_action_processing_ms": 0.05416159915743608, "mean_env_wait_ms": 1.190110712595204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1920800, "timers": {"sample_time_ms": 1153.681, "sample_throughput": 6587.61, "learn_time_ms": 301.994, "learn_throughput": 25166.024, "update_time_ms": 2.89}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.223015277861142e-61, "cur_lr": 0.001, "total_loss": 0.03444241499528289, "policy_loss": 0.015600085258483887, "vf_loss": 0.018842335790395737, "vf_explained_var": 0.9890109300613403, "kl": 0.0014271268155425787, "entropy": -6.889559507369995, "entropy_coeff": 0.0}}, "num_steps_sampled": 1920800, "num_steps_trained": 1920800}, "done": false, "episodes_total": 1910, "training_iteration": 256, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-11", "timestamp": 1617635471, "time_this_iter_s": 1.4262473583221436, "time_total_s": 469.36004996299744, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 304.5735855102539, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 71.7, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.36615821948327, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 47.862293430670185, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.31192847880337, "MDD_min": 17.122746062060536, "MDD_max": 38.407536994425655}, "hist_stats": {"episode_reward": [65.58902608259325, 47.54230429748831, 112.36615821948327, 34.923080556137975, 34.39537268824489, 34.78571346824024, 34.82259611755525, 41.913213443663665, 37.50351330564891, 44.36664163151523, 28.194078255432498, 51.03897207460957, 41.68955383604019, 41.599319768282385, 59.49275234465155, 50.713933845892925, 41.226876309680776, 90.44380757671706, 36.77774649950231, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19917240081030615, "mean_inference_ms": 1.2722125073300496, "mean_action_processing_ms": 0.05416159915743608, "mean_env_wait_ms": 1.190110712595204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1928400, "timers": {"sample_time_ms": 1154.733, "sample_throughput": 6581.605, "learn_time_ms": 302.606, "learn_throughput": 25115.183, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.111507638930571e-61, "cur_lr": 0.001, "total_loss": 0.2171754613518715, "policy_loss": 0.013582073850557208, "vf_loss": 0.2035934031009674, "vf_explained_var": 0.9865067005157471, "kl": 0.002714726491831243, "entropy": -6.780917406082153, "entropy_coeff": 0.0}}, "num_steps_sampled": 1928400, "num_steps_trained": 1928400}, "done": false, "episodes_total": 1910, "training_iteration": 257, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-12", "timestamp": 1617635472, "time_this_iter_s": 1.4373373985290527, "time_total_s": 470.7973873615265, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 306.01092290878296, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.67108114784772, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 48.856328643268, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.03434716023053, "MDD_min": 17.122746062060536, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991423935779907, "mean_inference_ms": 1.2721820386492244, "mean_action_processing_ms": 0.05416107271351005, "mean_env_wait_ms": 1.1901103371010409, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1936000, "timers": {"sample_time_ms": 1156.615, "sample_throughput": 6570.898, "learn_time_ms": 303.369, "learn_throughput": 25052.019, "update_time_ms": 2.855}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5557538194652854e-61, "cur_lr": 0.001, "total_loss": 0.5914296507835388, "policy_loss": -0.00034258319647051394, "vf_loss": 0.591772198677063, "vf_explained_var": 0.9723048806190491, "kl": 0.002639590878970921, "entropy": -6.67921781539917, "entropy_coeff": 0.0}}, "num_steps_sampled": 1936000, "num_steps_trained": 1936000}, "done": false, "episodes_total": 1929, "training_iteration": 258, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-14", "timestamp": 1617635474, "time_this_iter_s": 1.5419697761535645, "time_total_s": 472.33935713768005, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 307.5528926849365, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 65.66666666666667, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.67108114784772, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 48.85632864326803, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.034347160230528, "MDD_min": 17.122746062060536, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [37.323628626688276, 42.085863282468544, 77.01860015993448, 59.54199588864745, 36.341453394096604, 44.39256956487295, 40.29530655416355, 31.669583278067144, 55.12033455918014, 52.593582941246936, 33.876691325345384, 48.76918810417647, 27.873314771159457, 44.436887354381646, 59.355633962624296, 37.06209713407268, 49.20657674838848, 66.31230112917908, 61.308071383345926, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991423935779907, "mean_inference_ms": 1.2721820386492246, "mean_action_processing_ms": 0.05416107271351005, "mean_env_wait_ms": 1.1901103371010409, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1943600, "timers": {"sample_time_ms": 1163.174, "sample_throughput": 6533.845, "learn_time_ms": 302.502, "learn_throughput": 25123.816, "update_time_ms": 2.872}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.778769097326427e-62, "cur_lr": 0.001, "total_loss": 0.04815211333334446, "policy_loss": 0.0032271037925966084, "vf_loss": 0.0449250154197216, "vf_explained_var": 0.9803106784820557, "kl": 0.001585410034749657, "entropy": -6.756588697433472, "entropy_coeff": 0.0}}, "num_steps_sampled": 1943600, "num_steps_trained": 1943600}, "done": false, "episodes_total": 1929, "training_iteration": 259, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-15", "timestamp": 1617635475, "time_this_iter_s": 1.4893219470977783, "time_total_s": 473.82867908477783, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 309.0422146320343, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 74.19999999999999, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.67108114784772, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 50.18262815908183, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.73371979655859, "MDD_min": 16.123631082647265, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19918078879102896, "mean_inference_ms": 1.272142650759818, "mean_action_processing_ms": 0.05415967489714418, "mean_env_wait_ms": 1.1901008376002025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1951200, "timers": {"sample_time_ms": 1161.857, "sample_throughput": 6541.255, "learn_time_ms": 301.609, "learn_throughput": 25198.206, "update_time_ms": 2.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.8893845486632136e-62, "cur_lr": 0.001, "total_loss": 0.7136862277984619, "policy_loss": -0.017618813551962376, "vf_loss": 0.7313050031661987, "vf_explained_var": 0.9796682596206665, "kl": 0.0038486099801957607, "entropy": -6.631353139877319, "entropy_coeff": 0.0}}, "num_steps_sampled": 1951200, "num_steps_trained": 1951200}, "done": false, "episodes_total": 1948, "training_iteration": 260, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-17", "timestamp": 1617635477, "time_this_iter_s": 1.5226247310638428, "time_total_s": 475.3513038158417, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 310.56483936309814, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.67108114784772, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 50.18262815908182, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.733719796558592, "MDD_min": 16.123631082647265, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19918078879102896, "mean_inference_ms": 1.272142650759818, "mean_action_processing_ms": 0.05415967489714418, "mean_env_wait_ms": 1.1901008376002027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1958800, "timers": {"sample_time_ms": 1161.224, "sample_throughput": 6544.82, "learn_time_ms": 300.777, "learn_throughput": 25267.911, "update_time_ms": 2.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9446922743316068e-62, "cur_lr": 0.001, "total_loss": 0.013842363376170397, "policy_loss": -0.00619087927043438, "vf_loss": 0.02003323845565319, "vf_explained_var": 0.9903510808944702, "kl": 0.001507422246504575, "entropy": -6.867439031600952, "entropy_coeff": 0.0}}, "num_steps_sampled": 1958800, "num_steps_trained": 1958800}, "done": false, "episodes_total": 1948, "training_iteration": 261, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-18", "timestamp": 1617635478, "time_this_iter_s": 1.4080946445465088, "time_total_s": 476.7593984603882, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 311.97293400764465, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.67108114784772, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 50.18262815908182, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.733719796558592, "MDD_min": 16.123631082647265, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [29.28074191222385, 36.006529638833186, 24.00508357980581, 47.36424783475592, 36.174785687332495, 69.52961377794855, 36.491574564834224, 32.433817763184706, 24.32040117559267, 34.596162857860655, 48.81678356512847, 43.496423446259115, 31.869436770782265, 36.23672935245628, 107.67108114784772, 64.77161561360798, 44.035758281580286, 25.004856455693886, 33.29581774443287, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19918078879102896, "mean_inference_ms": 1.272142650759818, "mean_action_processing_ms": 0.05415967489714418, "mean_env_wait_ms": 1.1901008376002027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1966400, "timers": {"sample_time_ms": 1160.574, "sample_throughput": 6548.485, "learn_time_ms": 300.758, "learn_throughput": 25269.489, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.723461371658034e-63, "cur_lr": 0.001, "total_loss": 0.20174884051084518, "policy_loss": -0.005700863082893193, "vf_loss": 0.20744971185922623, "vf_explained_var": 0.9864622354507446, "kl": 0.0020556848030537367, "entropy": -6.771803617477417, "entropy_coeff": 0.0}}, "num_steps_sampled": 1966400, "num_steps_trained": 1966400}, "done": false, "episodes_total": 1948, "training_iteration": 262, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-20", "timestamp": 1617635480, "time_this_iter_s": 1.4166460037231445, "time_total_s": 478.1760444641113, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 313.3895800113678, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 74.6, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 53.38892534042919, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.0185875356595, "MDD_min": 15.939341277876224, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19915610365710432, "mean_inference_ms": 1.272123287551498, "mean_action_processing_ms": 0.05415871770483829, "mean_env_wait_ms": 1.1901263126615038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1974000, "timers": {"sample_time_ms": 1159.752, "sample_throughput": 6553.123, "learn_time_ms": 302.615, "learn_throughput": 25114.447, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.861730685829017e-63, "cur_lr": 0.001, "total_loss": 0.5710995495319366, "policy_loss": -0.008888497832231224, "vf_loss": 0.5799880623817444, "vf_explained_var": 0.9746450781822205, "kl": 0.0017981998389586806, "entropy": -6.712679386138916, "entropy_coeff": 0.0}}, "num_steps_sampled": 1974000, "num_steps_trained": 1974000}, "done": false, "episodes_total": 1967, "training_iteration": 263, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-21", "timestamp": 1617635481, "time_this_iter_s": 1.5357041358947754, "time_total_s": 479.7117486000061, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 314.9252841472626, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 75.05, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 53.38892534042919, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.018587535659503, "MDD_min": 15.939341277876224, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [29.030388346397103, 47.87390869045643, 34.074059244205756, 67.6881369413367, 53.0723390629683, 89.03687981027979, 43.80725026889841, 55.85388897137679, 62.99626181398703, 54.230262621283636, 32.96289317678739, 60.40651711879592, 72.56532999151078, 46.29670446464236, 55.81525048479424, 58.631854536260015, 40.90775921226821, 31.491067539212843, 40.979479565686454, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19915610365710434, "mean_inference_ms": 1.272123287551498, "mean_action_processing_ms": 0.05415871770483829, "mean_env_wait_ms": 1.190126312661504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1981600, "timers": {"sample_time_ms": 1161.879, "sample_throughput": 6541.131, "learn_time_ms": 302.792, "learn_throughput": 25099.742, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4308653429145085e-63, "cur_lr": 0.001, "total_loss": 0.04837159439921379, "policy_loss": 0.010519810719415545, "vf_loss": 0.03785177879035473, "vf_explained_var": 0.983770489692688, "kl": 0.001876584894489497, "entropy": -6.747491836547852, "entropy_coeff": 0.0}}, "num_steps_sampled": 1981600, "num_steps_trained": 1981600}, "done": false, "episodes_total": 1967, "training_iteration": 264, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-23", "timestamp": 1617635483, "time_this_iter_s": 1.4394211769104004, "time_total_s": 481.1511697769165, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 316.364705324173, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 66.3, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 53.62302919201418, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.907160841775468, "MDD_min": 15.338382763686518, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199196160336014, "mean_inference_ms": 1.272103640245699, "mean_action_processing_ms": 0.05415795429225119, "mean_env_wait_ms": 1.1901585285114027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1989200, "timers": {"sample_time_ms": 1162.072, "sample_throughput": 6540.04, "learn_time_ms": 303.748, "learn_throughput": 25020.765, "update_time_ms": 2.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2154326714572542e-63, "cur_lr": 0.001, "total_loss": 0.7180857062339783, "policy_loss": -0.010123354266397655, "vf_loss": 0.7282091081142426, "vf_explained_var": 0.9798115491867065, "kl": 0.002071091497782618, "entropy": -6.637570381164551, "entropy_coeff": 0.0}}, "num_steps_sampled": 1989200, "num_steps_trained": 1989200}, "done": false, "episodes_total": 1986, "training_iteration": 265, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-24", "timestamp": 1617635484, "time_this_iter_s": 1.5352659225463867, "time_total_s": 482.6864356994629, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 317.89997124671936, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 67.33333333333333, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 53.6230291920142, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.90716084177546, "MDD_min": 15.338382763686518, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199196160336014, "mean_inference_ms": 1.2721036402456989, "mean_action_processing_ms": 0.0541579542922512, "mean_env_wait_ms": 1.1901585285114025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 1996800, "timers": {"sample_time_ms": 1161.567, "sample_throughput": 6542.883, "learn_time_ms": 304.004, "learn_throughput": 24999.687, "update_time_ms": 2.776}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.077163357286271e-64, "cur_lr": 0.001, "total_loss": 0.016739928163588047, "policy_loss": -0.003123164176940918, "vf_loss": 0.019863084889948368, "vf_explained_var": 0.9892526268959045, "kl": 0.001129421405494213, "entropy": -6.854031801223755, "entropy_coeff": 0.0}}, "num_steps_sampled": 1996800, "num_steps_trained": 1996800}, "done": false, "episodes_total": 1986, "training_iteration": 266, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-26", "timestamp": 1617635486, "time_this_iter_s": 1.4233627319335938, "time_total_s": 484.1097984313965, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 319.32333397865295, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 53.6230291920142, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.90716084177546, "MDD_min": 15.338382763686518, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [33.80557047851967, 35.988376786019295, 68.36719995753575, 68.7759901561382, 28.78577585657679, 70.58130808417086, 30.76591557988556, 67.4502878013636, 24.6847674625748, 37.05514698953549, 31.819474275766147, 34.96147599244371, 60.30173056582365, 44.22580220823659, 36.83355539844729, 76.91166422446983, 52.75528543963807, 50.90961432418388, 58.759348451207494, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199196160336014, "mean_inference_ms": 1.2721036402456989, "mean_action_processing_ms": 0.0541579542922512, "mean_env_wait_ms": 1.1901585285114025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2004400, "timers": {"sample_time_ms": 1160.646, "sample_throughput": 6548.078, "learn_time_ms": 304.053, "learn_throughput": 24995.613, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0385816786431356e-64, "cur_lr": 0.001, "total_loss": 0.16543278843164444, "policy_loss": -0.01936012739315629, "vf_loss": 0.1847929283976555, "vf_explained_var": 0.9882641434669495, "kl": 0.002917350153438747, "entropy": -6.816933631896973, "entropy_coeff": 0.0}}, "num_steps_sampled": 2004400, "num_steps_trained": 2004400}, "done": false, "episodes_total": 1986, "training_iteration": 267, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-27", "timestamp": 1617635487, "time_this_iter_s": 1.429551124572754, "time_total_s": 485.53934955596924, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 320.7528851032257, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 54.30235800963153, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.874795671358147, "MDD_min": 15.338382763686518, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916672271319416, "mean_inference_ms": 1.2720689399631298, "mean_action_processing_ms": 0.054156492637449906, "mean_env_wait_ms": 1.190160695292111, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2012000, "timers": {"sample_time_ms": 1157.481, "sample_throughput": 6565.984, "learn_time_ms": 304.075, "learn_throughput": 24993.812, "update_time_ms": 2.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5192908393215678e-64, "cur_lr": 0.001, "total_loss": 0.47568807005882263, "policy_loss": 0.0011127127800136805, "vf_loss": 0.47457538545131683, "vf_explained_var": 0.9790828227996826, "kl": 0.0016604930278845131, "entropy": -6.734899520874023, "entropy_coeff": 0.0}}, "num_steps_sampled": 2012000, "num_steps_trained": 2012000}, "done": false, "episodes_total": 2005, "training_iteration": 268, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-29", "timestamp": 1617635489, "time_this_iter_s": 1.5104665756225586, "time_total_s": 487.0498161315918, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345167a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 322.26335167884827, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 80.8, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 18.712241515479956, "episode_reward_mean": 54.30235800963152, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.87479567135815, "MDD_min": 15.338382763686518, "MDD_max": 35.77688468290082}, "hist_stats": {"episode_reward": [53.18617622884313, 18.712241515479956, 40.192214438581985, 83.53601582109548, 59.774371515753415, 54.543620076557595, 34.95006824675633, 90.29339791403783, 55.47808735870261, 75.53966141053867, 55.017928770248204, 60.24193750459918, 39.63472458741884, 36.06291137035783, 72.8841368547765, 68.33357118402652, 47.55965700410536, 68.24450411266238, 49.619157092417076, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19916672271319416, "mean_inference_ms": 1.2720689399631298, "mean_action_processing_ms": 0.054156492637449906, "mean_env_wait_ms": 1.190160695292111, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2019600, "timers": {"sample_time_ms": 1151.556, "sample_throughput": 6599.768, "learn_time_ms": 304.994, "learn_throughput": 24918.524, "update_time_ms": 2.786}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.596454196607839e-65, "cur_lr": 0.001, "total_loss": 0.031624916940927505, "policy_loss": -0.01106705004349351, "vf_loss": 0.04269196651875973, "vf_explained_var": 0.9823397994041443, "kl": 0.0016555748297832906, "entropy": -6.727951526641846, "entropy_coeff": 0.0}}, "num_steps_sampled": 2019600, "num_steps_trained": 2019600}, "done": false, "episodes_total": 2005, "training_iteration": 269, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-30", "timestamp": 1617635490, "time_this_iter_s": 1.4393727779388428, "time_total_s": 488.48918890953064, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 323.7027244567871, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 74.4, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 21.577126845339826, "episode_reward_mean": 53.448850312004744, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.20849178966359, "MDD_min": 15.338382763686518, "MDD_max": 33.65151036529798}, "hist_stats": {"episode_reward": [47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1992099912333631, "mean_inference_ms": 1.272060208113831, "mean_action_processing_ms": 0.05415705525749516, "mean_env_wait_ms": 1.1902006323766425, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2027200, "timers": {"sample_time_ms": 1154.353, "sample_throughput": 6583.773, "learn_time_ms": 305.539, "learn_throughput": 24874.072, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7982270983039195e-65, "cur_lr": 0.001, "total_loss": 0.6522006392478943, "policy_loss": -0.0023699893499724567, "vf_loss": 0.6545706391334534, "vf_explained_var": 0.9816341400146484, "kl": 0.0030419619288295507, "entropy": -6.688425064086914, "entropy_coeff": 0.0}}, "num_steps_sampled": 2027200, "num_steps_trained": 2027200}, "done": false, "episodes_total": 2024, "training_iteration": 270, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-32", "timestamp": 1617635492, "time_this_iter_s": 1.5565109252929688, "time_total_s": 490.0456998348236, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 325.2592353820801, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 75.85, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 21.577126845339826, "episode_reward_mean": 53.44885031200476, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.208491789663587, "MDD_min": 15.338382763686518, "MDD_max": 33.65151036529798}, "hist_stats": {"episode_reward": [36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19920999123336308, "mean_inference_ms": 1.2720602081138312, "mean_action_processing_ms": 0.05415705525749515, "mean_env_wait_ms": 1.1902006323766425, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2034800, "timers": {"sample_time_ms": 1154.918, "sample_throughput": 6580.555, "learn_time_ms": 305.993, "learn_throughput": 24837.149, "update_time_ms": 2.807}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8991135491519597e-65, "cur_lr": 0.001, "total_loss": 0.011606446176301688, "policy_loss": -0.008827188517898321, "vf_loss": 0.020433634519577026, "vf_explained_var": 0.9873135089874268, "kl": 0.0015239251661114395, "entropy": -6.832363605499268, "entropy_coeff": 0.0}}, "num_steps_sampled": 2034800, "num_steps_trained": 2034800}, "done": false, "episodes_total": 2024, "training_iteration": 271, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-33", "timestamp": 1617635493, "time_this_iter_s": 1.4180810451507568, "time_total_s": 491.46378087997437, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345ace60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 326.67731642723083, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 70.9, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 21.577126845339826, "episode_reward_mean": 53.44885031200476, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.208491789663587, "MDD_min": 15.338382763686518, "MDD_max": 33.65151036529798}, "hist_stats": {"episode_reward": [36.11728716636126, 28.699725400166802, 80.02061977488677, 45.00672313937755, 30.540462613164465, 35.91091832552684, 35.98129395697827, 65.92461241353512, 40.046109144610966, 35.88110143504049, 68.69539522325213, 61.68590710604079, 40.15343168707142, 58.3905267415618, 50.484020388140365, 70.02864350532995, 39.087495686496936, 89.65556447190467, 47.40160425757826, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19920999123336308, "mean_inference_ms": 1.2720602081138312, "mean_action_processing_ms": 0.05415705525749515, "mean_env_wait_ms": 1.1902006323766425, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2042400, "timers": {"sample_time_ms": 1154.339, "sample_throughput": 6583.857, "learn_time_ms": 306.255, "learn_throughput": 24815.913, "update_time_ms": 2.836}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.495567745759799e-66, "cur_lr": 0.001, "total_loss": 0.1814584881067276, "policy_loss": -0.009995193220674992, "vf_loss": 0.19145368784666061, "vf_explained_var": 0.9878768920898438, "kl": 0.0022108378470875323, "entropy": -6.827934503555298, "entropy_coeff": 0.0}}, "num_steps_sampled": 2042400, "num_steps_trained": 2042400}, "done": false, "episodes_total": 2024, "training_iteration": 272, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-34", "timestamp": 1617635494, "time_this_iter_s": 1.413651466369629, "time_total_s": 492.877432346344, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 328.09096789360046, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 72.45, "ram_util_percent": 61.9}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 21.577126845339826, "episode_reward_mean": 53.64760694279774, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.095418532592234, "MDD_min": 15.338382763686518, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991817272431536, "mean_inference_ms": 1.2720601734781636, "mean_action_processing_ms": 0.054158813368077194, "mean_env_wait_ms": 1.1902313481444144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2050000, "timers": {"sample_time_ms": 1156.383, "sample_throughput": 6572.22, "learn_time_ms": 305.067, "learn_throughput": 24912.541, "update_time_ms": 2.838}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.7477838728798994e-66, "cur_lr": 0.001, "total_loss": 0.5420277714729309, "policy_loss": 0.009305951185524464, "vf_loss": 0.5327218770980835, "vf_explained_var": 0.9765484929084778, "kl": 0.0023702741600573063, "entropy": -6.724812984466553, "entropy_coeff": 0.0}}, "num_steps_sampled": 2050000, "num_steps_trained": 2050000}, "done": false, "episodes_total": 2043, "training_iteration": 273, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-36", "timestamp": 1617635496, "time_this_iter_s": 1.5446858406066895, "time_total_s": 494.4221181869507, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 329.63565373420715, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 71.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 105.71781529691877, "episode_reward_min": 21.577126845339826, "episode_reward_mean": 53.64760694279773, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.09541853259223, "MDD_min": 15.338382763686518, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [95.62622867149359, 83.66364649189198, 36.678282817870986, 44.11059996867739, 37.808249450418884, 47.51020777251543, 75.05941087339978, 53.059476390708504, 62.779355096539, 48.75145139335278, 81.98094505079884, 53.80334813211207, 43.41446548460744, 49.94733731449142, 65.54889792525415, 105.71781529691877, 90.95902408856503, 53.95219646951016, 70.13758868633181, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991817272431536, "mean_inference_ms": 1.2720601734781634, "mean_action_processing_ms": 0.0541588133680772, "mean_env_wait_ms": 1.1902313481444144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2057600, "timers": {"sample_time_ms": 1155.204, "sample_throughput": 6578.926, "learn_time_ms": 305.125, "learn_throughput": 24907.84, "update_time_ms": 2.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3738919364399497e-66, "cur_lr": 0.001, "total_loss": 0.020167099544778466, "policy_loss": -0.01747240382246673, "vf_loss": 0.03763950802385807, "vf_explained_var": 0.9836460947990417, "kl": 0.001638366433326155, "entropy": -6.729082107543945, "entropy_coeff": 0.0}}, "num_steps_sampled": 2057600, "num_steps_trained": 2057600}, "done": false, "episodes_total": 2043, "training_iteration": 274, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-37", "timestamp": 1617635497, "time_this_iter_s": 1.428534746170044, "time_total_s": 495.8506529331207, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345167a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 331.0641884803772, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 67.03333333333333, "ram_util_percent": 61.79999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 99.25533320197671, "episode_reward_min": 20.56074421608867, "episode_reward_mean": 50.75544604726937, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.38770952245469, "MDD_min": 15.338382763686518, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1992236420098328, "mean_inference_ms": 1.2720681590812064, "mean_action_processing_ms": 0.05416113108429494, "mean_env_wait_ms": 1.1902657813261854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2065200, "timers": {"sample_time_ms": 1156.666, "sample_throughput": 6570.609, "learn_time_ms": 304.371, "learn_throughput": 24969.529, "update_time_ms": 2.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1869459682199748e-66, "cur_lr": 0.001, "total_loss": 0.5388319194316864, "policy_loss": -0.006826391676440835, "vf_loss": 0.5456582903862, "vf_explained_var": 0.9839351177215576, "kl": 0.0015988281229510903, "entropy": -6.7492194175720215, "entropy_coeff": 0.0}}, "num_steps_sampled": 2065200, "num_steps_trained": 2065200}, "done": false, "episodes_total": 2062, "training_iteration": 275, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-39", "timestamp": 1617635499, "time_this_iter_s": 1.542562484741211, "time_total_s": 497.39321541786194, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345157a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 332.6067509651184, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 81.19999999999999, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 99.25533320197671, "episode_reward_min": 20.56074421608867, "episode_reward_mean": 50.75544604726938, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.3877095224547, "MDD_min": 15.338382763686518, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1992236420098328, "mean_inference_ms": 1.2720681590812064, "mean_action_processing_ms": 0.05416113108429496, "mean_env_wait_ms": 1.1902657813261852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2072800, "timers": {"sample_time_ms": 1156.761, "sample_throughput": 6570.071, "learn_time_ms": 304.158, "learn_throughput": 24987.027, "update_time_ms": 2.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.934729841099874e-67, "cur_lr": 0.001, "total_loss": 0.01421273173764348, "policy_loss": -0.005796888493932784, "vf_loss": 0.020009619183838367, "vf_explained_var": 0.9867572784423828, "kl": 0.0019178670481778681, "entropy": -6.824234247207642, "entropy_coeff": 0.0}}, "num_steps_sampled": 2072800, "num_steps_trained": 2072800}, "done": false, "episodes_total": 2062, "training_iteration": 276, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-40", "timestamp": 1617635500, "time_this_iter_s": 1.4223384857177734, "time_total_s": 498.8155539035797, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 334.0290894508362, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 61.849999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 99.25533320197671, "episode_reward_min": 20.56074421608867, "episode_reward_mean": 50.75544604726938, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.3877095224547, "MDD_min": 15.338382763686518, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [43.95021759481202, 47.42756883791883, 43.722974501947014, 37.36633008401548, 50.94256831109959, 40.285515697013814, 27.344189357883863, 40.35304882776691, 43.80643877105899, 92.30384355008694, 25.471910077329234, 45.43822181167791, 58.22220213222504, 50.178804976836126, 50.69185072135854, 30.848398204847477, 58.13068209557905, 41.54782867312252, 80.52290023953343, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1992236420098328, "mean_inference_ms": 1.2720681590812064, "mean_action_processing_ms": 0.05416113108429496, "mean_env_wait_ms": 1.1902657813261852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2080400, "timers": {"sample_time_ms": 1157.088, "sample_throughput": 6568.21, "learn_time_ms": 305.019, "learn_throughput": 24916.477, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.967364920549937e-67, "cur_lr": 0.001, "total_loss": 0.1930626556277275, "policy_loss": 0.005454517435282469, "vf_loss": 0.18760812282562256, "vf_explained_var": 0.9880778789520264, "kl": 0.0020541571429930627, "entropy": -6.869227409362793, "entropy_coeff": 0.0}}, "num_steps_sampled": 2080400, "num_steps_trained": 2080400}, "done": false, "episodes_total": 2062, "training_iteration": 277, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-42", "timestamp": 1617635502, "time_this_iter_s": 1.4412071704864502, "time_total_s": 500.25676107406616, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345158c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 335.47029662132263, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 61.8}, "trial_id": "6c840_00000"}
{"episode_reward_max": 99.25533320197671, "episode_reward_min": 20.56074421608867, "episode_reward_mean": 51.21139617206999, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.310325674729988, "MDD_min": 18.143851585185885, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991980643991704, "mean_inference_ms": 1.2720873718451733, "mean_action_processing_ms": 0.05416481916057078, "mean_env_wait_ms": 1.1902949118105723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2088000, "timers": {"sample_time_ms": 1161.407, "sample_throughput": 6543.789, "learn_time_ms": 306.743, "learn_throughput": 24776.464, "update_time_ms": 2.845}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4836824602749686e-67, "cur_lr": 0.001, "total_loss": 0.4597742557525635, "policy_loss": -0.00044187388266436756, "vf_loss": 0.46021611988544464, "vf_explained_var": 0.9800882339477539, "kl": 0.0012686096015386283, "entropy": -6.75674843788147, "entropy_coeff": 0.0}}, "num_steps_sampled": 2088000, "num_steps_trained": 2088000}, "done": false, "episodes_total": 2081, "training_iteration": 278, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-44", "timestamp": 1617635504, "time_this_iter_s": 1.5700562000274658, "time_total_s": 501.8268172740936, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 337.0403528213501, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 78.15, "ram_util_percent": 61.95}, "trial_id": "6c840_00000"}
{"episode_reward_max": 99.25533320197671, "episode_reward_min": 20.56074421608867, "episode_reward_mean": 51.21139617206998, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.310325674729985, "MDD_min": 18.143851585185885, "MDD_max": 31.96974014757797}, "hist_stats": {"episode_reward": [28.41554683295039, 99.25533320197671, 45.304564595940754, 52.96570468374795, 90.04363256871213, 36.62390493436265, 77.54700362314836, 57.54357548383573, 35.842232216442945, 85.22588757841301, 46.131894733414626, 60.327327752114215, 40.251578833288825, 39.599802098020675, 77.57525739471387, 50.28034919989807, 55.370675876274724, 32.81893237273699, 52.41944864897504, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19919806439917034, "mean_inference_ms": 1.2720873718451733, "mean_action_processing_ms": 0.05416481916057078, "mean_env_wait_ms": 1.1902949118105726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2095600, "timers": {"sample_time_ms": 1162.71, "sample_throughput": 6536.454, "learn_time_ms": 306.194, "learn_throughput": 24820.889, "update_time_ms": 2.833}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.418412301374843e-68, "cur_lr": 0.001, "total_loss": 0.03422375675290823, "policy_loss": -0.008161904930602759, "vf_loss": 0.04238566383719444, "vf_explained_var": 0.9795860648155212, "kl": 0.0019356062985025346, "entropy": -6.722600221633911, "entropy_coeff": 0.0}}, "num_steps_sampled": 2095600, "num_steps_trained": 2095600}, "done": false, "episodes_total": 2081, "training_iteration": 279, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-45", "timestamp": 1617635505, "time_this_iter_s": 1.4466044902801514, "time_total_s": 503.2734217643738, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 338.48695731163025, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.42605507300377, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 50.19815816552249, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.23765756639039, "MDD_min": 18.143851585185885, "MDD_max": 31.86339670102959}, "hist_stats": {"episode_reward": [43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1992420631753087, "mean_inference_ms": 1.2721247503348787, "mean_action_processing_ms": 0.054168764813864866, "mean_env_wait_ms": 1.1903473982331816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2103200, "timers": {"sample_time_ms": 1160.999, "sample_throughput": 6546.087, "learn_time_ms": 309.323, "learn_throughput": 24569.762, "update_time_ms": 2.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7092061506874214e-68, "cur_lr": 0.001, "total_loss": 0.7017024755477905, "policy_loss": 0.00660284876357764, "vf_loss": 0.6950996816158295, "vf_explained_var": 0.9808869361877441, "kl": 0.0017209590296261013, "entropy": -6.797149658203125, "entropy_coeff": 0.0}}, "num_steps_sampled": 2103200, "num_steps_trained": 2103200}, "done": false, "episodes_total": 2100, "training_iteration": 280, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-47", "timestamp": 1617635507, "time_this_iter_s": 1.5703816413879395, "time_total_s": 504.8438034057617, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 340.0573389530182, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 71.35, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.42605507300377, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 50.19815816552248, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.23765756639039, "MDD_min": 18.143851585185885, "MDD_max": 31.86339670102959}, "hist_stats": {"episode_reward": [60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19924206317530874, "mean_inference_ms": 1.2721247503348787, "mean_action_processing_ms": 0.054168764813864866, "mean_env_wait_ms": 1.1903473982331816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2110800, "timers": {"sample_time_ms": 1172.463, "sample_throughput": 6482.083, "learn_time_ms": 309.766, "learn_throughput": 24534.622, "update_time_ms": 2.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8546030753437107e-68, "cur_lr": 0.001, "total_loss": 0.0032999133691191673, "policy_loss": -0.01462724874727428, "vf_loss": 0.017927159555256367, "vf_explained_var": 0.986585259437561, "kl": 0.0019779617432504892, "entropy": -6.822012662887573, "entropy_coeff": 0.0}}, "num_steps_sampled": 2110800, "num_steps_trained": 2110800}, "done": false, "episodes_total": 2100, "training_iteration": 281, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-48", "timestamp": 1617635508, "time_this_iter_s": 1.537501573562622, "time_total_s": 506.38130497932434, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345157a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 341.5948405265808, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 71.76666666666667, "ram_util_percent": 62.06666666666666}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.42605507300377, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 50.19815816552248, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.23765756639039, "MDD_min": 18.143851585185885, "MDD_max": 31.86339670102959}, "hist_stats": {"episode_reward": [60.523646304010775, 43.601781948648814, 52.12689187329492, 41.433292330440274, 36.4276885922353, 47.37244731188521, 53.517356854726025, 44.9889829419066, 58.77344251741921, 89.72699859616422, 40.541983916360195, 48.20732383161255, 45.53929483529601, 74.32695890557473, 39.98389146177029, 44.7020851093904, 27.64510639743041, 46.93206432787193, 56.983260920512635, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19924206317530874, "mean_inference_ms": 1.2721247503348787, "mean_action_processing_ms": 0.054168764813864866, "mean_env_wait_ms": 1.1903473982331816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2118400, "timers": {"sample_time_ms": 1172.913, "sample_throughput": 6479.592, "learn_time_ms": 311.924, "learn_throughput": 24364.9, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.273015376718553e-69, "cur_lr": 0.001, "total_loss": 0.17388277500867844, "policy_loss": -0.0077245194697752595, "vf_loss": 0.18160727620124817, "vf_explained_var": 0.9891124367713928, "kl": 0.0017217767308466136, "entropy": -6.891422510147095, "entropy_coeff": 0.0}}, "num_steps_sampled": 2118400, "num_steps_trained": 2118400}, "done": false, "episodes_total": 2100, "training_iteration": 282, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-50", "timestamp": 1617635510, "time_this_iter_s": 1.4404404163360596, "time_total_s": 507.8217453956604, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 343.03528094291687, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 73.6, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.227098432941744, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.450027680919387, "MDD_min": 18.143851585185885, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19923103010604162, "mean_inference_ms": 1.2722897503386985, "mean_action_processing_ms": 0.054176644739568965, "mean_env_wait_ms": 1.1905168301915359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2126000, "timers": {"sample_time_ms": 1178.006, "sample_throughput": 6451.578, "learn_time_ms": 313.126, "learn_throughput": 24271.397, "update_time_ms": 2.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.636507688359277e-69, "cur_lr": 0.001, "total_loss": 0.4466185122728348, "policy_loss": 0.006504925200715661, "vf_loss": 0.4401136040687561, "vf_explained_var": 0.9819736480712891, "kl": 0.0019209893653169274, "entropy": -6.758496999740601, "entropy_coeff": 0.0}}, "num_steps_sampled": 2126000, "num_steps_trained": 2126000}, "done": false, "episodes_total": 2119, "training_iteration": 283, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-51", "timestamp": 1617635511, "time_this_iter_s": 1.6075632572174072, "time_total_s": 509.4293086528778, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515c20>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 344.6428442001343, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 83.7, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.22709843294174, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.450027680919398, "MDD_min": 18.143851585185885, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [21.577126845339826, 45.62699764595278, 70.54789460813713, 39.360368911363146, 82.1000273055684, 46.86528321662994, 32.66246513706229, 55.59387376471763, 50.66249817796813, 23.110479837795488, 69.19036172419257, 48.50255358639348, 33.08831620881727, 28.828976272665376, 53.57930443758397, 56.18929214924937, 77.27377181681618, 92.42605507300377, 56.95922688073348, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19923103010604162, "mean_inference_ms": 1.272289750338699, "mean_action_processing_ms": 0.05417664473956895, "mean_env_wait_ms": 1.190516830191536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2133600, "timers": {"sample_time_ms": 1195.839, "sample_throughput": 6355.371, "learn_time_ms": 316.297, "learn_throughput": 24028.056, "update_time_ms": 2.754}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3182538441796384e-69, "cur_lr": 0.001, "total_loss": 0.03368815965950489, "policy_loss": -0.008299307781271636, "vf_loss": 0.04198747128248215, "vf_explained_var": 0.9791532754898071, "kl": 0.0015650351415388286, "entropy": -6.770036935806274, "entropy_coeff": 0.0}}, "num_steps_sampled": 2133600, "num_steps_trained": 2133600}, "done": false, "episodes_total": 2119, "training_iteration": 284, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-53", "timestamp": 1617635513, "time_this_iter_s": 1.6377997398376465, "time_total_s": 511.06710839271545, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345158c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 346.2806439399719, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.30502971227152, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.61401231332825, "MDD_min": 18.143851585185885, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1993061628697438, "mean_inference_ms": 1.272665868512854, "mean_action_processing_ms": 0.054195820778202675, "mean_env_wait_ms": 1.1908837465291644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2141200, "timers": {"sample_time_ms": 1212.311, "sample_throughput": 6269.016, "learn_time_ms": 317.992, "learn_throughput": 23899.935, "update_time_ms": 2.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1591269220898192e-69, "cur_lr": 0.001, "total_loss": 0.7573491930961609, "policy_loss": -0.0019427690021984745, "vf_loss": 0.7592919170856476, "vf_explained_var": 0.9790637493133545, "kl": 0.0014890905003994703, "entropy": -6.793428659439087, "entropy_coeff": 0.0}}, "num_steps_sampled": 2141200, "num_steps_trained": 2141200}, "done": false, "episodes_total": 2138, "training_iteration": 285, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-55", "timestamp": 1617635515, "time_this_iter_s": 1.7249982357025146, "time_total_s": 512.792106628418, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345157a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 348.00564217567444, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 76.89999999999999, "ram_util_percent": 62.36666666666667}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.305029712271526, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.61401231332825, "MDD_min": 18.143851585185885, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1993061628697438, "mean_inference_ms": 1.272665868512854, "mean_action_processing_ms": 0.05419582077820269, "mean_env_wait_ms": 1.1908837465291644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2148800, "timers": {"sample_time_ms": 1233.816, "sample_throughput": 6159.75, "learn_time_ms": 319.334, "learn_throughput": 23799.566, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.795634610449096e-70, "cur_lr": 0.001, "total_loss": 0.019649412482976913, "policy_loss": 0.001840799581259489, "vf_loss": 0.017808611504733562, "vf_explained_var": 0.9847893714904785, "kl": 0.0016900243936106563, "entropy": -6.800518989562988, "entropy_coeff": 0.0}}, "num_steps_sampled": 2148800, "num_steps_trained": 2148800}, "done": false, "episodes_total": 2138, "training_iteration": 286, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-56", "timestamp": 1617635516, "time_this_iter_s": 1.6509120464324951, "time_total_s": 514.4430186748505, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 349.65655422210693, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 77.35, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.305029712271526, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.61401231332825, "MDD_min": 18.143851585185885, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [80.90780236962145, 52.05816751861006, 30.177341849479618, 39.78998828239705, 51.721347212585485, 42.91782840475944, 58.60830755423365, 46.232344764920406, 32.29679119447543, 43.628846774394475, 20.56074421608867, 59.402072650331334, 50.918819819976605, 51.90224657345544, 33.04609911948583, 37.20407471969515, 43.30409373879476, 52.417000492624055, 55.25016571253052, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1993061628697438, "mean_inference_ms": 1.272665868512854, "mean_action_processing_ms": 0.05419582077820269, "mean_env_wait_ms": 1.1908837465291644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2156400, "timers": {"sample_time_ms": 1234.494, "sample_throughput": 6156.366, "learn_time_ms": 318.728, "learn_throughput": 23844.757, "update_time_ms": 2.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.897817305224548e-70, "cur_lr": 0.001, "total_loss": 0.20033013075590134, "policy_loss": 0.0008420875092269853, "vf_loss": 0.1994880512356758, "vf_explained_var": 0.9876734018325806, "kl": 0.0013660864788107574, "entropy": -6.929514408111572, "entropy_coeff": 0.0}}, "num_steps_sampled": 2156400, "num_steps_trained": 2156400}, "done": false, "episodes_total": 2138, "training_iteration": 287, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-58", "timestamp": 1617635518, "time_this_iter_s": 1.4420809745788574, "time_total_s": 515.8850996494293, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 351.0986351966858, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 70.85, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.75570806161254, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.99883067924125, "MDD_min": 13.955930497715041, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19935458441155177, "mean_inference_ms": 1.2732012833812707, "mean_action_processing_ms": 0.0542213358816356, "mean_env_wait_ms": 1.191424665758777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2164000, "timers": {"sample_time_ms": 1240.407, "sample_throughput": 6127.022, "learn_time_ms": 317.42, "learn_throughput": 23943.067, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.448908652612274e-70, "cur_lr": 0.001, "total_loss": 0.5663239061832428, "policy_loss": 0.020263427402824163, "vf_loss": 0.5460604429244995, "vf_explained_var": 0.9765564203262329, "kl": 0.0014903633273206651, "entropy": -6.782490968704224, "entropy_coeff": 0.0}}, "num_steps_sampled": 2164000, "num_steps_trained": 2164000}, "done": false, "episodes_total": 2157, "training_iteration": 288, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-11-59", "timestamp": 1617635519, "time_this_iter_s": 1.6169767379760742, "time_total_s": 517.5020763874054, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534515d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 352.71561193466187, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 71.8, "ram_util_percent": 62.36666666666667}, "trial_id": "6c840_00000"}
{"episode_reward_max": 103.67260758825432, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 49.75570806161254, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.99883067924125, "MDD_min": 13.955930497715041, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [60.317545490355535, 28.646534897318393, 91.9637539562254, 45.690384888147435, 56.984782854810106, 58.25196503889596, 53.39534744596347, 67.8750164033272, 24.891974131202222, 53.7594790406219, 54.01504924215915, 36.5154600177162, 43.71382136051066, 48.86980717842718, 58.53105904743926, 77.40706913708613, 46.350625405089374, 59.04442900083883, 45.949729650716556, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19935458441155177, "mean_inference_ms": 1.2732012833812707, "mean_action_processing_ms": 0.0542213358816356, "mean_env_wait_ms": 1.1914246657587773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2171600, "timers": {"sample_time_ms": 1237.731, "sample_throughput": 6140.268, "learn_time_ms": 316.95, "learn_throughput": 23978.509, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.24454326306137e-71, "cur_lr": 0.001, "total_loss": 0.055902149528265, "policy_loss": -0.0004971214766555931, "vf_loss": 0.0563992653042078, "vf_explained_var": 0.9697374105453491, "kl": 0.0015249879797920585, "entropy": -6.772692680358887, "entropy_coeff": 0.0}}, "num_steps_sampled": 2171600, "num_steps_trained": 2171600}, "done": false, "episodes_total": 2157, "training_iteration": 289, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-01", "timestamp": 1617635521, "time_this_iter_s": 1.415287733078003, "time_total_s": 518.9173641204834, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345157a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 354.13089966773987, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 73.65, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 51.53787287054322, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.20267096629589, "MDD_min": 13.955930497715041, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1994711618241233, "mean_inference_ms": 1.2737447377048055, "mean_action_processing_ms": 0.054245811497924984, "mean_env_wait_ms": 1.1919707797578547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2179200, "timers": {"sample_time_ms": 1247.217, "sample_throughput": 6093.569, "learn_time_ms": 314.61, "learn_throughput": 24156.883, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.622271631530685e-71, "cur_lr": 0.001, "total_loss": 0.9308860599994659, "policy_loss": 0.01331243384629488, "vf_loss": 0.9175735712051392, "vf_explained_var": 0.9744420051574707, "kl": 0.001862312143202871, "entropy": -6.854863166809082, "entropy_coeff": 0.0}}, "num_steps_sampled": 2179200, "num_steps_trained": 2179200}, "done": false, "episodes_total": 2176, "training_iteration": 290, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-02", "timestamp": 1617635522, "time_this_iter_s": 1.6413085460662842, "time_total_s": 520.5586726665497, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345158c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 355.77220821380615, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 83.8, "ram_util_percent": 62.349999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 51.53787287054322, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.202670966295884, "MDD_min": 13.955930497715041, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1994711618241233, "mean_inference_ms": 1.2737447377048055, "mean_action_processing_ms": 0.05424581149792496, "mean_env_wait_ms": 1.1919707797578545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2186800, "timers": {"sample_time_ms": 1238.292, "sample_throughput": 6137.488, "learn_time_ms": 313.646, "learn_throughput": 24231.137, "update_time_ms": 2.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8111358157653425e-71, "cur_lr": 0.001, "total_loss": 0.013646200532093644, "policy_loss": -0.004010086297057569, "vf_loss": 0.017656289972364902, "vf_explained_var": 0.9860422611236572, "kl": 0.0018729952862486243, "entropy": -6.829641819000244, "entropy_coeff": 0.0}}, "num_steps_sampled": 2186800, "num_steps_trained": 2186800}, "done": false, "episodes_total": 2176, "training_iteration": 291, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-04", "timestamp": 1617635524, "time_this_iter_s": 1.438528060913086, "time_total_s": 521.9972007274628, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 357.21073627471924, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 67.85, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 20.31073879455302, "episode_reward_mean": 51.53787287054322, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.202670966295884, "MDD_min": 13.955930497715041, "MDD_max": 32.513173074192245}, "hist_stats": {"episode_reward": [40.79293204672474, 57.65099148813308, 40.57234653065571, 51.53583062386751, 35.02757415679878, 43.10268778705229, 40.11001569212441, 61.95119501196562, 49.38729712418534, 87.60210632540378, 37.9875706287508, 48.050184734917636, 45.993981557741726, 55.95285983768242, 34.491609243792574, 20.31073879455302, 45.94101506785982, 47.73486620606469, 58.86645468668238, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1994711618241233, "mean_inference_ms": 1.2737447377048055, "mean_action_processing_ms": 0.05424581149792496, "mean_env_wait_ms": 1.1919707797578545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2194400, "timers": {"sample_time_ms": 1238.489, "sample_throughput": 6136.511, "learn_time_ms": 314.193, "learn_throughput": 24188.918, "update_time_ms": 2.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.055679078826712e-72, "cur_lr": 0.001, "total_loss": 0.16386640071868896, "policy_loss": -0.0018053450621664524, "vf_loss": 0.16567173600196838, "vf_explained_var": 0.9897557497024536, "kl": 0.0008725236693862826, "entropy": -6.957224369049072, "entropy_coeff": 0.0}}, "num_steps_sampled": 2194400, "num_steps_trained": 2194400}, "done": false, "episodes_total": 2176, "training_iteration": 292, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-05", "timestamp": 1617635525, "time_this_iter_s": 1.4466760158538818, "time_total_s": 523.4438767433167, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 358.6574122905731, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 21.96456923411227, "episode_reward_mean": 52.14822255899957, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.3284424886897, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19953880155280218, "mean_inference_ms": 1.2743316998425254, "mean_action_processing_ms": 0.05427174647317767, "mean_env_wait_ms": 1.1925589318315648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2202000, "timers": {"sample_time_ms": 1240.114, "sample_throughput": 6128.468, "learn_time_ms": 314.007, "learn_throughput": 24203.266, "update_time_ms": 2.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.527839539413356e-72, "cur_lr": 0.001, "total_loss": 0.4662276357412338, "policy_loss": 0.0020408039854373783, "vf_loss": 0.46418681740760803, "vf_explained_var": 0.9799789786338806, "kl": 0.0017237504362128675, "entropy": -6.79453444480896, "entropy_coeff": 0.0}}, "num_steps_sampled": 2202000, "num_steps_trained": 2202000}, "done": false, "episodes_total": 2195, "training_iteration": 293, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-07", "timestamp": 1617635527, "time_this_iter_s": 1.6218035221099854, "time_total_s": 525.0656802654266, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345163b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 360.2792158126831, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 70.16666666666667, "ram_util_percent": 62.26666666666667}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 21.96456923411227, "episode_reward_mean": 52.14822255899957, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.328442488689703, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [54.789580751108915, 35.65558747036453, 56.611907517447996, 67.19471277384245, 70.48448076267718, 47.89934301708557, 24.438885215264417, 83.19809423802353, 30.60069968735888, 46.27645121970268, 56.827636934381495, 103.67260758825432, 34.933643992643894, 42.268121933229594, 51.559571848141104, 40.597419832934335, 40.76722364073179, 38.743557706311265, 35.514395236032485, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19953880155280213, "mean_inference_ms": 1.2743316998425251, "mean_action_processing_ms": 0.054271746473177666, "mean_env_wait_ms": 1.1925589318315648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2209600, "timers": {"sample_time_ms": 1225.655, "sample_throughput": 6200.768, "learn_time_ms": 314.732, "learn_throughput": 24147.496, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.263919769706678e-72, "cur_lr": 0.001, "total_loss": 0.037191810086369514, "policy_loss": 0.0012885003816336393, "vf_loss": 0.03590330481529236, "vf_explained_var": 0.9825789928436279, "kl": 0.0007290245266631246, "entropy": -6.798259735107422, "entropy_coeff": 0.0}}, "num_steps_sampled": 2209600, "num_steps_trained": 2209600}, "done": false, "episodes_total": 2195, "training_iteration": 294, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-08", "timestamp": 1617635528, "time_this_iter_s": 1.501035213470459, "time_total_s": 526.5667154788971, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 361.78025102615356, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 79.0, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 21.96456923411227, "episode_reward_mean": 51.50251272506934, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.26254612489302, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19968104653965785, "mean_inference_ms": 1.2749310821586486, "mean_action_processing_ms": 0.05429851057058177, "mean_env_wait_ms": 1.1931769222235176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2217200, "timers": {"sample_time_ms": 1223.654, "sample_throughput": 6210.907, "learn_time_ms": 315.708, "learn_throughput": 24072.851, "update_time_ms": 2.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.131959884853339e-72, "cur_lr": 0.001, "total_loss": 0.46999429166316986, "policy_loss": 0.0035210212226957083, "vf_loss": 0.4664732664823532, "vf_explained_var": 0.986992359161377, "kl": 0.001692457648459822, "entropy": -6.885461330413818, "entropy_coeff": 0.0}}, "num_steps_sampled": 2217200, "num_steps_trained": 2217200}, "done": false, "episodes_total": 2214, "training_iteration": 295, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-10", "timestamp": 1617635530, "time_this_iter_s": 1.7143731117248535, "time_total_s": 528.281088590622, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 363.4946241378784, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 82.35, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 21.96456923411227, "episode_reward_mean": 51.502512725069344, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.26254612489302, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19968104653965787, "mean_inference_ms": 1.2749310821586486, "mean_action_processing_ms": 0.05429851057058178, "mean_env_wait_ms": 1.1931769222235178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2224800, "timers": {"sample_time_ms": 1202.608, "sample_throughput": 6319.599, "learn_time_ms": 316.029, "learn_throughput": 24048.424, "update_time_ms": 2.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.659799424266695e-73, "cur_lr": 0.001, "total_loss": 0.011222771718166769, "policy_loss": -0.008985382446553558, "vf_loss": 0.020208154805004597, "vf_explained_var": 0.9831353425979614, "kl": 0.0013848120579496026, "entropy": -6.860421180725098, "entropy_coeff": 0.0}}, "num_steps_sampled": 2224800, "num_steps_trained": 2224800}, "done": false, "episodes_total": 2214, "training_iteration": 296, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-12", "timestamp": 1617635532, "time_this_iter_s": 1.4434432983398438, "time_total_s": 529.7245318889618, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 364.93806743621826, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 73.19999999999999, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 21.96456923411227, "episode_reward_mean": 51.502512725069344, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.26254612489302, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [36.68610374504128, 37.23060025345617, 27.789782786197904, 51.80433919482663, 25.44004764885934, 50.000002649848625, 36.35501735472937, 76.89255783157925, 46.75341366665944, 59.215717139696494, 53.48821264337293, 88.74073417002828, 52.03305944529497, 26.14836789544325, 79.86488629080056, 51.512130807189635, 94.03283704422545, 21.96456923411227, 51.06940854264865, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19968104653965787, "mean_inference_ms": 1.2749310821586486, "mean_action_processing_ms": 0.05429851057058178, "mean_env_wait_ms": 1.1931769222235178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2232400, "timers": {"sample_time_ms": 1201.137, "sample_throughput": 6327.341, "learn_time_ms": 315.238, "learn_throughput": 24108.8, "update_time_ms": 2.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8298997121333476e-73, "cur_lr": 0.001, "total_loss": 0.15039397031068802, "policy_loss": -0.002384165461990051, "vf_loss": 0.15277813374996185, "vf_explained_var": 0.9908087253570557, "kl": 0.001332330342847854, "entropy": -6.941617012023926, "entropy_coeff": 0.0}}, "num_steps_sampled": 2232400, "num_steps_trained": 2232400}, "done": false, "episodes_total": 2214, "training_iteration": 297, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-13", "timestamp": 1617635533, "time_this_iter_s": 1.4186561107635498, "time_total_s": 531.1431879997253, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 366.3567235469818, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 72.05, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 24.275602177200284, "episode_reward_mean": 51.289138329426706, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.247186127665472, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1997432092544733, "mean_inference_ms": 1.2753476568677728, "mean_action_processing_ms": 0.05431674474426273, "mean_env_wait_ms": 1.1936185201561758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2240000, "timers": {"sample_time_ms": 1193.224, "sample_throughput": 6369.297, "learn_time_ms": 315.056, "learn_throughput": 24122.702, "update_time_ms": 2.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4149498560666738e-73, "cur_lr": 0.001, "total_loss": 0.40753909945487976, "policy_loss": 0.007665605051442981, "vf_loss": 0.3998735398054123, "vf_explained_var": 0.9832077026367188, "kl": 0.0017233872786164284, "entropy": -6.812346458435059, "entropy_coeff": 0.0}}, "num_steps_sampled": 2240000, "num_steps_trained": 2240000}, "done": false, "episodes_total": 2233, "training_iteration": 298, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-15", "timestamp": 1617635535, "time_this_iter_s": 1.5354318618774414, "time_total_s": 532.6786198616028, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 367.89215540885925, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 67.93333333333334, "ram_util_percent": 62.26666666666667}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 24.275602177200284, "episode_reward_mean": 51.28913832942671, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.247186127665476, "MDD_min": 13.955930497715041, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [24.68088862757031, 41.799938411379124, 46.14692908147363, 36.69992286810632, 54.53940782880873, 30.700863581011788, 101.95279374462942, 24.275602177200284, 45.423868897402905, 83.89081375248134, 28.37920687476053, 66.6772914164104, 32.339541335241314, 49.44793798955391, 35.504350133482674, 75.70651604017542, 40.29652939836431, 31.99430893274986, 70.30559225916846, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19974320925447334, "mean_inference_ms": 1.275347656867773, "mean_action_processing_ms": 0.054316744744262714, "mean_env_wait_ms": 1.193618520156176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2247600, "timers": {"sample_time_ms": 1198.095, "sample_throughput": 6343.404, "learn_time_ms": 318.278, "learn_throughput": 23878.471, "update_time_ms": 2.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.074749280333369e-74, "cur_lr": 0.001, "total_loss": 0.03942464478313923, "policy_loss": 0.0029363882495090365, "vf_loss": 0.036488257348537445, "vf_explained_var": 0.9816065430641174, "kl": 0.0014377223560586572, "entropy": -6.77930212020874, "entropy_coeff": 0.0}}, "num_steps_sampled": 2247600, "num_steps_trained": 2247600}, "done": false, "episodes_total": 2233, "training_iteration": 299, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-16", "timestamp": 1617635536, "time_this_iter_s": 1.4971625804901123, "time_total_s": 534.1757824420929, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 369.38931798934937, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 79.44999999999999, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 27.70990154104194, "episode_reward_mean": 51.38260475577954, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.486111556662014, "MDD_min": 16.79688177808762, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199859354648238, "mean_inference_ms": 1.2757566466172712, "mean_action_processing_ms": 0.05433285741856439, "mean_env_wait_ms": 1.1940189021538996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2255200, "timers": {"sample_time_ms": 1219.492, "sample_throughput": 6232.105, "learn_time_ms": 321.91, "learn_throughput": 23609.117, "update_time_ms": 2.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.5373746401666845e-74, "cur_lr": 0.001, "total_loss": 0.524530291557312, "policy_loss": -0.006191972177475691, "vf_loss": 0.5307223200798035, "vf_explained_var": 0.9850424528121948, "kl": 0.002328302594833076, "entropy": -6.932166337966919, "entropy_coeff": 0.0}}, "num_steps_sampled": 2255200, "num_steps_trained": 2255200}, "done": false, "episodes_total": 2252, "training_iteration": 300, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-18", "timestamp": 1617635538, "time_this_iter_s": 1.8925707340240479, "time_total_s": 536.068353176117, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 371.2818887233734, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 82.55000000000001, "ram_util_percent": 62.349999999999994}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 27.70990154104194, "episode_reward_mean": 51.38260475577953, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.48611155666201, "MDD_min": 16.79688177808762, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199859354648238, "mean_inference_ms": 1.275756646617271, "mean_action_processing_ms": 0.05433285741856438, "mean_env_wait_ms": 1.1940189021538994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2262800, "timers": {"sample_time_ms": 1226.602, "sample_throughput": 6195.98, "learn_time_ms": 323.866, "learn_throughput": 23466.503, "update_time_ms": 2.739}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7686873200833423e-74, "cur_lr": 0.001, "total_loss": 0.004939103499054909, "policy_loss": -0.013501466251909733, "vf_loss": 0.018440572544932365, "vf_explained_var": 0.9825719594955444, "kl": 0.0012367331073619425, "entropy": -6.871656179428101, "entropy_coeff": 0.0}}, "num_steps_sampled": 2262800, "num_steps_trained": 2262800}, "done": false, "episodes_total": 2252, "training_iteration": 301, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-20", "timestamp": 1617635540, "time_this_iter_s": 1.528954029083252, "time_total_s": 537.5973072052002, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 372.81084275245667, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 68.7, "ram_util_percent": 62.53333333333333}, "trial_id": "6c840_00000"}
{"episode_reward_max": 107.58262440946947, "episode_reward_min": 27.70990154104194, "episode_reward_mean": 51.38260475577953, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.48611155666201, "MDD_min": 16.79688177808762, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [29.271843450337528, 42.892739182736115, 57.25176824633885, 38.58407140156944, 42.516279088946824, 67.12224337285521, 30.993451631521545, 56.07660492232387, 70.79803791525377, 57.87297506436145, 57.49109778228281, 37.267675507634166, 75.51267187106559, 88.44937320222435, 61.118350190062124, 107.58262440946947, 84.03658911014206, 66.40509212777849, 68.89327726392757, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199859354648238, "mean_inference_ms": 1.275756646617271, "mean_action_processing_ms": 0.05433285741856438, "mean_env_wait_ms": 1.1940189021538994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2270400, "timers": {"sample_time_ms": 1240.873, "sample_throughput": 6124.719, "learn_time_ms": 323.613, "learn_throughput": 23484.871, "update_time_ms": 2.73}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.843436600416711e-75, "cur_lr": 0.001, "total_loss": 0.19187434762716293, "policy_loss": -0.004858929110923782, "vf_loss": 0.1967332661151886, "vf_explained_var": 0.9886547923088074, "kl": 0.000630867580184713, "entropy": -6.981446266174316, "entropy_coeff": 0.0}}, "num_steps_sampled": 2270400, "num_steps_trained": 2270400}, "done": false, "episodes_total": 2252, "training_iteration": 302, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-21", "timestamp": 1617635541, "time_this_iter_s": 1.5865120887756348, "time_total_s": 539.1838192939758, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 374.3973548412323, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 83.7, "ram_util_percent": 62.45}, "trial_id": "6c840_00000"}
{"episode_reward_max": 119.98052803677292, "episode_reward_min": 27.137134356245923, "episode_reward_mean": 50.27606251457013, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.26225138425239, "MDD_min": 16.79688177808762, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19991274995282665, "mean_inference_ms": 1.2762550833130906, "mean_action_processing_ms": 0.05435331997694866, "mean_env_wait_ms": 1.194513082655919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2278000, "timers": {"sample_time_ms": 1237.846, "sample_throughput": 6139.698, "learn_time_ms": 323.137, "learn_throughput": 23519.467, "update_time_ms": 2.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.421718300208356e-75, "cur_lr": 0.001, "total_loss": 0.5309519469738007, "policy_loss": 0.007695959066040814, "vf_loss": 0.5232560038566589, "vf_explained_var": 0.9786027669906616, "kl": 0.0019049816764891148, "entropy": -6.8118650913238525, "entropy_coeff": 0.0}}, "num_steps_sampled": 2278000, "num_steps_trained": 2278000}, "done": false, "episodes_total": 2271, "training_iteration": 303, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-23", "timestamp": 1617635543, "time_this_iter_s": 1.587259292602539, "time_total_s": 540.7710785865784, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 375.98461413383484, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 74.45, "ram_util_percent": 62.5}, "trial_id": "6c840_00000"}
{"episode_reward_max": 119.98052803677292, "episode_reward_min": 27.137134356245923, "episode_reward_mean": 50.27606251457013, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.262251384252398, "MDD_min": 16.79688177808762, "MDD_max": 39.12253039342858}, "hist_stats": {"episode_reward": [34.08916187100296, 76.65047578787171, 30.067995021212486, 39.72245326927245, 80.24016475965595, 55.432866844421085, 46.33044328325243, 92.00800797264314, 53.330121940035, 47.770862122107296, 47.63240736285774, 72.54279745740631, 39.25029934901615, 48.98041240652433, 27.70990154104194, 62.70305657373413, 54.42411150909938, 33.545285711644674, 55.398093990403986, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19991274995282662, "mean_inference_ms": 1.2762550833130906, "mean_action_processing_ms": 0.05435331997694866, "mean_env_wait_ms": 1.1945130826559192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2285600, "timers": {"sample_time_ms": 1235.11, "sample_throughput": 6153.3, "learn_time_ms": 318.594, "learn_throughput": 23854.801, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.210859150104178e-75, "cur_lr": 0.001, "total_loss": 0.02052513719536364, "policy_loss": -0.014743254519999027, "vf_loss": 0.0352683961391449, "vf_explained_var": 0.980523407459259, "kl": 0.00131246168166399, "entropy": -6.786164283752441, "entropy_coeff": 0.0}}, "num_steps_sampled": 2285600, "num_steps_trained": 2285600}, "done": false, "episodes_total": 2271, "training_iteration": 304, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-24", "timestamp": 1617635544, "time_this_iter_s": 1.4277698993682861, "time_total_s": 542.1988484859467, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 377.4123840332031, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 72.55, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 119.98052803677292, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 48.96032275197515, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.043726180705256, "MDD_min": 14.44613237730763, "MDD_max": 33.16728021852348}, "hist_stats": {"episode_reward": [50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20001311532670704, "mean_inference_ms": 1.2766929788305952, "mean_action_processing_ms": 0.05437241622891069, "mean_env_wait_ms": 1.1949517917127832, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2293200, "timers": {"sample_time_ms": 1219.506, "sample_throughput": 6232.033, "learn_time_ms": 316.304, "learn_throughput": 24027.537, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.105429575052089e-75, "cur_lr": 0.001, "total_loss": 0.44278842210769653, "policy_loss": 0.005085948767373338, "vf_loss": 0.4377024918794632, "vf_explained_var": 0.9883703589439392, "kl": 0.0012225513346493244, "entropy": -6.925290822982788, "entropy_coeff": 0.0}}, "num_steps_sampled": 2293200, "num_steps_trained": 2293200}, "done": false, "episodes_total": 2290, "training_iteration": 305, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-26", "timestamp": 1617635546, "time_this_iter_s": 1.535780906677246, "time_total_s": 543.7346293926239, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 378.94816493988037, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 71.69999999999999, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 119.98052803677292, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 48.960322751975134, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.043726180705253, "MDD_min": 14.44613237730763, "MDD_max": 33.16728021852348}, "hist_stats": {"episode_reward": [37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20001311532670704, "mean_inference_ms": 1.2766929788305954, "mean_action_processing_ms": 0.054372416228910696, "mean_env_wait_ms": 1.194951791712783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2300800, "timers": {"sample_time_ms": 1220.401, "sample_throughput": 6227.46, "learn_time_ms": 316.836, "learn_throughput": 23987.179, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.527147875260445e-76, "cur_lr": 0.001, "total_loss": 0.01720540039241314, "policy_loss": -0.000571376928405698, "vf_loss": 0.017776774242520332, "vf_explained_var": 0.9797208309173584, "kl": 0.0007867580570746213, "entropy": -6.844752311706543, "entropy_coeff": 0.0}}, "num_steps_sampled": 2300800, "num_steps_trained": 2300800}, "done": false, "episodes_total": 2290, "training_iteration": 306, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-27", "timestamp": 1617635547, "time_this_iter_s": 1.4571919441223145, "time_total_s": 545.1918213367462, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 380.4053568840027, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 66.93333333333334, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 119.98052803677292, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 48.960322751975134, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.043726180705253, "MDD_min": 14.44613237730763, "MDD_max": 33.16728021852348}, "hist_stats": {"episode_reward": [37.67553343510639, 47.73878895259233, 35.374059382560006, 75.70221088532621, 30.547965670819146, 30.71754858337947, 49.19307103200002, 28.45959092299164, 57.88063263634654, 76.95222947914834, 55.680849371721806, 60.78785973847595, 57.585539952446595, 47.85130648593345, 51.2786598810843, 37.66898675653228, 31.2852628610839, 37.65706834958617, 41.36733460042979, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20001311532670704, "mean_inference_ms": 1.2766929788305954, "mean_action_processing_ms": 0.054372416228910696, "mean_env_wait_ms": 1.194951791712783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2308400, "timers": {"sample_time_ms": 1238.747, "sample_throughput": 6135.231, "learn_time_ms": 317.426, "learn_throughput": 23942.618, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7635739376302223e-76, "cur_lr": 0.001, "total_loss": 0.2699183449149132, "policy_loss": 0.009223674307577312, "vf_loss": 0.2606946751475334, "vf_explained_var": 0.984977126121521, "kl": 0.0013045734958723187, "entropy": -6.9892356395721436, "entropy_coeff": 0.0}}, "num_steps_sampled": 2308400, "num_steps_trained": 2308400}, "done": false, "episodes_total": 2290, "training_iteration": 307, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-29", "timestamp": 1617635549, "time_this_iter_s": 1.6084249019622803, "time_total_s": 546.8002462387085, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 382.01378178596497, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 85.65, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.22456168439391, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.158830365606736, "MDD_min": 14.44613237730763, "MDD_max": 34.02983711102304}, "hist_stats": {"episode_reward": [30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20006130890808507, "mean_inference_ms": 1.2771639289982872, "mean_action_processing_ms": 0.05439600033560727, "mean_env_wait_ms": 1.1954031779730006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2316000, "timers": {"sample_time_ms": 1244.994, "sample_throughput": 6104.449, "learn_time_ms": 317.022, "learn_throughput": 23973.12, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3817869688151111e-76, "cur_lr": 0.001, "total_loss": 0.7804486453533173, "policy_loss": -0.003056854155147448, "vf_loss": 0.7835055589675903, "vf_explained_var": 0.9681302309036255, "kl": 0.0014586622710339725, "entropy": -6.806897878646851, "entropy_coeff": 0.0}}, "num_steps_sampled": 2316000, "num_steps_trained": 2316000}, "done": false, "episodes_total": 2309, "training_iteration": 308, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-31", "timestamp": 1617635551, "time_this_iter_s": 1.5944724082946777, "time_total_s": 548.3947186470032, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 383.60825419425964, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 77.0, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.22456168439391, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.158830365606732, "MDD_min": 14.44613237730763, "MDD_max": 34.02983711102304}, "hist_stats": {"episode_reward": [66.25205261477653, 59.482129332682334, 29.255727170969433, 35.13473402821796, 42.97235417470857, 46.63176167464648, 29.252474450253033, 30.261003906248025, 49.41272062714722, 59.6412035202223, 43.010356966371944, 40.27473206498887, 50.02712973563968, 44.47647127362831, 102.5910426101024, 41.99322210472324, 58.02984530761663, 51.46587104764798, 38.774758471954065, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2000613089080851, "mean_inference_ms": 1.2771639289982872, "mean_action_processing_ms": 0.054396000335607264, "mean_env_wait_ms": 1.1954031779730006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2323600, "timers": {"sample_time_ms": 1240.776, "sample_throughput": 6125.198, "learn_time_ms": 313.558, "learn_throughput": 24237.927, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.908934844075556e-77, "cur_lr": 0.001, "total_loss": 0.055309420451521873, "policy_loss": 0.011002758052200079, "vf_loss": 0.04430666193366051, "vf_explained_var": 0.9758945107460022, "kl": 0.0019302405999042094, "entropy": -6.75263237953186, "entropy_coeff": 0.0}}, "num_steps_sampled": 2323600, "num_steps_trained": 2323600}, "done": false, "episodes_total": 2309, "training_iteration": 309, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-32", "timestamp": 1617635552, "time_this_iter_s": 1.4193565845489502, "time_total_s": 549.8140752315521, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 385.0276107788086, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 71.8, "ram_util_percent": 62.45}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.228278322773775, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.205221724731533, "MDD_min": 14.44613237730763, "MDD_max": 34.02983711102304}, "hist_stats": {"episode_reward": [55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200160658061857, "mean_inference_ms": 1.2775840585674956, "mean_action_processing_ms": 0.054417873142816334, "mean_env_wait_ms": 1.1958146741247855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2331200, "timers": {"sample_time_ms": 1208.941, "sample_throughput": 6286.492, "learn_time_ms": 311.567, "learn_throughput": 24392.799, "update_time_ms": 2.786}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.454467422037778e-77, "cur_lr": 0.001, "total_loss": 0.48691561818122864, "policy_loss": -0.014080274617299438, "vf_loss": 0.5009958744049072, "vf_explained_var": 0.9867383241653442, "kl": 0.0010309576173312962, "entropy": -6.925495147705078, "entropy_coeff": 0.0}}, "num_steps_sampled": 2331200, "num_steps_trained": 2331200}, "done": false, "episodes_total": 2328, "training_iteration": 310, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-34", "timestamp": 1617635554, "time_this_iter_s": 1.553466558456421, "time_total_s": 551.3675417900085, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345133b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 386.581077337265, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.22827832277378, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.205221724731533, "MDD_min": 14.44613237730763, "MDD_max": 34.02983711102304}, "hist_stats": {"episode_reward": [48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200160658061857, "mean_inference_ms": 1.2775840585674954, "mean_action_processing_ms": 0.05441787314281631, "mean_env_wait_ms": 1.1958146741247853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2338800, "timers": {"sample_time_ms": 1208.342, "sample_throughput": 6289.609, "learn_time_ms": 309.481, "learn_throughput": 24557.248, "update_time_ms": 2.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.727233711018889e-77, "cur_lr": 0.001, "total_loss": 0.017010691575706005, "policy_loss": -0.0032077067880891263, "vf_loss": 0.020218398422002792, "vf_explained_var": 0.9755775928497314, "kl": 0.0007976160268299282, "entropy": -6.802276611328125, "entropy_coeff": 0.0}}, "num_steps_sampled": 2338800, "num_steps_trained": 2338800}, "done": false, "episodes_total": 2328, "training_iteration": 311, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-35", "timestamp": 1617635555, "time_this_iter_s": 1.5020549297332764, "time_total_s": 552.8695967197418, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 388.0831322669983, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.22827832277378, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.205221724731533, "MDD_min": 14.44613237730763, "MDD_max": 34.02983711102304}, "hist_stats": {"episode_reward": [48.83709703761758, 53.69923477893287, 39.487445400133105, 70.35215667535932, 47.46582112651324, 36.20094516750577, 51.39471252996893, 42.98037711134843, 51.99033510786962, 52.4764052661166, 48.34863366668376, 50.12272641856022, 36.60872377328808, 72.84952947894385, 63.34157113735233, 41.91028443664825, 40.12402811187301, 32.05452749845978, 59.8195354030609, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200160658061857, "mean_inference_ms": 1.2775840585674954, "mean_action_processing_ms": 0.05441787314281631, "mean_env_wait_ms": 1.1958146741247853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2346400, "timers": {"sample_time_ms": 1199.8, "sample_throughput": 6334.387, "learn_time_ms": 309.756, "learn_throughput": 24535.453, "update_time_ms": 2.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.636168555094445e-78, "cur_lr": 0.001, "total_loss": 0.19966797530651093, "policy_loss": -0.002340295206522569, "vf_loss": 0.20200827717781067, "vf_explained_var": 0.989069938659668, "kl": 0.0018165449146181345, "entropy": -6.978245258331299, "entropy_coeff": 0.0}}, "num_steps_sampled": 2346400, "num_steps_trained": 2346400}, "done": false, "episodes_total": 2328, "training_iteration": 312, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-37", "timestamp": 1617635557, "time_this_iter_s": 1.5042712688446045, "time_total_s": 554.3738679885864, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345135f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 389.5874035358429, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 78.55000000000001, "ram_util_percent": 62.4}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.30187620491899, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.253584504448245, "MDD_min": 14.44613237730763, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002049190810698, "mean_inference_ms": 1.278024117926173, "mean_action_processing_ms": 0.054440616941450276, "mean_env_wait_ms": 1.1962681510147586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2354000, "timers": {"sample_time_ms": 1211.814, "sample_throughput": 6271.589, "learn_time_ms": 310.037, "learn_throughput": 24513.217, "update_time_ms": 2.751}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.3180842775472223e-78, "cur_lr": 0.001, "total_loss": 0.5419626533985138, "policy_loss": 0.026866811327636242, "vf_loss": 0.5150958299636841, "vf_explained_var": 0.9779613018035889, "kl": 0.003760128514841199, "entropy": -6.763408660888672, "entropy_coeff": 0.0}}, "num_steps_sampled": 2354000, "num_steps_trained": 2354000}, "done": false, "episodes_total": 2347, "training_iteration": 313, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-38", "timestamp": 1617635558, "time_this_iter_s": 1.7094855308532715, "time_total_s": 556.0833535194397, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 391.29688906669617, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 79.65, "ram_util_percent": 62.6}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 50.30187620491899, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.25358450444825, "MDD_min": 14.44613237730763, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [59.57924933798807, 46.77066799354273, 67.51251774449683, 36.82294001426007, 39.20123578728675, 55.010344274736134, 71.33147731861303, 53.47641224287959, 45.720560073069926, 81.15048113438662, 119.98052803677292, 27.137134356245923, 56.92308385776689, 38.641278231168236, 57.71438472543265, 36.9754826631238, 74.38244840927612, 37.74540844816365, 29.030484950913863, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002049190810698, "mean_inference_ms": 1.278024117926173, "mean_action_processing_ms": 0.05444061694145029, "mean_env_wait_ms": 1.1962681510147588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2361600, "timers": {"sample_time_ms": 1215.577, "sample_throughput": 6252.176, "learn_time_ms": 311.615, "learn_throughput": 24389.086, "update_time_ms": 2.741}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1590421387736112e-78, "cur_lr": 0.001, "total_loss": 0.03608873579651117, "policy_loss": -0.00855735526420176, "vf_loss": 0.04464609734714031, "vf_explained_var": 0.9763437509536743, "kl": 0.002010314608924091, "entropy": -6.739679336547852, "entropy_coeff": 0.0}}, "num_steps_sampled": 2361600, "num_steps_trained": 2361600}, "done": false, "episodes_total": 2347, "training_iteration": 314, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-40", "timestamp": 1617635560, "time_this_iter_s": 1.4809167385101318, "time_total_s": 557.5642702579498, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 392.7778058052063, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 62.55}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 48.6177589503955, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.155964840477463, "MDD_min": 14.44613237730763, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002910529938355, "mean_inference_ms": 1.2784120871658566, "mean_action_processing_ms": 0.05445984487594295, "mean_env_wait_ms": 1.1966511158496527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2369200, "timers": {"sample_time_ms": 1225.942, "sample_throughput": 6199.317, "learn_time_ms": 310.919, "learn_throughput": 24443.682, "update_time_ms": 2.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0795210693868056e-78, "cur_lr": 0.001, "total_loss": 0.5363010466098785, "policy_loss": 0.0013498060579877347, "vf_loss": 0.5349512100219727, "vf_explained_var": 0.985328197479248, "kl": 0.0021211360581219196, "entropy": -6.950311660766602, "entropy_coeff": 0.0}}, "num_steps_sampled": 2369200, "num_steps_trained": 2369200}, "done": false, "episodes_total": 2366, "training_iteration": 315, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-41", "timestamp": 1617635561, "time_this_iter_s": 1.6327829360961914, "time_total_s": 559.197053194046, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 394.4105887413025, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 72.06666666666666, "ram_util_percent": 62.56666666666666}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 48.61775895039551, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.15596484047746, "MDD_min": 14.44613237730763, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002910529938355, "mean_inference_ms": 1.2784120871658566, "mean_action_processing_ms": 0.054459844875942964, "mean_env_wait_ms": 1.1966511158496527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2376800, "timers": {"sample_time_ms": 1242.437, "sample_throughput": 6117.012, "learn_time_ms": 308.766, "learn_throughput": 24614.088, "update_time_ms": 2.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.397605346934028e-79, "cur_lr": 0.001, "total_loss": 0.021061408333480358, "policy_loss": 0.002806939068250358, "vf_loss": 0.01825446728616953, "vf_explained_var": 0.9778579473495483, "kl": 0.0015195065061561763, "entropy": -6.743118047714233, "entropy_coeff": 0.0}}, "num_steps_sampled": 2376800, "num_steps_trained": 2376800}, "done": false, "episodes_total": 2366, "training_iteration": 316, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-43", "timestamp": 1617635563, "time_this_iter_s": 1.6014225482940674, "time_total_s": 560.7984757423401, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345133b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 396.01201128959656, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 81.19999999999999, "ram_util_percent": 62.5}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 17.8054036274499, "episode_reward_mean": 48.61775895039551, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.15596484047746, "MDD_min": 14.44613237730763, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [55.98020942901387, 51.90783182952701, 51.84120612698786, 46.84099441894182, 37.69279109287075, 50.60780089041856, 38.22124035529438, 46.783249149447656, 62.79930987845678, 66.08036406793799, 45.59298217880351, 50.40477548960177, 30.77329583137954, 47.5748111133403, 57.7412012138659, 27.808828027050843, 34.69098276608517, 17.8054036274499, 38.02974402068198, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002910529938355, "mean_inference_ms": 1.2784120871658566, "mean_action_processing_ms": 0.054459844875942964, "mean_env_wait_ms": 1.1966511158496527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2384400, "timers": {"sample_time_ms": 1222.856, "sample_throughput": 6214.96, "learn_time_ms": 308.304, "learn_throughput": 24650.994, "update_time_ms": 2.79}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.698802673467014e-79, "cur_lr": 0.001, "total_loss": 0.16134914755821228, "policy_loss": -0.0003501357859931886, "vf_loss": 0.16169928014278412, "vf_explained_var": 0.9905495643615723, "kl": 0.0010659070685505867, "entropy": -6.967658519744873, "entropy_coeff": 0.0}}, "num_steps_sampled": 2384400, "num_steps_trained": 2384400}, "done": false, "episodes_total": 2366, "training_iteration": 317, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-44", "timestamp": 1617635564, "time_this_iter_s": 1.4078943729400635, "time_total_s": 562.2063701152802, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 397.4199056625366, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 69.85, "ram_util_percent": 62.45}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 49.21774721786347, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.125470803728216, "MDD_min": 16.44008081487021, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033732556582787, "mean_inference_ms": 1.2788596993563914, "mean_action_processing_ms": 0.054483467019293276, "mean_env_wait_ms": 1.197080111358588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2392000, "timers": {"sample_time_ms": 1227.852, "sample_throughput": 6189.672, "learn_time_ms": 308.387, "learn_throughput": 24644.35, "update_time_ms": 2.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.349401336733507e-79, "cur_lr": 0.001, "total_loss": 0.4131969213485718, "policy_loss": -0.004068938724230975, "vf_loss": 0.4172658771276474, "vf_explained_var": 0.9812427759170532, "kl": 0.0028495548758655787, "entropy": -6.7457616329193115, "entropy_coeff": 0.0}}, "num_steps_sampled": 2392000, "num_steps_trained": 2392000}, "done": false, "episodes_total": 2385, "training_iteration": 318, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-46", "timestamp": 1617635566, "time_this_iter_s": 1.6452457904815674, "time_total_s": 563.8516159057617, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 399.0651514530182, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 71.5, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 139.0058069697987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 49.21774721786346, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.125470803728213, "MDD_min": 16.44008081487021, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [30.84968925085519, 56.71743656317014, 55.45703593984707, 45.947987656384186, 62.368804493633085, 30.254924152627158, 35.73254860552808, 51.387194948329515, 25.343585702652458, 36.23179419701746, 27.58789426587699, 72.97603037394832, 64.53783514892922, 139.0058069697987, 89.4695437084187, 45.97847413894648, 28.409617562672388, 50.59488597252616, 27.668584586667937, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033732556582787, "mean_inference_ms": 1.2788596993563914, "mean_action_processing_ms": 0.05448346701929327, "mean_env_wait_ms": 1.1970801113585878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2399600, "timers": {"sample_time_ms": 1229.237, "sample_throughput": 6182.697, "learn_time_ms": 308.532, "learn_throughput": 24632.766, "update_time_ms": 2.77}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.747006683667535e-80, "cur_lr": 0.001, "total_loss": 0.004152936860918999, "policy_loss": -0.029958748258650303, "vf_loss": 0.03411168046295643, "vf_explained_var": 0.9817458391189575, "kl": 0.001075306732673198, "entropy": -6.74277138710022, "entropy_coeff": 0.0}}, "num_steps_sampled": 2399600, "num_steps_trained": 2399600}, "done": false, "episodes_total": 2385, "training_iteration": 319, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-48", "timestamp": 1617635568, "time_this_iter_s": 1.433849573135376, "time_total_s": 565.2854654788971, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 400.49900102615356, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 65.33333333333333, "ram_util_percent": 62.29999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 98.21356104975987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 48.379260192405894, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.21128571270362, "MDD_min": 16.44008081487021, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20041832930152986, "mean_inference_ms": 1.2791838320133095, "mean_action_processing_ms": 0.05449933588005171, "mean_env_wait_ms": 1.1974065144973376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2407200, "timers": {"sample_time_ms": 1229.827, "sample_throughput": 6179.733, "learn_time_ms": 305.747, "learn_throughput": 24857.131, "update_time_ms": 2.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3735033418337674e-80, "cur_lr": 0.001, "total_loss": 0.4593151956796646, "policy_loss": -0.013584673404693604, "vf_loss": 0.4728998839855194, "vf_explained_var": 0.9860897064208984, "kl": 0.0011411105515435338, "entropy": -6.955123424530029, "entropy_coeff": 0.0}}, "num_steps_sampled": 2407200, "num_steps_trained": 2407200}, "done": false, "episodes_total": 2404, "training_iteration": 320, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-49", "timestamp": 1617635569, "time_this_iter_s": 1.5314030647277832, "time_total_s": 566.8168685436249, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345135f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 402.03040409088135, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 80.25, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 98.21356104975987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 48.379260192405894, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.211285712703624, "MDD_min": 16.44008081487021, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20041832930152986, "mean_inference_ms": 1.2791838320133093, "mean_action_processing_ms": 0.05449933588005171, "mean_env_wait_ms": 1.1974065144973378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2414800, "timers": {"sample_time_ms": 1219.247, "sample_throughput": 6233.357, "learn_time_ms": 306.738, "learn_throughput": 24776.828, "update_time_ms": 2.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6867516709168837e-80, "cur_lr": 0.001, "total_loss": 0.012542463839054108, "policy_loss": -0.003770791576243937, "vf_loss": 0.016313252970576286, "vf_explained_var": 0.9788058400154114, "kl": 0.0011405476834625006, "entropy": -6.755955696105957, "entropy_coeff": 0.0}}, "num_steps_sampled": 2414800, "num_steps_trained": 2414800}, "done": false, "episodes_total": 2404, "training_iteration": 321, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-51", "timestamp": 1617635571, "time_this_iter_s": 1.4066221714019775, "time_total_s": 568.2234907150269, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345133b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 403.4370262622833, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 98.21356104975987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 48.379260192405894, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.211285712703624, "MDD_min": 16.44008081487021, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [26.050065833107627, 68.54196369996927, 89.42042555270422, 42.28520823745176, 66.35200856226898, 55.01461103722362, 62.03819160360493, 40.961796575488826, 31.530103299591076, 35.85902260106976, 59.953604572787675, 42.63550155688971, 53.517559066956935, 30.791919874627023, 61.69216792551427, 36.11245757009426, 58.35393180766325, 67.2783323866623, 56.36232025976426, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20041832930152986, "mean_inference_ms": 1.2791838320133093, "mean_action_processing_ms": 0.05449933588005171, "mean_env_wait_ms": 1.1974065144973378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2422400, "timers": {"sample_time_ms": 1213.389, "sample_throughput": 6263.447, "learn_time_ms": 303.753, "learn_throughput": 25020.304, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.433758354584419e-81, "cur_lr": 0.001, "total_loss": 0.16034020483493805, "policy_loss": 0.00916056358255446, "vf_loss": 0.15117963403463364, "vf_explained_var": 0.991409420967102, "kl": 0.0010727614862844348, "entropy": -6.958603382110596, "entropy_coeff": 0.0}}, "num_steps_sampled": 2422400, "num_steps_trained": 2422400}, "done": false, "episodes_total": 2404, "training_iteration": 322, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-52", "timestamp": 1617635572, "time_this_iter_s": 1.4156980514526367, "time_total_s": 569.6391887664795, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 404.85272431373596, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 98.21356104975987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.492567379467275, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.971884894967538, "MDD_min": 15.031709357046477, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004327085450269, "mean_inference_ms": 1.2794721677340177, "mean_action_processing_ms": 0.05451381717818429, "mean_env_wait_ms": 1.1976977079729327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2430000, "timers": {"sample_time_ms": 1196.021, "sample_throughput": 6354.403, "learn_time_ms": 302.997, "learn_throughput": 25082.757, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.2168791772922093e-81, "cur_lr": 0.001, "total_loss": 0.398388996720314, "policy_loss": -0.004993156064301729, "vf_loss": 0.4033821225166321, "vf_explained_var": 0.9807758927345276, "kl": 0.0023255656706169248, "entropy": -6.721259593963623, "entropy_coeff": 0.0}}, "num_steps_sampled": 2430000, "num_steps_trained": 2430000}, "done": false, "episodes_total": 2423, "training_iteration": 323, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-54", "timestamp": 1617635574, "time_this_iter_s": 1.52937650680542, "time_total_s": 571.1685652732849, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 406.3821008205414, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 80.2, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 98.21356104975987, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.49256737946728, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.971884894967545, "MDD_min": 15.031709357046477, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [35.67162494410129, 42.823837563981456, 51.32409377725037, 62.05362523957564, 35.33655325768509, 56.916951199373905, 84.85773035876288, 51.40260857856586, 35.172795131975604, 33.626729436590615, 28.281728715870983, 40.944177001723794, 48.57324058839492, 25.713602770726116, 42.343170570212386, 50.08936198591427, 98.21356104975987, 68.90242869254794, 51.20454863790915, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004327085450269, "mean_inference_ms": 1.2794721677340177, "mean_action_processing_ms": 0.05451381717818429, "mean_env_wait_ms": 1.197697707972933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2437600, "timers": {"sample_time_ms": 1190.797, "sample_throughput": 6382.282, "learn_time_ms": 301.346, "learn_throughput": 25220.193, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1084395886461046e-81, "cur_lr": 0.001, "total_loss": 0.04092597961425781, "policy_loss": 0.004045326262712479, "vf_loss": 0.036880649626255035, "vf_explained_var": 0.9783256649971008, "kl": 0.0013516501639969647, "entropy": -6.736982583999634, "entropy_coeff": 0.0}}, "num_steps_sampled": 2437600, "num_steps_trained": 2437600}, "done": false, "episodes_total": 2423, "training_iteration": 324, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-55", "timestamp": 1617635575, "time_this_iter_s": 1.4135167598724365, "time_total_s": 572.5820820331573, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 407.7956175804138, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.39479243860677, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.536362286112805, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.705264285375407, "MDD_min": 15.031709357046477, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20049255317321016, "mean_inference_ms": 1.2797299130920659, "mean_action_processing_ms": 0.054527230043165134, "mean_env_wait_ms": 1.197945027925464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2445200, "timers": {"sample_time_ms": 1194.112, "sample_throughput": 6364.563, "learn_time_ms": 303.513, "learn_throughput": 25040.096, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0542197943230523e-81, "cur_lr": 0.001, "total_loss": 0.4899614155292511, "policy_loss": -0.0036767158890143037, "vf_loss": 0.4936380982398987, "vf_explained_var": 0.9859874844551086, "kl": 0.0010844485368579626, "entropy": -6.957994699478149, "entropy_coeff": 0.0}}, "num_steps_sampled": 2445200, "num_steps_trained": 2445200}, "done": false, "episodes_total": 2442, "training_iteration": 325, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-57", "timestamp": 1617635577, "time_this_iter_s": 1.6863436698913574, "time_total_s": 574.2684257030487, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 409.4819612503052, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.39479243860677, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.53636228611282, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.70526428537541, "MDD_min": 15.031709357046477, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004925531732102, "mean_inference_ms": 1.279729913092066, "mean_action_processing_ms": 0.05452723004316512, "mean_env_wait_ms": 1.197945027925464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2452800, "timers": {"sample_time_ms": 1178.133, "sample_throughput": 6450.887, "learn_time_ms": 303.032, "learn_throughput": 25079.886, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.271098971615262e-82, "cur_lr": 0.001, "total_loss": -0.002098417840898037, "policy_loss": -0.01893114554695785, "vf_loss": 0.016832728870213032, "vf_explained_var": 0.9767160415649414, "kl": 0.0014883495168760419, "entropy": -6.723634243011475, "entropy_coeff": 0.0}}, "num_steps_sampled": 2452800, "num_steps_trained": 2452800}, "done": false, "episodes_total": 2442, "training_iteration": 326, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-12-58", "timestamp": 1617635578, "time_this_iter_s": 1.4368205070495605, "time_total_s": 575.7052462100983, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 410.91878175735474, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 63.46666666666667, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.39479243860677, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.53636228611282, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.70526428537541, "MDD_min": 15.031709357046477, "MDD_max": 35.39342390301184}, "hist_stats": {"episode_reward": [38.96910131387993, 83.59297292625938, 39.933271738159505, 29.008983317022473, 39.67691432710744, 50.62891336729998, 53.881048686929226, 79.95710789430228, 55.152754255905684, 50.525416338799, 39.2366900404793, 60.3846485695228, 41.69521713972587, 50.582550293542525, 59.599446065853165, 22.049446949846693, 51.38950376460982, 29.74429997087478, 40.686940523373366, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004925531732102, "mean_inference_ms": 1.279729913092066, "mean_action_processing_ms": 0.05452723004316512, "mean_env_wait_ms": 1.197945027925464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2460400, "timers": {"sample_time_ms": 1178.292, "sample_throughput": 6450.016, "learn_time_ms": 303.737, "learn_throughput": 25021.657, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.635549485807631e-82, "cur_lr": 0.001, "total_loss": 0.14134994894266129, "policy_loss": 0.006850683595985174, "vf_loss": 0.13449925929307938, "vf_explained_var": 0.9925805330276489, "kl": 0.0009703040414024144, "entropy": -6.958559036254883, "entropy_coeff": 0.0}}, "num_steps_sampled": 2460400, "num_steps_trained": 2460400}, "done": false, "episodes_total": 2442, "training_iteration": 327, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-00", "timestamp": 1617635580, "time_this_iter_s": 1.4162797927856445, "time_total_s": 577.1215260028839, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 412.3350615501404, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 73.5, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.39479243860677, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.229994312851396, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.085462346061284, "MDD_min": 15.031709357046477, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20048704232752315, "mean_inference_ms": 1.2798220511837786, "mean_action_processing_ms": 0.054534570123114016, "mean_env_wait_ms": 1.1980501109468047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2468000, "timers": {"sample_time_ms": 1166.642, "sample_throughput": 6514.421, "learn_time_ms": 303.242, "learn_throughput": 25062.496, "update_time_ms": 2.815}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3177747429038154e-82, "cur_lr": 0.001, "total_loss": 0.34039686620235443, "policy_loss": 0.006214627763256431, "vf_loss": 0.3341822624206543, "vf_explained_var": 0.9833924770355225, "kl": 0.0025216354988515377, "entropy": -6.719146728515625, "entropy_coeff": 0.0}}, "num_steps_sampled": 2468000, "num_steps_trained": 2468000}, "done": false, "episodes_total": 2461, "training_iteration": 328, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-01", "timestamp": 1617635581, "time_this_iter_s": 1.5239121913909912, "time_total_s": 578.6454381942749, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345160e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 413.8589737415314, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 80.25, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 87.39479243860677, "episode_reward_min": 21.61212730069486, "episode_reward_mean": 47.22999431285139, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.08546234606128, "MDD_min": 15.031709357046477, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [21.61212730069486, 57.07473278179073, 24.31237277640916, 29.305450270353163, 48.87572715746264, 60.63262798604363, 52.35452111116194, 76.51209238661724, 76.98662854622975, 32.07314894738955, 33.12055580183105, 24.139335082130046, 30.89100221945483, 34.80383367726005, 44.66107952940985, 87.39479243860677, 36.19696035141066, 37.721617441139216, 46.746217781088646, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004870423275231, "mean_inference_ms": 1.2798220511837786, "mean_action_processing_ms": 0.054534570123114016, "mean_env_wait_ms": 1.198050110946805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2475600, "timers": {"sample_time_ms": 1164.864, "sample_throughput": 6524.365, "learn_time_ms": 303.263, "learn_throughput": 25060.731, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.588873714519077e-83, "cur_lr": 0.001, "total_loss": 0.0337258018553257, "policy_loss": 0.0005505714798346162, "vf_loss": 0.03317523002624512, "vf_explained_var": 0.9798658490180969, "kl": 0.0018135499558411539, "entropy": -6.730707406997681, "entropy_coeff": 0.0}}, "num_steps_sampled": 2475600, "num_steps_trained": 2475600}, "done": false, "episodes_total": 2461, "training_iteration": 329, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-02", "timestamp": 1617635582, "time_this_iter_s": 1.4169676303863525, "time_total_s": 580.0624058246613, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 415.2759413719177, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 73.8, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 85.14050737221444, "episode_reward_min": 23.489941095764248, "episode_reward_mean": 47.966208340587485, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.911276612267642, "MDD_min": 15.031709357046477, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20051103135228485, "mean_inference_ms": 1.2798203305192373, "mean_action_processing_ms": 0.05453595545800918, "mean_env_wait_ms": 1.1980637284550755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2483200, "timers": {"sample_time_ms": 1164.985, "sample_throughput": 6523.689, "learn_time_ms": 303.175, "learn_throughput": 25068.07, "update_time_ms": 2.89}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2944368572595385e-83, "cur_lr": 0.001, "total_loss": 0.5112334191799164, "policy_loss": 0.005034377914853394, "vf_loss": 0.5061990469694138, "vf_explained_var": 0.985488772392273, "kl": 0.001332694257143885, "entropy": -6.948613882064819, "entropy_coeff": 0.0}}, "num_steps_sampled": 2483200, "num_steps_trained": 2483200}, "done": false, "episodes_total": 2480, "training_iteration": 330, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-04", "timestamp": 1617635584, "time_this_iter_s": 1.5316317081451416, "time_total_s": 581.5940375328064, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 416.80757308006287, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 79.25, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 85.14050737221444, "episode_reward_min": 23.489941095764248, "episode_reward_mean": 47.966208340587464, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.911276612267642, "MDD_min": 15.031709357046477, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005110313522848, "mean_inference_ms": 1.2798203305192373, "mean_action_processing_ms": 0.05453595545800918, "mean_env_wait_ms": 1.1980637284550752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2490800, "timers": {"sample_time_ms": 1165.657, "sample_throughput": 6519.926, "learn_time_ms": 302.326, "learn_throughput": 25138.442, "update_time_ms": 2.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6472184286297693e-83, "cur_lr": 0.001, "total_loss": 0.01209519524127245, "policy_loss": -0.0033747278503142297, "vf_loss": 0.015469922218471766, "vf_explained_var": 0.9796614646911621, "kl": 0.001783883257303387, "entropy": -6.714630842208862, "entropy_coeff": 0.0}}, "num_steps_sampled": 2490800, "num_steps_trained": 2490800}, "done": false, "episodes_total": 2480, "training_iteration": 331, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-05", "timestamp": 1617635585, "time_this_iter_s": 1.4044568538665771, "time_total_s": 582.998494386673, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 418.21202993392944, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 72.15, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 85.14050737221444, "episode_reward_min": 23.489941095764248, "episode_reward_mean": 47.966208340587464, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.911276612267642, "MDD_min": 15.031709357046477, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [73.89713009245034, 48.14085486431069, 23.489941095764248, 54.11851355812679, 45.29499534352678, 34.523928459770595, 64.71257866612116, 39.15814204047767, 26.78917994521488, 31.520487730272855, 27.501274573024144, 28.51228564572276, 50.058972754418676, 71.71134342988546, 66.31348475878376, 36.07774109806147, 76.40228455019408, 56.85333553377325, 41.10192669559277, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005110313522848, "mean_inference_ms": 1.2798203305192373, "mean_action_processing_ms": 0.05453595545800918, "mean_env_wait_ms": 1.1980637284550752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2498400, "timers": {"sample_time_ms": 1166.308, "sample_throughput": 6516.289, "learn_time_ms": 302.448, "learn_throughput": 25128.298, "update_time_ms": 2.855}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.236092143148846e-84, "cur_lr": 0.001, "total_loss": 0.13446403667330742, "policy_loss": -0.01082903565838933, "vf_loss": 0.14529307186603546, "vf_explained_var": 0.9913800954818726, "kl": 0.002599567174911499, "entropy": -6.965705871582031, "entropy_coeff": 0.0}}, "num_steps_sampled": 2498400, "num_steps_trained": 2498400}, "done": false, "episodes_total": 2480, "training_iteration": 332, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-07", "timestamp": 1617635587, "time_this_iter_s": 1.4236316680908203, "time_total_s": 584.4221260547638, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 419.63566160202026, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 72.05, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.80426018421824, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 47.72774974084755, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.456011247620793, "MDD_min": 14.14925333080601, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20048561570626652, "mean_inference_ms": 1.2797643585998266, "mean_action_processing_ms": 0.05453464375897596, "mean_env_wait_ms": 1.1980157524245605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2506000, "timers": {"sample_time_ms": 1165.523, "sample_throughput": 6520.678, "learn_time_ms": 302.201, "learn_throughput": 25148.79, "update_time_ms": 2.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.118046071574423e-84, "cur_lr": 0.001, "total_loss": 0.3891655504703522, "policy_loss": -0.017999529372900724, "vf_loss": 0.4071650803089142, "vf_explained_var": 0.9797364473342896, "kl": 0.0011915728391613811, "entropy": -6.773964881896973, "entropy_coeff": 0.0}}, "num_steps_sampled": 2506000, "num_steps_trained": 2506000}, "done": false, "episodes_total": 2499, "training_iteration": 333, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-08", "timestamp": 1617635588, "time_this_iter_s": 1.518028736114502, "time_total_s": 585.9401547908783, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a47a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 421.15369033813477, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 71.65, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.80426018421824, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 47.727749740847564, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.456011247620793, "MDD_min": 14.14925333080601, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [33.390217844708694, 45.280196037958575, 38.66131293695669, 54.70132651796026, 69.40095247317345, 34.07028525306356, 41.381616145768376, 54.87266567134096, 63.71778906337212, 41.51352439597889, 33.92702222862819, 40.28231776543463, 27.94675307980999, 31.093043153001517, 34.54274112293739, 47.912947136170175, 65.86994317494636, 53.771904288357234, 48.409371411300555, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20048561570626655, "mean_inference_ms": 1.2797643585998266, "mean_action_processing_ms": 0.05453464375897596, "mean_env_wait_ms": 1.1980157524245607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2513600, "timers": {"sample_time_ms": 1165.848, "sample_throughput": 6518.858, "learn_time_ms": 302.917, "learn_throughput": 25089.414, "update_time_ms": 2.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0590230357872116e-84, "cur_lr": 0.001, "total_loss": 0.03829975239932537, "policy_loss": 0.004609704366885126, "vf_loss": 0.03369004651904106, "vf_explained_var": 0.9785844087600708, "kl": 0.0019137742347083986, "entropy": -6.749844312667847, "entropy_coeff": 0.0}}, "num_steps_sampled": 2513600, "num_steps_trained": 2513600}, "done": false, "episodes_total": 2499, "training_iteration": 334, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-10", "timestamp": 1617635590, "time_this_iter_s": 1.4233064651489258, "time_total_s": 587.3634612560272, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 422.5769968032837, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.93101092534444, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 48.79138921920418, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.32980512124928, "MDD_min": 14.14925333080601, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20050898690943733, "mean_inference_ms": 1.279734058608987, "mean_action_processing_ms": 0.05453527036344366, "mean_env_wait_ms": 1.1979853145951993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2521200, "timers": {"sample_time_ms": 1158.659, "sample_throughput": 6559.308, "learn_time_ms": 301.083, "learn_throughput": 25242.228, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0295115178936058e-84, "cur_lr": 0.001, "total_loss": 0.5661191940307617, "policy_loss": -0.015743832103908062, "vf_loss": 0.5818629860877991, "vf_explained_var": 0.9820874929428101, "kl": 0.002698712865822017, "entropy": -6.972442626953125, "entropy_coeff": 0.0}}, "num_steps_sampled": 2521200, "num_steps_trained": 2521200}, "done": false, "episodes_total": 2518, "training_iteration": 335, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-11", "timestamp": 1617635591, "time_this_iter_s": 1.5970542430877686, "time_total_s": 588.960515499115, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 424.17405104637146, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 68.03333333333333, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.93101092534444, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 48.791389219204184, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.32980512124928, "MDD_min": 14.14925333080601, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005089869094374, "mean_inference_ms": 1.279734058608987, "mean_action_processing_ms": 0.05453527036344366, "mean_env_wait_ms": 1.1979853145951993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2528800, "timers": {"sample_time_ms": 1155.719, "sample_throughput": 6575.99, "learn_time_ms": 301.361, "learn_throughput": 25218.914, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.147557589468029e-85, "cur_lr": 0.001, "total_loss": 0.006662897299975157, "policy_loss": -0.00942787085659802, "vf_loss": 0.01609077211469412, "vf_explained_var": 0.9777801036834717, "kl": 0.0007023986254353076, "entropy": -6.753580570220947, "entropy_coeff": 0.0}}, "num_steps_sampled": 2528800, "num_steps_trained": 2528800}, "done": false, "episodes_total": 2518, "training_iteration": 336, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-13", "timestamp": 1617635593, "time_this_iter_s": 1.4100842475891113, "time_total_s": 590.3705997467041, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 425.58413529396057, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 73.3, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 95.93101092534444, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 48.791389219204184, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.32980512124928, "MDD_min": 14.14925333080601, "MDD_max": 35.83709503570122}, "hist_stats": {"episode_reward": [36.92248355333069, 72.87837104242607, 34.71824551224649, 47.11037935925061, 85.14050737221444, 37.09408808620783, 49.60186563525058, 38.667993295090476, 57.71256936679976, 29.237967382171334, 78.04580154344393, 47.56545472257661, 48.25759234950533, 58.7993767940044, 46.372031434331994, 44.022301483658325, 40.49966096027143, 34.4964861329237, 49.43414952483596, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005089869094374, "mean_inference_ms": 1.279734058608987, "mean_action_processing_ms": 0.05453527036344366, "mean_env_wait_ms": 1.1979853145951993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2536400, "timers": {"sample_time_ms": 1155.865, "sample_throughput": 6575.165, "learn_time_ms": 300.6, "learn_throughput": 25282.749, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5737787947340145e-85, "cur_lr": 0.001, "total_loss": 0.18820687383413315, "policy_loss": -0.011385848512873054, "vf_loss": 0.199592724442482, "vf_explained_var": 0.9885936975479126, "kl": 0.0013596551725640893, "entropy": -6.98628306388855, "entropy_coeff": 0.0}}, "num_steps_sampled": 2536400, "num_steps_trained": 2536400}, "done": false, "episodes_total": 2518, "training_iteration": 337, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-14", "timestamp": 1617635594, "time_this_iter_s": 1.4106342792510986, "time_total_s": 591.7812340259552, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 426.99476957321167, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 49.30791268464339, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.59965537131525, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20048234525815423, "mean_inference_ms": 1.2796347440079594, "mean_action_processing_ms": 0.054531251377312386, "mean_env_wait_ms": 1.1978844148287624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2544000, "timers": {"sample_time_ms": 1157.232, "sample_throughput": 6567.398, "learn_time_ms": 301.354, "learn_throughput": 25219.469, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2868893973670072e-85, "cur_lr": 0.001, "total_loss": 0.5058485567569733, "policy_loss": 0.009579519974067807, "vf_loss": 0.49626901745796204, "vf_explained_var": 0.9747654795646667, "kl": 0.002977353986352682, "entropy": -6.689307689666748, "entropy_coeff": 0.0}}, "num_steps_sampled": 2544000, "num_steps_trained": 2544000}, "done": false, "episodes_total": 2537, "training_iteration": 338, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-16", "timestamp": 1617635596, "time_this_iter_s": 1.5450842380523682, "time_total_s": 593.3263182640076, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 428.53985381126404, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 80.6, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 49.30791268464338, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.59965537131525, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [59.21613194244087, 37.86816801883165, 52.838104334079304, 78.05932117807684, 60.042795980975086, 41.368312301901234, 42.147284674419765, 44.15786683266012, 52.17654058347377, 39.43094632943137, 31.712626690615203, 55.193877581360894, 50.39515724791216, 35.086646692543866, 38.29096755619873, 34.99069939715931, 45.407949904186026, 56.17033966107229, 42.52320373014558, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20048234525815423, "mean_inference_ms": 1.2796347440079596, "mean_action_processing_ms": 0.05453125137731237, "mean_env_wait_ms": 1.1978844148287626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2551600, "timers": {"sample_time_ms": 1157.132, "sample_throughput": 6567.964, "learn_time_ms": 301.252, "learn_throughput": 25228.072, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.434446986835036e-86, "cur_lr": 0.001, "total_loss": 0.032597633078694344, "policy_loss": 0.0004911338910460472, "vf_loss": 0.032106502912938595, "vf_explained_var": 0.9754320383071899, "kl": 0.0007309839420486242, "entropy": -6.741515159606934, "entropy_coeff": 0.0}}, "num_steps_sampled": 2551600, "num_steps_trained": 2551600}, "done": false, "episodes_total": 2537, "training_iteration": 339, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-17", "timestamp": 1617635597, "time_this_iter_s": 1.4151337146759033, "time_total_s": 594.7414519786835, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a47a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 429.95498752593994, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 74.1, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 48.77692206326785, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.559196835150257, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20050215359253573, "mean_inference_ms": 1.2795272562658453, "mean_action_processing_ms": 0.054526916775246737, "mean_env_wait_ms": 1.1977761142216792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2559200, "timers": {"sample_time_ms": 1156.194, "sample_throughput": 6573.292, "learn_time_ms": 301.598, "learn_throughput": 25199.138, "update_time_ms": 2.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.217223493417518e-86, "cur_lr": 0.001, "total_loss": 0.4336870312690735, "policy_loss": -0.004417828400619328, "vf_loss": 0.43810488283634186, "vf_explained_var": 0.9865171909332275, "kl": 0.0012929936056025326, "entropy": -6.9866437911987305, "entropy_coeff": 0.0}}, "num_steps_sampled": 2559200, "num_steps_trained": 2559200}, "done": false, "episodes_total": 2556, "training_iteration": 340, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-19", "timestamp": 1617635599, "time_this_iter_s": 1.5262727737426758, "time_total_s": 596.2677247524261, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 431.4812602996826, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 73.15, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 48.77692206326784, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.55919683515025, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005021535925357, "mean_inference_ms": 1.279527256265845, "mean_action_processing_ms": 0.05452691677524672, "mean_env_wait_ms": 1.197776114221679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2566800, "timers": {"sample_time_ms": 1156.088, "sample_throughput": 6573.892, "learn_time_ms": 301.974, "learn_throughput": 25167.717, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.608611746708759e-86, "cur_lr": 0.001, "total_loss": 0.010088663315400481, "policy_loss": -0.005264744977466762, "vf_loss": 0.015353405848145485, "vf_explained_var": 0.9792056083679199, "kl": 0.0021986658102832735, "entropy": -6.758182525634766, "entropy_coeff": 0.0}}, "num_steps_sampled": 2566800, "num_steps_trained": 2566800}, "done": false, "episodes_total": 2556, "training_iteration": 341, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-20", "timestamp": 1617635600, "time_this_iter_s": 1.4076035022735596, "time_total_s": 597.6753282546997, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 432.8888638019562, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 71.7, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 21.094974279281946, "episode_reward_mean": 48.77692206326784, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.55919683515025, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [53.50321026433439, 67.1917739601832, 54.20971735421709, 42.462100298400635, 59.63920909713584, 29.857847157450923, 33.017931130390714, 35.92270370986952, 50.199642285838266, 26.96213356243668, 43.504111397454224, 56.91663911574689, 48.648432951211156, 65.74600057913524, 80.58925400672537, 42.35125617730514, 60.71753038238957, 51.27444319281772, 48.908566251441755, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005021535925357, "mean_inference_ms": 1.279527256265845, "mean_action_processing_ms": 0.05452691677524672, "mean_env_wait_ms": 1.197776114221679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2574400, "timers": {"sample_time_ms": 1154.302, "sample_throughput": 6584.066, "learn_time_ms": 302.035, "learn_throughput": 25162.617, "update_time_ms": 2.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.043058733543795e-87, "cur_lr": 0.001, "total_loss": 0.16683534532785416, "policy_loss": -0.008719627861864865, "vf_loss": 0.17555496096611023, "vf_explained_var": 0.9897516965866089, "kl": 0.0012190770939923823, "entropy": -7.017350196838379, "entropy_coeff": 0.0}}, "num_steps_sampled": 2574400, "num_steps_trained": 2574400}, "done": false, "episodes_total": 2556, "training_iteration": 342, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-22", "timestamp": 1617635602, "time_this_iter_s": 1.405900239944458, "time_total_s": 599.0812284946442, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345168c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 434.29476404190063, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 19.307784100062616, "episode_reward_mean": 48.546021720524635, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.38537197046269, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20046837062655784, "mean_inference_ms": 1.2794132385419121, "mean_action_processing_ms": 0.05452243882812771, "mean_env_wait_ms": 1.1976680328630984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2582000, "timers": {"sample_time_ms": 1154.512, "sample_throughput": 6582.868, "learn_time_ms": 302.498, "learn_throughput": 25124.121, "update_time_ms": 2.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.021529366771898e-87, "cur_lr": 0.001, "total_loss": 0.42664553225040436, "policy_loss": 0.003589633182855323, "vf_loss": 0.42305588722229004, "vf_explained_var": 0.9804354310035706, "kl": 0.0020392813021317124, "entropy": -6.806823968887329, "entropy_coeff": 0.0}}, "num_steps_sampled": 2582000, "num_steps_trained": 2582000}, "done": false, "episodes_total": 2575, "training_iteration": 343, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-23", "timestamp": 1617635603, "time_this_iter_s": 1.5252339839935303, "time_total_s": 600.6064624786377, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 435.81999802589417, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 19.307784100062616, "episode_reward_mean": 48.54602172052464, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.385371970462693, "MDD_min": 14.14925333080601, "MDD_max": 36.757154876647874}, "hist_stats": {"episode_reward": [48.945870217478706, 45.990200350649886, 45.11382086974434, 79.77980246619923, 34.59004055580792, 69.02108528435423, 28.966616283583733, 37.57091737095731, 50.37364132782146, 72.47079569367473, 28.17488547333471, 50.127332747745434, 36.08626884711183, 21.094974279281946, 27.972147966092834, 55.04372726158697, 51.2908908947913, 50.701651635151336, 95.80426018421824, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20046837062655787, "mean_inference_ms": 1.2794132385419121, "mean_action_processing_ms": 0.054522438828127726, "mean_env_wait_ms": 1.1976680328630984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2589600, "timers": {"sample_time_ms": 1155.473, "sample_throughput": 6577.395, "learn_time_ms": 302.034, "learn_throughput": 25162.734, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.010764683385949e-87, "cur_lr": 0.001, "total_loss": 0.033833994530141354, "policy_loss": -0.0026779385225381702, "vf_loss": 0.03651193156838417, "vf_explained_var": 0.9751604795455933, "kl": 0.0018975073471665382, "entropy": -6.782882928848267, "entropy_coeff": 0.0}}, "num_steps_sampled": 2589600, "num_steps_trained": 2589600}, "done": false, "episodes_total": 2575, "training_iteration": 344, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-25", "timestamp": 1617635605, "time_this_iter_s": 1.4283447265625, "time_total_s": 602.0348072052002, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 437.24834275245667, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 71.65, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 48.489406776888806, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.88276996735801, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20048309489611033, "mean_inference_ms": 1.2792932540445043, "mean_action_processing_ms": 0.05451732117160893, "mean_env_wait_ms": 1.1975544679131997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2597200, "timers": {"sample_time_ms": 1148.182, "sample_throughput": 6619.162, "learn_time_ms": 301.928, "learn_throughput": 25171.547, "update_time_ms": 2.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0053823416929744e-87, "cur_lr": 0.001, "total_loss": 0.5328610241413116, "policy_loss": 0.005880449200049043, "vf_loss": 0.5269805490970612, "vf_explained_var": 0.9852026700973511, "kl": 0.0018950941157527268, "entropy": -6.994634628295898, "entropy_coeff": 0.0}}, "num_steps_sampled": 2597200, "num_steps_trained": 2597200}, "done": false, "episodes_total": 2594, "training_iteration": 345, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-26", "timestamp": 1617635606, "time_this_iter_s": 1.522470235824585, "time_total_s": 603.5572774410248, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 438.77081298828125, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 69.43333333333334, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 48.489406776888806, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.88276996735801, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004830948961103, "mean_inference_ms": 1.2792932540445043, "mean_action_processing_ms": 0.05451732117160894, "mean_env_wait_ms": 1.1975544679131997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2604800, "timers": {"sample_time_ms": 1148.474, "sample_throughput": 6617.477, "learn_time_ms": 301.996, "learn_throughput": 25165.879, "update_time_ms": 2.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.026911708464872e-88, "cur_lr": 0.001, "total_loss": 0.022001192905008793, "policy_loss": 0.006179525691550225, "vf_loss": 0.015821662731468678, "vf_explained_var": 0.9801712036132812, "kl": 0.0017691795947030187, "entropy": -6.85368537902832, "entropy_coeff": 0.0}}, "num_steps_sampled": 2604800, "num_steps_trained": 2604800}, "done": false, "episodes_total": 2594, "training_iteration": 346, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-28", "timestamp": 1617635608, "time_this_iter_s": 1.4129688739776611, "time_total_s": 604.9702463150024, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345169e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 440.1837818622589, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 48.489406776888806, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.88276996735801, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [26.582395775568873, 63.78249887435804, 40.63846562615104, 30.068427143146984, 36.56155819256922, 32.12658194867388, 37.07688042485813, 36.71935932570286, 48.94995629443665, 61.67058919453226, 23.30778961221403, 69.89135342590455, 67.00636595722547, 54.907634688877714, 52.60294647351134, 38.33718045424409, 34.72662060012844, 31.745350560064956, 38.82115177964474, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004830948961103, "mean_inference_ms": 1.2792932540445043, "mean_action_processing_ms": 0.05451732117160894, "mean_env_wait_ms": 1.1975544679131997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2612400, "timers": {"sample_time_ms": 1148.464, "sample_throughput": 6617.537, "learn_time_ms": 301.808, "learn_throughput": 25181.543, "update_time_ms": 2.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.513455854232436e-88, "cur_lr": 0.001, "total_loss": 0.19739793241024017, "policy_loss": 0.011830734554678202, "vf_loss": 0.185567207634449, "vf_explained_var": 0.9895379543304443, "kl": 0.001600630464963615, "entropy": -7.006237983703613, "entropy_coeff": 0.0}}, "num_steps_sampled": 2612400, "num_steps_trained": 2612400}, "done": false, "episodes_total": 2594, "training_iteration": 347, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-29", "timestamp": 1617635609, "time_this_iter_s": 1.4090032577514648, "time_total_s": 606.3792495727539, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 441.5927851200104, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.83931041744681, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.8019178580052, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20044726427726428, "mean_inference_ms": 1.2791666005440196, "mean_action_processing_ms": 0.054510803955432514, "mean_env_wait_ms": 1.1974402167803024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2620000, "timers": {"sample_time_ms": 1147.971, "sample_throughput": 6620.376, "learn_time_ms": 301.797, "learn_throughput": 25182.499, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.256727927116218e-88, "cur_lr": 0.001, "total_loss": 0.4306820034980774, "policy_loss": -0.006119103753007948, "vf_loss": 0.43680110573768616, "vf_explained_var": 0.9819602966308594, "kl": 0.0009750113822519779, "entropy": -6.854593992233276, "entropy_coeff": 0.0}}, "num_steps_sampled": 2620000, "num_steps_trained": 2620000}, "done": false, "episodes_total": 2613, "training_iteration": 348, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-31", "timestamp": 1617635611, "time_this_iter_s": 1.5396509170532227, "time_total_s": 607.9189004898071, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 443.1324360370636, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 80.15, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.50322434696807, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.839310417446825, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.801917858005194, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [62.82828122904585, 46.808662239967376, 39.06434850664886, 94.58781389550282, 95.93101092534444, 30.431462274219157, 48.09597558322452, 124.50322434696807, 62.17029717888663, 33.17777633513662, 27.49262034963137, 68.5462608806904, 37.46531121098969, 36.346544573156436, 76.78015675752778, 39.23156808665985, 45.17031325024956, 61.913008708029466, 62.9138488922383, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20044726427726423, "mean_inference_ms": 1.2791666005440194, "mean_action_processing_ms": 0.05451080395543253, "mean_env_wait_ms": 1.1974402167803024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2627600, "timers": {"sample_time_ms": 1147.574, "sample_throughput": 6622.668, "learn_time_ms": 301.161, "learn_throughput": 25235.633, "update_time_ms": 2.833}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.28363963558109e-89, "cur_lr": 0.001, "total_loss": 0.056305560283362865, "policy_loss": 0.019391880836337805, "vf_loss": 0.0369136780500412, "vf_explained_var": 0.9768822193145752, "kl": 0.0014060878311283886, "entropy": -6.803177356719971, "entropy_coeff": 0.0}}, "num_steps_sampled": 2627600, "num_steps_trained": 2627600}, "done": false, "episodes_total": 2613, "training_iteration": 349, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-32", "timestamp": 1617635612, "time_this_iter_s": 1.4047355651855469, "time_total_s": 609.3236360549927, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 444.53717160224915, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 73.15, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.16997567002087, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.76191953911501, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20045666941001614, "mean_inference_ms": 1.2790371328162045, "mean_action_processing_ms": 0.05450474008172228, "mean_env_wait_ms": 1.1973265095981052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2635200, "timers": {"sample_time_ms": 1147.933, "sample_throughput": 6620.598, "learn_time_ms": 300.565, "learn_throughput": 25285.677, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.141819817790545e-89, "cur_lr": 0.001, "total_loss": 0.7013296782970428, "policy_loss": 0.005029188352636993, "vf_loss": 0.6963004767894745, "vf_explained_var": 0.9818135499954224, "kl": 0.001525243977084756, "entropy": -7.00151252746582, "entropy_coeff": 0.0}}, "num_steps_sampled": 2635200, "num_steps_trained": 2635200}, "done": false, "episodes_total": 2632, "training_iteration": 350, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-34", "timestamp": 1617635614, "time_this_iter_s": 1.5247058868408203, "time_total_s": 610.8483419418335, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aecb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 446.06187748908997, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 74.0, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.16997567002086, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.761919539115016, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20045666941001616, "mean_inference_ms": 1.279037132816205, "mean_action_processing_ms": 0.05450474008172228, "mean_env_wait_ms": 1.1973265095981052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2642800, "timers": {"sample_time_ms": 1148.939, "sample_throughput": 6614.801, "learn_time_ms": 300.743, "learn_throughput": 25270.715, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5709099088952725e-89, "cur_lr": 0.001, "total_loss": 0.019193666987121105, "policy_loss": 0.0035292820539325476, "vf_loss": 0.0156643851660192, "vf_explained_var": 0.9838880300521851, "kl": 0.0010451087728142738, "entropy": -6.909056663513184, "entropy_coeff": 0.0}}, "num_steps_sampled": 2642800, "num_steps_trained": 2642800}, "done": false, "episodes_total": 2632, "training_iteration": 351, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-35", "timestamp": 1617635615, "time_this_iter_s": 1.4191465377807617, "time_total_s": 612.2674884796143, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 447.4810240268707, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 71.2, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.16997567002086, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.761919539115016, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [56.88638502598857, 24.825295921831945, 28.913758678318143, 60.374729517775215, 62.99113452293907, 42.641707062998066, 50.900884718506035, 40.79297691156334, 40.49207078207541, 69.62455164157339, 50.3304803050308, 41.0015105462409, 55.86271171760929, 33.04596936907367, 40.551072231242195, 41.33079942551141, 30.216257539758104, 51.92387812613416, 57.57013712876152, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20045666941001616, "mean_inference_ms": 1.279037132816205, "mean_action_processing_ms": 0.05450474008172228, "mean_env_wait_ms": 1.1973265095981052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2650400, "timers": {"sample_time_ms": 1148.784, "sample_throughput": 6615.69, "learn_time_ms": 300.94, "learn_throughput": 25254.216, "update_time_ms": 2.871}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.854549544476363e-90, "cur_lr": 0.001, "total_loss": 0.12625235691666603, "policy_loss": -0.003656161075923592, "vf_loss": 0.1299085095524788, "vf_explained_var": 0.993224561214447, "kl": 0.0010485808015801013, "entropy": -7.028705835342407, "entropy_coeff": 0.0}}, "num_steps_sampled": 2650400, "num_steps_trained": 2650400}, "done": false, "episodes_total": 2632, "training_iteration": 352, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-36", "timestamp": 1617635616, "time_this_iter_s": 1.4069740772247314, "time_total_s": 613.674462556839, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 448.88799810409546, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 72.2, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 48.65570874029984, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.86186103262714, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2004186069906034, "mean_inference_ms": 1.2789030806916408, "mean_action_processing_ms": 0.05449898831582116, "mean_env_wait_ms": 1.1972058770589187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2658000, "timers": {"sample_time_ms": 1150.032, "sample_throughput": 6608.51, "learn_time_ms": 300.748, "learn_throughput": 25270.349, "update_time_ms": 2.902}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.9272747722381812e-90, "cur_lr": 0.001, "total_loss": 0.3334386646747589, "policy_loss": -0.015481763985008001, "vf_loss": 0.34892039000988007, "vf_explained_var": 0.9858768582344055, "kl": 0.002182368072681129, "entropy": -6.881891489028931, "entropy_coeff": 0.0}}, "num_steps_sampled": 2658000, "num_steps_trained": 2658000}, "done": false, "episodes_total": 2651, "training_iteration": 353, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-38", "timestamp": 1617635618, "time_this_iter_s": 1.5352003574371338, "time_total_s": 615.2096629142761, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 450.4231984615326, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 70.85, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 48.655708740299836, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.86186103262713, "MDD_min": 15.18704652448192, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [21.767933581480822, 35.13731498017849, 28.52248529167484, 58.800381160780674, 53.46475597973766, 55.59599043129367, 48.91283416394453, 39.8693485200926, 58.43145361558276, 24.727242145404485, 40.02640105885428, 76.29999850604246, 40.66505971590889, 29.711788387100132, 82.58354116223937, 43.86591884830373, 64.1253860628088, 19.307784100062616, 49.01703144303414, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20041860699060343, "mean_inference_ms": 1.2789030806916408, "mean_action_processing_ms": 0.05449898831582115, "mean_env_wait_ms": 1.1972058770589187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2665600, "timers": {"sample_time_ms": 1147.465, "sample_throughput": 6623.298, "learn_time_ms": 301.098, "learn_throughput": 25240.982, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9636373861190906e-90, "cur_lr": 0.001, "total_loss": 0.036458276212215424, "policy_loss": -0.001979687818675302, "vf_loss": 0.038437968119978905, "vf_explained_var": 0.977784276008606, "kl": 0.0010563135438133031, "entropy": -6.8071205615997314, "entropy_coeff": 0.0}}, "num_steps_sampled": 2665600, "num_steps_trained": 2665600}, "done": false, "episodes_total": 2651, "training_iteration": 354, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-39", "timestamp": 1617635619, "time_this_iter_s": 1.4056622982025146, "time_total_s": 616.6153252124786, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aeb90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 451.8288607597351, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 73.15, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.87677518199079, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.491854185738653, "MDD_min": 13.545113658123237, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20042677221684924, "mean_inference_ms": 1.2787791672222866, "mean_action_processing_ms": 0.05449390803405072, "mean_env_wait_ms": 1.1971000078119935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2673200, "timers": {"sample_time_ms": 1146.768, "sample_throughput": 6627.321, "learn_time_ms": 302.373, "learn_throughput": 25134.485, "update_time_ms": 2.897}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.818186930595453e-91, "cur_lr": 0.001, "total_loss": 0.5917851030826569, "policy_loss": -0.010556301102042198, "vf_loss": 0.6023414134979248, "vf_explained_var": 0.9852765798568726, "kl": 0.0015409091138280928, "entropy": -7.0402092933654785, "entropy_coeff": 0.0}}, "num_steps_sampled": 2673200, "num_steps_trained": 2673200}, "done": false, "episodes_total": 2670, "training_iteration": 355, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-41", "timestamp": 1617635621, "time_this_iter_s": 1.528982162475586, "time_total_s": 618.1443073749542, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 453.3578429222107, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 70.6, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.876775181990794, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.491854185738656, "MDD_min": 13.545113658123237, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20042677221684924, "mean_inference_ms": 1.2787791672222866, "mean_action_processing_ms": 0.054493908034050735, "mean_env_wait_ms": 1.1971000078119935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2680800, "timers": {"sample_time_ms": 1146.574, "sample_throughput": 6628.44, "learn_time_ms": 302.653, "learn_throughput": 25111.301, "update_time_ms": 2.875}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.909093465297727e-91, "cur_lr": 0.001, "total_loss": 0.03347379108890891, "policy_loss": 0.016209688503295183, "vf_loss": 0.017264104448258877, "vf_explained_var": 0.9825721383094788, "kl": 0.00051048984460067, "entropy": -6.943664312362671, "entropy_coeff": 0.0}}, "num_steps_sampled": 2680800, "num_steps_trained": 2680800}, "done": false, "episodes_total": 2670, "training_iteration": 356, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-42", "timestamp": 1617635622, "time_this_iter_s": 1.4137005805969238, "time_total_s": 619.5580079555511, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aecb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 454.7715435028076, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 73.44999999999999, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 15.357699733694616, "episode_reward_mean": 49.876775181990794, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.491854185738656, "MDD_min": 13.545113658123237, "MDD_max": 37.685886347726026}, "hist_stats": {"episode_reward": [86.5841633099213, 44.17514914439004, 37.838152466391804, 39.48000503687054, 47.31522048191717, 49.184256678591545, 44.8976193565501, 28.574103584714834, 31.535926485105023, 69.04802669356187, 29.94035209329292, 75.68088271109114, 30.64796150652623, 60.37980794402848, 15.357699733694616, 63.98544461081403, 47.86284170071583, 52.25646758957113, 42.52860398686647, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20042677221684924, "mean_inference_ms": 1.2787791672222866, "mean_action_processing_ms": 0.054493908034050735, "mean_env_wait_ms": 1.1971000078119935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2688400, "timers": {"sample_time_ms": 1146.437, "sample_throughput": 6629.232, "learn_time_ms": 303.601, "learn_throughput": 25032.895, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4545467326488633e-91, "cur_lr": 0.001, "total_loss": 0.2072724848985672, "policy_loss": 0.0012299238005653024, "vf_loss": 0.2060425654053688, "vf_explained_var": 0.9895251393318176, "kl": 0.0009989086538553238, "entropy": -7.050774812698364, "entropy_coeff": 0.0}}, "num_steps_sampled": 2688400, "num_steps_trained": 2688400}, "done": false, "episodes_total": 2670, "training_iteration": 357, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-44", "timestamp": 1617635624, "time_this_iter_s": 1.4163424968719482, "time_total_s": 620.9743504524231, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 456.18788599967957, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 73.30000000000001, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.37007509101974, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.3908109983658, "MDD_min": 13.545113658123237, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038026869062772, "mean_inference_ms": 1.2786464994712816, "mean_action_processing_ms": 0.0544886803609074, "mean_env_wait_ms": 1.196981518579105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2696000, "timers": {"sample_time_ms": 1146.48, "sample_throughput": 6628.984, "learn_time_ms": 304.335, "learn_throughput": 24972.491, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2272733663244316e-91, "cur_lr": 0.001, "total_loss": 0.595370352268219, "policy_loss": -0.0004920796927763149, "vf_loss": 0.595862478017807, "vf_explained_var": 0.9772840738296509, "kl": 0.002637017867527902, "entropy": -6.918048858642578, "entropy_coeff": 0.0}}, "num_steps_sampled": 2696000, "num_steps_trained": 2696000}, "done": false, "episodes_total": 2689, "training_iteration": 358, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-45", "timestamp": 1617635625, "time_this_iter_s": 1.5473010540008545, "time_total_s": 622.521651506424, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae320>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 457.7351870536804, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 80.4, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 104.29471292086501, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.37007509101974, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.390810998365797, "MDD_min": 13.545113658123237, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [44.9246623643921, 56.30780926499225, 100.02466603137069, 40.972520158880116, 39.34778285124369, 81.30672118764923, 23.976048354802195, 67.50628711309406, 38.17857973543296, 104.29471292086501, 52.74077613971558, 44.21266023115162, 37.252679571903585, 66.39426305568846, 61.48261941664251, 61.236735501320524, 36.70045990897795, 56.16371192157668, 44.86777907321543, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038026869062775, "mean_inference_ms": 1.2786464994712816, "mean_action_processing_ms": 0.05448868036090741, "mean_env_wait_ms": 1.196981518579105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2703600, "timers": {"sample_time_ms": 1147.202, "sample_throughput": 6624.813, "learn_time_ms": 305.005, "learn_throughput": 24917.64, "update_time_ms": 2.831}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.136366831622158e-92, "cur_lr": 0.001, "total_loss": 0.04146386869251728, "policy_loss": 0.002012425902648829, "vf_loss": 0.039451442658901215, "vf_explained_var": 0.9764008522033691, "kl": 0.0029460000805556774, "entropy": -6.800645351409912, "entropy_coeff": 0.0}}, "num_steps_sampled": 2703600, "num_steps_trained": 2703600}, "done": false, "episodes_total": 2689, "training_iteration": 359, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-47", "timestamp": 1617635627, "time_this_iter_s": 1.4187772274017334, "time_total_s": 623.9404287338257, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 459.15396428108215, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 72.55, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.97401066915273, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.1085042409514, "MDD_min": 12.890838032657754, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003827138499474, "mean_inference_ms": 1.2785276779272745, "mean_action_processing_ms": 0.05448417157883728, "mean_env_wait_ms": 1.1968810555565648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2711200, "timers": {"sample_time_ms": 1146.611, "sample_throughput": 6628.226, "learn_time_ms": 305.647, "learn_throughput": 24865.323, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.068183415811079e-92, "cur_lr": 0.001, "total_loss": 1.0262164771556854, "policy_loss": -0.009577034274116158, "vf_loss": 1.0357934832572937, "vf_explained_var": 0.9751656651496887, "kl": 0.0010899074841290712, "entropy": -7.039816617965698, "entropy_coeff": 0.0}}, "num_steps_sampled": 2711200, "num_steps_trained": 2711200}, "done": false, "episodes_total": 2708, "training_iteration": 360, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-48", "timestamp": 1617635628, "time_this_iter_s": 1.5250210762023926, "time_total_s": 625.4654498100281, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aeb90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 460.67898535728455, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 72.8, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.97401066915272, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.1085042409514, "MDD_min": 12.890838032657754, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038271384994735, "mean_inference_ms": 1.2785276779272743, "mean_action_processing_ms": 0.05448417157883727, "mean_env_wait_ms": 1.196881055556565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2718800, "timers": {"sample_time_ms": 1152.407, "sample_throughput": 6594.893, "learn_time_ms": 305.825, "learn_throughput": 24850.81, "update_time_ms": 2.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5340917079055395e-92, "cur_lr": 0.001, "total_loss": 0.007815054384991527, "policy_loss": -0.008944712462835014, "vf_loss": 0.01675976812839508, "vf_explained_var": 0.9821320176124573, "kl": 0.0017367994878441095, "entropy": -6.911850929260254, "entropy_coeff": 0.0}}, "num_steps_sampled": 2718800, "num_steps_trained": 2718800}, "done": false, "episodes_total": 2708, "training_iteration": 361, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-50", "timestamp": 1617635630, "time_this_iter_s": 1.478959560394287, "time_total_s": 626.9444093704224, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 462.15794491767883, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.97401066915272, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.1085042409514, "MDD_min": 12.890838032657754, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [36.84360598545522, 44.5734305458505, 22.17387923907243, 39.13913956189953, 41.46938094330078, 40.052603737462675, 57.277674874511035, 78.81520637437629, 68.76038817772776, 86.93373170817219, 34.89230996247374, 65.42056269107947, 57.65978960938945, 50.62075922820559, 40.50635081474473, 51.82233507835154, 30.25740024120037, 28.697543424160823, 99.36307645375202, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038271384994735, "mean_inference_ms": 1.2785276779272743, "mean_action_processing_ms": 0.05448417157883727, "mean_env_wait_ms": 1.196881055556565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2726400, "timers": {"sample_time_ms": 1154.503, "sample_throughput": 6582.921, "learn_time_ms": 305.59, "learn_throughput": 24869.911, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.670458539527698e-93, "cur_lr": 0.001, "total_loss": 0.19118312746286392, "policy_loss": 0.004189603379927576, "vf_loss": 0.18699351698160172, "vf_explained_var": 0.9913142919540405, "kl": 0.0011268026428297162, "entropy": -7.033164978027344, "entropy_coeff": 0.0}}, "num_steps_sampled": 2726400, "num_steps_trained": 2726400}, "done": false, "episodes_total": 2708, "training_iteration": 362, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-51", "timestamp": 1617635631, "time_this_iter_s": 1.4260995388031006, "time_total_s": 628.3705089092255, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae320>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 463.58404445648193, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 66.75, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.914935999262326, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.8560933322805, "MDD_min": 12.890838032657754, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003383117923624, "mean_inference_ms": 1.2784271477781535, "mean_action_processing_ms": 0.054480195589039014, "mean_env_wait_ms": 1.1967898457827821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2734000, "timers": {"sample_time_ms": 1154.339, "sample_throughput": 6583.857, "learn_time_ms": 305.64, "learn_throughput": 24865.841, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.835229269763849e-93, "cur_lr": 0.001, "total_loss": 0.4291473627090454, "policy_loss": -0.014488149201497436, "vf_loss": 0.4436355233192444, "vf_explained_var": 0.9835729002952576, "kl": 0.0030968509381636977, "entropy": -6.905487537384033, "entropy_coeff": 0.0}}, "num_steps_sampled": 2734000, "num_steps_trained": 2734000}, "done": false, "episodes_total": 2727, "training_iteration": 363, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-53", "timestamp": 1617635633, "time_this_iter_s": 1.5338547229766846, "time_total_s": 629.9043636322021, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 465.1178991794586, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 68.43333333333334, "ram_util_percent": 62.166666666666664}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 52.91493599926233, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.856093332280498, "MDD_min": 12.890838032657754, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [78.8131258390017, 55.03401969246924, 45.30659106441654, 32.672503914328026, 23.619037595698337, 45.664680939009415, 44.603675290860444, 45.93090483435198, 30.492835150532073, 63.46179891458381, 60.81827104131071, 47.92984132265549, 40.9541116937547, 36.237421291865736, 62.11983343009058, 29.07618550426558, 25.80076775457412, 38.061130020901516, 22.637841606533406, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033831179236233, "mean_inference_ms": 1.2784271477781535, "mean_action_processing_ms": 0.05448019558903901, "mean_env_wait_ms": 1.1967898457827821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2741600, "timers": {"sample_time_ms": 1156.68, "sample_throughput": 6570.528, "learn_time_ms": 305.057, "learn_throughput": 24913.386, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9176146348819244e-93, "cur_lr": 0.001, "total_loss": 0.03814233839511871, "policy_loss": 0.0031979427440091968, "vf_loss": 0.03494439646601677, "vf_explained_var": 0.9718092679977417, "kl": 0.0007740016153547913, "entropy": -6.7907280921936035, "entropy_coeff": 0.0}}, "num_steps_sampled": 2741600, "num_steps_trained": 2741600}, "done": false, "episodes_total": 2727, "training_iteration": 364, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-54", "timestamp": 1617635634, "time_this_iter_s": 1.4235455989837646, "time_total_s": 631.3279092311859, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 466.5414447784424, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 73.35, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 54.19797646881294, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.769444333854057, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034103947020665, "mean_inference_ms": 1.2783249572981736, "mean_action_processing_ms": 0.05447600713080017, "mean_env_wait_ms": 1.196694630837539, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2749200, "timers": {"sample_time_ms": 1157.972, "sample_throughput": 6563.201, "learn_time_ms": 304.574, "learn_throughput": 24952.853, "update_time_ms": 2.926}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.588073174409622e-94, "cur_lr": 0.001, "total_loss": 0.5878016948699951, "policy_loss": 0.0003806810127571225, "vf_loss": 0.5874210000038147, "vf_explained_var": 0.9851135015487671, "kl": 0.0019775773398578167, "entropy": -7.001115798950195, "entropy_coeff": 0.0}}, "num_steps_sampled": 2749200, "num_steps_trained": 2749200}, "done": false, "episodes_total": 2746, "training_iteration": 365, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-56", "timestamp": 1617635636, "time_this_iter_s": 1.5373811721801758, "time_total_s": 632.8652904033661, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 468.07882595062256, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 80.25, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 54.197976468812946, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.76944433385405, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034103947020668, "mean_inference_ms": 1.2783249572981736, "mean_action_processing_ms": 0.05447600713080018, "mean_env_wait_ms": 1.196694630837539, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2756800, "timers": {"sample_time_ms": 1158.768, "sample_throughput": 6558.693, "learn_time_ms": 303.965, "learn_throughput": 25002.918, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.794036587204811e-94, "cur_lr": 0.001, "total_loss": 0.0419189294334501, "policy_loss": 0.02465076232329011, "vf_loss": 0.0172681687399745, "vf_explained_var": 0.9795284271240234, "kl": 0.0011705413344316185, "entropy": -6.869415283203125, "entropy_coeff": 0.0}}, "num_steps_sampled": 2756800, "num_steps_trained": 2756800}, "done": false, "episodes_total": 2746, "training_iteration": 366, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-57", "timestamp": 1617635637, "time_this_iter_s": 1.416543960571289, "time_total_s": 634.2818343639374, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344aeb90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 469.49536991119385, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 54.197976468812946, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.76944433385405, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [47.55031504598047, 54.72642802461625, 21.77427681447426, 55.61731208593123, 55.391987434537526, 60.48330499998015, 57.50636760346783, 39.95628838389478, 25.900579052050414, 64.87084215365164, 39.96829625709737, 66.91662679038936, 29.805447655106313, 56.32655484191934, 42.6892512864484, 64.94440118602363, 52.99626570059315, 48.38946423180197, 100.72116704047363, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034103947020668, "mean_inference_ms": 1.2783249572981736, "mean_action_processing_ms": 0.05447600713080018, "mean_env_wait_ms": 1.196694630837539, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2764400, "timers": {"sample_time_ms": 1161.091, "sample_throughput": 6545.569, "learn_time_ms": 303.059, "learn_throughput": 25077.611, "update_time_ms": 2.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3970182936024055e-94, "cur_lr": 0.001, "total_loss": 0.20641164481639862, "policy_loss": -0.0022154278158268426, "vf_loss": 0.20862706005573273, "vf_explained_var": 0.9897341728210449, "kl": 0.0012993994751013815, "entropy": -7.024981737136841, "entropy_coeff": 0.0}}, "num_steps_sampled": 2764400, "num_steps_trained": 2764400}, "done": false, "episodes_total": 2746, "training_iteration": 367, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-13-59", "timestamp": 1617635639, "time_this_iter_s": 1.430600881576538, "time_total_s": 635.7124352455139, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 470.9259707927704, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 73.5, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 55.53921770112808, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.90474307926703, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029861777789684, "mean_inference_ms": 1.278222248666284, "mean_action_processing_ms": 0.05447207624821471, "mean_env_wait_ms": 1.1965931392517524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2772000, "timers": {"sample_time_ms": 1159.897, "sample_throughput": 6552.306, "learn_time_ms": 301.536, "learn_throughput": 25204.32, "update_time_ms": 2.95}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1985091468012028e-94, "cur_lr": 0.001, "total_loss": 0.6434075832366943, "policy_loss": 0.014722105581313372, "vf_loss": 0.6286855041980743, "vf_explained_var": 0.9747933745384216, "kl": 0.0018350484315305948, "entropy": -6.885189056396484, "entropy_coeff": 0.0}}, "num_steps_sampled": 2772000, "num_steps_trained": 2772000}, "done": false, "episodes_total": 2765, "training_iteration": 368, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-00", "timestamp": 1617635640, "time_this_iter_s": 1.5202305316925049, "time_total_s": 637.2326657772064, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 472.4462013244629, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 16.60313293784536, "episode_reward_mean": 55.539217701128074, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.904743079267032, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [54.113527928790134, 52.5115259038683, 16.60313293784536, 44.707571751456115, 73.52867761876188, 44.68426588545792, 66.64322748571814, 102.84281767047499, 55.857882721720294, 54.03398399362951, 61.14949009558361, 43.14832309761798, 78.23790024881175, 31.677977594873155, 40.58398983605999, 29.061630372210946, 36.916016802964194, 69.29903351405197, 78.50648289494448, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029861777789684, "mean_inference_ms": 1.278222248666284, "mean_action_processing_ms": 0.054472076248214714, "mean_env_wait_ms": 1.1965931392517526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2779600, "timers": {"sample_time_ms": 1159.713, "sample_throughput": 6553.348, "learn_time_ms": 301.265, "learn_throughput": 25226.962, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.992545734006014e-95, "cur_lr": 0.001, "total_loss": 0.02461816370487213, "policy_loss": -0.0064803342102095485, "vf_loss": 0.031098496168851852, "vf_explained_var": 0.9746941328048706, "kl": 0.0014520012773573399, "entropy": -6.825328350067139, "entropy_coeff": 0.0}}, "num_steps_sampled": 2779600, "num_steps_trained": 2779600}, "done": false, "episodes_total": 2765, "training_iteration": 369, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-02", "timestamp": 1617635642, "time_this_iter_s": 1.4139606952667236, "time_total_s": 638.6466264724731, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344ae830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 473.8601620197296, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 72.05000000000001, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 24.22769758698568, "episode_reward_mean": 55.06049730984796, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.111891744316026, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002997269362509, "mean_inference_ms": 1.278119095610565, "mean_action_processing_ms": 0.05446807757187044, "mean_env_wait_ms": 1.1964932068261442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2787200, "timers": {"sample_time_ms": 1160.269, "sample_throughput": 6550.208, "learn_time_ms": 301.019, "learn_throughput": 25247.57, "update_time_ms": 2.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.996272867003007e-95, "cur_lr": 0.001, "total_loss": 0.5689747631549835, "policy_loss": 0.0026640425785444677, "vf_loss": 0.5663107335567474, "vf_explained_var": 0.9857478141784668, "kl": 0.0012339625973254442, "entropy": -7.0188987255096436, "entropy_coeff": 0.0}}, "num_steps_sampled": 2787200, "num_steps_trained": 2787200}, "done": false, "episodes_total": 2784, "training_iteration": 370, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-03", "timestamp": 1617635643, "time_this_iter_s": 1.5273158550262451, "time_total_s": 640.1739423274994, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 475.38747787475586, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 72.35, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 24.22769758698568, "episode_reward_mean": 55.06049730984797, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.111891744316022, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029972693625087, "mean_inference_ms": 1.2781190956105648, "mean_action_processing_ms": 0.05446807757187042, "mean_env_wait_ms": 1.1964932068261442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2794800, "timers": {"sample_time_ms": 1154.186, "sample_throughput": 6584.728, "learn_time_ms": 300.455, "learn_throughput": 25294.941, "update_time_ms": 2.919}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4981364335015035e-95, "cur_lr": 0.001, "total_loss": 0.014982729684561491, "policy_loss": -0.00042481423588469625, "vf_loss": 0.015407540835440159, "vf_explained_var": 0.9815928936004639, "kl": 0.0027735307812690735, "entropy": -6.901216506958008, "entropy_coeff": 0.0}}, "num_steps_sampled": 2794800, "num_steps_trained": 2794800}, "done": false, "episodes_total": 2784, "training_iteration": 371, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-05", "timestamp": 1617635645, "time_this_iter_s": 1.4124374389648438, "time_total_s": 641.5863797664642, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 476.7999153137207, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 71.15, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 24.22769758698568, "episode_reward_mean": 55.06049730984797, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.111891744316022, "MDD_min": 12.539753430420333, "MDD_max": 37.177861760019795}, "hist_stats": {"episode_reward": [89.27499995366202, 68.02011403037153, 35.29164999733604, 79.57892724354453, 81.7939625784764, 60.36615617045549, 54.400070382711796, 34.563320113388784, 43.82207820950319, 47.730697586716055, 44.488860192004516, 34.143793041874915, 53.45473536996287, 51.79832282845477, 24.35766557972535, 77.82489244332524, 60.58979362722998, 57.602993191787604, 27.08814360353356, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029972693625087, "mean_inference_ms": 1.2781190956105648, "mean_action_processing_ms": 0.05446807757187042, "mean_env_wait_ms": 1.1964932068261442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2802400, "timers": {"sample_time_ms": 1153.806, "sample_throughput": 6586.897, "learn_time_ms": 299.655, "learn_throughput": 25362.485, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.490682167507517e-96, "cur_lr": 0.001, "total_loss": 0.18015840649604797, "policy_loss": 0.012739443918690085, "vf_loss": 0.167418971657753, "vf_explained_var": 0.9909647703170776, "kl": 0.0010915662278421223, "entropy": -7.042431354522705, "entropy_coeff": 0.0}}, "num_steps_sampled": 2802400, "num_steps_trained": 2802400}, "done": false, "episodes_total": 2784, "training_iteration": 372, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-06", "timestamp": 1617635646, "time_this_iter_s": 1.413506269454956, "time_total_s": 642.9998860359192, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 478.21342158317566, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 54.32673092366716, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.722055765520526, "MDD_min": 12.539753430420333, "MDD_max": 34.70978190109631}, "hist_stats": {"episode_reward": [57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026431169877693, "mean_inference_ms": 1.2780197942532787, "mean_action_processing_ms": 0.054464172061109234, "mean_env_wait_ms": 1.1963963690932524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2810000, "timers": {"sample_time_ms": 1153.554, "sample_throughput": 6588.336, "learn_time_ms": 299.383, "learn_throughput": 25385.521, "update_time_ms": 2.913}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.745341083753759e-96, "cur_lr": 0.001, "total_loss": 0.4073307067155838, "policy_loss": 0.0050407504895702004, "vf_loss": 0.402289941906929, "vf_explained_var": 0.9826349020004272, "kl": 0.001857150171417743, "entropy": -6.861784219741821, "entropy_coeff": 0.0}}, "num_steps_sampled": 2810000, "num_steps_trained": 2810000}, "done": false, "episodes_total": 2803, "training_iteration": 373, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-08", "timestamp": 1617635648, "time_this_iter_s": 1.5289173126220703, "time_total_s": 644.5288033485413, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 479.74233889579773, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 70.86666666666666, "ram_util_percent": 62.13333333333333}, "trial_id": "6c840_00000"}
{"episode_reward_max": 201.14039393932137, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 54.32673092366715, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.722055765520523, "MDD_min": 12.539753430420333, "MDD_max": 34.70978190109631}, "hist_stats": {"episode_reward": [73.97663727591016, 85.62486246814026, 46.52106723738674, 201.14039393932137, 38.79054935478094, 59.14645372116394, 41.323345004972964, 40.02101484636608, 41.56525000090843, 43.34516191965408, 43.0760850988911, 91.00146897542139, 41.8407607011892, 49.23037191767362, 56.35853053688358, 51.46866260347161, 75.47679465989302, 27.660174292671535, 51.40486994956178, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026431169877693, "mean_inference_ms": 1.278019794253279, "mean_action_processing_ms": 0.054464172061109234, "mean_env_wait_ms": 1.1963963690932524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2817600, "timers": {"sample_time_ms": 1153.456, "sample_throughput": 6588.893, "learn_time_ms": 298.763, "learn_throughput": 25438.218, "update_time_ms": 2.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8726705418768793e-96, "cur_lr": 0.001, "total_loss": 0.014144682325422764, "policy_loss": -0.026969574857503176, "vf_loss": 0.04111425392329693, "vf_explained_var": 0.9671940803527832, "kl": 0.002139671938493848, "entropy": -6.810473918914795, "entropy_coeff": 0.0}}, "num_steps_sampled": 2817600, "num_steps_trained": 2817600}, "done": false, "episodes_total": 2803, "training_iteration": 374, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-09", "timestamp": 1617635649, "time_this_iter_s": 1.4160430431365967, "time_total_s": 645.9448463916779, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516dd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 481.1583819389343, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 73.95, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 108.82152448210918, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 52.472035942229084, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.818442483730447, "MDD_min": 12.539753430420333, "MDD_max": 34.70978190109631}, "hist_stats": {"episode_reward": [46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002839114156238, "mean_inference_ms": 1.2779291628349931, "mean_action_processing_ms": 0.05446083070537183, "mean_env_wait_ms": 1.1963101099293376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2825200, "timers": {"sample_time_ms": 1153.939, "sample_throughput": 6586.139, "learn_time_ms": 298.403, "learn_throughput": 25468.931, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.363352709384397e-97, "cur_lr": 0.001, "total_loss": 0.5686050653457642, "policy_loss": 0.00661690637934953, "vf_loss": 0.5619882345199585, "vf_explained_var": 0.9848161935806274, "kl": 0.0015199832851067185, "entropy": -7.006817102432251, "entropy_coeff": 0.0}}, "num_steps_sampled": 2825200, "num_steps_trained": 2825200}, "done": false, "episodes_total": 2822, "training_iteration": 375, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-11", "timestamp": 1617635651, "time_this_iter_s": 1.5386483669281006, "time_total_s": 647.483494758606, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 482.6970303058624, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 80.6, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 108.82152448210918, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 52.4720359422291, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.81844248373045, "MDD_min": 12.539753430420333, "MDD_max": 34.70978190109631}, "hist_stats": {"episode_reward": [59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028391141562385, "mean_inference_ms": 1.2779291628349931, "mean_action_processing_ms": 0.05446083070537184, "mean_env_wait_ms": 1.1963101099293376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2832800, "timers": {"sample_time_ms": 1154.529, "sample_throughput": 6582.771, "learn_time_ms": 298.259, "learn_throughput": 25481.191, "update_time_ms": 2.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.6816763546921983e-97, "cur_lr": 0.001, "total_loss": 0.0006751986220479012, "policy_loss": -0.014887680299580097, "vf_loss": 0.015562879852950573, "vf_explained_var": 0.9780505895614624, "kl": 0.0020776544115506113, "entropy": -6.861052751541138, "entropy_coeff": 0.0}}, "num_steps_sampled": 2832800, "num_steps_trained": 2832800}, "done": false, "episodes_total": 2822, "training_iteration": 376, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-12", "timestamp": 1617635652, "time_this_iter_s": 1.4200940132141113, "time_total_s": 648.9035887718201, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 484.11712431907654, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 108.82152448210918, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 52.4720359422291, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.81844248373045, "MDD_min": 12.539753430420333, "MDD_max": 34.70978190109631}, "hist_stats": {"episode_reward": [59.338804264422414, 32.65541793086219, 26.13441993933423, 67.5427116335206, 70.78140366528551, 57.982011923828345, 37.76105203623194, 45.91997865514402, 45.62532127993903, 66.55707746485287, 25.407025750156357, 38.108454506319006, 47.55763017131651, 24.35236293360057, 84.58044860978703, 48.28930555823557, 49.54885311260551, 81.52078139579498, 29.0388020267021, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028391141562385, "mean_inference_ms": 1.2779291628349931, "mean_action_processing_ms": 0.05446083070537184, "mean_env_wait_ms": 1.1963101099293376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2840400, "timers": {"sample_time_ms": 1153.324, "sample_throughput": 6589.649, "learn_time_ms": 297.793, "learn_throughput": 25521.107, "update_time_ms": 2.882}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3408381773460992e-97, "cur_lr": 0.001, "total_loss": 0.16243552416563034, "policy_loss": 0.0014359446940943599, "vf_loss": 0.160999596118927, "vf_explained_var": 0.9916163682937622, "kl": 0.0007126493437681347, "entropy": -7.073492765426636, "entropy_coeff": 0.0}}, "num_steps_sampled": 2840400, "num_steps_trained": 2840400}, "done": false, "episodes_total": 2822, "training_iteration": 377, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-13", "timestamp": 1617635653, "time_this_iter_s": 1.414262294769287, "time_total_s": 650.3178510665894, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 485.5313866138458, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 72.15, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 108.82152448210918, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 53.24904107104056, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.647830563373066, "MDD_min": 12.539753430420333, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025800388261775, "mean_inference_ms": 1.2778303077129831, "mean_action_processing_ms": 0.05445678598490673, "mean_env_wait_ms": 1.1962284293493213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2848000, "timers": {"sample_time_ms": 1152.795, "sample_throughput": 6592.672, "learn_time_ms": 298.432, "learn_throughput": 25466.404, "update_time_ms": 2.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1704190886730496e-97, "cur_lr": 0.001, "total_loss": 0.4105825126171112, "policy_loss": -0.016839333344250917, "vf_loss": 0.42742183804512024, "vf_explained_var": 0.979783833026886, "kl": 0.0013624161947518587, "entropy": -6.844444513320923, "entropy_coeff": 0.0}}, "num_steps_sampled": 2848000, "num_steps_trained": 2848000}, "done": false, "episodes_total": 2841, "training_iteration": 378, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-15", "timestamp": 1617635655, "time_this_iter_s": 1.521059513092041, "time_total_s": 651.8389105796814, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516dd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 487.05244612693787, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 72.35, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 108.82152448210918, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 53.249041071040544, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.647830563373066, "MDD_min": 12.539753430420333, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [39.751830735431625, 56.311276049332136, 24.47607435854404, 108.82152448210918, 45.92881280633324, 44.859171039336445, 97.35516571020604, 24.22769758698568, 44.812949637340324, 47.38591897145292, 52.25597698651962, 62.00122327976629, 61.92767150679321, 35.26476294432051, 99.17457015875479, 48.94383587993863, 69.64027084756471, 57.27855637115024, 69.92205245309535, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025800388261772, "mean_inference_ms": 1.277830307712983, "mean_action_processing_ms": 0.05445678598490671, "mean_env_wait_ms": 1.1962284293493213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2855600, "timers": {"sample_time_ms": 1154.105, "sample_throughput": 6585.187, "learn_time_ms": 301.263, "learn_throughput": 25227.127, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.852095443365248e-98, "cur_lr": 0.001, "total_loss": 0.039474040269851685, "policy_loss": 0.0013735018437728286, "vf_loss": 0.03810053691267967, "vf_explained_var": 0.9713019132614136, "kl": 0.0010772620444186032, "entropy": -6.823723077774048, "entropy_coeff": 0.0}}, "num_steps_sampled": 2855600, "num_steps_trained": 2855600}, "done": false, "episodes_total": 2841, "training_iteration": 379, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-16", "timestamp": 1617635656, "time_this_iter_s": 1.4553346633911133, "time_total_s": 653.2942452430725, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 488.507780790329, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 72.7, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.51052033847486, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 51.76033049434719, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.53254641048993, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002771712007224, "mean_inference_ms": 1.2777536765858755, "mean_action_processing_ms": 0.05445301157099297, "mean_env_wait_ms": 1.1961720155853564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2863200, "timers": {"sample_time_ms": 1155.859, "sample_throughput": 6575.195, "learn_time_ms": 301.199, "learn_throughput": 25232.499, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.926047721682624e-98, "cur_lr": 0.001, "total_loss": 0.46178846061229706, "policy_loss": 0.002098857657983899, "vf_loss": 0.45968957245349884, "vf_explained_var": 0.9865913391113281, "kl": 0.0014836774207651615, "entropy": -7.036711931228638, "entropy_coeff": 0.0}}, "num_steps_sampled": 2863200, "num_steps_trained": 2863200}, "done": false, "episodes_total": 2860, "training_iteration": 380, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-18", "timestamp": 1617635658, "time_this_iter_s": 1.54374098777771, "time_total_s": 654.8379862308502, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 490.0515217781067, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 65.23333333333333, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.51052033847486, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 51.7603304943472, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.53254641048992, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002771712007224, "mean_inference_ms": 1.2777536765858752, "mean_action_processing_ms": 0.05445301157099296, "mean_env_wait_ms": 1.1961720155853566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2870800, "timers": {"sample_time_ms": 1155.298, "sample_throughput": 6578.387, "learn_time_ms": 302.452, "learn_throughput": 25127.941, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.463023860841312e-98, "cur_lr": 0.001, "total_loss": 0.017503594048321247, "policy_loss": 0.001412319135852158, "vf_loss": 0.016091272234916687, "vf_explained_var": 0.975096583366394, "kl": 0.001190790964756161, "entropy": -6.881276607513428, "entropy_coeff": 0.0}}, "num_steps_sampled": 2870800, "num_steps_trained": 2870800}, "done": false, "episodes_total": 2860, "training_iteration": 381, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-19", "timestamp": 1617635659, "time_this_iter_s": 1.4186859130859375, "time_total_s": 656.2566721439362, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 491.4702076911926, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 74.6, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 88.51052033847486, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 51.7603304943472, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.53254641048992, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [86.9100276895817, 51.52547840514415, 54.6346191328624, 47.687316025122755, 64.85203519401617, 72.48218284383715, 36.63604785007752, 45.2046201546678, 61.04885750507405, 46.528427426228745, 45.91632643346908, 27.505917966873668, 62.48589311988882, 38.340275661747704, 53.49373460523197, 55.502455534639935, 32.96626852450413, 47.35180348604436, 59.3228518351133, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002771712007224, "mean_inference_ms": 1.2777536765858752, "mean_action_processing_ms": 0.05445301157099296, "mean_env_wait_ms": 1.1961720155853566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2878400, "timers": {"sample_time_ms": 1154.132, "sample_throughput": 6585.035, "learn_time_ms": 303.123, "learn_throughput": 25072.289, "update_time_ms": 2.767}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.31511930420656e-99, "cur_lr": 0.001, "total_loss": 0.2109348177909851, "policy_loss": 0.009033969603478909, "vf_loss": 0.20190084725618362, "vf_explained_var": 0.9886502027511597, "kl": 0.0006883723253849894, "entropy": -7.074214220046997, "entropy_coeff": 0.0}}, "num_steps_sampled": 2878400, "num_steps_trained": 2878400}, "done": false, "episodes_total": 2860, "training_iteration": 382, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-21", "timestamp": 1617635661, "time_this_iter_s": 1.4087111949920654, "time_total_s": 657.6653833389282, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 492.8789188861847, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 74.85, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.71505223592897, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 52.16903202638904, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.403736495864873, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025804401073072, "mean_inference_ms": 1.277679072276204, "mean_action_processing_ms": 0.05444925037802905, "mean_env_wait_ms": 1.1961180194178924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2886000, "timers": {"sample_time_ms": 1155.738, "sample_throughput": 6575.885, "learn_time_ms": 303.517, "learn_throughput": 25039.785, "update_time_ms": 2.765}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.65755965210328e-99, "cur_lr": 0.001, "total_loss": 0.5314991772174835, "policy_loss": -0.0037877719150856137, "vf_loss": 0.5352869927883148, "vf_explained_var": 0.9769368171691895, "kl": 0.0013641989789903164, "entropy": -6.873737812042236, "entropy_coeff": 0.0}}, "num_steps_sampled": 2886000, "num_steps_trained": 2886000}, "done": false, "episodes_total": 2879, "training_iteration": 383, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-22", "timestamp": 1617635662, "time_this_iter_s": 1.5491867065429688, "time_total_s": 659.2145700454712, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345e9f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 494.42810559272766, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 81.3, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.71505223592897, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 52.16903202638903, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.403736495864884, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [67.25306743665075, 52.45556843841194, 31.01428244319051, 76.12806385543644, 74.5987741057417, 57.65316336308503, 45.32467032339177, 83.42074050431775, 43.07618189272554, 47.27778491678947, 78.96797741962637, 70.68337970911246, 52.736190016148235, 24.434713054966714, 76.61831205647788, 71.1042295635487, 50.49440350903519, 42.51730182861477, 36.87963011219792, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025804401073072, "mean_inference_ms": 1.277679072276204, "mean_action_processing_ms": 0.05444925037802907, "mean_env_wait_ms": 1.1961180194178922, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2893600, "timers": {"sample_time_ms": 1156.203, "sample_throughput": 6573.241, "learn_time_ms": 304.512, "learn_throughput": 24957.993, "update_time_ms": 2.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.82877982605164e-99, "cur_lr": 0.001, "total_loss": 0.037861499935388565, "policy_loss": 0.002973448485136032, "vf_loss": 0.03488805331289768, "vf_explained_var": 0.9766480922698975, "kl": 0.0011119851842522621, "entropy": -6.833489418029785, "entropy_coeff": 0.0}}, "num_steps_sampled": 2893600, "num_steps_trained": 2893600}, "done": false, "episodes_total": 2879, "training_iteration": 384, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-24", "timestamp": 1617635664, "time_this_iter_s": 1.4304730892181396, "time_total_s": 660.6450431346893, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 495.8585786819458, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 74.80000000000001, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.71505223592897, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 50.471948135792864, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.770042769696616, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029176165929408, "mean_inference_ms": 1.2776432372199118, "mean_action_processing_ms": 0.05444831979381435, "mean_env_wait_ms": 1.1961011476904988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2901200, "timers": {"sample_time_ms": 1164.843, "sample_throughput": 6524.484, "learn_time_ms": 305.68, "learn_throughput": 24862.641, "update_time_ms": 2.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.1438991302582e-100, "cur_lr": 0.001, "total_loss": 0.5423086285591125, "policy_loss": -0.0007718258129898459, "vf_loss": 0.5430804491043091, "vf_explained_var": 0.9848631620407104, "kl": 0.0018271235167048872, "entropy": -7.052948951721191, "entropy_coeff": 0.0}}, "num_steps_sampled": 2901200, "num_steps_trained": 2901200}, "done": false, "episodes_total": 2898, "training_iteration": 385, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-26", "timestamp": 1617635666, "time_this_iter_s": 1.635852336883545, "time_total_s": 662.2808954715729, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 497.49443101882935, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 78.4, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.71505223592897, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 50.47194813579286, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.770042769696612, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029176165929408, "mean_inference_ms": 1.2776432372199118, "mean_action_processing_ms": 0.05444831979381435, "mean_env_wait_ms": 1.1961011476904988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2908800, "timers": {"sample_time_ms": 1164.127, "sample_throughput": 6528.496, "learn_time_ms": 305.817, "learn_throughput": 24851.438, "update_time_ms": 2.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5719495651291e-100, "cur_lr": 0.001, "total_loss": 0.018724016845226288, "policy_loss": 0.0037831058725714684, "vf_loss": 0.014940911438316107, "vf_explained_var": 0.9765671491622925, "kl": 0.0017826588591560721, "entropy": -6.849229335784912, "entropy_coeff": 0.0}}, "num_steps_sampled": 2908800, "num_steps_trained": 2908800}, "done": false, "episodes_total": 2898, "training_iteration": 386, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-27", "timestamp": 1617635667, "time_this_iter_s": 1.4147942066192627, "time_total_s": 663.6956896781921, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345130e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 498.9092252254486, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 92.71505223592897, "episode_reward_min": 20.680082141447638, "episode_reward_mean": 50.47194813579286, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.770042769696612, "MDD_min": 13.207795930469775, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [20.680082141447638, 36.64236898501087, 32.189634647538455, 31.43869376565278, 50.67507971629517, 46.78813674560484, 40.90767419055834, 28.92463017677647, 83.15009081503965, 60.5223180950353, 28.267350222414525, 71.23668999265828, 31.07298660213361, 47.42283380034375, 44.825633480442725, 40.259780500151635, 60.425044481731085, 88.51052033847486, 48.88770309541676, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029176165929408, "mean_inference_ms": 1.2776432372199118, "mean_action_processing_ms": 0.05444831979381435, "mean_env_wait_ms": 1.1961011476904988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2916400, "timers": {"sample_time_ms": 1164.105, "sample_throughput": 6528.619, "learn_time_ms": 307.419, "learn_throughput": 24721.926, "update_time_ms": 2.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.28597478256455e-100, "cur_lr": 0.001, "total_loss": 0.22878950089216232, "policy_loss": 0.011754170758649707, "vf_loss": 0.21703533083200455, "vf_explained_var": 0.9877191781997681, "kl": 0.0009022034937515855, "entropy": -7.0954413414001465, "entropy_coeff": 0.0}}, "num_steps_sampled": 2916400, "num_steps_trained": 2916400}, "done": false, "episodes_total": 2898, "training_iteration": 387, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-28", "timestamp": 1617635668, "time_this_iter_s": 1.4307622909545898, "time_total_s": 665.1264519691467, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 500.3399875164032, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 62.25}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.89845227562341, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 51.95136198809519, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.731832991389535, "MDD_min": 15.392271786954991, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002760211136978, "mean_inference_ms": 1.2776167829375515, "mean_action_processing_ms": 0.054448718920723206, "mean_env_wait_ms": 1.1960967628211858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2924000, "timers": {"sample_time_ms": 1167.115, "sample_throughput": 6511.783, "learn_time_ms": 308.221, "learn_throughput": 24657.67, "update_time_ms": 2.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.142987391282275e-100, "cur_lr": 0.001, "total_loss": 0.5790785551071167, "policy_loss": -0.016351542435586452, "vf_loss": 0.5954300761222839, "vf_explained_var": 0.9750873446464539, "kl": 0.0017858313512988389, "entropy": -6.858691692352295, "entropy_coeff": 0.0}}, "num_steps_sampled": 2924000, "num_steps_trained": 2924000}, "done": false, "episodes_total": 2917, "training_iteration": 388, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-30", "timestamp": 1617635670, "time_this_iter_s": 1.5591599941253662, "time_total_s": 666.6856119632721, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 501.89914751052856, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 67.5, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.89845227562341, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 51.95136198809519, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.731832991389524, "MDD_min": 15.392271786954991, "MDD_max": 36.33426684193675}, "hist_stats": {"episode_reward": [37.81847148628243, 52.427412727382034, 54.97954983384622, 38.27834241514372, 68.79778736101939, 61.662457201184054, 42.346362927826384, 33.97855983863351, 57.152466870348874, 35.96852396963068, 65.78087618115666, 50.4265067767699, 38.77200061438423, 54.96757378784552, 39.42758512275374, 46.69779242039966, 71.53123486669726, 81.88515276773607, 74.47959611966141, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027602111369777, "mean_inference_ms": 1.2776167829375513, "mean_action_processing_ms": 0.054448718920723206, "mean_env_wait_ms": 1.1960967628211858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2931600, "timers": {"sample_time_ms": 1169.051, "sample_throughput": 6500.997, "learn_time_ms": 306.589, "learn_throughput": 24788.923, "update_time_ms": 2.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.714936956411375e-101, "cur_lr": 0.001, "total_loss": 0.052953317761421204, "policy_loss": 0.011409167433157563, "vf_loss": 0.041544148698449135, "vf_explained_var": 0.9706591367721558, "kl": 0.0018595777219161391, "entropy": -6.8021745681762695, "entropy_coeff": 0.0}}, "num_steps_sampled": 2931600, "num_steps_trained": 2931600}, "done": false, "episodes_total": 2917, "training_iteration": 389, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-31", "timestamp": 1617635671, "time_this_iter_s": 1.4581880569458008, "time_total_s": 668.1438000202179, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 503.35733556747437, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 78.1, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.89845227562341, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 52.52710325593102, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.960210492890795, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20031434927334701, "mean_inference_ms": 1.277621338342058, "mean_action_processing_ms": 0.05445220860756473, "mean_env_wait_ms": 1.1961211512898127, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2939200, "timers": {"sample_time_ms": 1166.886, "sample_throughput": 6513.059, "learn_time_ms": 306.469, "learn_throughput": 24798.625, "update_time_ms": 2.786}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8574684782056875e-101, "cur_lr": 0.001, "total_loss": 0.7175881862640381, "policy_loss": -0.002025234221946448, "vf_loss": 0.7196134030818939, "vf_explained_var": 0.9820237159729004, "kl": 0.0011400702060200274, "entropy": -7.076536417007446, "entropy_coeff": 0.0}}, "num_steps_sampled": 2939200, "num_steps_trained": 2939200}, "done": false, "episodes_total": 2936, "training_iteration": 390, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-33", "timestamp": 1617635673, "time_this_iter_s": 1.5210728645324707, "time_total_s": 669.6648728847504, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345130e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 504.87840843200684, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 80.8, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.89845227562341, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 52.52710325593102, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.960210492890802, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20031434927334696, "mean_inference_ms": 1.2776213383420583, "mean_action_processing_ms": 0.05445220860756473, "mean_env_wait_ms": 1.196121151289813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2946800, "timers": {"sample_time_ms": 1169.989, "sample_throughput": 6495.787, "learn_time_ms": 306.945, "learn_throughput": 24760.174, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4287342391028437e-101, "cur_lr": 0.001, "total_loss": 0.025785538833588362, "policy_loss": 0.010354310041293502, "vf_loss": 0.015431229025125504, "vf_explained_var": 0.9780987501144409, "kl": 0.003468659706413746, "entropy": -6.849527835845947, "entropy_coeff": 0.0}}, "num_steps_sampled": 2946800, "num_steps_trained": 2946800}, "done": false, "episodes_total": 2936, "training_iteration": 391, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-34", "timestamp": 1617635674, "time_this_iter_s": 1.454758644104004, "time_total_s": 671.1196315288544, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 506.33316707611084, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 75.5, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 118.89845227562341, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 52.52710325593102, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.960210492890802, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [44.45130877850467, 81.84994867615966, 50.68191863513129, 44.92439657705403, 39.418113607207076, 60.11034735020901, 55.248694893551395, 43.03976337871526, 46.736649148415836, 37.762920723355734, 72.94364389114273, 56.12282777076875, 53.48081634520955, 64.36444437612356, 43.57503396328349, 59.217025815717584, 44.4041987019411, 63.39847649700627, 50.767680203717184, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20031434927334696, "mean_inference_ms": 1.2776213383420583, "mean_action_processing_ms": 0.05445220860756473, "mean_env_wait_ms": 1.196121151289813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2954400, "timers": {"sample_time_ms": 1172.022, "sample_throughput": 6484.522, "learn_time_ms": 307.255, "learn_throughput": 24735.124, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.143671195514219e-102, "cur_lr": 0.001, "total_loss": 0.26745424419641495, "policy_loss": -0.021527286618947983, "vf_loss": 0.28898151218891144, "vf_explained_var": 0.9850023984909058, "kl": 0.0007264474406838417, "entropy": -7.103981971740723, "entropy_coeff": 0.0}}, "num_steps_sampled": 2954400, "num_steps_trained": 2954400}, "done": false, "episodes_total": 2936, "training_iteration": 392, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-36", "timestamp": 1617635676, "time_this_iter_s": 1.432037115097046, "time_total_s": 672.5516686439514, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 507.7652041912079, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 73.0, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 56.39047815799191, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.044957072524696, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20031554610796365, "mean_inference_ms": 1.277641876918767, "mean_action_processing_ms": 0.05445733236739178, "mean_env_wait_ms": 1.1961593632227001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2962000, "timers": {"sample_time_ms": 1171.827, "sample_throughput": 6485.598, "learn_time_ms": 307.177, "learn_throughput": 24741.453, "update_time_ms": 2.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.5718355977571093e-102, "cur_lr": 0.001, "total_loss": 0.9485874772071838, "policy_loss": 0.005728877382352948, "vf_loss": 0.9428585469722748, "vf_explained_var": 0.9666665196418762, "kl": 0.0037295641377568245, "entropy": -6.894639015197754, "entropy_coeff": 0.0}}, "num_steps_sampled": 2962000, "num_steps_trained": 2962000}, "done": false, "episodes_total": 2955, "training_iteration": 393, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-37", "timestamp": 1617635677, "time_this_iter_s": 1.5462183952331543, "time_total_s": 674.0978870391846, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 509.31142258644104, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 56.39047815799191, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.0449570725247, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [38.85972637538499, 46.92463444370641, 31.949200663963538, 31.417430829159066, 41.14476876426832, 48.52245002519013, 47.53539517103343, 44.32379374239253, 75.63754831144199, 92.71505223592897, 92.47922072178166, 44.595004341077406, 52.23130985162552, 41.301968574929305, 79.004922647804, 53.10410255761574, 59.1106997975224, 33.5206882787615, 64.45054685297966, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003155461079637, "mean_inference_ms": 1.2776418769187667, "mean_action_processing_ms": 0.05445733236739179, "mean_env_wait_ms": 1.1961593632227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2969600, "timers": {"sample_time_ms": 1171.983, "sample_throughput": 6484.738, "learn_time_ms": 306.551, "learn_throughput": 24791.986, "update_time_ms": 2.779}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7859177988785547e-102, "cur_lr": 0.001, "total_loss": 0.03404172416776419, "policy_loss": -0.012639845488592982, "vf_loss": 0.046681566163897514, "vf_explained_var": 0.9696409702301025, "kl": 0.0012787297018803656, "entropy": -6.792530059814453, "entropy_coeff": 0.0}}, "num_steps_sampled": 2969600, "num_steps_trained": 2969600}, "done": false, "episodes_total": 2955, "training_iteration": 394, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-39", "timestamp": 1617635679, "time_this_iter_s": 1.4265429973602295, "time_total_s": 675.5244300365448, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345133b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 510.73796558380127, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 72.5, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 57.47619590669372, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.5794777418948, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20035957509652264, "mean_inference_ms": 1.2776886607770583, "mean_action_processing_ms": 0.05446410172559198, "mean_env_wait_ms": 1.196221237363609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2977200, "timers": {"sample_time_ms": 1163.635, "sample_throughput": 6531.255, "learn_time_ms": 305.244, "learn_throughput": 24898.082, "update_time_ms": 2.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.929588994392773e-103, "cur_lr": 0.001, "total_loss": 0.7807504534721375, "policy_loss": -0.0008706724911462516, "vf_loss": 0.7816210985183716, "vf_explained_var": 0.9824526906013489, "kl": 0.0012343029084149748, "entropy": -7.073567628860474, "entropy_coeff": 0.0}}, "num_steps_sampled": 2977200, "num_steps_trained": 2977200}, "done": false, "episodes_total": 2974, "training_iteration": 395, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-40", "timestamp": 1617635680, "time_this_iter_s": 1.5392930507659912, "time_total_s": 677.0637230873108, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 512.2772586345673, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 67.26666666666667, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 57.47619590669372, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.57947774189479, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003595750965227, "mean_inference_ms": 1.2776886607770583, "mean_action_processing_ms": 0.05446410172559199, "mean_env_wait_ms": 1.1962212373636087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2984800, "timers": {"sample_time_ms": 1164.864, "sample_throughput": 6524.366, "learn_time_ms": 305.381, "learn_throughput": 24886.909, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.464794497196387e-103, "cur_lr": 0.001, "total_loss": 0.03217519912868738, "policy_loss": 0.0157918450422585, "vf_loss": 0.016383353620767593, "vf_explained_var": 0.9764108657836914, "kl": 0.0028035679715685546, "entropy": -6.820308685302734, "entropy_coeff": 0.0}}, "num_steps_sampled": 2984800, "num_steps_trained": 2984800}, "done": false, "episodes_total": 2974, "training_iteration": 396, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-42", "timestamp": 1617635682, "time_this_iter_s": 1.4287216663360596, "time_total_s": 678.4924447536469, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 513.7059803009033, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 25.043770528901007, "episode_reward_mean": 57.47619590669372, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.57947774189479, "MDD_min": 15.469092837287562, "MDD_max": 34.51597514616283}, "hist_stats": {"episode_reward": [50.301815896991585, 40.22506133509352, 41.21627740798035, 36.962827975502115, 34.026606872656956, 56.22147195843163, 47.241308790672576, 38.17012533773117, 83.45493340355263, 32.69922363555775, 25.043770528901007, 54.459799825843454, 35.83784024037066, 28.900512096400952, 52.99545944286342, 31.2826846757905, 49.49106169310477, 49.45766010657909, 68.66164991887246, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003595750965227, "mean_inference_ms": 1.2776886607770583, "mean_action_processing_ms": 0.05446410172559199, "mean_env_wait_ms": 1.1962212373636087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 2992400, "timers": {"sample_time_ms": 1166.093, "sample_throughput": 6517.489, "learn_time_ms": 304.425, "learn_throughput": 24965.088, "update_time_ms": 2.755}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2323972485981933e-103, "cur_lr": 0.001, "total_loss": 0.22948728501796722, "policy_loss": -0.001233951043104753, "vf_loss": 0.23072123527526855, "vf_explained_var": 0.9888400435447693, "kl": 0.0013834842829965055, "entropy": -7.0687384605407715, "entropy_coeff": 0.0}}, "num_steps_sampled": 2992400, "num_steps_trained": 2992400}, "done": false, "episodes_total": 2974, "training_iteration": 397, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-43", "timestamp": 1617635683, "time_this_iter_s": 1.4328434467315674, "time_total_s": 679.9252882003784, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 515.1388237476349, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 24.19772828394991, "episode_reward_mean": 60.962847046865335, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.75419082391597, "MDD_min": 15.469092837287562, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034541582315923, "mean_inference_ms": 1.2777083902623128, "mean_action_processing_ms": 0.05446846681903532, "mean_env_wait_ms": 1.1962479866608655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3000000, "timers": {"sample_time_ms": 1164.193, "sample_throughput": 6528.13, "learn_time_ms": 304.103, "learn_throughput": 24991.562, "update_time_ms": 2.778}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1161986242990967e-103, "cur_lr": 0.001, "total_loss": 0.6772433221340179, "policy_loss": 0.019801243906840682, "vf_loss": 0.6574420630931854, "vf_explained_var": 0.979230523109436, "kl": 0.001528410823084414, "entropy": -6.883600234985352, "entropy_coeff": 0.0}}, "num_steps_sampled": 3000000, "num_steps_trained": 3000000}, "done": false, "episodes_total": 2993, "training_iteration": 398, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-45", "timestamp": 1617635685, "time_this_iter_s": 1.5375666618347168, "time_total_s": 681.4628548622131, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345130e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 516.6763904094696, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 80.4, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 24.19772828394991, "episode_reward_mean": 60.96284704686533, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.75419082391597, "MDD_min": 15.469092837287562, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [46.952026999624266, 36.62838693392066, 67.51405903122519, 46.14343959848463, 61.77463127192526, 36.409761075385006, 34.62618006132888, 80.31981767345071, 63.928320128857294, 34.89533926694479, 71.70904278643191, 35.47712721980258, 47.09507956241061, 54.543357254721364, 42.591284508855765, 29.841048543855674, 35.43604694393749, 53.157824505830746, 118.89845227562341, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034541582315918, "mean_inference_ms": 1.2777083902623123, "mean_action_processing_ms": 0.054468466819035305, "mean_env_wait_ms": 1.1962479866608657, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3007600, "timers": {"sample_time_ms": 1162.763, "sample_throughput": 6536.156, "learn_time_ms": 303.485, "learn_throughput": 25042.417, "update_time_ms": 2.825}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.5809931214954833e-104, "cur_lr": 0.001, "total_loss": 0.06206023879349232, "policy_loss": 0.006068585789762437, "vf_loss": 0.055991653352975845, "vf_explained_var": 0.967182457447052, "kl": 0.001599696755874902, "entropy": -6.798438310623169, "entropy_coeff": 0.0}}, "num_steps_sampled": 3007600, "num_steps_trained": 3007600}, "done": false, "episodes_total": 2993, "training_iteration": 399, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-46", "timestamp": 1617635686, "time_this_iter_s": 1.4380950927734375, "time_total_s": 682.9009499549866, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 518.114485502243, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 24.19772828394991, "episode_reward_mean": 63.08207681865917, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.86977598526611, "MDD_min": 15.469092837287562, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20037620004198317, "mean_inference_ms": 1.2777148636177702, "mean_action_processing_ms": 0.05447148193105845, "mean_env_wait_ms": 1.196265017232055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3015200, "timers": {"sample_time_ms": 1162.391, "sample_throughput": 6538.245, "learn_time_ms": 303.522, "learn_throughput": 25039.397, "update_time_ms": 2.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7904965607477417e-104, "cur_lr": 0.001, "total_loss": 0.829359620809555, "policy_loss": -0.006657826830632985, "vf_loss": 0.8360174298286438, "vf_explained_var": 0.9823514223098755, "kl": 0.0014780974015593529, "entropy": -7.039612054824829, "entropy_coeff": 0.0}}, "num_steps_sampled": 3015200, "num_steps_trained": 3015200}, "done": false, "episodes_total": 3012, "training_iteration": 400, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-48", "timestamp": 1617635688, "time_this_iter_s": 1.5173218250274658, "time_total_s": 684.418271780014, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 519.6318073272705, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 24.19772828394991, "episode_reward_mean": 63.08207681865917, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.869775985266106, "MDD_min": 15.469092837287562, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003762000419832, "mean_inference_ms": 1.2777148636177704, "mean_action_processing_ms": 0.054471481931058455, "mean_env_wait_ms": 1.196265017232055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3022800, "timers": {"sample_time_ms": 1161.156, "sample_throughput": 6545.204, "learn_time_ms": 301.617, "learn_throughput": 25197.522, "update_time_ms": 2.791}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3952482803738708e-104, "cur_lr": 0.001, "total_loss": 0.013850308023393154, "policy_loss": -0.003455928475887049, "vf_loss": 0.01730623748153448, "vf_explained_var": 0.9782931208610535, "kl": 0.0018590252147987485, "entropy": -6.883634328842163, "entropy_coeff": 0.0}}, "num_steps_sampled": 3022800, "num_steps_trained": 3022800}, "done": false, "episodes_total": 3012, "training_iteration": 401, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-49", "timestamp": 1617635689, "time_this_iter_s": 1.4236600399017334, "time_total_s": 685.8419318199158, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513b90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 521.0554673671722, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 71.8, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 24.19772828394991, "episode_reward_mean": 63.08207681865917, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.869775985266106, "MDD_min": 15.469092837287562, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [78.83640693989264, 71.15936100078054, 52.602815998874554, 43.11223920272307, 56.129132073253345, 51.38978495429247, 85.94322509950584, 27.317866844338944, 62.23513604664044, 43.098995332332436, 43.190823185622726, 45.124665617792765, 96.3948181861938, 57.37497977768696, 34.51829072647736, 78.31505559882687, 103.4506397648403, 30.686781633443367, 56.307898944917895, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003762000419832, "mean_inference_ms": 1.2777148636177704, "mean_action_processing_ms": 0.054471481931058455, "mean_env_wait_ms": 1.196265017232055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3030400, "timers": {"sample_time_ms": 1159.33, "sample_throughput": 6555.51, "learn_time_ms": 301.079, "learn_throughput": 25242.573, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.976241401869354e-105, "cur_lr": 0.001, "total_loss": 0.22559956461191177, "policy_loss": -0.03202891396358609, "vf_loss": 0.2576284855604172, "vf_explained_var": 0.9880300760269165, "kl": 0.0016664264257997274, "entropy": -7.072770118713379, "entropy_coeff": 0.0}}, "num_steps_sampled": 3030400, "num_steps_trained": 3030400}, "done": false, "episodes_total": 3012, "training_iteration": 402, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-51", "timestamp": 1617635691, "time_this_iter_s": 1.4082343578338623, "time_total_s": 687.2501661777496, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345133b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 522.4637017250061, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 72.65, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 63.91141102605232, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.755607087256458, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036039884297513, "mean_inference_ms": 1.277705582988526, "mean_action_processing_ms": 0.054472312491039565, "mean_env_wait_ms": 1.1962613989188917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3038000, "timers": {"sample_time_ms": 1159.21, "sample_throughput": 6556.189, "learn_time_ms": 301.019, "learn_throughput": 25247.566, "update_time_ms": 2.776}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.488120700934677e-105, "cur_lr": 0.001, "total_loss": 0.5794635564088821, "policy_loss": 0.0031833036337047815, "vf_loss": 0.5762802362442017, "vf_explained_var": 0.9821929931640625, "kl": 0.0021073835669085383, "entropy": -6.875590562820435, "entropy_coeff": 0.0}}, "num_steps_sampled": 3038000, "num_steps_trained": 3038000}, "done": false, "episodes_total": 3031, "training_iteration": 403, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-52", "timestamp": 1617635692, "time_this_iter_s": 1.5442018508911133, "time_total_s": 688.7943680286407, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 524.0079035758972, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 154.30181694721318, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 63.91141102605233, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.755607087256458, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [42.47228195267325, 30.595546015099774, 54.76069999293952, 68.33550722407432, 53.439383174585075, 45.80388494543251, 77.98095452758123, 154.30181694721318, 65.59838098274228, 87.94795369756056, 98.74567430970016, 42.76879073188732, 100.48314832407178, 70.52828481204791, 95.83090570991929, 47.50191435164369, 53.60650127128343, 45.25787809235403, 107.64774176907027, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036039884297516, "mean_inference_ms": 1.277705582988526, "mean_action_processing_ms": 0.054472312491039565, "mean_env_wait_ms": 1.1962613989188917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3045600, "timers": {"sample_time_ms": 1157.707, "sample_throughput": 6564.699, "learn_time_ms": 301.714, "learn_throughput": 25189.43, "update_time_ms": 2.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7440603504673385e-105, "cur_lr": 0.001, "total_loss": 0.05843710899353027, "policy_loss": 0.01205359073355794, "vf_loss": 0.04638352058827877, "vf_explained_var": 0.975386381149292, "kl": 0.001638406130950898, "entropy": -6.832330703735352, "entropy_coeff": 0.0}}, "num_steps_sampled": 3045600, "num_steps_trained": 3045600}, "done": false, "episodes_total": 3031, "training_iteration": 404, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-54", "timestamp": 1617635694, "time_this_iter_s": 1.4176673889160156, "time_total_s": 690.2120354175568, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 525.4255709648132, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 123.7998580583304, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.75833000374242, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.407116575757136, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038259808459913, "mean_inference_ms": 1.2776793642295887, "mean_action_processing_ms": 0.0544717521984649, "mean_env_wait_ms": 1.1962443304996968, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3053200, "timers": {"sample_time_ms": 1157.964, "sample_throughput": 6563.246, "learn_time_ms": 302.132, "learn_throughput": 25154.579, "update_time_ms": 2.783}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.720301752336693e-106, "cur_lr": 0.001, "total_loss": 0.8046980202198029, "policy_loss": 0.006468963634688407, "vf_loss": 0.7982289791107178, "vf_explained_var": 0.9839693307876587, "kl": 0.0021437190007418394, "entropy": -7.026946783065796, "entropy_coeff": 0.0}}, "num_steps_sampled": 3053200, "num_steps_trained": 3053200}, "done": false, "episodes_total": 3050, "training_iteration": 405, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-55", "timestamp": 1617635695, "time_this_iter_s": 1.5465965270996094, "time_total_s": 691.7586319446564, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 526.9721674919128, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 70.8, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 123.7998580583304, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.75833000374242, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.40711657575714, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003825980845991, "mean_inference_ms": 1.2776793642295887, "mean_action_processing_ms": 0.05447175219846489, "mean_env_wait_ms": 1.196244330499697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3060800, "timers": {"sample_time_ms": 1157.21, "sample_throughput": 6567.519, "learn_time_ms": 302.679, "learn_throughput": 25109.141, "update_time_ms": 2.824}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.3601508761683463e-106, "cur_lr": 0.001, "total_loss": 0.011829675117041916, "policy_loss": -0.006168661406263709, "vf_loss": 0.01799833495169878, "vf_explained_var": 0.983106791973114, "kl": 0.0018265875696670264, "entropy": -6.908102512359619, "entropy_coeff": 0.0}}, "num_steps_sampled": 3060800, "num_steps_trained": 3060800}, "done": false, "episodes_total": 3050, "training_iteration": 406, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-57", "timestamp": 1617635697, "time_this_iter_s": 1.426445484161377, "time_total_s": 693.1850774288177, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 528.3986129760742, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 74.8, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 123.7998580583304, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.75833000374242, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.40711657575714, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [67.17468927209647, 40.88099966347247, 55.11171665978597, 71.36908204651616, 70.29538142492491, 68.42719159481074, 75.14359520304177, 57.50504321771785, 40.461930744743064, 63.58483485679275, 34.867706039388935, 39.015706103856175, 49.695915943731336, 85.99906820095266, 55.547698879767005, 57.81822992964318, 90.11062387486585, 94.06929848686278, 32.82761123088417, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003825980845991, "mean_inference_ms": 1.2776793642295887, "mean_action_processing_ms": 0.05447175219846489, "mean_env_wait_ms": 1.196244330499697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3068400, "timers": {"sample_time_ms": 1156.289, "sample_throughput": 6572.749, "learn_time_ms": 302.945, "learn_throughput": 25087.037, "update_time_ms": 2.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1800754380841732e-106, "cur_lr": 0.001, "total_loss": 0.19451330602169037, "policy_loss": -0.011133150896057487, "vf_loss": 0.20564646273851395, "vf_explained_var": 0.9912044405937195, "kl": 0.0018287192797288299, "entropy": -7.100103855133057, "entropy_coeff": 0.0}}, "num_steps_sampled": 3068400, "num_steps_trained": 3068400}, "done": false, "episodes_total": 3050, "training_iteration": 407, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-14-58", "timestamp": 1617635698, "time_this_iter_s": 1.425635814666748, "time_total_s": 694.6107132434845, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345163b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 529.824248790741, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 74.5, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 123.7998580583304, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.00495241168732, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.264994569034492, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036131666506996, "mean_inference_ms": 1.277640828989675, "mean_action_processing_ms": 0.054470258797667294, "mean_env_wait_ms": 1.1962076127256172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3076000, "timers": {"sample_time_ms": 1155.856, "sample_throughput": 6575.215, "learn_time_ms": 302.824, "learn_throughput": 25097.077, "update_time_ms": 2.755}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0900377190420866e-106, "cur_lr": 0.001, "total_loss": 0.4382741153240204, "policy_loss": 0.004538508481346071, "vf_loss": 0.43373557925224304, "vf_explained_var": 0.9863853454589844, "kl": 0.0014067652518860996, "entropy": -6.904155492782593, "entropy_coeff": 0.0}}, "num_steps_sampled": 3076000, "num_steps_trained": 3076000}, "done": false, "episodes_total": 3069, "training_iteration": 408, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-00", "timestamp": 1617635700, "time_this_iter_s": 1.5320355892181396, "time_total_s": 696.1427488327026, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 531.3562843799591, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 79.4, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 123.7998580583304, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.004952411687306, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.264994569034492, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [56.882464628149464, 56.86078820340813, 57.059788038756274, 78.23210107284652, 33.290642806528496, 56.483922361112825, 96.58495641732912, 38.17217905289665, 86.19759211443117, 73.42623806092651, 34.56013873035926, 64.4308283272369, 65.95292151445197, 110.64566036112625, 58.33995440376567, 63.474332958210056, 56.82572242921366, 51.284987787312915, 24.19772828394991, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036131666506996, "mean_inference_ms": 1.277640828989675, "mean_action_processing_ms": 0.054470258797667294, "mean_env_wait_ms": 1.196207612725617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3083600, "timers": {"sample_time_ms": 1154.468, "sample_throughput": 6583.118, "learn_time_ms": 302.103, "learn_throughput": 25157.005, "update_time_ms": 2.705}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.450188595210433e-107, "cur_lr": 0.001, "total_loss": 0.031291824067011476, "policy_loss": -0.022368332836776972, "vf_loss": 0.053660158067941666, "vf_explained_var": 0.969656765460968, "kl": 0.0015702320379205048, "entropy": -6.8314008712768555, "entropy_coeff": 0.0}}, "num_steps_sampled": 3083600, "num_steps_trained": 3083600}, "done": false, "episodes_total": 3069, "training_iteration": 409, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-01", "timestamp": 1617635701, "time_this_iter_s": 1.4168081283569336, "time_total_s": 697.5595569610596, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 532.773092508316, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 73.05, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 63.444401752531434, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.941308365806517, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038164200562986, "mean_inference_ms": 1.277594487899682, "mean_action_processing_ms": 0.05446834474424844, "mean_env_wait_ms": 1.196176046916654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3091200, "timers": {"sample_time_ms": 1155.49, "sample_throughput": 6577.296, "learn_time_ms": 302.672, "learn_throughput": 25109.691, "update_time_ms": 2.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7250942976052165e-107, "cur_lr": 0.001, "total_loss": 1.1716002225875854, "policy_loss": -0.020852078683674335, "vf_loss": 1.1924523711204529, "vf_explained_var": 0.9766829013824463, "kl": 0.0021430717315524817, "entropy": -7.046391010284424, "entropy_coeff": 0.0}}, "num_steps_sampled": 3091200, "num_steps_trained": 3091200}, "done": false, "episodes_total": 3088, "training_iteration": 410, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-03", "timestamp": 1617635703, "time_this_iter_s": 1.5339946746826172, "time_total_s": 699.0935516357422, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 534.3070871829987, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 63.44440175253144, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.941308365806528, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038164200562988, "mean_inference_ms": 1.2775944878996819, "mean_action_processing_ms": 0.054468344744248436, "mean_env_wait_ms": 1.196176046916654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3098800, "timers": {"sample_time_ms": 1153.743, "sample_throughput": 6587.256, "learn_time_ms": 303.603, "learn_throughput": 25032.678, "update_time_ms": 2.738}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3625471488026082e-107, "cur_lr": 0.001, "total_loss": 0.023752410896122456, "policy_loss": 0.0011860716331284493, "vf_loss": 0.022566339932382107, "vf_explained_var": 0.9857141971588135, "kl": 0.0014883939293213189, "entropy": -6.895608901977539, "entropy_coeff": 0.0}}, "num_steps_sampled": 3098800, "num_steps_trained": 3098800}, "done": false, "episodes_total": 3088, "training_iteration": 411, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-04", "timestamp": 1617635704, "time_this_iter_s": 1.4154868125915527, "time_total_s": 700.5090384483337, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345acd40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 535.7225739955902, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 72.6, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 63.44440175253144, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.941308365806528, "MDD_min": 14.11921801227616, "MDD_max": 39.70875399821178}, "hist_stats": {"episode_reward": [65.4253913909627, 71.98041687661159, 72.5501129872673, 30.05083482353227, 84.73128627936083, 42.01659714081085, 41.00197083242307, 76.51336295298502, 53.55278733546608, 52.951066631162995, 55.641989892779, 85.37812581060997, 73.26218197712201, 123.7998580583304, 51.98780354076366, 86.93954114879271, 54.693151679980275, 28.508965594979266, 88.24105270970237, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20038164200562988, "mean_inference_ms": 1.2775944878996819, "mean_action_processing_ms": 0.054468344744248436, "mean_env_wait_ms": 1.196176046916654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3106400, "timers": {"sample_time_ms": 1153.34, "sample_throughput": 6589.556, "learn_time_ms": 304.394, "learn_throughput": 24967.611, "update_time_ms": 2.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.812735744013041e-108, "cur_lr": 0.001, "total_loss": 0.23681624233722687, "policy_loss": 0.009617175557650626, "vf_loss": 0.22719908505678177, "vf_explained_var": 0.9913524389266968, "kl": 0.0018237007316201925, "entropy": -7.107418537139893, "entropy_coeff": 0.0}}, "num_steps_sampled": 3106400, "num_steps_trained": 3106400}, "done": false, "episodes_total": 3088, "training_iteration": 412, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-06", "timestamp": 1617635706, "time_this_iter_s": 1.412020206451416, "time_total_s": 701.9210586547852, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 537.1345942020416, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 72.05, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.83277407440015, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.49907884750931, "MDD_min": 12.054272667806657, "MDD_max": 32.466089766871775}, "hist_stats": {"episode_reward": [52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036043474776932, "mean_inference_ms": 1.2775443130180946, "mean_action_processing_ms": 0.054466917437239776, "mean_env_wait_ms": 1.1961379233364942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3114000, "timers": {"sample_time_ms": 1152.424, "sample_throughput": 6594.797, "learn_time_ms": 304.615, "learn_throughput": 24949.566, "update_time_ms": 2.796}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4063678720065206e-108, "cur_lr": 0.001, "total_loss": 0.7326994240283966, "policy_loss": -0.0006748304804204963, "vf_loss": 0.7333742380142212, "vf_explained_var": 0.9767719507217407, "kl": 0.0015381438424810767, "entropy": -6.901684522628784, "entropy_coeff": 0.0}}, "num_steps_sampled": 3114000, "num_steps_trained": 3114000}, "done": false, "episodes_total": 3107, "training_iteration": 413, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-07", "timestamp": 1617635707, "time_this_iter_s": 1.5372288227081299, "time_total_s": 703.4582874774933, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 538.6718230247498, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 67.26666666666667, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 20.211664926522335, "episode_reward_mean": 62.832774074400135, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.49907884750931, "MDD_min": 12.054272667806657, "MDD_max": 32.466089766871775}, "hist_stats": {"episode_reward": [81.80870372692304, 50.28770552425885, 34.65021340459312, 58.14077485405182, 70.4883500062658, 55.051720223000984, 52.92083271264112, 53.7271960043777, 65.93151306690721, 94.12291325952516, 46.347664743253134, 82.74779438207777, 113.77185264230577, 20.211664926522335, 64.54851412643852, 61.02293276016917, 53.41260288469464, 52.23988048222601, 64.19545529742956, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036043474776924, "mean_inference_ms": 1.2775443130180948, "mean_action_processing_ms": 0.05446691743723977, "mean_env_wait_ms": 1.1961379233364942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3121600, "timers": {"sample_time_ms": 1152.026, "sample_throughput": 6597.071, "learn_time_ms": 303.787, "learn_throughput": 25017.488, "update_time_ms": 2.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7031839360032603e-108, "cur_lr": 0.001, "total_loss": 0.06116166524589062, "policy_loss": 0.0014939485117793083, "vf_loss": 0.05966773070394993, "vf_explained_var": 0.9647889137268066, "kl": 0.0019244825816713274, "entropy": -6.8345043659210205, "entropy_coeff": 0.0}}, "num_steps_sampled": 3121600, "num_steps_trained": 3121600}, "done": false, "episodes_total": 3107, "training_iteration": 414, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-09", "timestamp": 1617635709, "time_this_iter_s": 1.4059247970581055, "time_total_s": 704.8642122745514, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 540.0777478218079, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 35.05278349640316, "episode_reward_mean": 65.00489047338843, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.23899118011433, "MDD_min": 12.054272667806657, "MDD_max": 32.466089766871775}, "hist_stats": {"episode_reward": [70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20037868026411723, "mean_inference_ms": 1.2774991907357611, "mean_action_processing_ms": 0.05446551430053547, "mean_env_wait_ms": 1.1961052075930838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3129200, "timers": {"sample_time_ms": 1150.561, "sample_throughput": 6605.476, "learn_time_ms": 303.286, "learn_throughput": 25058.887, "update_time_ms": 2.796}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.515919680016301e-109, "cur_lr": 0.001, "total_loss": 1.0843978524208069, "policy_loss": 0.0021784738055430353, "vf_loss": 1.0822193622589111, "vf_explained_var": 0.9792558550834656, "kl": 0.0027787330327555537, "entropy": -7.047046661376953, "entropy_coeff": 0.0}}, "num_steps_sampled": 3129200, "num_steps_trained": 3129200}, "done": false, "episodes_total": 3126, "training_iteration": 415, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-10", "timestamp": 1617635710, "time_this_iter_s": 1.5271437168121338, "time_total_s": 706.3913559913635, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345163b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 541.60489153862, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 35.05278349640316, "episode_reward_mean": 65.00489047338841, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.238991180114322, "MDD_min": 12.054272667806657, "MDD_max": 32.466089766871775}, "hist_stats": {"episode_reward": [41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20037868026411723, "mean_inference_ms": 1.2774991907357611, "mean_action_processing_ms": 0.054465514300535485, "mean_env_wait_ms": 1.196105207593084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3136800, "timers": {"sample_time_ms": 1149.259, "sample_throughput": 6612.957, "learn_time_ms": 303.0, "learn_throughput": 25082.526, "update_time_ms": 2.748}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.257959840008151e-109, "cur_lr": 0.001, "total_loss": 0.022782483138144016, "policy_loss": 0.0051708127139136195, "vf_loss": 0.01761166751384735, "vf_explained_var": 0.9886429309844971, "kl": 0.0012532120454125106, "entropy": -6.9256885051727295, "entropy_coeff": 0.0}}, "num_steps_sampled": 3136800, "num_steps_trained": 3136800}, "done": false, "episodes_total": 3126, "training_iteration": 416, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-11", "timestamp": 1617635711, "time_this_iter_s": 1.4102585315704346, "time_total_s": 707.801614522934, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 543.0151500701904, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 35.05278349640316, "episode_reward_mean": 65.00489047338841, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.238991180114322, "MDD_min": 12.054272667806657, "MDD_max": 32.466089766871775}, "hist_stats": {"episode_reward": [41.88893749762224, 96.4243513054578, 72.43617352271552, 56.04653767806191, 53.07380015232495, 67.86768690653697, 50.81748647309946, 105.59566970424821, 63.65526245126755, 62.24392398780606, 86.63401189789586, 70.90788037289862, 37.58284727736951, 91.33471865273997, 81.8418014086749, 41.70573093376246, 39.48411675966136, 37.347313693688974, 53.0878672569788, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20037868026411723, "mean_inference_ms": 1.2774991907357611, "mean_action_processing_ms": 0.054465514300535485, "mean_env_wait_ms": 1.196105207593084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3144400, "timers": {"sample_time_ms": 1147.897, "sample_throughput": 6620.802, "learn_time_ms": 303.119, "learn_throughput": 25072.691, "update_time_ms": 2.765}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1289799200040754e-109, "cur_lr": 0.001, "total_loss": 0.21005325764417648, "policy_loss": 0.00231637479737401, "vf_loss": 0.20773687958717346, "vf_explained_var": 0.991554856300354, "kl": 0.0015975721762515604, "entropy": -7.105146884918213, "entropy_coeff": 0.0}}, "num_steps_sampled": 3144400, "num_steps_trained": 3144400}, "done": false, "episodes_total": 3126, "training_iteration": 417, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-13", "timestamp": 1617635713, "time_this_iter_s": 1.4138679504394531, "time_total_s": 709.2154824733734, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 544.4290180206299, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 74.19999999999999, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 31.8707115027739, "episode_reward_mean": 64.9456669336482, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.090463912802985, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003539162404147, "mean_inference_ms": 1.2774428214195763, "mean_action_processing_ms": 0.054464714145381704, "mean_env_wait_ms": 1.1960511030637608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3152000, "timers": {"sample_time_ms": 1148.502, "sample_throughput": 6617.314, "learn_time_ms": 303.087, "learn_throughput": 25075.332, "update_time_ms": 2.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0644899600020377e-109, "cur_lr": 0.001, "total_loss": 0.6109922826290131, "policy_loss": -0.0007082996307872236, "vf_loss": 0.6117005944252014, "vf_explained_var": 0.9789003133773804, "kl": 0.0030482084257528186, "entropy": -6.900966167449951, "entropy_coeff": 0.0}}, "num_steps_sampled": 3152000, "num_steps_trained": 3152000}, "done": false, "episodes_total": 3145, "training_iteration": 418, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-14", "timestamp": 1617635714, "time_this_iter_s": 1.5370419025421143, "time_total_s": 710.7525243759155, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 545.966059923172, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 77.3, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 31.8707115027739, "episode_reward_mean": 64.94566693364818, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.090463912802985, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [73.93159986476226, 67.4254703468869, 68.4339292336904, 57.056879163709375, 71.34495021521151, 59.063908169484684, 35.05278349640316, 48.66812726446813, 41.40175846471785, 64.06401546041843, 46.06570559075187, 43.15601166414608, 59.073735423234645, 60.16086657670319, 64.39497308331828, 46.45579408381874, 46.887796838484924, 64.51392369180125, 79.13884219050799, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003539162404147, "mean_inference_ms": 1.2774428214195763, "mean_action_processing_ms": 0.0544647141453817, "mean_env_wait_ms": 1.1960511030637608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3159600, "timers": {"sample_time_ms": 1148.236, "sample_throughput": 6618.848, "learn_time_ms": 304.212, "learn_throughput": 24982.568, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.3224498000101884e-110, "cur_lr": 0.001, "total_loss": 0.04920788109302521, "policy_loss": -0.0034272104676347226, "vf_loss": 0.05263509787619114, "vf_explained_var": 0.9689130783081055, "kl": 0.0015891550574451685, "entropy": -6.8653013706207275, "entropy_coeff": 0.0}}, "num_steps_sampled": 3159600, "num_steps_trained": 3159600}, "done": false, "episodes_total": 3145, "training_iteration": 419, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-16", "timestamp": 1617635716, "time_this_iter_s": 1.424983263015747, "time_total_s": 712.1775076389313, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 547.3910431861877, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 70.95, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 66.28719036232809, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.150900466630247, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036568533105314, "mean_inference_ms": 1.2773781687001655, "mean_action_processing_ms": 0.054463748834986676, "mean_env_wait_ms": 1.1959914150515631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3167200, "timers": {"sample_time_ms": 1149.699, "sample_throughput": 6610.426, "learn_time_ms": 304.259, "learn_throughput": 24978.729, "update_time_ms": 2.781}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6612249000050942e-110, "cur_lr": 0.001, "total_loss": 0.9204395711421967, "policy_loss": 0.003728461218997836, "vf_loss": 0.9167112112045288, "vf_explained_var": 0.980932354927063, "kl": 0.0011259163729846478, "entropy": -7.054142951965332, "entropy_coeff": 0.0}}, "num_steps_sampled": 3167200, "num_steps_trained": 3167200}, "done": false, "episodes_total": 3164, "training_iteration": 420, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-17", "timestamp": 1617635717, "time_this_iter_s": 1.549290657043457, "time_total_s": 713.7267982959747, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 548.9403338432312, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 66.28719036232809, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.150900466630247, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036568533105317, "mean_inference_ms": 1.2773781687001655, "mean_action_processing_ms": 0.05446374883498667, "mean_env_wait_ms": 1.1959914150515631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3174800, "timers": {"sample_time_ms": 1151.831, "sample_throughput": 6598.193, "learn_time_ms": 304.558, "learn_throughput": 24954.156, "update_time_ms": 2.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3306124500025471e-110, "cur_lr": 0.001, "total_loss": 0.030418636742979288, "policy_loss": 0.011699918890371919, "vf_loss": 0.018718717619776726, "vf_explained_var": 0.9862073659896851, "kl": 0.0013693818473257124, "entropy": -6.915473937988281, "entropy_coeff": 0.0}}, "num_steps_sampled": 3174800, "num_steps_trained": 3174800}, "done": false, "episodes_total": 3164, "training_iteration": 421, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-19", "timestamp": 1617635719, "time_this_iter_s": 1.4397087097167969, "time_total_s": 715.1665070056915, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 550.380042552948, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 70.4, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 175.34507816854634, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 66.28719036232809, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.150900466630247, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [47.47746979827611, 75.97927095443238, 74.52031439656974, 47.471328290985326, 71.02193872982063, 64.92467150316165, 39.18900977008777, 62.461751963148124, 70.21943324228114, 45.22138567798233, 54.38458177332423, 59.05426095881885, 50.234022787361745, 94.02499280244261, 52.13532111223406, 65.7952003864985, 61.23757154768967, 175.34507816854634, 60.22071975351717, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036568533105317, "mean_inference_ms": 1.2773781687001655, "mean_action_processing_ms": 0.05446374883498667, "mean_env_wait_ms": 1.1959914150515631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3182400, "timers": {"sample_time_ms": 1151.798, "sample_throughput": 6598.377, "learn_time_ms": 304.976, "learn_throughput": 24919.995, "update_time_ms": 2.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.653062250012736e-111, "cur_lr": 0.001, "total_loss": 0.21926306188106537, "policy_loss": -0.0067972049582749605, "vf_loss": 0.22606026381254196, "vf_explained_var": 0.9896997213363647, "kl": 0.0023216460831463337, "entropy": -7.079701900482178, "entropy_coeff": 0.0}}, "num_steps_sampled": 3182400, "num_steps_trained": 3182400}, "done": false, "episodes_total": 3164, "training_iteration": 422, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-20", "timestamp": 1617635720, "time_this_iter_s": 1.415862798690796, "time_total_s": 716.5823698043823, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 551.7959053516388, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 72.25, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 145.180136652394, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 64.90620909511136, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.047903820751326, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200335679001876, "mean_inference_ms": 1.2773131649685707, "mean_action_processing_ms": 0.05446259165946639, "mean_env_wait_ms": 1.195925151969963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3190000, "timers": {"sample_time_ms": 1151.811, "sample_throughput": 6598.302, "learn_time_ms": 304.522, "learn_throughput": 24957.155, "update_time_ms": 2.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.326531125006368e-111, "cur_lr": 0.001, "total_loss": 0.6009584963321686, "policy_loss": 0.006912835640832782, "vf_loss": 0.5940456390380859, "vf_explained_var": 0.9791765213012695, "kl": 0.001744175620842725, "entropy": -6.8724365234375, "entropy_coeff": 0.0}}, "num_steps_sampled": 3190000, "num_steps_trained": 3190000}, "done": false, "episodes_total": 3183, "training_iteration": 423, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-22", "timestamp": 1617635722, "time_this_iter_s": 1.5326957702636719, "time_total_s": 718.115065574646, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 553.3286011219025, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 70.33333333333333, "ram_util_percent": 62.20000000000001}, "trial_id": "6c840_00000"}
{"episode_reward_max": 145.180136652394, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 64.90620909511136, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.04790382075133, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [63.383837419310765, 55.298534097211764, 85.29527981873916, 59.90637408635918, 88.51585476770884, 52.00821545916249, 64.43677724811317, 118.3528289226603, 35.932263939564365, 60.94184681318501, 76.23173156707907, 56.8083950917778, 36.78288007430009, 48.16586591014555, 69.80222786930972, 41.42453915578796, 48.574784694755635, 48.34794225619758, 43.40363922636224, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200335679001876, "mean_inference_ms": 1.277313164968571, "mean_action_processing_ms": 0.0544625916594664, "mean_env_wait_ms": 1.195925151969963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3197600, "timers": {"sample_time_ms": 1152.186, "sample_throughput": 6596.157, "learn_time_ms": 305.151, "learn_throughput": 24905.674, "update_time_ms": 2.739}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.663265562503184e-111, "cur_lr": 0.001, "total_loss": 0.01572144217789173, "policy_loss": -0.025949594099074602, "vf_loss": 0.0416710339486599, "vf_explained_var": 0.9775358438491821, "kl": 0.0011987978650722653, "entropy": -6.873196601867676, "entropy_coeff": 0.0}}, "num_steps_sampled": 3197600, "num_steps_trained": 3197600}, "done": false, "episodes_total": 3183, "training_iteration": 424, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-23", "timestamp": 1617635723, "time_this_iter_s": 1.4167170524597168, "time_total_s": 719.5317826271057, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a48c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 554.7453181743622, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 74.05, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 145.180136652394, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 64.14825490489702, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.25146681310422, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003496361341993, "mean_inference_ms": 1.2772623058142176, "mean_action_processing_ms": 0.05446149091266061, "mean_env_wait_ms": 1.1958761401037739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3205200, "timers": {"sample_time_ms": 1153.186, "sample_throughput": 6590.439, "learn_time_ms": 305.496, "learn_throughput": 24877.555, "update_time_ms": 2.728}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.31632781251592e-112, "cur_lr": 0.001, "total_loss": 0.5923246741294861, "policy_loss": -0.034390199929475784, "vf_loss": 0.6267148852348328, "vf_explained_var": 0.9856148958206177, "kl": 0.0015319270896725357, "entropy": -7.058435440063477, "entropy_coeff": 0.0}}, "num_steps_sampled": 3205200, "num_steps_trained": 3205200}, "done": false, "episodes_total": 3202, "training_iteration": 425, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-25", "timestamp": 1617635725, "time_this_iter_s": 1.540092945098877, "time_total_s": 721.0718755722046, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 556.2854111194611, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 81.25, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 145.180136652394, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 64.14825490489702, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.251466813104212, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034963613419926, "mean_inference_ms": 1.2772623058142176, "mean_action_processing_ms": 0.05446149091266061, "mean_env_wait_ms": 1.195876140103774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3212800, "timers": {"sample_time_ms": 1154.26, "sample_throughput": 6584.303, "learn_time_ms": 306.259, "learn_throughput": 24815.567, "update_time_ms": 2.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.15816390625796e-112, "cur_lr": 0.001, "total_loss": 0.002655560150742531, "policy_loss": -0.01406502490863204, "vf_loss": 0.016720585525035858, "vf_explained_var": 0.9883981347084045, "kl": 0.001724627974908799, "entropy": -6.9056031703948975, "entropy_coeff": 0.0}}, "num_steps_sampled": 3212800, "num_steps_trained": 3212800}, "done": false, "episodes_total": 3202, "training_iteration": 426, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-26", "timestamp": 1617635726, "time_this_iter_s": 1.4290814399719238, "time_total_s": 722.5009570121765, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 557.714492559433, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 145.180136652394, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 64.14825490489702, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.251466813104212, "MDD_min": 12.054272667806657, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [63.16170428317223, 145.180136652394, 51.747320439135095, 58.430319244757456, 58.33031100265292, 70.42974320304138, 85.86278404156792, 42.98503763213277, 108.0150536147085, 99.0743030742148, 60.68442632266258, 49.35642289497737, 38.98599654803608, 76.70868408911709, 75.49888614316434, 118.33460185526118, 62.05425789146744, 59.90619350472601, 103.79965060078892, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034963613419926, "mean_inference_ms": 1.2772623058142176, "mean_action_processing_ms": 0.05446149091266061, "mean_env_wait_ms": 1.195876140103774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3220400, "timers": {"sample_time_ms": 1155.198, "sample_throughput": 6578.96, "learn_time_ms": 305.912, "learn_throughput": 24843.708, "update_time_ms": 2.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.07908195312898e-112, "cur_lr": 0.001, "total_loss": 0.22168020904064178, "policy_loss": 0.01350084482692182, "vf_loss": 0.20817936211824417, "vf_explained_var": 0.9901758432388306, "kl": 0.0017530365148559213, "entropy": -7.093392372131348, "entropy_coeff": 0.0}}, "num_steps_sampled": 3220400, "num_steps_trained": 3220400}, "done": false, "episodes_total": 3202, "training_iteration": 427, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-28", "timestamp": 1617635728, "time_this_iter_s": 1.4208126068115234, "time_total_s": 723.921769618988, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 559.1353051662445, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 72.5, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.77408692991025, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 61.18569242086467, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.714291178594145, "MDD_min": 12.16627806798065, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20031691616858852, "mean_inference_ms": 1.2772009736016998, "mean_action_processing_ms": 0.054460317142947565, "mean_env_wait_ms": 1.1958206465404155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3228000, "timers": {"sample_time_ms": 1154.693, "sample_throughput": 6581.838, "learn_time_ms": 305.56, "learn_throughput": 24872.36, "update_time_ms": 2.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.03954097656449e-112, "cur_lr": 0.001, "total_loss": 0.5587345063686371, "policy_loss": -0.008577853441238403, "vf_loss": 0.5673123300075531, "vf_explained_var": 0.9789812564849854, "kl": 0.0019109818385913968, "entropy": -6.88469123840332, "entropy_coeff": 0.0}}, "num_steps_sampled": 3228000, "num_steps_trained": 3228000}, "done": false, "episodes_total": 3221, "training_iteration": 428, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-29", "timestamp": 1617635729, "time_this_iter_s": 1.529212236404419, "time_total_s": 725.4509818553925, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 560.6645174026489, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 62.150000000000006}, "trial_id": "6c840_00000"}
{"episode_reward_max": 112.77408692991025, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 61.18569242086468, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.714291178594138, "MDD_min": 12.16627806798065, "MDD_max": 32.535244354662346}, "hist_stats": {"episode_reward": [111.51196394500103, 75.9578748816856, 46.34348325931833, 36.569634658282794, 70.76092676633547, 43.615883645924626, 66.01433655576746, 66.10418248289744, 46.68991741460874, 65.88113403073477, 62.03171597471509, 63.92704096776116, 48.74870933452375, 84.82652863580515, 54.63115522583716, 70.2662322412996, 72.92637957316208, 74.53404451324975, 83.04544819570705, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20031691616858846, "mean_inference_ms": 1.2772009736016998, "mean_action_processing_ms": 0.054460317142947565, "mean_env_wait_ms": 1.1958206465404155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3235600, "timers": {"sample_time_ms": 1155.354, "sample_throughput": 6578.068, "learn_time_ms": 304.719, "learn_throughput": 24941.033, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.19770488282245e-113, "cur_lr": 0.001, "total_loss": 0.05169712379574776, "policy_loss": -0.0017238742584595457, "vf_loss": 0.05342099815607071, "vf_explained_var": 0.9737017154693604, "kl": 0.0012683583772741258, "entropy": -6.8705315589904785, "entropy_coeff": 0.0}}, "num_steps_sampled": 3235600, "num_steps_trained": 3235600}, "done": false, "episodes_total": 3221, "training_iteration": 429, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-31", "timestamp": 1617635731, "time_this_iter_s": 1.424394130706787, "time_total_s": 726.8753759860992, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 562.0889115333557, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 72.7, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 61.3701319867099, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.123347058552405, "MDD_min": 13.59444588901601, "MDD_max": 32.28585163669078}, "hist_stats": {"episode_reward": [81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20032759435228495, "mean_inference_ms": 1.2771467145138322, "mean_action_processing_ms": 0.054458491669411996, "mean_env_wait_ms": 1.195773648409415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3243200, "timers": {"sample_time_ms": 1154.25, "sample_throughput": 6584.362, "learn_time_ms": 304.173, "learn_throughput": 24985.799, "update_time_ms": 3.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.598852441411225e-113, "cur_lr": 0.001, "total_loss": 1.0752662420272827, "policy_loss": 0.023392830044031143, "vf_loss": 1.051873356103897, "vf_explained_var": 0.9749271869659424, "kl": 0.00460132141597569, "entropy": -7.06909704208374, "entropy_coeff": 0.0}}, "num_steps_sampled": 3243200, "num_steps_trained": 3243200}, "done": false, "episodes_total": 3240, "training_iteration": 430, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-32", "timestamp": 1617635732, "time_this_iter_s": 1.5409538745880127, "time_total_s": 728.4163298606873, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 563.6298654079437, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 65.60000000000001, "ram_util_percent": 62.13333333333333}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 61.3701319867099, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.123347058552408, "MDD_min": 13.59444588901601, "MDD_max": 32.28585163669078}, "hist_stats": {"episode_reward": [79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20032759435228506, "mean_inference_ms": 1.2771467145138322, "mean_action_processing_ms": 0.054458491669411996, "mean_env_wait_ms": 1.1957736484094152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3250800, "timers": {"sample_time_ms": 1159.858, "sample_throughput": 6552.526, "learn_time_ms": 307.35, "learn_throughput": 24727.512, "update_time_ms": 3.655}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2994262207056124e-113, "cur_lr": 0.001, "total_loss": 0.0161502743139863, "policy_loss": -0.0023519706446677446, "vf_loss": 0.018502249382436275, "vf_explained_var": 0.9865676164627075, "kl": 0.0024439243134111166, "entropy": -6.944639444351196, "entropy_coeff": 0.0}}, "num_steps_sampled": 3250800, "num_steps_trained": 3250800}, "done": false, "episodes_total": 3240, "training_iteration": 431, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-34", "timestamp": 1617635734, "time_this_iter_s": 1.5273587703704834, "time_total_s": 729.9436886310577, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a48c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 565.1572241783142, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 85.15, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.53269285629466, "episode_reward_mean": 61.3701319867099, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.123347058552408, "MDD_min": 13.59444588901601, "MDD_max": 32.28585163669078}, "hist_stats": {"episode_reward": [79.55795169855406, 31.8707115027739, 42.06617113139664, 109.69085766441792, 37.62536316965309, 89.17985284737242, 84.90212298289823, 46.10169759933317, 36.245295980988146, 87.349382113835, 37.217389763371315, 72.03806662500509, 41.60919156265091, 69.41980035590842, 61.33694867714642, 58.40514003686538, 27.53269285629466, 51.71208052343471, 88.27682091267448, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20032759435228506, "mean_inference_ms": 1.2771467145138322, "mean_action_processing_ms": 0.054458491669411996, "mean_env_wait_ms": 1.1957736484094152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3258400, "timers": {"sample_time_ms": 1166.391, "sample_throughput": 6515.823, "learn_time_ms": 307.915, "learn_throughput": 24682.118, "update_time_ms": 3.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.497131103528062e-114, "cur_lr": 0.001, "total_loss": 0.2516312673687935, "policy_loss": -0.006377362180501223, "vf_loss": 0.25800860673189163, "vf_explained_var": 0.9878410696983337, "kl": 0.0028071014676243067, "entropy": -7.110237121582031, "entropy_coeff": 0.0}}, "num_steps_sampled": 3258400, "num_steps_trained": 3258400}, "done": false, "episodes_total": 3240, "training_iteration": 432, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-35", "timestamp": 1617635735, "time_this_iter_s": 1.4879951477050781, "time_total_s": 731.4316837787628, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344a4680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 566.6452193260193, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 81.85, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 63.18107830645762, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.21104437120617, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20032007220280812, "mean_inference_ms": 1.2773048465442107, "mean_action_processing_ms": 0.05446852312432146, "mean_env_wait_ms": 1.1959164444014896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3266000, "timers": {"sample_time_ms": 1212.871, "sample_throughput": 6266.122, "learn_time_ms": 308.388, "learn_throughput": 24644.245, "update_time_ms": 3.71}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.248565551764031e-114, "cur_lr": 0.001, "total_loss": 0.7148623168468475, "policy_loss": -0.0012366081355139613, "vf_loss": 0.7160989344120026, "vf_explained_var": 0.9767667055130005, "kl": 0.003060764283873141, "entropy": -6.893843412399292, "entropy_coeff": 0.0}}, "num_steps_sampled": 3266000, "num_steps_trained": 3266000}, "done": false, "episodes_total": 3259, "training_iteration": 433, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-37", "timestamp": 1617635737, "time_this_iter_s": 2.0025627613067627, "time_total_s": 733.4342465400696, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 568.647782087326, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 76.96666666666667, "ram_util_percent": 62.06666666666666}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 63.18107830645763, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.211044371206167, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [52.85864955892417, 57.01660833396053, 96.06965685320239, 60.39792917673403, 112.77408692991025, 30.007968639085725, 92.41595132231528, 54.664146465890376, 54.2422840062748, 42.08757051274219, 65.11543081925863, 79.07522355374641, 53.1665219347629, 46.54848821443983, 47.753269896101536, 95.23901112064836, 32.91953745232251, 57.309618336019604, 80.01389649860083, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20032007220280804, "mean_inference_ms": 1.2773048465442105, "mean_action_processing_ms": 0.054468523124321475, "mean_env_wait_ms": 1.1959164444014898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3273600, "timers": {"sample_time_ms": 1213.377, "sample_throughput": 6263.512, "learn_time_ms": 308.616, "learn_throughput": 24626.058, "update_time_ms": 3.684}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6242827758820155e-114, "cur_lr": 0.001, "total_loss": 0.047495037317276, "policy_loss": -0.0027394515345804393, "vf_loss": 0.050234487280249596, "vf_explained_var": 0.978596568107605, "kl": 0.0018559150048531592, "entropy": -6.88167142868042, "entropy_coeff": 0.0}}, "num_steps_sampled": 3273600, "num_steps_trained": 3273600}, "done": false, "episodes_total": 3259, "training_iteration": 434, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-39", "timestamp": 1617635739, "time_this_iter_s": 1.4227230548858643, "time_total_s": 734.8569695949554, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 570.0705051422119, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 74.19999999999999, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 62.94119752664909, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.694697408674486, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034652063198966, "mean_inference_ms": 1.2774656885725775, "mean_action_processing_ms": 0.05447827341492992, "mean_env_wait_ms": 1.1960665787879945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3281200, "timers": {"sample_time_ms": 1214.473, "sample_throughput": 6257.859, "learn_time_ms": 308.262, "learn_throughput": 24654.361, "update_time_ms": 3.702}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.121413879410078e-115, "cur_lr": 0.001, "total_loss": 0.8158935010433197, "policy_loss": -0.005399612186010927, "vf_loss": 0.8212931454181671, "vf_explained_var": 0.9824751019477844, "kl": 0.002514737076126039, "entropy": -7.057893514633179, "entropy_coeff": 0.0}}, "num_steps_sampled": 3281200, "num_steps_trained": 3281200}, "done": false, "episodes_total": 3278, "training_iteration": 435, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-40", "timestamp": 1617635740, "time_this_iter_s": 1.547111988067627, "time_total_s": 736.4040815830231, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 571.6176171302795, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 80.7, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 62.94119752664911, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.694697408674482, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034652063198974, "mean_inference_ms": 1.2774656885725775, "mean_action_processing_ms": 0.054478273414929904, "mean_env_wait_ms": 1.1960665787879945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3288800, "timers": {"sample_time_ms": 1214.143, "sample_throughput": 6259.559, "learn_time_ms": 306.868, "learn_throughput": 24766.329, "update_time_ms": 3.714}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.060706939705039e-115, "cur_lr": 0.001, "total_loss": 0.04364976356737316, "policy_loss": 0.024994318839162588, "vf_loss": 0.018655448220670223, "vf_explained_var": 0.9866461753845215, "kl": 0.0013517663755919784, "entropy": -6.996256113052368, "entropy_coeff": 0.0}}, "num_steps_sampled": 3288800, "num_steps_trained": 3288800}, "done": false, "episodes_total": 3278, "training_iteration": 436, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-42", "timestamp": 1617635742, "time_this_iter_s": 1.411527156829834, "time_total_s": 737.8156087398529, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345160e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 573.0291442871094, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 62.94119752664911, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.694697408674482, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [95.51063084410178, 35.07932159743028, 40.32764372749238, 49.34461131074498, 81.99907064352611, 81.40035122031348, 57.17347772495491, 43.02737148088645, 66.6168750927546, 76.4225374584506, 36.3486756598704, 53.24552010085227, 80.85230667212849, 53.782050825606774, 61.201035119902066, 54.82024604833564, 43.912127935600154, 38.67746244208021, 44.98777083529361, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034652063198974, "mean_inference_ms": 1.2774656885725775, "mean_action_processing_ms": 0.054478273414929904, "mean_env_wait_ms": 1.1960665787879945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3296400, "timers": {"sample_time_ms": 1214.304, "sample_throughput": 6258.727, "learn_time_ms": 306.465, "learn_throughput": 24798.912, "update_time_ms": 3.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0303534698525194e-115, "cur_lr": 0.001, "total_loss": 0.23833055049180984, "policy_loss": 0.009702725801616907, "vf_loss": 0.22862782329320908, "vf_explained_var": 0.9907531142234802, "kl": 0.0014911331236362457, "entropy": -7.150532960891724, "entropy_coeff": 0.0}}, "num_steps_sampled": 3296400, "num_steps_trained": 3296400}, "done": false, "episodes_total": 3278, "training_iteration": 437, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-43", "timestamp": 1617635743, "time_this_iter_s": 1.4172728061676025, "time_total_s": 739.2328815460205, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516dd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 574.446417093277, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 64.38517418173598, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.634218126933366, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033345791749899, "mean_inference_ms": 1.2776161077442647, "mean_action_processing_ms": 0.054488416529996545, "mean_env_wait_ms": 1.1962142235490556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3304000, "timers": {"sample_time_ms": 1215.052, "sample_throughput": 6254.878, "learn_time_ms": 306.677, "learn_throughput": 24781.744, "update_time_ms": 3.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0151767349262597e-115, "cur_lr": 0.001, "total_loss": 0.7281474471092224, "policy_loss": 0.006156714225653559, "vf_loss": 0.7219908535480499, "vf_explained_var": 0.9785284996032715, "kl": 0.0032105037244036794, "entropy": -6.904411554336548, "entropy_coeff": 0.0}}, "num_steps_sampled": 3304000, "num_steps_trained": 3304000}, "done": false, "episodes_total": 3297, "training_iteration": 438, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-45", "timestamp": 1617635745, "time_this_iter_s": 1.5391156673431396, "time_total_s": 740.7719972133636, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 575.9855327606201, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 71.6, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 27.563512777944734, "episode_reward_mean": 64.38517418173596, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.634218126933366, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [62.23608283226468, 73.04342371707672, 36.86840672643304, 67.56467462391818, 45.63800287957501, 29.51523365186237, 57.68320317649536, 47.909627438075454, 100.75905802404901, 68.70136126295363, 58.15467200041464, 51.91786043632856, 49.535917997205885, 33.420769288142615, 65.32123602838276, 76.62518127384669, 40.49299079483497, 48.89892041613872, 38.68370664828787, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033345791749896, "mean_inference_ms": 1.2776161077442647, "mean_action_processing_ms": 0.054488416529996545, "mean_env_wait_ms": 1.1962142235490558, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3311600, "timers": {"sample_time_ms": 1214.371, "sample_throughput": 6258.386, "learn_time_ms": 306.818, "learn_throughput": 24770.411, "update_time_ms": 3.744}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.075883674631299e-116, "cur_lr": 0.001, "total_loss": 0.05287131853401661, "policy_loss": 0.0060770693235099316, "vf_loss": 0.04679425060749054, "vf_explained_var": 0.9792013168334961, "kl": 0.0012380958651192486, "entropy": -6.914041757583618, "entropy_coeff": 0.0}}, "num_steps_sampled": 3311600, "num_steps_trained": 3311600}, "done": false, "episodes_total": 3297, "training_iteration": 439, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-46", "timestamp": 1617635746, "time_this_iter_s": 1.418464183807373, "time_total_s": 742.190461397171, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 577.4039969444275, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 73.3, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 63.961934683406554, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.745030615614354, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20035736825401354, "mean_inference_ms": 1.2777771484175278, "mean_action_processing_ms": 0.05449910353725163, "mean_env_wait_ms": 1.1963725498225692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3319200, "timers": {"sample_time_ms": 1214.418, "sample_throughput": 6258.139, "learn_time_ms": 306.835, "learn_throughput": 24768.993, "update_time_ms": 2.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5379418373156492e-116, "cur_lr": 0.001, "total_loss": 0.6764708757400513, "policy_loss": -0.012408336624503136, "vf_loss": 0.6888791918754578, "vf_explained_var": 0.9863096475601196, "kl": 0.0015508028445765376, "entropy": -7.0752177238464355, "entropy_coeff": 0.0}}, "num_steps_sampled": 3319200, "num_steps_trained": 3319200}, "done": false, "episodes_total": 3316, "training_iteration": 440, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-48", "timestamp": 1617635748, "time_this_iter_s": 1.5328645706176758, "time_total_s": 743.7233259677887, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345165f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 578.9368615150452, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 67.0, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 63.96193468340655, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.74503061561435, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20035736825401354, "mean_inference_ms": 1.2777771484175278, "mean_action_processing_ms": 0.05449910353725164, "mean_env_wait_ms": 1.196372549822569, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3326800, "timers": {"sample_time_ms": 1207.498, "sample_throughput": 6294.005, "learn_time_ms": 302.283, "learn_throughput": 25142.03, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2689709186578246e-116, "cur_lr": 0.001, "total_loss": 0.0015057772397994995, "policy_loss": -0.01779221440665424, "vf_loss": 0.019297989085316658, "vf_explained_var": 0.9842419624328613, "kl": 0.0012620205525308847, "entropy": -7.002737283706665, "entropy_coeff": 0.0}}, "num_steps_sampled": 3326800, "num_steps_trained": 3326800}, "done": false, "episodes_total": 3316, "training_iteration": 441, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-49", "timestamp": 1617635749, "time_this_iter_s": 1.4132130146026611, "time_total_s": 745.1365389823914, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516dd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 580.3500745296478, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 73.8, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 180.21835588690146, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 63.96193468340655, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.74503061561435, "MDD_min": 13.59444588901601, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [78.63611660418016, 56.613470225418226, 43.31227507639299, 111.00965479997627, 75.09832949175694, 81.63482022349542, 70.12707047593611, 42.36384000944402, 31.499670443199342, 81.91011080284008, 61.12722228596413, 99.81489336464733, 54.890471939226224, 55.31826380032155, 50.51098960688417, 79.04715234013378, 180.21835588690146, 74.9465003657978, 35.999320582088025, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20035736825401354, "mean_inference_ms": 1.2777771484175278, "mean_action_processing_ms": 0.05449910353725164, "mean_env_wait_ms": 1.196372549822569, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3334400, "timers": {"sample_time_ms": 1202.195, "sample_throughput": 6321.77, "learn_time_ms": 301.284, "learn_throughput": 25225.329, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.344854593289123e-117, "cur_lr": 0.001, "total_loss": 0.2717166244983673, "policy_loss": -0.007726456271484494, "vf_loss": 0.2794431000947952, "vf_explained_var": 0.989745020866394, "kl": 0.0011523783905431628, "entropy": -7.164076328277588, "entropy_coeff": 0.0}}, "num_steps_sampled": 3334400, "num_steps_trained": 3334400}, "done": false, "episodes_total": 3316, "training_iteration": 442, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-51", "timestamp": 1617635751, "time_this_iter_s": 1.4243006706237793, "time_total_s": 746.5608396530151, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345160e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 581.7743752002716, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 114.62291159286782, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 62.02365635684774, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.83007307327534, "MDD_min": 14.473861286259657, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003433473680535, "mean_inference_ms": 1.2779402787935705, "mean_action_processing_ms": 0.05450994580057156, "mean_env_wait_ms": 1.1965234877307511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3342000, "timers": {"sample_time_ms": 1156.224, "sample_throughput": 6573.122, "learn_time_ms": 300.904, "learn_throughput": 25257.202, "update_time_ms": 2.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1724272966445615e-117, "cur_lr": 0.001, "total_loss": 0.7443488538265228, "policy_loss": 0.004591994802467525, "vf_loss": 0.7397568821907043, "vf_explained_var": 0.9768580198287964, "kl": 0.0018920211587101221, "entropy": -6.883380651473999, "entropy_coeff": 0.0}}, "num_steps_sampled": 3342000, "num_steps_trained": 3342000}, "done": false, "episodes_total": 3335, "training_iteration": 443, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-52", "timestamp": 1617635752, "time_this_iter_s": 1.538639783859253, "time_total_s": 748.0994794368744, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 583.3130149841309, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 81.4, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 114.62291159286782, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 62.02365635684773, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.83007307327534, "MDD_min": 14.473861286259657, "MDD_max": 37.96215994712794}, "hist_stats": {"episode_reward": [40.57558953112586, 57.45950024793669, 46.074384491917286, 40.08293110353168, 79.22946138574899, 75.41319488344784, 31.092646508181737, 69.44467364997084, 27.563512777944734, 64.45665455393222, 77.162748088742, 86.58249794724212, 72.3632702456736, 77.11872810257164, 110.7818922648695, 66.02168875222814, 68.84867811169117, 56.35783594519659, 47.23025943649928, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034334736805356, "mean_inference_ms": 1.2779402787935705, "mean_action_processing_ms": 0.05450994580057155, "mean_env_wait_ms": 1.1965234877307516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3349600, "timers": {"sample_time_ms": 1157.112, "sample_throughput": 6568.074, "learn_time_ms": 300.997, "learn_throughput": 25249.404, "update_time_ms": 2.884}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5862136483222808e-117, "cur_lr": 0.001, "total_loss": 0.07484311982989311, "policy_loss": 0.017444200115278363, "vf_loss": 0.05739892087876797, "vf_explained_var": 0.9709283113479614, "kl": 0.001250296423677355, "entropy": -6.923549175262451, "entropy_coeff": 0.0}}, "num_steps_sampled": 3349600, "num_steps_trained": 3349600}, "done": false, "episodes_total": 3335, "training_iteration": 444, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-54", "timestamp": 1617635754, "time_this_iter_s": 1.432999610900879, "time_total_s": 749.5324790477753, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534516560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 584.7460145950317, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 62.785194751948964, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.629617764105827, "MDD_min": 15.245732457026378, "MDD_max": 35.15258078182783}, "hist_stats": {"episode_reward": [30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036004215302397, "mean_inference_ms": 1.2779596726900517, "mean_action_processing_ms": 0.05451411351664191, "mean_env_wait_ms": 1.1965509674294827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3357200, "timers": {"sample_time_ms": 1162.18, "sample_throughput": 6539.434, "learn_time_ms": 342.075, "learn_throughput": 22217.321, "update_time_ms": 2.879}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.931068241611404e-118, "cur_lr": 0.001, "total_loss": 1.173687994480133, "policy_loss": 0.0028331313587841578, "vf_loss": 1.1708547472953796, "vf_explained_var": 0.9773756265640259, "kl": 0.0022364037577062845, "entropy": -7.07576847076416, "entropy_coeff": 0.0}}, "num_steps_sampled": 3357200, "num_steps_trained": 3357200}, "done": false, "episodes_total": 3354, "training_iteration": 445, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-56", "timestamp": 1617635756, "time_this_iter_s": 2.0087473392486572, "time_total_s": 751.5412263870239, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534580440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 586.7547619342804, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 62.06666666666666}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 62.785194751948985, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.629617764105827, "MDD_min": 15.245732457026378, "MDD_max": 35.15258078182783}, "hist_stats": {"episode_reward": [83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036004215302394, "mean_inference_ms": 1.2779596726900517, "mean_action_processing_ms": 0.05451411351664191, "mean_env_wait_ms": 1.1965509674294825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3364800, "timers": {"sample_time_ms": 1160.578, "sample_throughput": 6548.459, "learn_time_ms": 342.295, "learn_throughput": 22203.076, "update_time_ms": 2.849}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.965534120805702e-118, "cur_lr": 0.001, "total_loss": 0.026022321544587612, "policy_loss": 0.006117254612036049, "vf_loss": 0.01990506611764431, "vf_explained_var": 0.9829367399215698, "kl": 0.001171341456938535, "entropy": -6.9750049114227295, "entropy_coeff": 0.0}}, "num_steps_sampled": 3364800, "num_steps_trained": 3364800}, "done": false, "episodes_total": 3354, "training_iteration": 446, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-57", "timestamp": 1617635757, "time_this_iter_s": 1.3973047733306885, "time_total_s": 752.9385311603546, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cd40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 588.1520667076111, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 62.785194751948985, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.629617764105827, "MDD_min": 15.245732457026378, "MDD_max": 35.15258078182783}, "hist_stats": {"episode_reward": [83.68286181984409, 95.75033187806403, 73.45773946111201, 61.00108314355191, 88.90187240858295, 64.16509523150906, 45.67581537659186, 81.37214008409858, 88.56197198412691, 44.701814231556114, 43.46172865489308, 69.88628380635153, 69.58694382436155, 53.11124227963796, 49.3167599439413, 49.358549918961245, 61.07837491538864, 40.35948481981072, 60.89226791152686, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20036004215302394, "mean_inference_ms": 1.2779596726900517, "mean_action_processing_ms": 0.05451411351664191, "mean_env_wait_ms": 1.1965509674294825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3372400, "timers": {"sample_time_ms": 1160.083, "sample_throughput": 6551.256, "learn_time_ms": 343.222, "learn_throughput": 22143.126, "update_time_ms": 2.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.982767060402851e-118, "cur_lr": 0.001, "total_loss": 0.36504343152046204, "policy_loss": 0.001591618376551196, "vf_loss": 0.363451823592186, "vf_explained_var": 0.9874603748321533, "kl": 0.001668237498961389, "entropy": -7.178503751754761, "entropy_coeff": 0.0}}, "num_steps_sampled": 3372400, "num_steps_trained": 3372400}, "done": false, "episodes_total": 3354, "training_iteration": 447, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-15-58", "timestamp": 1617635758, "time_this_iter_s": 1.4208605289459229, "time_total_s": 754.3593916893005, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55460325f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 589.572927236557, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 73.55, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 64.94194730187583, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.61421616674565, "MDD_min": 14.394620397504761, "MDD_max": 35.15258078182783}, "hist_stats": {"episode_reward": [43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033393631023155, "mean_inference_ms": 1.2779235262714908, "mean_action_processing_ms": 0.05451400005947622, "mean_env_wait_ms": 1.1965262476060663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3380000, "timers": {"sample_time_ms": 1159.78, "sample_throughput": 6552.966, "learn_time_ms": 343.296, "learn_throughput": 22138.326, "update_time_ms": 2.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.913835302014255e-119, "cur_lr": 0.001, "total_loss": 1.029562771320343, "policy_loss": -0.02264628978446126, "vf_loss": 1.0522090792655945, "vf_explained_var": 0.9710526466369629, "kl": 0.004899849183857441, "entropy": -6.862236738204956, "entropy_coeff": 0.0}}, "num_steps_sampled": 3380000, "num_steps_trained": 3380000}, "done": false, "episodes_total": 3373, "training_iteration": 448, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-00", "timestamp": 1617635760, "time_this_iter_s": 1.535855770111084, "time_total_s": 755.8952474594116, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cb00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 591.1087830066681, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 77.1, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 64.94194730187583, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.614216166745656, "MDD_min": 14.394620397504761, "MDD_max": 35.15258078182783}, "hist_stats": {"episode_reward": [39.58487941664996, 63.55118528046842, 114.62291159286782, 63.88177932993726, 82.51854304140846, 59.746412032258746, 46.98420603105352, 50.05096858982032, 92.91545709422928, 76.43295495968198, 69.06185169568657, 91.5477000732995, 109.54450746153637, 54.8618089500161, 76.29883108379693, 74.0805725650261, 36.050811430092196, 77.78276881486072, 70.10911005721321, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033393631023153, "mean_inference_ms": 1.2779235262714908, "mean_action_processing_ms": 0.054514000059476236, "mean_env_wait_ms": 1.196526247606066, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3387600, "timers": {"sample_time_ms": 1159.213, "sample_throughput": 6556.174, "learn_time_ms": 344.558, "learn_throughput": 22057.255, "update_time_ms": 2.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.9569176510071274e-119, "cur_lr": 0.001, "total_loss": 0.059285733848810196, "policy_loss": -0.0021435206290334463, "vf_loss": 0.061429256573319435, "vf_explained_var": 0.9676771759986877, "kl": 0.001182131643872708, "entropy": -6.898341417312622, "entropy_coeff": 0.0}}, "num_steps_sampled": 3387600, "num_steps_trained": 3387600}, "done": false, "episodes_total": 3373, "training_iteration": 449, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-01", "timestamp": 1617635761, "time_this_iter_s": 1.4252619743347168, "time_total_s": 757.3205094337463, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 592.5340449810028, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 71.95, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 65.02809341428272, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.766347616925195, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034764491989496, "mean_inference_ms": 1.2778847930476762, "mean_action_processing_ms": 0.05451289133566418, "mean_env_wait_ms": 1.196492848480382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3395200, "timers": {"sample_time_ms": 1159.223, "sample_throughput": 6556.116, "learn_time_ms": 344.271, "learn_throughput": 22075.645, "update_time_ms": 2.815}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4784588255035637e-119, "cur_lr": 0.001, "total_loss": 1.3738391995429993, "policy_loss": 0.007293093949556351, "vf_loss": 1.366546094417572, "vf_explained_var": 0.9748800992965698, "kl": 0.008210762403905392, "entropy": -7.068661451339722, "entropy_coeff": 0.0}}, "num_steps_sampled": 3395200, "num_steps_trained": 3395200}, "done": false, "episodes_total": 3392, "training_iteration": 450, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-03", "timestamp": 1617635763, "time_this_iter_s": 1.530874490737915, "time_total_s": 758.8513839244843, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 594.0649194717407, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 71.35, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 65.02809341428274, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.76634761692519, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034764491989498, "mean_inference_ms": 1.2778847930476764, "mean_action_processing_ms": 0.054512891335664185, "mean_env_wait_ms": 1.1964928484803823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3402800, "timers": {"sample_time_ms": 1158.832, "sample_throughput": 6558.327, "learn_time_ms": 345.854, "learn_throughput": 21974.613, "update_time_ms": 2.828}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4784588255035637e-119, "cur_lr": 0.001, "total_loss": 0.02999162580817938, "policy_loss": 0.006620013504289091, "vf_loss": 0.02337160985916853, "vf_explained_var": 0.9833245277404785, "kl": 0.001208952919114381, "entropy": -6.990058183670044, "entropy_coeff": 0.0}}, "num_steps_sampled": 3402800, "num_steps_trained": 3402800}, "done": false, "episodes_total": 3392, "training_iteration": 451, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-04", "timestamp": 1617635764, "time_this_iter_s": 1.4251649379730225, "time_total_s": 760.2765488624573, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55460325f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 595.4900844097137, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 21.577718592721883, "episode_reward_mean": 65.02809341428274, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 22.76634761692519, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [66.38362408561579, 42.58330668661157, 45.21518641010109, 51.09092786223499, 48.38574636587679, 46.50906128528052, 75.10569834935387, 36.52544126080701, 39.4336215420485, 101.03209681422267, 33.136021682127684, 63.76765417154621, 44.6887187549928, 36.57930700427508, 60.95403174129692, 49.3823974564233, 21.577718592721883, 81.92902474845843, 48.95703290237074, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20034764491989498, "mean_inference_ms": 1.2778847930476764, "mean_action_processing_ms": 0.054512891335664185, "mean_env_wait_ms": 1.1964928484803823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3410400, "timers": {"sample_time_ms": 1158.031, "sample_throughput": 6562.864, "learn_time_ms": 344.834, "learn_throughput": 22039.58, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2392294127517818e-119, "cur_lr": 0.001, "total_loss": 0.2406817004084587, "policy_loss": -0.016929826233536005, "vf_loss": 0.25761155784130096, "vf_explained_var": 0.9912864565849304, "kl": 0.0014646158087998629, "entropy": -7.179821491241455, "entropy_coeff": 0.0}}, "num_steps_sampled": 3410400, "num_steps_trained": 3410400}, "done": false, "episodes_total": 3392, "training_iteration": 452, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-06", "timestamp": 1617635766, "time_this_iter_s": 1.4063880443572998, "time_total_s": 761.6829369068146, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a47a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 596.896472454071, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 72.2, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 29.318817429009307, "episode_reward_mean": 66.85571721976858, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.05045543373067, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20032439201412708, "mean_inference_ms": 1.277846528099466, "mean_action_processing_ms": 0.05451186707671142, "mean_env_wait_ms": 1.1964516175905577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3418000, "timers": {"sample_time_ms": 1159.354, "sample_throughput": 6555.377, "learn_time_ms": 345.418, "learn_throughput": 22002.34, "update_time_ms": 2.781}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.196147063758909e-120, "cur_lr": 0.001, "total_loss": 0.5206263065338135, "policy_loss": -0.008187921717762947, "vf_loss": 0.5288142263889313, "vf_explained_var": 0.9862896203994751, "kl": 0.0010452277201693505, "entropy": -6.9137256145477295, "entropy_coeff": 0.0}}, "num_steps_sampled": 3418000, "num_steps_trained": 3418000}, "done": false, "episodes_total": 3411, "training_iteration": 453, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-07", "timestamp": 1617635767, "time_this_iter_s": 1.5580496788024902, "time_total_s": 763.2409865856171, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 598.4545221328735, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 70.03333333333335, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 29.318817429009307, "episode_reward_mean": 66.85571721976858, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.05045543373066, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [42.88501723351239, 41.564924314969815, 42.4748021642491, 77.34947265348106, 66.794336711207, 64.3769858264681, 64.82444739966223, 114.5373709932019, 61.06173147075775, 67.39191380975284, 98.49232840347555, 67.88352132192863, 30.493629383737204, 41.995921587191226, 49.09768197645739, 51.30690257730961, 44.46962616109679, 55.33905592966472, 48.40589047701843, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003243920141271, "mean_inference_ms": 1.277846528099466, "mean_action_processing_ms": 0.05451186707671143, "mean_env_wait_ms": 1.1964516175905577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3425600, "timers": {"sample_time_ms": 1158.233, "sample_throughput": 6561.72, "learn_time_ms": 344.794, "learn_throughput": 22042.139, "update_time_ms": 2.773}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0980735318794546e-120, "cur_lr": 0.001, "total_loss": 0.03761922288686037, "policy_loss": -0.008732952643185854, "vf_loss": 0.046352170407772064, "vf_explained_var": 0.9807442426681519, "kl": 0.0034416286507621408, "entropy": -6.9349424839019775, "entropy_coeff": 0.0}}, "num_steps_sampled": 3425600, "num_steps_trained": 3425600}, "done": false, "episodes_total": 3411, "training_iteration": 454, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-09", "timestamp": 1617635769, "time_this_iter_s": 1.4151456356048584, "time_total_s": 764.6561322212219, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 599.8696677684784, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 66.1047882426734, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.194209686451, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033548958386507, "mean_inference_ms": 1.2777952323897859, "mean_action_processing_ms": 0.05451024917655672, "mean_env_wait_ms": 1.1964046075973165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3433200, "timers": {"sample_time_ms": 1150.776, "sample_throughput": 6604.241, "learn_time_ms": 304.094, "learn_throughput": 24992.307, "update_time_ms": 2.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5490367659397273e-120, "cur_lr": 0.001, "total_loss": 0.7195939421653748, "policy_loss": -0.003244819468818605, "vf_loss": 0.7228386998176575, "vf_explained_var": 0.9878911972045898, "kl": 0.0015845830785110593, "entropy": -7.067356586456299, "entropy_coeff": 0.0}}, "num_steps_sampled": 3433200, "num_steps_trained": 3433200}, "done": false, "episodes_total": 3430, "training_iteration": 455, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-10", "timestamp": 1617635770, "time_this_iter_s": 1.5272209644317627, "time_total_s": 766.1833531856537, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cdd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 601.3968887329102, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 81.0, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 66.1047882426734, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.194209686450996, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033548958386507, "mean_inference_ms": 1.2777952323897859, "mean_action_processing_ms": 0.05451024917655671, "mean_env_wait_ms": 1.1964046075973165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3440800, "timers": {"sample_time_ms": 1152.363, "sample_throughput": 6595.143, "learn_time_ms": 304.561, "learn_throughput": 24953.921, "update_time_ms": 2.79}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.745183829698637e-121, "cur_lr": 0.001, "total_loss": 0.02540077641606331, "policy_loss": 0.004082561004906893, "vf_loss": 0.021318212151527405, "vf_explained_var": 0.9868238568305969, "kl": 0.0011096884263679385, "entropy": -7.016145706176758, "entropy_coeff": 0.0}}, "num_steps_sampled": 3440800, "num_steps_trained": 3440800}, "done": false, "episodes_total": 3430, "training_iteration": 456, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-12", "timestamp": 1617635772, "time_this_iter_s": 1.418196439743042, "time_total_s": 767.6015496253967, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 602.8150851726532, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 74.75, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 66.1047882426734, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.194209686450996, "MDD_min": 14.394620397504761, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [66.21915502065146, 29.318817429009307, 101.15599982879269, 38.35864860714488, 75.52106746540215, 30.837930136388763, 52.50318051889953, 36.53386411820979, 115.64728503310832, 54.42762403728397, 33.00449177024777, 87.12055420372133, 79.31693508184155, 32.508968088457756, 114.11110803730354, 78.51742573371196, 62.955225719980405, 54.636762139507205, 60.9839934965374, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033548958386507, "mean_inference_ms": 1.2777952323897859, "mean_action_processing_ms": 0.05451024917655671, "mean_env_wait_ms": 1.1964046075973165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3448400, "timers": {"sample_time_ms": 1152.268, "sample_throughput": 6595.689, "learn_time_ms": 304.352, "learn_throughput": 24971.114, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.8725919148493183e-121, "cur_lr": 0.001, "total_loss": 0.3145413100719452, "policy_loss": 0.017227769130840898, "vf_loss": 0.29731352627277374, "vf_explained_var": 0.9907031655311584, "kl": 0.0018825542647391558, "entropy": -7.1787109375, "entropy_coeff": 0.0}}, "num_steps_sampled": 3448400, "num_steps_trained": 3448400}, "done": false, "episodes_total": 3430, "training_iteration": 457, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-13", "timestamp": 1617635773, "time_this_iter_s": 1.4187586307525635, "time_total_s": 769.0203082561493, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cdd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 604.2338438034058, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 67.02537749528823, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.13235184668964, "MDD_min": 14.268133668048632, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030771555930305, "mean_inference_ms": 1.2777480573373603, "mean_action_processing_ms": 0.05450955182600271, "mean_env_wait_ms": 1.1963596887345345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3456000, "timers": {"sample_time_ms": 1151.687, "sample_throughput": 6599.013, "learn_time_ms": 304.533, "learn_throughput": 24956.256, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9362959574246591e-121, "cur_lr": 0.001, "total_loss": 0.9263223111629486, "policy_loss": 0.018274522619321942, "vf_loss": 0.9080477058887482, "vf_explained_var": 0.9794248342514038, "kl": 0.0018346686265431345, "entropy": -6.952335357666016, "entropy_coeff": 0.0}}, "num_steps_sampled": 3456000, "num_steps_trained": 3456000}, "done": false, "episodes_total": 3449, "training_iteration": 458, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-15", "timestamp": 1617635775, "time_this_iter_s": 1.533534049987793, "time_total_s": 770.5538423061371, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cc20>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 605.7673778533936, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 72.0, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.80327635955896, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 67.02537749528824, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.13235184668964, "MDD_min": 14.268133668048632, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [85.21230192175045, 149.80327635955896, 44.183827547383224, 48.972305851423314, 48.736927743260495, 43.94869994183569, 40.962473356892765, 101.92464746462964, 83.22543763564003, 80.43883056819504, 98.93526236940923, 75.77123960186209, 63.07480752138615, 119.43528315399882, 104.19371132572981, 48.16474009270096, 38.720816372667414, 118.38567284971921, 45.922443140958464, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030771555930307, "mean_inference_ms": 1.27774805733736, "mean_action_processing_ms": 0.05450955182600271, "mean_env_wait_ms": 1.1963596887345347, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3463600, "timers": {"sample_time_ms": 1151.948, "sample_throughput": 6597.519, "learn_time_ms": 303.379, "learn_throughput": 25051.167, "update_time_ms": 2.766}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.681479787123296e-122, "cur_lr": 0.001, "total_loss": 0.07862783223390579, "policy_loss": 0.019855734193697572, "vf_loss": 0.05877210386097431, "vf_explained_var": 0.9769139289855957, "kl": 0.001915337285026908, "entropy": -6.939518928527832, "entropy_coeff": 0.0}}, "num_steps_sampled": 3463600, "num_steps_trained": 3463600}, "done": false, "episodes_total": 3449, "training_iteration": 459, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-16", "timestamp": 1617635776, "time_this_iter_s": 1.4164812564849854, "time_total_s": 771.9703235626221, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 607.1838591098785, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.22383024840434, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 64.15461909653662, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.365249123807853, "MDD_min": 14.268133668048632, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003136516655539, "mean_inference_ms": 1.2777054846956915, "mean_action_processing_ms": 0.05450858486745546, "mean_env_wait_ms": 1.1963185140023291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3471200, "timers": {"sample_time_ms": 1151.839, "sample_throughput": 6598.145, "learn_time_ms": 304.776, "learn_throughput": 24936.335, "update_time_ms": 2.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.840739893561648e-122, "cur_lr": 0.001, "total_loss": 0.8751778602600098, "policy_loss": -0.0024607435916550457, "vf_loss": 0.8776386380195618, "vf_explained_var": 0.9860255718231201, "kl": 0.001971825025975704, "entropy": -7.064648628234863, "entropy_coeff": 0.0}}, "num_steps_sampled": 3471200, "num_steps_trained": 3471200}, "done": false, "episodes_total": 3468, "training_iteration": 460, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-18", "timestamp": 1617635778, "time_this_iter_s": 1.54298996925354, "time_total_s": 773.5133135318756, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cb00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 608.7268490791321, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 72.80000000000001, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.22383024840434, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 64.15461909653662, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.36524912380786, "MDD_min": 14.268133668048632, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003136516655539, "mean_inference_ms": 1.2777054846956912, "mean_action_processing_ms": 0.05450858486745546, "mean_env_wait_ms": 1.1963185140023291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3478800, "timers": {"sample_time_ms": 1153.023, "sample_throughput": 6591.368, "learn_time_ms": 303.799, "learn_throughput": 25016.567, "update_time_ms": 2.743}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.420369946780824e-122, "cur_lr": 0.001, "total_loss": 0.003956984728574753, "policy_loss": -0.016766683664172888, "vf_loss": 0.020723668858408928, "vf_explained_var": 0.9893112778663635, "kl": 0.0015494030667468905, "entropy": -7.045288324356079, "entropy_coeff": 0.0}}, "num_steps_sampled": 3478800, "num_steps_trained": 3478800}, "done": false, "episodes_total": 3468, "training_iteration": 461, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-19", "timestamp": 1617635779, "time_this_iter_s": 1.4273462295532227, "time_total_s": 774.9406597614288, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cf80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 610.1541953086853, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 65.23333333333333, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 149.22383024840434, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 64.15461909653662, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.36524912380786, "MDD_min": 14.268133668048632, "MDD_max": 37.55423755742579}, "hist_stats": {"episode_reward": [66.57443499869433, 73.54216319899038, 67.74530220380113, 85.55833591324476, 83.4733149762396, 54.5264945445857, 45.62819890944282, 38.269814116743404, 71.28886829215706, 68.24624837365043, 69.45137372507126, 79.01144347923801, 44.47071929830884, 149.22383024840434, 42.48268133167438, 58.26305379427434, 96.20444800614992, 65.65305204743241, 50.4297255860847, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003136516655539, "mean_inference_ms": 1.2777054846956912, "mean_action_processing_ms": 0.05450858486745546, "mean_env_wait_ms": 1.1963185140023291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3486400, "timers": {"sample_time_ms": 1159.011, "sample_throughput": 6557.317, "learn_time_ms": 304.195, "learn_throughput": 24983.947, "update_time_ms": 2.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.210184973390412e-122, "cur_lr": 0.001, "total_loss": 0.3583715409040451, "policy_loss": 0.027318036649376154, "vf_loss": 0.3310534805059433, "vf_explained_var": 0.9886784553527832, "kl": 0.001071078993845731, "entropy": -7.159496784210205, "entropy_coeff": 0.0}}, "num_steps_sampled": 3486400, "num_steps_trained": 3486400}, "done": false, "episodes_total": 3468, "training_iteration": 462, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-21", "timestamp": 1617635781, "time_this_iter_s": 1.469259262084961, "time_total_s": 776.4099190235138, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 611.6234545707703, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 76.7, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 63.91242541333378, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.43226235611545, "MDD_min": 14.268133668048632, "MDD_max": 35.72981979257403}, "hist_stats": {"episode_reward": [165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028455361212175, "mean_inference_ms": 1.277685290937811, "mean_action_processing_ms": 0.05450811630513912, "mean_env_wait_ms": 1.1962896434872372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3494000, "timers": {"sample_time_ms": 1157.082, "sample_throughput": 6568.245, "learn_time_ms": 304.2, "learn_throughput": 24983.594, "update_time_ms": 2.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.05092486695206e-123, "cur_lr": 0.001, "total_loss": 1.063986361026764, "policy_loss": 0.015341367106884718, "vf_loss": 1.0486449003219604, "vf_explained_var": 0.9750388264656067, "kl": 0.004298949032090604, "entropy": -6.939124345779419, "entropy_coeff": 0.0}}, "num_steps_sampled": 3494000, "num_steps_trained": 3494000}, "done": false, "episodes_total": 3487, "training_iteration": 463, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-22", "timestamp": 1617635782, "time_this_iter_s": 1.5391449928283691, "time_total_s": 777.9490640163422, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345137a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 613.1625995635986, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 81.4, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 25.305392931500755, "episode_reward_mean": 63.91242541333378, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.43226235611545, "MDD_min": 14.268133668048632, "MDD_max": 35.72981979257403}, "hist_stats": {"episode_reward": [81.39702557868415, 114.93476270039733, 54.85330106687572, 56.35016332041112, 117.55666632100663, 52.16542315078156, 46.94822589940869, 68.60448965427476, 55.53728014324361, 54.92092234416582, 91.84594619575141, 56.23327340591005, 54.484500727947626, 85.55753353256368, 44.61384660107882, 58.07345556867066, 41.063729108510245, 58.108726586044895, 94.20835085891554, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028455361212175, "mean_inference_ms": 1.277685290937811, "mean_action_processing_ms": 0.05450811630513914, "mean_env_wait_ms": 1.1962896434872372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3501600, "timers": {"sample_time_ms": 1158.431, "sample_throughput": 6560.596, "learn_time_ms": 304.88, "learn_throughput": 24927.809, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.02546243347603e-123, "cur_lr": 0.001, "total_loss": 0.05887535400688648, "policy_loss": 0.0035341973998583853, "vf_loss": 0.05534116178750992, "vf_explained_var": 0.979118824005127, "kl": 0.0014560719137080014, "entropy": -6.922248601913452, "entropy_coeff": 0.0}}, "num_steps_sampled": 3501600, "num_steps_trained": 3501600}, "done": false, "episodes_total": 3487, "training_iteration": 464, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-24", "timestamp": 1617635784, "time_this_iter_s": 1.436025619506836, "time_total_s": 779.385089635849, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 614.5986251831055, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 73.75, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 21.89644101526242, "episode_reward_mean": 62.70041985663164, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.2327411178444, "MDD_min": 14.268133668048632, "MDD_max": 33.58082142038647}, "hist_stats": {"episode_reward": [41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029488950288016, "mean_inference_ms": 1.2776634954157178, "mean_action_processing_ms": 0.054507691645301865, "mean_env_wait_ms": 1.1962602203531132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3509200, "timers": {"sample_time_ms": 1159.002, "sample_throughput": 6557.367, "learn_time_ms": 303.956, "learn_throughput": 25003.64, "update_time_ms": 2.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.512731216738015e-123, "cur_lr": 0.001, "total_loss": 0.8699631690979004, "policy_loss": -0.01078545511700213, "vf_loss": 0.8807485699653625, "vf_explained_var": 0.9861607551574707, "kl": 0.0011369723360985518, "entropy": -7.08699107170105, "entropy_coeff": 0.0}}, "num_steps_sampled": 3509200, "num_steps_trained": 3509200}, "done": false, "episodes_total": 3506, "training_iteration": 465, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-25", "timestamp": 1617635785, "time_this_iter_s": 1.523716926574707, "time_total_s": 780.9088065624237, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345137a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 616.1223421096802, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 75.3, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 21.89644101526242, "episode_reward_mean": 62.70041985663163, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.232741117844398, "MDD_min": 14.268133668048632, "MDD_max": 33.58082142038647}, "hist_stats": {"episode_reward": [45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029488950288016, "mean_inference_ms": 1.2776634954157178, "mean_action_processing_ms": 0.054507691645301844, "mean_env_wait_ms": 1.1962602203531132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3516800, "timers": {"sample_time_ms": 1158.774, "sample_throughput": 6558.658, "learn_time_ms": 303.605, "learn_throughput": 25032.492, "update_time_ms": 2.752}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.563656083690075e-124, "cur_lr": 0.001, "total_loss": 0.03241335228085518, "policy_loss": 0.01208727597258985, "vf_loss": 0.02032607514411211, "vf_explained_var": 0.9896879196166992, "kl": 0.0012003540177829564, "entropy": -7.025386333465576, "entropy_coeff": 0.0}}, "num_steps_sampled": 3516800, "num_steps_trained": 3516800}, "done": false, "episodes_total": 3506, "training_iteration": 466, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-27", "timestamp": 1617635787, "time_this_iter_s": 1.4124245643615723, "time_total_s": 782.3212311267853, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513ef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 617.5347666740417, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 21.89644101526242, "episode_reward_mean": 62.70041985663163, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.232741117844398, "MDD_min": 14.268133668048632, "MDD_max": 33.58082142038647}, "hist_stats": {"episode_reward": [45.395775957114, 41.01917470153118, 76.96147931725875, 78.90611214346286, 71.35075236831747, 53.96489132233104, 48.70545755398675, 43.36690988822667, 77.89311671476335, 40.196129296163576, 46.26808359000169, 70.76746995672188, 63.774783150907055, 66.21163685017655, 33.12319307157469, 61.07888798471123, 25.305392931500755, 50.96832917862137, 32.89103280188488, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029488950288016, "mean_inference_ms": 1.2776634954157178, "mean_action_processing_ms": 0.054507691645301844, "mean_env_wait_ms": 1.1962602203531132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3524400, "timers": {"sample_time_ms": 1159.098, "sample_throughput": 6556.825, "learn_time_ms": 303.014, "learn_throughput": 25081.366, "update_time_ms": 2.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7818280418450374e-124, "cur_lr": 0.001, "total_loss": 0.28903932869434357, "policy_loss": -0.018285608384758234, "vf_loss": 0.30732491612434387, "vf_explained_var": 0.9903680086135864, "kl": 0.0020189895876683295, "entropy": -7.155885219573975, "entropy_coeff": 0.0}}, "num_steps_sampled": 3524400, "num_steps_trained": 3524400}, "done": false, "episodes_total": 3506, "training_iteration": 467, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-28", "timestamp": 1617635788, "time_this_iter_s": 1.415543794631958, "time_total_s": 783.7367749214172, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55467cacb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 618.9503104686737, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 72.75, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 21.89644101526242, "episode_reward_mean": 66.6967138728863, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.088353314633466, "MDD_min": 14.268133668048632, "MDD_max": 33.58082142038647}, "hist_stats": {"episode_reward": [62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002741845466424, "mean_inference_ms": 1.277640031150842, "mean_action_processing_ms": 0.05450685206354889, "mean_env_wait_ms": 1.1962334999479116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3532000, "timers": {"sample_time_ms": 1160.658, "sample_throughput": 6548.007, "learn_time_ms": 302.496, "learn_throughput": 25124.273, "update_time_ms": 2.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8909140209225187e-124, "cur_lr": 0.001, "total_loss": 1.0873518288135529, "policy_loss": -0.0009382819307575119, "vf_loss": 1.0882899761199951, "vf_explained_var": 0.9779534339904785, "kl": 0.0014922918053343892, "entropy": -6.922877073287964, "entropy_coeff": 0.0}}, "num_steps_sampled": 3532000, "num_steps_trained": 3532000}, "done": false, "episodes_total": 3525, "training_iteration": 468, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-30", "timestamp": 1617635790, "time_this_iter_s": 1.5427403450012207, "time_total_s": 785.2795152664185, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513ef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 620.4930508136749, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 21.89644101526242, "episode_reward_mean": 66.6967138728863, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.08835331463346, "MDD_min": 14.268133668048632, "MDD_max": 33.58082142038647}, "hist_stats": {"episode_reward": [63.835896540119336, 61.32822131986442, 69.64545556530214, 55.906787166335285, 90.42098780243133, 62.162427562633596, 55.273613149762284, 51.957653564367796, 41.48185423938343, 91.57829027308169, 51.07704798860451, 81.76601412871102, 54.48065110008174, 87.22335182088604, 72.040262884773, 84.78687607777206, 62.5954577846083, 44.523632173450075, 104.54564054096409, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027418454664236, "mean_inference_ms": 1.2776400311508416, "mean_action_processing_ms": 0.0545068520635489, "mean_env_wait_ms": 1.1962334999479116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3539600, "timers": {"sample_time_ms": 1162.187, "sample_throughput": 6539.397, "learn_time_ms": 303.537, "learn_throughput": 25038.127, "update_time_ms": 2.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.454570104612593e-125, "cur_lr": 0.001, "total_loss": 0.0633728913962841, "policy_loss": 0.010115193901583552, "vf_loss": 0.05325770378112793, "vf_explained_var": 0.9807547330856323, "kl": 0.0016852797707542777, "entropy": -6.939739227294922, "entropy_coeff": 0.0}}, "num_steps_sampled": 3539600, "num_steps_trained": 3539600}, "done": false, "episodes_total": 3525, "training_iteration": 469, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-31", "timestamp": 1617635791, "time_this_iter_s": 1.4418389797210693, "time_total_s": 786.7213542461395, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345137a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 621.934889793396, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 70.80000000000001, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 65.62125378180632, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.17788550089598, "MDD_min": 14.268133668048632, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028531624932946, "mean_inference_ms": 1.2776263090104112, "mean_action_processing_ms": 0.0545052352102888, "mean_env_wait_ms": 1.1962176249295144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3547200, "timers": {"sample_time_ms": 1162.158, "sample_throughput": 6539.557, "learn_time_ms": 302.684, "learn_throughput": 25108.718, "update_time_ms": 2.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.727285052306297e-125, "cur_lr": 0.001, "total_loss": 1.1632859706878662, "policy_loss": -0.005550765432417393, "vf_loss": 1.1688366532325745, "vf_explained_var": 0.9827091693878174, "kl": 0.0030464521842077374, "entropy": -7.093394041061401, "entropy_coeff": 0.0}}, "num_steps_sampled": 3547200, "num_steps_trained": 3547200}, "done": false, "episodes_total": 3544, "training_iteration": 470, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-33", "timestamp": 1617635793, "time_this_iter_s": 1.5346298217773438, "time_total_s": 788.2559840679169, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 623.4695196151733, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 71.23333333333333, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 65.6212537818063, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.17788550089598, "MDD_min": 14.268133668048632, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002853162493295, "mean_inference_ms": 1.2776263090104112, "mean_action_processing_ms": 0.0545052352102888, "mean_env_wait_ms": 1.1962176249295144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3554800, "timers": {"sample_time_ms": 1161.188, "sample_throughput": 6545.021, "learn_time_ms": 303.362, "learn_throughput": 25052.551, "update_time_ms": 2.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3636425261531484e-125, "cur_lr": 0.001, "total_loss": 0.01829361356794834, "policy_loss": -0.002455863985233009, "vf_loss": 0.020749473944306374, "vf_explained_var": 0.9905922412872314, "kl": 0.002170342253521085, "entropy": -7.024020671844482, "entropy_coeff": 0.0}}, "num_steps_sampled": 3554800, "num_steps_trained": 3554800}, "done": false, "episodes_total": 3544, "training_iteration": 471, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-34", "timestamp": 1617635794, "time_this_iter_s": 1.4238317012786865, "time_total_s": 789.6798157691956, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55467cacb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 624.893351316452, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 73.85, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 65.6212537818063, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.17788550089598, "MDD_min": 14.268133668048632, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [84.88369063908765, 104.67818015610234, 51.74292662773466, 63.274292448694936, 45.666098566984545, 80.48588721715522, 64.57719314632834, 37.942999176779445, 54.767363759378696, 40.65339200231953, 67.77426788118711, 41.96966599801092, 39.06033038077068, 94.85379656998792, 84.57846774570983, 88.91855915670531, 43.921679415431285, 38.134230082395405, 41.37259898667515, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002853162493295, "mean_inference_ms": 1.2776263090104112, "mean_action_processing_ms": 0.0545052352102888, "mean_env_wait_ms": 1.1962176249295144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3562400, "timers": {"sample_time_ms": 1157.053, "sample_throughput": 6568.409, "learn_time_ms": 303.736, "learn_throughput": 25021.694, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1818212630765742e-125, "cur_lr": 0.001, "total_loss": 0.2740337997674942, "policy_loss": -0.008885567309334874, "vf_loss": 0.28291934728622437, "vf_explained_var": 0.990706741809845, "kl": 0.0025156374322250485, "entropy": -7.1845457553863525, "entropy_coeff": 0.0}}, "num_steps_sampled": 3562400, "num_steps_trained": 3562400}, "done": false, "episodes_total": 3544, "training_iteration": 472, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-36", "timestamp": 1617635796, "time_this_iter_s": 1.4320456981658936, "time_total_s": 791.1118614673615, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534513f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 626.3253970146179, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 66.89512866396052, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.73612462005514, "MDD_min": 15.602016313405077, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027231383580923, "mean_inference_ms": 1.2776032322014488, "mean_action_processing_ms": 0.05450329409518572, "mean_env_wait_ms": 1.196196813947154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3570000, "timers": {"sample_time_ms": 1156.518, "sample_throughput": 6571.451, "learn_time_ms": 303.453, "learn_throughput": 25045.085, "update_time_ms": 2.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.909106315382871e-126, "cur_lr": 0.001, "total_loss": 0.9892598092556, "policy_loss": 0.0005370564758777618, "vf_loss": 0.9887226819992065, "vf_explained_var": 0.9787904620170593, "kl": 0.0023266641655936837, "entropy": -6.925776958465576, "entropy_coeff": 0.0}}, "num_steps_sampled": 3570000, "num_steps_trained": 3570000}, "done": false, "episodes_total": 3563, "training_iteration": 473, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-37", "timestamp": 1617635797, "time_this_iter_s": 1.5310354232788086, "time_total_s": 792.6428968906403, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 627.8564324378967, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 79.05000000000001, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 165.5504705983068, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 66.89512866396052, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.736124620055133, "MDD_min": 15.602016313405077, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [73.74385964061204, 57.6065405731697, 98.04283717743162, 40.95628100125821, 63.57691503253348, 165.5504705983068, 55.25566339822972, 54.29093736140538, 36.873665595894785, 54.37517306468547, 36.9359171961549, 27.128020723155775, 49.15282409465549, 116.3410022694439, 49.33385876693975, 68.47206922601883, 89.84972253695176, 72.95781729604411, 73.72404989365486, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027231383580918, "mean_inference_ms": 1.2776032322014488, "mean_action_processing_ms": 0.05450329409518572, "mean_env_wait_ms": 1.1961968139471537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3577600, "timers": {"sample_time_ms": 1155.451, "sample_throughput": 6577.52, "learn_time_ms": 303.106, "learn_throughput": 25073.713, "update_time_ms": 2.85}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9545531576914354e-126, "cur_lr": 0.001, "total_loss": 0.05846601165831089, "policy_loss": 0.0014519220276270062, "vf_loss": 0.057014092803001404, "vf_explained_var": 0.9791185855865479, "kl": 0.0018070278456434608, "entropy": -6.962982416152954, "entropy_coeff": 0.0}}, "num_steps_sampled": 3577600, "num_steps_trained": 3577600}, "done": false, "episodes_total": 3563, "training_iteration": 474, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-39", "timestamp": 1617635799, "time_this_iter_s": 1.4217233657836914, "time_total_s": 794.064620256424, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f5534580440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 629.2781558036804, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 72.35, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 137.7548008287838, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 66.89785956537975, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.23405829863344, "MDD_min": 15.925448580550379, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028815968378988, "mean_inference_ms": 1.2775599868449055, "mean_action_processing_ms": 0.05450103500678052, "mean_env_wait_ms": 1.196166178780145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3585200, "timers": {"sample_time_ms": 1156.424, "sample_throughput": 6571.986, "learn_time_ms": 303.264, "learn_throughput": 25060.707, "update_time_ms": 2.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4772765788457177e-126, "cur_lr": 0.001, "total_loss": 1.1189424395561218, "policy_loss": 0.0005075773151475005, "vf_loss": 1.1184347867965698, "vf_explained_var": 0.983468770980835, "kl": 0.002277655410580337, "entropy": -7.077569484710693, "entropy_coeff": 0.0}}, "num_steps_sampled": 3585200, "num_steps_trained": 3585200}, "done": false, "episodes_total": 3582, "training_iteration": 475, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-40", "timestamp": 1617635800, "time_this_iter_s": 1.5349230766296387, "time_total_s": 795.5995433330536, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 630.8130788803101, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 72.5, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 137.7548008287838, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 66.89785956537973, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.234058298633446, "MDD_min": 15.925448580550379, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028815968378996, "mean_inference_ms": 1.2775599868449055, "mean_action_processing_ms": 0.05450103500678049, "mean_env_wait_ms": 1.1961661787801448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3592800, "timers": {"sample_time_ms": 1157.402, "sample_throughput": 6566.43, "learn_time_ms": 303.731, "learn_throughput": 25022.166, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.386382894228589e-127, "cur_lr": 0.001, "total_loss": 0.005611332133412361, "policy_loss": -0.01769340503960848, "vf_loss": 0.02330473717302084, "vf_explained_var": 0.990921139717102, "kl": 0.002357816672883928, "entropy": -7.056771516799927, "entropy_coeff": 0.0}}, "num_steps_sampled": 3592800, "num_steps_trained": 3592800}, "done": false, "episodes_total": 3582, "training_iteration": 476, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-42", "timestamp": 1617635802, "time_this_iter_s": 1.4264681339263916, "time_total_s": 797.02601146698, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345a4560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 632.2395470142365, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 72.05, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 137.7548008287838, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 66.89785956537973, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.234058298633446, "MDD_min": 15.925448580550379, "MDD_max": 34.10449353877555}, "hist_stats": {"episode_reward": [82.35112525359703, 43.41348200734621, 78.09563835994317, 43.0662840579223, 88.65641302355375, 41.90110109330151, 117.01538486301308, 65.77390670629204, 43.16311941543964, 94.41024270081881, 25.73402609091827, 69.89021143723559, 64.46488789412676, 61.79312370362551, 105.59996406510328, 67.11531535947717, 58.72931257039149, 52.67431968949983, 46.962154554127245, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028815968378996, "mean_inference_ms": 1.2775599868449055, "mean_action_processing_ms": 0.05450103500678049, "mean_env_wait_ms": 1.1961661787801448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3600400, "timers": {"sample_time_ms": 1160.768, "sample_throughput": 6547.392, "learn_time_ms": 304.327, "learn_throughput": 24973.16, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.6931914471142943e-127, "cur_lr": 0.001, "total_loss": 0.3100588917732239, "policy_loss": 0.02516312338411808, "vf_loss": 0.28489576280117035, "vf_explained_var": 0.9916921257972717, "kl": 0.003078381880186498, "entropy": -7.165412425994873, "entropy_coeff": 0.0}}, "num_steps_sampled": 3600400, "num_steps_trained": 3600400}, "done": false, "episodes_total": 3582, "training_iteration": 477, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-43", "timestamp": 1617635803, "time_this_iter_s": 1.4563806056976318, "time_total_s": 798.4823920726776, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 633.6959276199341, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 72.05000000000001, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 67.66116689769837, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.55528021437418, "MDD_min": 15.906263201973873, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200271666104081, "mean_inference_ms": 1.2775237261034678, "mean_action_processing_ms": 0.054500342060716925, "mean_env_wait_ms": 1.196139627077424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3608000, "timers": {"sample_time_ms": 1159.627, "sample_throughput": 6553.832, "learn_time_ms": 305.053, "learn_throughput": 24913.679, "update_time_ms": 2.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8465957235571472e-127, "cur_lr": 0.001, "total_loss": 1.0127894580364227, "policy_loss": 0.007297185831703246, "vf_loss": 1.005492389202118, "vf_explained_var": 0.979660153388977, "kl": 0.0017314035794697702, "entropy": -6.920167922973633, "entropy_coeff": 0.0}}, "num_steps_sampled": 3608000, "num_steps_trained": 3608000}, "done": false, "episodes_total": 3601, "training_iteration": 478, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-45", "timestamp": 1617635805, "time_this_iter_s": 1.5386931896209717, "time_total_s": 800.0210852622986, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 635.234620809555, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 70.6, "ram_util_percent": 62.03333333333333}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 67.66116689769837, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.555280214374175, "MDD_min": 15.906263201973873, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [67.77166875265134, 38.7386609500442, 63.47348996126571, 59.14973627183398, 21.89644101526242, 62.2089118902782, 44.16387788358586, 101.73226612948363, 40.97204799438227, 83.78292626040485, 137.7548008287838, 88.24639307460852, 92.20325777905114, 77.78102827600632, 29.5954814236068, 88.90097303972499, 62.23247772160767, 55.60341712134277, 64.14196421314195, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.200271666104081, "mean_inference_ms": 1.2775237261034678, "mean_action_processing_ms": 0.054500342060716925, "mean_env_wait_ms": 1.1961396270774243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3615600, "timers": {"sample_time_ms": 1159.666, "sample_throughput": 6553.614, "learn_time_ms": 303.934, "learn_throughput": 25005.448, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.232978617785736e-128, "cur_lr": 0.001, "total_loss": 0.0769741851836443, "policy_loss": 0.022233054507523775, "vf_loss": 0.054741133004426956, "vf_explained_var": 0.9817847609519958, "kl": 0.0024193391436710954, "entropy": -6.928728103637695, "entropy_coeff": 0.0}}, "num_steps_sampled": 3615600, "num_steps_trained": 3615600}, "done": false, "episodes_total": 3601, "training_iteration": 479, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-46", "timestamp": 1617635806, "time_this_iter_s": 1.4314725399017334, "time_total_s": 801.4525578022003, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cdd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 636.6660933494568, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 74.80000000000001, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 67.48454433653404, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.173126555343856, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029176158837425, "mean_inference_ms": 1.2774872912305326, "mean_action_processing_ms": 0.054500097623019036, "mean_env_wait_ms": 1.1961180122578903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3623200, "timers": {"sample_time_ms": 1160.044, "sample_throughput": 6551.477, "learn_time_ms": 303.465, "learn_throughput": 25044.062, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.616489308892868e-128, "cur_lr": 0.001, "total_loss": 1.127286970615387, "policy_loss": -0.01475209230557084, "vf_loss": 1.1420390605926514, "vf_explained_var": 0.9841099977493286, "kl": 0.003602338838391006, "entropy": -7.08788800239563, "entropy_coeff": 0.0}}, "num_steps_sampled": 3623200, "num_steps_trained": 3623200}, "done": false, "episodes_total": 3620, "training_iteration": 480, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-48", "timestamp": 1617635808, "time_this_iter_s": 1.5338408946990967, "time_total_s": 802.9863986968994, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 638.1999342441559, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 81.15, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 67.48454433653404, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.17312655534386, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002917615883743, "mean_inference_ms": 1.2774872912305326, "mean_action_processing_ms": 0.054500097623019036, "mean_env_wait_ms": 1.1961180122578903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3630800, "timers": {"sample_time_ms": 1159.524, "sample_throughput": 6554.411, "learn_time_ms": 303.001, "learn_throughput": 25082.453, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.308244654446434e-128, "cur_lr": 0.001, "total_loss": 0.025875850580632687, "policy_loss": 0.00557440469856374, "vf_loss": 0.020301449112594128, "vf_explained_var": 0.9933689832687378, "kl": 0.0020524788415059447, "entropy": -7.059020042419434, "entropy_coeff": 0.0}}, "num_steps_sampled": 3630800, "num_steps_trained": 3630800}, "done": false, "episodes_total": 3620, "training_iteration": 481, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-49", "timestamp": 1617635809, "time_this_iter_s": 1.4148645401000977, "time_total_s": 804.4012632369995, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 639.614798784256, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 20.607594998403332, "episode_reward_mean": 67.48454433653404, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.17312655534386, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [62.547090029145, 74.90936169327738, 52.39537945859279, 125.25286749144703, 83.35348809625145, 84.04960222950177, 36.43948717052132, 53.166137159260174, 51.96294143544225, 114.08632067304382, 64.54430332865755, 77.75138645975592, 105.06430751079009, 63.024816363847506, 20.607594998403332, 45.069928377321254, 78.4121058444119, 60.54061037307835, 30.635907038762653, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002917615883743, "mean_inference_ms": 1.2774872912305326, "mean_action_processing_ms": 0.054500097623019036, "mean_env_wait_ms": 1.1961180122578903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3638400, "timers": {"sample_time_ms": 1158.867, "sample_throughput": 6558.129, "learn_time_ms": 303.197, "learn_throughput": 25066.246, "update_time_ms": 2.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.154122327223217e-128, "cur_lr": 0.001, "total_loss": 0.22977613657712936, "policy_loss": -0.003970680758357048, "vf_loss": 0.23374679684638977, "vf_explained_var": 0.9938030242919922, "kl": 0.002709078136831522, "entropy": -7.15841269493103, "entropy_coeff": 0.0}}, "num_steps_sampled": 3638400, "num_steps_trained": 3638400}, "done": false, "episodes_total": 3620, "training_iteration": 482, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-50", "timestamp": 1617635810, "time_this_iter_s": 1.4277396202087402, "time_total_s": 805.8290028572083, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ca70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 641.0425384044647, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 72.95, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 27.68580436742281, "episode_reward_mean": 67.08333672662248, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.25455476528211, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002805913399202, "mean_inference_ms": 1.2774594378359978, "mean_action_processing_ms": 0.0545010103158668, "mean_env_wait_ms": 1.1961039486490046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3646000, "timers": {"sample_time_ms": 1160.377, "sample_throughput": 6549.597, "learn_time_ms": 303.564, "learn_throughput": 25035.877, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.770611636116085e-129, "cur_lr": 0.001, "total_loss": 0.8003551363945007, "policy_loss": 0.00527565460652113, "vf_loss": 0.7950794696807861, "vf_explained_var": 0.9835904836654663, "kl": 0.00255031231790781, "entropy": -6.939770460128784, "entropy_coeff": 0.0}}, "num_steps_sampled": 3646000, "num_steps_trained": 3646000}, "done": false, "episodes_total": 3639, "training_iteration": 483, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-52", "timestamp": 1617635812, "time_this_iter_s": 1.5496459007263184, "time_total_s": 807.3786487579346, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 642.592184305191, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 71.6, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 27.68580436742281, "episode_reward_mean": 67.08333672662248, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.254554765282105, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [49.25882839509656, 77.97199300014509, 78.78471001234571, 46.08594620324086, 41.62718600150608, 27.68580436742281, 31.635033917547396, 53.511336507436184, 98.96978387903523, 96.97081192574728, 44.23677370728291, 58.60291283877102, 96.44616309659449, 67.68356908125699, 52.61147426429697, 103.09449193612083, 75.1654503736268, 56.87289377365331, 105.38744405750883, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028059133992013, "mean_inference_ms": 1.277459437835998, "mean_action_processing_ms": 0.05450101031586681, "mean_env_wait_ms": 1.1961039486490044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3653600, "timers": {"sample_time_ms": 1160.802, "sample_throughput": 6547.195, "learn_time_ms": 304.011, "learn_throughput": 24999.075, "update_time_ms": 2.898}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8853058180580424e-129, "cur_lr": 0.001, "total_loss": 0.028065667138434947, "policy_loss": -0.02420095633715391, "vf_loss": 0.05226662568747997, "vf_explained_var": 0.9818657636642456, "kl": 0.001542884623631835, "entropy": -6.943381309509277, "entropy_coeff": 0.0}}, "num_steps_sampled": 3653600, "num_steps_trained": 3653600}, "done": false, "episodes_total": 3639, "training_iteration": 484, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-53", "timestamp": 1617635813, "time_this_iter_s": 1.4303407669067383, "time_total_s": 808.8089895248413, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ca70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 644.0225250720978, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 29.2523285188394, "episode_reward_mean": 65.84432430680245, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.028768255068012, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030114087859144, "mean_inference_ms": 1.2774334683491866, "mean_action_processing_ms": 0.054502204949385416, "mean_env_wait_ms": 1.1960935203826806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3661200, "timers": {"sample_time_ms": 1159.551, "sample_throughput": 6554.263, "learn_time_ms": 304.074, "learn_throughput": 24993.941, "update_time_ms": 2.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4426529090290212e-129, "cur_lr": 0.001, "total_loss": 1.0252983272075653, "policy_loss": -0.005586197366937995, "vf_loss": 1.0308845937252045, "vf_explained_var": 0.9853826761245728, "kl": 0.002017116523347795, "entropy": -7.121258974075317, "entropy_coeff": 0.0}}, "num_steps_sampled": 3661200, "num_steps_trained": 3661200}, "done": false, "episodes_total": 3658, "training_iteration": 485, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-55", "timestamp": 1617635815, "time_this_iter_s": 1.5236117839813232, "time_total_s": 810.3326013088226, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 645.5461368560791, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 66.26666666666667, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 29.2523285188394, "episode_reward_mean": 65.84432430680245, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.028768255068012, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030114087859147, "mean_inference_ms": 1.2774334683491864, "mean_action_processing_ms": 0.054502204949385416, "mean_env_wait_ms": 1.1960935203826804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3668800, "timers": {"sample_time_ms": 1158.862, "sample_throughput": 6558.16, "learn_time_ms": 303.559, "learn_throughput": 25036.312, "update_time_ms": 2.908}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.213264545145106e-130, "cur_lr": 0.001, "total_loss": 0.02768737729638815, "policy_loss": 0.008303665788844228, "vf_loss": 0.01938370894640684, "vf_explained_var": 0.9932782053947449, "kl": 0.001638168003410101, "entropy": -7.063842058181763, "entropy_coeff": 0.0}}, "num_steps_sampled": 3668800, "num_steps_trained": 3668800}, "done": false, "episodes_total": 3658, "training_iteration": 486, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-56", "timestamp": 1617635816, "time_this_iter_s": 1.415076494216919, "time_total_s": 811.7476778030396, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 646.961213350296, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 73.65, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 29.2523285188394, "episode_reward_mean": 65.84432430680245, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.028768255068012, "MDD_min": 14.07297542933393, "MDD_max": 36.23097365825192}, "hist_stats": {"episode_reward": [57.265248887062825, 64.6025860814878, 90.03187374897472, 64.36342445995521, 51.5060312690785, 110.94536774853, 66.99302828286415, 50.830751867456456, 60.84646391467743, 36.84845447751323, 77.92961196733599, 65.23225673140266, 50.96590063871491, 44.658619680373725, 99.55510309054246, 57.413738366655586, 65.88437078357367, 106.84823164571013, 93.24692666291892, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030114087859147, "mean_inference_ms": 1.2774334683491864, "mean_action_processing_ms": 0.054502204949385416, "mean_env_wait_ms": 1.1960935203826804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3676400, "timers": {"sample_time_ms": 1156.391, "sample_throughput": 6572.171, "learn_time_ms": 303.784, "learn_throughput": 25017.775, "update_time_ms": 2.942}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.606632272572553e-130, "cur_lr": 0.001, "total_loss": 0.19115079939365387, "policy_loss": 0.009123511495999992, "vf_loss": 0.18202729523181915, "vf_explained_var": 0.9957555532455444, "kl": 0.0010844228672794998, "entropy": -7.184454917907715, "entropy_coeff": 0.0}}, "num_steps_sampled": 3676400, "num_steps_trained": 3676400}, "done": false, "episodes_total": 3658, "training_iteration": 487, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-58", "timestamp": 1617635818, "time_this_iter_s": 1.4333820343017578, "time_total_s": 813.1810598373413, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345aa5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 648.3945953845978, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 74.44999999999999, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 63.408220559292864, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.49776484912779, "MDD_min": 14.07297542933393, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002890897079075, "mean_inference_ms": 1.2774056938599374, "mean_action_processing_ms": 0.054503335096426714, "mean_env_wait_ms": 1.1960779142368612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3684000, "timers": {"sample_time_ms": 1157.071, "sample_throughput": 6568.311, "learn_time_ms": 303.255, "learn_throughput": 25061.414, "update_time_ms": 2.94}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8033161362862765e-130, "cur_lr": 0.001, "total_loss": 0.5488729476928711, "policy_loss": 0.009929768042638898, "vf_loss": 0.5389432013034821, "vf_explained_var": 0.9885765314102173, "kl": 0.0015995572321116924, "entropy": -6.950088739395142, "entropy_coeff": 0.0}}, "num_steps_sampled": 3684000, "num_steps_trained": 3684000}, "done": false, "episodes_total": 3677, "training_iteration": 488, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-16-59", "timestamp": 1617635819, "time_this_iter_s": 1.5404012203216553, "time_total_s": 814.721461057663, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ca70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 649.9349966049194, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 80.75, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 153.02720193037618, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 63.40822055929286, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.497764849127783, "MDD_min": 14.07297542933393, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [57.29671152975771, 53.36671888569513, 74.80122396478664, 70.41819475141894, 40.35904059854077, 124.62024356240187, 51.62456647190119, 84.67804168001973, 153.02720193037618, 89.59965384393372, 29.2523285188394, 44.1664260958291, 45.1381438969459, 54.853825582206596, 35.37416222108152, 96.55103523890553, 65.12015777261612, 41.393768197744606, 86.26418113023759, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028908970790746, "mean_inference_ms": 1.2774056938599374, "mean_action_processing_ms": 0.054503335096426714, "mean_env_wait_ms": 1.1960779142368614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3691600, "timers": {"sample_time_ms": 1156.396, "sample_throughput": 6572.143, "learn_time_ms": 302.675, "learn_throughput": 25109.424, "update_time_ms": 2.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.016580681431383e-131, "cur_lr": 0.001, "total_loss": 0.03165878960862756, "policy_loss": -0.018376266350969672, "vf_loss": 0.050035055726766586, "vf_explained_var": 0.9823682308197021, "kl": 0.0013650903129018843, "entropy": -6.921776533126831, "entropy_coeff": 0.0}}, "num_steps_sampled": 3691600, "num_steps_trained": 3691600}, "done": false, "episodes_total": 3677, "training_iteration": 489, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-01", "timestamp": 1617635821, "time_this_iter_s": 1.4186341762542725, "time_total_s": 816.1400952339172, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 651.3536307811737, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 74.30000000000001, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 62.449362575824765, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.848334518367206, "MDD_min": 14.07297542933393, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030671982102333, "mean_inference_ms": 1.2773669833716703, "mean_action_processing_ms": 0.05450336697677427, "mean_env_wait_ms": 1.1960547818413039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3699200, "timers": {"sample_time_ms": 1157.061, "sample_throughput": 6568.367, "learn_time_ms": 302.778, "learn_throughput": 25100.91, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5082903407156913e-131, "cur_lr": 0.001, "total_loss": 0.8667525351047516, "policy_loss": -0.013282902771607041, "vf_loss": 0.8800355494022369, "vf_explained_var": 0.9872456789016724, "kl": 0.002462988253682852, "entropy": -7.097784519195557, "entropy_coeff": 0.0}}, "num_steps_sampled": 3699200, "num_steps_trained": 3699200}, "done": false, "episodes_total": 3696, "training_iteration": 490, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-02", "timestamp": 1617635822, "time_this_iter_s": 1.5410447120666504, "time_total_s": 817.6811399459839, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 652.8946754932404, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 75.85, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 62.44936257582477, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.848334518367214, "MDD_min": 14.07297542933393, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030671982102344, "mean_inference_ms": 1.2773669833716703, "mean_action_processing_ms": 0.05450336697677426, "mean_env_wait_ms": 1.196054781841304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3706800, "timers": {"sample_time_ms": 1157.491, "sample_throughput": 6565.927, "learn_time_ms": 302.714, "learn_throughput": 25106.195, "update_time_ms": 2.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2541451703578456e-131, "cur_lr": 0.001, "total_loss": 0.022867290303111076, "policy_loss": -0.0010082046328534489, "vf_loss": 0.023875494487583637, "vf_explained_var": 0.9911983013153076, "kl": 0.0012185228988528252, "entropy": -7.053757190704346, "entropy_coeff": 0.0}}, "num_steps_sampled": 3706800, "num_steps_trained": 3706800}, "done": false, "episodes_total": 3696, "training_iteration": 491, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-04", "timestamp": 1617635824, "time_this_iter_s": 1.4177687168121338, "time_total_s": 819.098908662796, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345e9f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 654.3124442100525, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 72.55, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 62.44936257582477, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.848334518367214, "MDD_min": 14.07297542933393, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [72.94822162052752, 54.418582832874534, 72.03290135564913, 54.87068448932543, 71.20661963617952, 72.18944454379401, 96.7082158127792, 50.94310952089571, 44.08188487085497, 119.62982312747287, 67.72206306020952, 97.6497871033491, 61.34475013370355, 81.21553280544082, 59.360536167769375, 55.916624981395564, 55.88415198059657, 47.1504580571401, 57.59681614147538, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20030671982102344, "mean_inference_ms": 1.2773669833716703, "mean_action_processing_ms": 0.05450336697677426, "mean_env_wait_ms": 1.196054781841304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3714400, "timers": {"sample_time_ms": 1156.995, "sample_throughput": 6568.738, "learn_time_ms": 302.606, "learn_throughput": 25115.193, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1270725851789228e-131, "cur_lr": 0.001, "total_loss": 0.260989710688591, "policy_loss": -0.002517613349482417, "vf_loss": 0.26350733637809753, "vf_explained_var": 0.9940237998962402, "kl": 0.001241194608155638, "entropy": -7.2034289836883545, "entropy_coeff": 0.0}}, "num_steps_sampled": 3714400, "num_steps_trained": 3714400}, "done": false, "episodes_total": 3696, "training_iteration": 492, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-05", "timestamp": 1617635825, "time_this_iter_s": 1.4213790893554688, "time_total_s": 820.5202877521515, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 655.733823299408, "timesteps_since_restore": 0, "iterations_since_restore": 442, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 61.55797034311491, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.96120166992953, "MDD_min": 14.794518492079746, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002804461466132, "mean_inference_ms": 1.27733087181678, "mean_action_processing_ms": 0.054504510158416467, "mean_env_wait_ms": 1.1960296198989218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3722000, "timers": {"sample_time_ms": 1158.377, "sample_throughput": 6560.904, "learn_time_ms": 302.905, "learn_throughput": 25090.386, "update_time_ms": 2.875}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.635362925894614e-132, "cur_lr": 0.001, "total_loss": 0.7739381194114685, "policy_loss": -0.024564099498093128, "vf_loss": 0.7985021770000458, "vf_explained_var": 0.9823290109634399, "kl": 0.0032771617406979203, "entropy": -6.960797071456909, "entropy_coeff": 0.0}}, "num_steps_sampled": 3722000, "num_steps_trained": 3722000}, "done": false, "episodes_total": 3715, "training_iteration": 493, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-07", "timestamp": 1617635827, "time_this_iter_s": 1.5667047500610352, "time_total_s": 822.0869925022125, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 657.300528049469, "timesteps_since_restore": 0, "iterations_since_restore": 443, "perf": {"cpu_util_percent": 72.35, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 61.5579703431149, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 23.96120166992952, "MDD_min": 14.794518492079746, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [40.30483531743035, 73.30745126877173, 73.60414349878197, 44.13696574681392, 63.94097033195919, 86.01896518227775, 50.867912662242674, 63.956633805704, 52.895349678526486, 84.26127673928966, 72.91542474335704, 49.57837596977349, 41.46701565276276, 53.14126879207614, 83.61224697308872, 57.207532538475846, 68.26071980982125, 54.04501680181775, 104.43209373200162, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028044614661314, "mean_inference_ms": 1.27733087181678, "mean_action_processing_ms": 0.05450451015841645, "mean_env_wait_ms": 1.1960296198989218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3729600, "timers": {"sample_time_ms": 1161.331, "sample_throughput": 6544.216, "learn_time_ms": 303.286, "learn_throughput": 25058.873, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.817681462947307e-132, "cur_lr": 0.001, "total_loss": 0.03758107125759125, "policy_loss": -0.014200047357007861, "vf_loss": 0.05178111605346203, "vf_explained_var": 0.9786158204078674, "kl": 0.0020894529297947884, "entropy": -6.959530353546143, "entropy_coeff": 0.0}}, "num_steps_sampled": 3729600, "num_steps_trained": 3729600}, "done": false, "episodes_total": 3715, "training_iteration": 494, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-08", "timestamp": 1617635828, "time_this_iter_s": 1.4629249572753906, "time_total_s": 823.5499174594879, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 658.7634530067444, "timesteps_since_restore": 0, "iterations_since_restore": 444, "perf": {"cpu_util_percent": 66.43333333333334, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 60.58213975008087, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.019741929008983, "MDD_min": 14.259518936682555, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029241392104422, "mean_inference_ms": 1.2773227210800762, "mean_action_processing_ms": 0.054506703089721296, "mean_env_wait_ms": 1.1960368151145955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3737200, "timers": {"sample_time_ms": 1165.261, "sample_throughput": 6522.145, "learn_time_ms": 303.949, "learn_throughput": 25004.209, "update_time_ms": 2.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4088407314736535e-132, "cur_lr": 0.001, "total_loss": 0.8608410954475403, "policy_loss": -0.01272837514989078, "vf_loss": 0.8735694885253906, "vf_explained_var": 0.9879641532897949, "kl": 0.0015510567463934422, "entropy": -7.10485053062439, "entropy_coeff": 0.0}}, "num_steps_sampled": 3737200, "num_steps_trained": 3737200}, "done": false, "episodes_total": 3734, "training_iteration": 495, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-10", "timestamp": 1617635830, "time_this_iter_s": 1.5697605609893799, "time_total_s": 825.1196780204773, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 660.3332135677338, "timesteps_since_restore": 0, "iterations_since_restore": 445, "perf": {"cpu_util_percent": 83.95, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 60.582139750080884, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.019741929008987, "MDD_min": 14.259518936682555, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029241392104416, "mean_inference_ms": 1.2773227210800762, "mean_action_processing_ms": 0.05450670308972128, "mean_env_wait_ms": 1.1960368151145955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3744800, "timers": {"sample_time_ms": 1165.302, "sample_throughput": 6521.914, "learn_time_ms": 305.527, "learn_throughput": 24875.05, "update_time_ms": 2.779}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.044203657368268e-133, "cur_lr": 0.001, "total_loss": 0.024508481845259666, "policy_loss": 0.004939205013215542, "vf_loss": 0.019569283351302147, "vf_explained_var": 0.9905163049697876, "kl": 0.001559348835144192, "entropy": -7.077251195907593, "entropy_coeff": 0.0}}, "num_steps_sampled": 3744800, "num_steps_trained": 3744800}, "done": false, "episodes_total": 3734, "training_iteration": 496, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-11", "timestamp": 1617635831, "time_this_iter_s": 1.4309484958648682, "time_total_s": 826.5506265163422, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 661.7641620635986, "timesteps_since_restore": 0, "iterations_since_restore": 446, "perf": {"cpu_util_percent": 74.15, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 60.582139750080884, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.019741929008987, "MDD_min": 14.259518936682555, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [80.01168115829206, 46.87227593638769, 46.72984617642587, 57.55018570662475, 89.8690526814105, 48.5886629266785, 51.898916292791675, 56.961008764323765, 31.590453834440105, 67.39357085302633, 57.2012812430612, 80.98309508755302, 43.6368291999797, 93.075589865489, 45.48397647317618, 59.861861760675495, 72.65350153270518, 31.824435494795758, 39.980211029503444, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20029241392104416, "mean_inference_ms": 1.2773227210800762, "mean_action_processing_ms": 0.05450670308972128, "mean_env_wait_ms": 1.1960368151145955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3752400, "timers": {"sample_time_ms": 1164.893, "sample_throughput": 6524.205, "learn_time_ms": 306.429, "learn_throughput": 24801.868, "update_time_ms": 2.727}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.522101828684134e-133, "cur_lr": 0.001, "total_loss": 0.19173327833414078, "policy_loss": -0.014399171574041247, "vf_loss": 0.2061324566602707, "vf_explained_var": 0.9952647686004639, "kl": 0.002036179124843329, "entropy": -7.175532579421997, "entropy_coeff": 0.0}}, "num_steps_sampled": 3752400, "num_steps_trained": 3752400}, "done": false, "episodes_total": 3734, "training_iteration": 497, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-13", "timestamp": 1617635833, "time_this_iter_s": 1.4372165203094482, "time_total_s": 827.9878430366516, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 663.2013785839081, "timesteps_since_restore": 0, "iterations_since_restore": 447, "perf": {"cpu_util_percent": 76.15, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 60.58023722520128, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.598210586708, "MDD_min": 14.259518936682555, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027007367773847, "mean_inference_ms": 1.2773241083536246, "mean_action_processing_ms": 0.054509084856128105, "mean_env_wait_ms": 1.1960549310531803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3760000, "timers": {"sample_time_ms": 1165.595, "sample_throughput": 6520.276, "learn_time_ms": 306.381, "learn_throughput": 24805.742, "update_time_ms": 2.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.761050914342067e-133, "cur_lr": 0.001, "total_loss": 0.6168111562728882, "policy_loss": 0.002993662958033383, "vf_loss": 0.613817423582077, "vf_explained_var": 0.9856221675872803, "kl": 0.0008406688866671175, "entropy": -6.964895248413086, "entropy_coeff": 0.0}}, "num_steps_sampled": 3760000, "num_steps_trained": 3760000}, "done": false, "episodes_total": 3753, "training_iteration": 498, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-14", "timestamp": 1617635834, "time_this_iter_s": 1.5465667247772217, "time_total_s": 829.5344097614288, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450eef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 664.7479453086853, "timesteps_since_restore": 0, "iterations_since_restore": 448, "perf": {"cpu_util_percent": 74.35, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 148.0932039433721, "episode_reward_min": 28.774892108160547, "episode_reward_mean": 60.580237225201266, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.598210586707996, "MDD_min": 14.259518936682555, "MDD_max": 36.439394718647414}, "hist_stats": {"episode_reward": [38.876857413299454, 64.62777141755735, 148.0932039433721, 47.48388797108134, 58.486250253123075, 42.75015847756913, 57.58753140418252, 49.87630681983745, 76.24669536648514, 58.975752728271374, 50.68674565838327, 48.11552908419131, 66.8670651960251, 73.08941560897652, 85.26593882557913, 44.236125200454225, 55.53851240574289, 76.32784276639929, 47.93320062036056, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027007367773847, "mean_inference_ms": 1.2773241083536246, "mean_action_processing_ms": 0.0545090848561281, "mean_env_wait_ms": 1.1960549310531803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3767600, "timers": {"sample_time_ms": 1164.018, "sample_throughput": 6529.106, "learn_time_ms": 306.183, "learn_throughput": 24821.797, "update_time_ms": 2.703}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.805254571710335e-134, "cur_lr": 0.001, "total_loss": 0.060324857011437416, "policy_loss": -0.0019146140257362276, "vf_loss": 0.062239473685622215, "vf_explained_var": 0.9751332998275757, "kl": 0.0018581144395284355, "entropy": -6.946005582809448, "entropy_coeff": 0.0}}, "num_steps_sampled": 3767600, "num_steps_trained": 3767600}, "done": false, "episodes_total": 3753, "training_iteration": 499, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-16", "timestamp": 1617635836, "time_this_iter_s": 1.4013187885284424, "time_total_s": 830.9357285499573, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 666.1492640972137, "timesteps_since_restore": 0, "iterations_since_restore": 449, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 136.82089929081778, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 60.92714056992302, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.32370631016454, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002774580471808, "mean_inference_ms": 1.2773174873039461, "mean_action_processing_ms": 0.05451191724614223, "mean_env_wait_ms": 1.1960678027639495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3775200, "timers": {"sample_time_ms": 1163.403, "sample_throughput": 6532.559, "learn_time_ms": 306.753, "learn_throughput": 24775.631, "update_time_ms": 2.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4026272858551673e-134, "cur_lr": 0.001, "total_loss": 0.9981745481491089, "policy_loss": 0.003846791048999876, "vf_loss": 0.9943278431892395, "vf_explained_var": 0.9848177433013916, "kl": 0.0018670303979888558, "entropy": -7.094147205352783, "entropy_coeff": 0.0}}, "num_steps_sampled": 3775200, "num_steps_trained": 3775200}, "done": false, "episodes_total": 3772, "training_iteration": 500, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-17", "timestamp": 1617635837, "time_this_iter_s": 1.5407395362854004, "time_total_s": 832.4764680862427, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450eef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 667.6900036334991, "timesteps_since_restore": 0, "iterations_since_restore": 450, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 136.82089929081778, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 60.92714056992302, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.323706310164535, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027745804718086, "mean_inference_ms": 1.2773174873039461, "mean_action_processing_ms": 0.05451191724614222, "mean_env_wait_ms": 1.1960678027639498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3782800, "timers": {"sample_time_ms": 1162.361, "sample_throughput": 6538.416, "learn_time_ms": 307.594, "learn_throughput": 24707.933, "update_time_ms": 2.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2013136429275836e-134, "cur_lr": 0.001, "total_loss": 0.036773969419300556, "policy_loss": 0.016324849100783467, "vf_loss": 0.020449116826057434, "vf_explained_var": 0.9899933338165283, "kl": 0.002062154933810234, "entropy": -7.065720558166504, "entropy_coeff": 0.0}}, "num_steps_sampled": 3782800, "num_steps_trained": 3782800}, "done": false, "episodes_total": 3772, "training_iteration": 501, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-19", "timestamp": 1617635839, "time_this_iter_s": 1.4156279563903809, "time_total_s": 833.892096042633, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 669.1056315898895, "timesteps_since_restore": 0, "iterations_since_restore": 451, "perf": {"cpu_util_percent": 71.55, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 136.82089929081778, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 60.92714056992302, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.323706310164535, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [66.69146168638393, 28.774892108160547, 29.973694744974118, 55.65927571312403, 57.761471138769444, 45.07120486605775, 57.17438337541263, 44.45420313383865, 53.253272420884024, 48.952933845970584, 92.522596721666, 51.75790441428704, 52.951116096051614, 43.17891947989561, 52.27881316828111, 55.319894356296395, 61.59659132045853, 46.056641605018385, 107.10027432573239, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20027745804718086, "mean_inference_ms": 1.2773174873039461, "mean_action_processing_ms": 0.05451191724614222, "mean_env_wait_ms": 1.1960678027639498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3790400, "timers": {"sample_time_ms": 1163.716, "sample_throughput": 6530.803, "learn_time_ms": 307.997, "learn_throughput": 24675.568, "update_time_ms": 2.65}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1006568214637918e-134, "cur_lr": 0.001, "total_loss": 0.38313014805316925, "policy_loss": -0.0061991309048607945, "vf_loss": 0.38932928442955017, "vf_explained_var": 0.9904187917709351, "kl": 0.001000732067041099, "entropy": -7.181918382644653, "entropy_coeff": 0.0}}, "num_steps_sampled": 3790400, "num_steps_trained": 3790400}, "done": false, "episodes_total": 3772, "training_iteration": 502, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-20", "timestamp": 1617635840, "time_this_iter_s": 1.4396159648895264, "time_total_s": 835.3317120075226, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55345e9f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 670.545247554779, "timesteps_since_restore": 0, "iterations_since_restore": 452, "perf": {"cpu_util_percent": 67.10000000000001, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 136.82089929081778, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 64.82120667527755, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.510532541922476, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025337722023054, "mean_inference_ms": 1.277317154664849, "mean_action_processing_ms": 0.05451540753978862, "mean_env_wait_ms": 1.1960873678413209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3798000, "timers": {"sample_time_ms": 1161.461, "sample_throughput": 6543.48, "learn_time_ms": 308.293, "learn_throughput": 24651.886, "update_time_ms": 2.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.503284107318959e-135, "cur_lr": 0.001, "total_loss": 1.0187211632728577, "policy_loss": 0.012193478527478874, "vf_loss": 1.006527692079544, "vf_explained_var": 0.9728660583496094, "kl": 0.0019615727942436934, "entropy": -6.964068412780762, "entropy_coeff": 0.0}}, "num_steps_sampled": 3798000, "num_steps_trained": 3798000}, "done": false, "episodes_total": 3791, "training_iteration": 503, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-22", "timestamp": 1617635842, "time_this_iter_s": 1.5468196868896484, "time_total_s": 836.8785316944122, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 672.0920672416687, "timesteps_since_restore": 0, "iterations_since_restore": 453, "perf": {"cpu_util_percent": 81.1, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 136.82089929081778, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 64.82120667527755, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.510532541922473, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [40.9613173346375, 70.19242229554594, 136.82089929081778, 68.63347110138513, 73.74296837419101, 54.54670343392101, 69.49580797163746, 73.11175144492388, 55.13874080531503, 67.31114787028444, 62.34236935986842, 53.662637200604145, 56.79451658244842, 53.694055628822, 74.20305071074515, 101.74290881682995, 83.36181283314862, 40.53370634303915, 54.685493376832596, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025337722023057, "mean_inference_ms": 1.277317154664849, "mean_action_processing_ms": 0.05451540753978864, "mean_env_wait_ms": 1.1960873678413209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3805600, "timers": {"sample_time_ms": 1158.192, "sample_throughput": 6561.949, "learn_time_ms": 307.206, "learn_throughput": 24739.115, "update_time_ms": 2.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7516420536594796e-135, "cur_lr": 0.001, "total_loss": 0.05059255100786686, "policy_loss": -0.0020750336989294738, "vf_loss": 0.05266759172081947, "vf_explained_var": 0.9806982278823853, "kl": 0.001433130877558142, "entropy": -6.969542503356934, "entropy_coeff": 0.0}}, "num_steps_sampled": 3805600, "num_steps_trained": 3805600}, "done": false, "episodes_total": 3791, "training_iteration": 504, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-23", "timestamp": 1617635843, "time_this_iter_s": 1.4202721118927002, "time_total_s": 838.2988038063049, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 673.5123393535614, "timesteps_since_restore": 0, "iterations_since_restore": 454, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.48410979286017, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.78885751585087, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026437287413798, "mean_inference_ms": 1.2773266054395178, "mean_action_processing_ms": 0.054517957239334336, "mean_env_wait_ms": 1.1961148338951213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3813200, "timers": {"sample_time_ms": 1155.662, "sample_throughput": 6576.319, "learn_time_ms": 306.861, "learn_throughput": 24766.878, "update_time_ms": 2.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3758210268297398e-135, "cur_lr": 0.001, "total_loss": 1.1678833365440369, "policy_loss": 0.006577377120265737, "vf_loss": 1.1613060235977173, "vf_explained_var": 0.9818860292434692, "kl": 0.003273404436185956, "entropy": -7.100879192352295, "entropy_coeff": 0.0}}, "num_steps_sampled": 3813200, "num_steps_trained": 3813200}, "done": false, "episodes_total": 3810, "training_iteration": 505, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-25", "timestamp": 1617635845, "time_this_iter_s": 1.5401301383972168, "time_total_s": 839.8389339447021, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 675.0524694919586, "timesteps_since_restore": 0, "iterations_since_restore": 455, "perf": {"cpu_util_percent": 80.55000000000001, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.48410979286017, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.78885751585087, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026437287413795, "mean_inference_ms": 1.2773266054395178, "mean_action_processing_ms": 0.054517957239334336, "mean_env_wait_ms": 1.1961148338951215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3820800, "timers": {"sample_time_ms": 1155.824, "sample_throughput": 6575.394, "learn_time_ms": 305.034, "learn_throughput": 24915.24, "update_time_ms": 2.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.879105134148699e-136, "cur_lr": 0.001, "total_loss": 0.00749053293839097, "policy_loss": -0.011976252775639296, "vf_loss": 0.019466781057417393, "vf_explained_var": 0.9895446300506592, "kl": 0.0025882174959406257, "entropy": -7.087845087051392, "entropy_coeff": 0.0}}, "num_steps_sampled": 3820800, "num_steps_trained": 3820800}, "done": false, "episodes_total": 3810, "training_iteration": 506, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-26", "timestamp": 1617635846, "time_this_iter_s": 1.4138059616088867, "time_total_s": 841.252739906311, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 676.4662754535675, "timesteps_since_restore": 0, "iterations_since_restore": 456, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.48410979286017, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.78885751585087, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [40.015767699334205, 50.42297680358962, 71.28615920657904, 43.005930561903575, 98.37544832062066, 33.65873078954191, 51.147290455631946, 47.283255251701455, 63.737490039932425, 38.52578712229813, 38.285633977178406, 69.61950843315093, 35.55280475041615, 49.612947114866444, 43.73173700147067, 70.12901836252807, 66.16688334959059, 80.56295255434377, 49.1790871665579, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026437287413795, "mean_inference_ms": 1.2773266054395178, "mean_action_processing_ms": 0.054517957239334336, "mean_env_wait_ms": 1.1961148338951215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3828400, "timers": {"sample_time_ms": 1154.2, "sample_throughput": 6584.648, "learn_time_ms": 303.211, "learn_throughput": 25065.082, "update_time_ms": 2.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4395525670743494e-136, "cur_lr": 0.001, "total_loss": 0.1825885996222496, "policy_loss": -0.004688595654442906, "vf_loss": 0.1872771829366684, "vf_explained_var": 0.9948456287384033, "kl": 0.0008582121809013188, "entropy": -7.199253082275391, "entropy_coeff": 0.0}}, "num_steps_sampled": 3828400, "num_steps_trained": 3828400}, "done": false, "episodes_total": 3810, "training_iteration": 507, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-28", "timestamp": 1617635848, "time_this_iter_s": 1.4036693572998047, "time_total_s": 842.6564092636108, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450eef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 677.8699448108673, "timesteps_since_restore": 0, "iterations_since_restore": 457, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.11492343356727, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.795311681667016, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024461351671774, "mean_inference_ms": 1.277306401689667, "mean_action_processing_ms": 0.054519384540764645, "mean_env_wait_ms": 1.1961134477579778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3836000, "timers": {"sample_time_ms": 1152.364, "sample_throughput": 6595.141, "learn_time_ms": 303.226, "learn_throughput": 25063.777, "update_time_ms": 2.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7197762835371747e-136, "cur_lr": 0.001, "total_loss": 0.5335920453071594, "policy_loss": -0.0015487008495256305, "vf_loss": 0.5351407527923584, "vf_explained_var": 0.9853061437606812, "kl": 0.0010282833245582879, "entropy": -6.974847316741943, "entropy_coeff": 0.0}}, "num_steps_sampled": 3836000, "num_steps_trained": 3836000}, "done": false, "episodes_total": 3829, "training_iteration": 508, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-29", "timestamp": 1617635849, "time_this_iter_s": 1.5289523601531982, "time_total_s": 844.185361623764, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 679.3988971710205, "timesteps_since_restore": 0, "iterations_since_restore": 458, "perf": {"cpu_util_percent": 72.9, "ram_util_percent": 62.0}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.11492343356727, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.795311681667016, "MDD_min": 14.259518936682555, "MDD_max": 34.830037121008196}, "hist_stats": {"episode_reward": [82.87137754629047, 78.64847771520688, 29.53726575893974, 94.08096051667765, 98.03993203524512, 83.03034198004046, 107.29954307537177, 52.915474677596535, 38.281526317991926, 56.00175125471795, 59.242458473248185, 43.35147643354819, 51.20777699569713, 79.99149132589334, 75.02571136673703, 34.17446341071532, 66.35561973414909, 32.62378612841, 38.5391687064824, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002446135167177, "mean_inference_ms": 1.2773064016896667, "mean_action_processing_ms": 0.05451938454076464, "mean_env_wait_ms": 1.196113447757978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3843600, "timers": {"sample_time_ms": 1153.247, "sample_throughput": 6590.09, "learn_time_ms": 303.678, "learn_throughput": 25026.484, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.598881417685874e-137, "cur_lr": 0.001, "total_loss": 0.07802238687872887, "policy_loss": 0.015145839424803853, "vf_loss": 0.06287654675543308, "vf_explained_var": 0.976103663444519, "kl": 0.0015514273545704782, "entropy": -6.97016453742981, "entropy_coeff": 0.0}}, "num_steps_sampled": 3843600, "num_steps_trained": 3843600}, "done": false, "episodes_total": 3829, "training_iteration": 509, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-31", "timestamp": 1617635851, "time_this_iter_s": 1.4141619205474854, "time_total_s": 845.5995235443115, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450e290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 680.813059091568, "timesteps_since_restore": 0, "iterations_since_restore": 459, "perf": {"cpu_util_percent": 71.9, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.15001808647474, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.667925054175136, "MDD_min": 14.867895869415495, "MDD_max": 32.68488416438967}, "hist_stats": {"episode_reward": [63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002564308536983, "mean_inference_ms": 1.2772735648003495, "mean_action_processing_ms": 0.05451997028817353, "mean_env_wait_ms": 1.1960913902207866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3851200, "timers": {"sample_time_ms": 1154.299, "sample_throughput": 6584.085, "learn_time_ms": 302.618, "learn_throughput": 25114.15, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.299440708842937e-137, "cur_lr": 0.001, "total_loss": 1.1001447439193726, "policy_loss": 0.0030683265067636967, "vf_loss": 1.0970765352249146, "vf_explained_var": 0.9825244545936584, "kl": 0.0027495311805978417, "entropy": -7.1152026653289795, "entropy_coeff": 0.0}}, "num_steps_sampled": 3851200, "num_steps_trained": 3851200}, "done": false, "episodes_total": 3848, "training_iteration": 510, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-32", "timestamp": 1617635852, "time_this_iter_s": 1.5407683849334717, "time_total_s": 847.140291929245, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 682.3538274765015, "timesteps_since_restore": 0, "iterations_since_restore": 460, "perf": {"cpu_util_percent": 67.23333333333333, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.15001808647474, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.66792505417513, "MDD_min": 14.867895869415495, "MDD_max": 32.68488416438967}, "hist_stats": {"episode_reward": [54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025643085369826, "mean_inference_ms": 1.2772735648003497, "mean_action_processing_ms": 0.05451997028817353, "mean_env_wait_ms": 1.1960913902207866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3858800, "timers": {"sample_time_ms": 1156.379, "sample_throughput": 6572.239, "learn_time_ms": 301.706, "learn_throughput": 25190.059, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1497203544214684e-137, "cur_lr": 0.001, "total_loss": 0.023163694888353348, "policy_loss": 0.003551508649252355, "vf_loss": 0.019612185657024384, "vf_explained_var": 0.9900116324424744, "kl": 0.0014519792166538537, "entropy": -7.118707895278931, "entropy_coeff": 0.0}}, "num_steps_sampled": 3858800, "num_steps_trained": 3858800}, "done": false, "episodes_total": 3848, "training_iteration": 511, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-34", "timestamp": 1617635854, "time_this_iter_s": 1.4277958869934082, "time_total_s": 848.5680878162384, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 683.7816233634949, "timesteps_since_restore": 0, "iterations_since_restore": 461, "perf": {"cpu_util_percent": 73.9, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 19.54914886375204, "episode_reward_mean": 65.15001808647474, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.66792505417513, "MDD_min": 14.867895869415495, "MDD_max": 32.68488416438967}, "hist_stats": {"episode_reward": [54.896578906271415, 36.40052507178599, 90.1210536043194, 33.29408121289555, 69.22335485350789, 88.45665723271819, 44.6855388963553, 96.92770218388473, 88.72177399340137, 45.69656328672409, 69.33691146522412, 54.532139142429585, 55.369836053991776, 19.54914886375204, 69.64019935874748, 51.37411648748643, 58.734238070359815, 64.24932606496242, 74.13973193263588, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025643085369826, "mean_inference_ms": 1.2772735648003497, "mean_action_processing_ms": 0.05451997028817353, "mean_env_wait_ms": 1.1960913902207866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3866400, "timers": {"sample_time_ms": 1156.32, "sample_throughput": 6572.578, "learn_time_ms": 301.281, "learn_throughput": 25225.588, "update_time_ms": 2.858}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0748601772107342e-137, "cur_lr": 0.001, "total_loss": 0.1893969178199768, "policy_loss": -0.0019125846010865644, "vf_loss": 0.19130950421094894, "vf_explained_var": 0.9946850538253784, "kl": 0.0006423245358746499, "entropy": -7.209945440292358, "entropy_coeff": 0.0}}, "num_steps_sampled": 3866400, "num_steps_trained": 3866400}, "done": false, "episodes_total": 3848, "training_iteration": 512, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-35", "timestamp": 1617635855, "time_this_iter_s": 1.4339280128479004, "time_total_s": 850.0020158290863, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 685.2155513763428, "timesteps_since_restore": 0, "iterations_since_restore": 462, "perf": {"cpu_util_percent": 74.25, "ram_util_percent": 62.05}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 26.517741186050447, "episode_reward_mean": 64.06334773288718, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.50553358738635, "MDD_min": 14.867895869415495, "MDD_max": 32.68488416438967}, "hist_stats": {"episode_reward": [58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354, 65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024366853050624, "mean_inference_ms": 1.2772494937263354, "mean_action_processing_ms": 0.05452055936279009, "mean_env_wait_ms": 1.1960798328058397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3874000, "timers": {"sample_time_ms": 1158.144, "sample_throughput": 6562.226, "learn_time_ms": 300.749, "learn_throughput": 25270.249, "update_time_ms": 2.828}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.374300886053671e-138, "cur_lr": 0.001, "total_loss": 0.5214871466159821, "policy_loss": -0.0001366646320093423, "vf_loss": 0.5216238498687744, "vf_explained_var": 0.9860416054725647, "kl": 0.0024448175681754947, "entropy": -6.977266311645508, "entropy_coeff": 0.0}}, "num_steps_sampled": 3874000, "num_steps_trained": 3874000}, "done": false, "episodes_total": 3867, "training_iteration": 513, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-37", "timestamp": 1617635857, "time_this_iter_s": 1.5589790344238281, "time_total_s": 851.5609948635101, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c7a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 686.7745304107666, "timesteps_since_restore": 0, "iterations_since_restore": 463, "perf": {"cpu_util_percent": 82.94999999999999, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 125.01907869386922, "episode_reward_min": 26.517741186050447, "episode_reward_mean": 64.06334773288718, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 24.50553358738635, "MDD_min": 14.867895869415495, "MDD_max": 32.68488416438967}, "hist_stats": {"episode_reward": [65.68147505872724, 56.01148826790146, 81.06827317425851, 50.90861076183099, 90.67139533767498, 91.62610781388017, 66.45916962638462, 116.58003197944346, 96.492913136547, 79.34422934884871, 52.91939739516039, 65.92698627328801, 40.25167390345622, 125.01907869386922, 72.60585726581242, 64.00191898524305, 62.63490054756781, 117.93641393267944, 54.04719631361712, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024366853050615, "mean_inference_ms": 1.2772494937263354, "mean_action_processing_ms": 0.05452055936279009, "mean_env_wait_ms": 1.1960798328058397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3881600, "timers": {"sample_time_ms": 1159.035, "sample_throughput": 6557.177, "learn_time_ms": 300.504, "learn_throughput": 25290.843, "update_time_ms": 2.842}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6871504430268355e-138, "cur_lr": 0.001, "total_loss": 0.06355472840368748, "policy_loss": 0.006398057914339006, "vf_loss": 0.057156672701239586, "vf_explained_var": 0.9787235856056213, "kl": 0.0023981984704732895, "entropy": -7.004963397979736, "entropy_coeff": 0.0}}, "num_steps_sampled": 3881600, "num_steps_trained": 3881600}, "done": false, "episodes_total": 3867, "training_iteration": 514, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-38", "timestamp": 1617635858, "time_this_iter_s": 1.426943063735962, "time_total_s": 852.9879379272461, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 688.2014734745026, "timesteps_since_restore": 0, "iterations_since_restore": 464, "perf": {"cpu_util_percent": 75.7, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.22071910274703, "episode_reward_min": 26.517741186050447, "episode_reward_mean": 60.77161121149011, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.288755112407316, "MDD_min": 16.357948897718746, "MDD_max": 33.8776667285728}, "hist_stats": {"episode_reward": [61.88135356479319, 34.57576227629542, 47.60351020144281, 48.6176076084435, 104.65295086289788, 78.77031365563354, 64.06451778350483, 49.90447169763063, 56.076828633418295, 50.70904020187075, 50.5972528124291, 42.80807231219103, 53.21225136560672, 72.15616934963477, 50.6751439236667, 43.785186141392806, 39.14901979776556, 105.00735110095924, 66.76666238690606, 54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026585686247944, "mean_inference_ms": 1.2772378916690823, "mean_action_processing_ms": 0.05452120104725559, "mean_env_wait_ms": 1.1960798758752247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3889200, "timers": {"sample_time_ms": 1159.743, "sample_throughput": 6553.173, "learn_time_ms": 301.294, "learn_throughput": 25224.504, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3435752215134178e-138, "cur_lr": 0.001, "total_loss": 0.9202695488929749, "policy_loss": 0.0013286455941852182, "vf_loss": 0.9189409613609314, "vf_explained_var": 0.9861149787902832, "kl": 0.001467315771151334, "entropy": -7.107524156570435, "entropy_coeff": 0.0}}, "num_steps_sampled": 3889200, "num_steps_trained": 3889200}, "done": false, "episodes_total": 3886, "training_iteration": 515, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-40", "timestamp": 1617635860, "time_this_iter_s": 1.5555386543273926, "time_total_s": 854.5434765815735, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cb00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 689.75701212883, "timesteps_since_restore": 0, "iterations_since_restore": 465, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.22071910274703, "episode_reward_min": 26.517741186050447, "episode_reward_mean": 60.7716112114901, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.288755112407316, "MDD_min": 16.357948897718746, "MDD_max": 33.8776667285728}, "hist_stats": {"episode_reward": [54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354, 61.88135356479319, 34.57576227629542, 47.60351020144281, 48.6176076084435, 104.65295086289788, 78.77031365563354, 64.06451778350483, 49.90447169763063, 56.076828633418295, 50.70904020187075, 50.5972528124291, 42.80807231219103, 53.21225136560672, 72.15616934963477, 50.6751439236667, 43.785186141392806, 39.14901979776556, 105.00735110095924, 66.76666238690606], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026585686247944, "mean_inference_ms": 1.277237891669082, "mean_action_processing_ms": 0.05452120104725559, "mean_env_wait_ms": 1.1960798758752247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3896800, "timers": {"sample_time_ms": 1159.488, "sample_throughput": 6554.616, "learn_time_ms": 301.668, "learn_throughput": 25193.219, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.717876107567089e-139, "cur_lr": 0.001, "total_loss": 0.041373454965651035, "policy_loss": 0.02147582545876503, "vf_loss": 0.01989763043820858, "vf_explained_var": 0.9886598587036133, "kl": 0.0007081613293848932, "entropy": -7.130634069442749, "entropy_coeff": 0.0}}, "num_steps_sampled": 3896800, "num_steps_trained": 3896800}, "done": false, "episodes_total": 3886, "training_iteration": 516, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-41", "timestamp": 1617635861, "time_this_iter_s": 1.4155244827270508, "time_total_s": 855.9590010643005, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450ca70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 691.172536611557, "timesteps_since_restore": 0, "iterations_since_restore": 466, "perf": {"cpu_util_percent": 71.05, "ram_util_percent": 62.2}, "trial_id": "6c840_00000"}
{"episode_reward_max": 124.22071910274703, "episode_reward_min": 26.517741186050447, "episode_reward_mean": 60.7716112114901, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.288755112407316, "MDD_min": 16.357948897718746, "MDD_max": 33.8776667285728}, "hist_stats": {"episode_reward": [54.9602524990143, 56.512689552129935, 122.47574593456544, 53.3290742184769, 46.81251763673046, 59.98524631325416, 67.83986391276045, 118.46140244734454, 83.54780410431957, 66.69073086368348, 46.87948415218941, 52.9057498371275, 31.10972147215365, 101.78677976409776, 71.95146737923635, 70.899098672762, 100.49738095831484, 46.12015621934079, 100.5671597187349, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354, 61.88135356479319, 34.57576227629542, 47.60351020144281, 48.6176076084435, 104.65295086289788, 78.77031365563354, 64.06451778350483, 49.90447169763063, 56.076828633418295, 50.70904020187075, 50.5972528124291, 42.80807231219103, 53.21225136560672, 72.15616934963477, 50.6751439236667, 43.785186141392806, 39.14901979776556, 105.00735110095924, 66.76666238690606], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20026585686247944, "mean_inference_ms": 1.277237891669082, "mean_action_processing_ms": 0.05452120104725559, "mean_env_wait_ms": 1.1960798758752247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3904400, "timers": {"sample_time_ms": 1162.371, "sample_throughput": 6538.362, "learn_time_ms": 302.701, "learn_throughput": 25107.265, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3589380537835444e-139, "cur_lr": 0.001, "total_loss": 0.2738770693540573, "policy_loss": 0.011221794760785997, "vf_loss": 0.26265527307987213, "vf_explained_var": 0.9934827089309692, "kl": 0.0013834836427122355, "entropy": -7.233802080154419, "entropy_coeff": 0.0}}, "num_steps_sampled": 3904400, "num_steps_trained": 3904400}, "done": false, "episodes_total": 3886, "training_iteration": 517, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-43", "timestamp": 1617635863, "time_this_iter_s": 1.4423949718475342, "time_total_s": 857.4013960361481, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450cef0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 692.6149315834045, "timesteps_since_restore": 0, "iterations_since_restore": 467, "perf": {"cpu_util_percent": 73.4, "ram_util_percent": 62.3}, "trial_id": "6c840_00000"}
{"episode_reward_max": 144.73653686577921, "episode_reward_min": 21.23148824029998, "episode_reward_mean": 58.803198511692045, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.569601510126127, "MDD_min": 16.357948897718746, "MDD_max": 35.8446156304295}, "hist_stats": {"episode_reward": [46.69447930499544, 49.31715244215087, 48.95865127974579, 39.80349734822027, 68.41238017539102, 81.99048769341533, 47.73392526097818, 50.72246996052047, 61.65413011027995, 31.279759020597027, 82.37432419398635, 66.88464562428534, 108.27927129173673, 144.73653686577921, 52.460299826488736, 72.22119786038529, 34.14138517166971, 21.23148824029998, 47.59497400550382, 57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354, 61.88135356479319, 34.57576227629542, 47.60351020144281, 48.6176076084435, 104.65295086289788, 78.77031365563354, 64.06451778350483, 49.90447169763063, 56.076828633418295, 50.70904020187075, 50.5972528124291, 42.80807231219103, 53.21225136560672, 72.15616934963477, 50.6751439236667, 43.785186141392806, 39.14901979776556, 105.00735110095924, 66.76666238690606], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20025664475157176, "mean_inference_ms": 1.2772335361743203, "mean_action_processing_ms": 0.05452250380042027, "mean_env_wait_ms": 1.19609004050206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3912000, "timers": {"sample_time_ms": 1163.123, "sample_throughput": 6534.133, "learn_time_ms": 302.586, "learn_throughput": 25116.806, "update_time_ms": 2.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6794690268917722e-139, "cur_lr": 0.001, "total_loss": 0.7888583242893219, "policy_loss": 0.006585896364413202, "vf_loss": 0.782272458076477, "vf_explained_var": 0.9799059629440308, "kl": 0.0009474546823184937, "entropy": -6.991759777069092, "entropy_coeff": 0.0}}, "num_steps_sampled": 3912000, "num_steps_trained": 3912000}, "done": false, "episodes_total": 3905, "training_iteration": 518, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-44", "timestamp": 1617635864, "time_this_iter_s": 1.5351285934448242, "time_total_s": 858.9365246295929, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 694.1500601768494, "timesteps_since_restore": 0, "iterations_since_restore": 468, "perf": {"cpu_util_percent": 67.39999999999999, "ram_util_percent": 62.29999999999999}, "trial_id": "6c840_00000"}
{"episode_reward_max": 144.73653686577921, "episode_reward_min": 21.23148824029998, "episode_reward_mean": 58.80319851169204, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 25.569601510126127, "MDD_min": 16.357948897718746, "MDD_max": 35.8446156304295}, "hist_stats": {"episode_reward": [57.30099833615927, 63.55246171097656, 63.451613213607885, 124.22071910274703, 29.498254354449845, 64.58643089099827, 51.09479146143078, 90.44782665570018, 68.9258851744615, 60.95039784066539, 54.069644783977694, 26.517741186050447, 31.159013299190846, 36.91447805557082, 51.71046647333888, 32.179511306917334, 75.66711948831711, 48.613275407317325, 73.99691462424249, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354, 61.88135356479319, 34.57576227629542, 47.60351020144281, 48.6176076084435, 104.65295086289788, 78.77031365563354, 64.06451778350483, 49.90447169763063, 56.076828633418295, 50.70904020187075, 50.5972528124291, 42.80807231219103, 53.21225136560672, 72.15616934963477, 50.6751439236667, 43.785186141392806, 39.14901979776556, 105.00735110095924, 66.76666238690606, 46.69447930499544, 49.31715244215087, 48.95865127974579, 39.80349734822027, 68.41238017539102, 81.99048769341533, 47.73392526097818, 50.72246996052047, 61.65413011027995, 31.279759020597027, 82.37432419398635, 66.88464562428534, 108.27927129173673, 144.73653686577921, 52.460299826488736, 72.22119786038529, 34.14138517166971, 21.23148824029998, 47.59497400550382], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002566447515718, "mean_inference_ms": 1.2772335361743203, "mean_action_processing_ms": 0.05452250380042027, "mean_env_wait_ms": 1.19609004050206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3919600, "timers": {"sample_time_ms": 1163.66, "sample_throughput": 6531.117, "learn_time_ms": 303.044, "learn_throughput": 25078.878, "update_time_ms": 2.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.397345134458861e-140, "cur_lr": 0.001, "total_loss": 0.05083342641592026, "policy_loss": 0.0026495278580114245, "vf_loss": 0.04818389378488064, "vf_explained_var": 0.9821021556854248, "kl": 0.0018412669305689633, "entropy": -7.005089521408081, "entropy_coeff": 0.0}}, "num_steps_sampled": 3919600, "num_steps_trained": 3919600}, "done": false, "episodes_total": 3905, "training_iteration": 519, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-46", "timestamp": 1617635866, "time_this_iter_s": 1.4243736267089844, "time_total_s": 860.3608982563019, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f553450c7a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 695.5744338035583, "timesteps_since_restore": 0, "iterations_since_restore": 469, "perf": {"cpu_util_percent": 74.45, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
{"episode_reward_max": 144.73653686577921, "episode_reward_min": 21.23148824029998, "episode_reward_mean": 57.44146979479874, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.21832058680577, "MDD_min": 16.756631210600162, "MDD_max": 37.845748808485546}, "hist_stats": {"episode_reward": [45.862902932922154, 58.95810880869095, 61.858446515492055, 57.153969223283916, 58.295088443935846, 46.92629118126861, 41.90296061823313, 28.20817625923337, 94.88096105880621, 43.097671821774405, 40.81636424673118, 33.048059123617264, 71.41681864925499, 49.9622093658667, 49.072691639178686, 67.66722427639253, 28.791736748615037, 51.215818055821515, 39.54917270767119, 36.59904545946994, 49.20679523277709, 39.50368134693265, 58.62409236570108, 52.613661978886626, 63.30293427709162, 84.64526489322621, 76.16073513013752, 53.15980820901736, 38.033935291903056, 91.61869519884507, 38.14290445921233, 46.44916585585615, 59.205602268649564, 44.79451476482, 98.21147715233334, 51.20156240620032, 67.19647104444057, 72.25838977669417, 30.772270462504174, 95.97470507073724, 42.71915635492698, 65.65459526302726, 85.22588086408373, 58.64203232133377, 91.67960635766514, 45.37950377106607, 66.56856279942596, 70.38393221033822, 33.76044074603615, 67.82199546561935, 49.640531104339765, 61.136270235862995, 59.92527259226217, 72.0430648600673, 52.99843673943923, 38.207847753308066, 58.40140397476263, 45.97065138767077, 67.97293899719031, 34.38218327769993, 41.62038906494608, 40.14737766366354, 61.88135356479319, 34.57576227629542, 47.60351020144281, 48.6176076084435, 104.65295086289788, 78.77031365563354, 64.06451778350483, 49.90447169763063, 56.076828633418295, 50.70904020187075, 50.5972528124291, 42.80807231219103, 53.21225136560672, 72.15616934963477, 50.6751439236667, 43.785186141392806, 39.14901979776556, 105.00735110095924, 66.76666238690606, 46.69447930499544, 49.31715244215087, 48.95865127974579, 39.80349734822027, 68.41238017539102, 81.99048769341533, 47.73392526097818, 50.72246996052047, 61.65413011027995, 31.279759020597027, 82.37432419398635, 66.88464562428534, 108.27927129173673, 144.73653686577921, 52.460299826488736, 72.22119786038529, 34.14138517166971, 21.23148824029998, 47.59497400550382], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002744870549654, "mean_inference_ms": 1.2772362255313074, "mean_action_processing_ms": 0.05452427118206229, "mean_env_wait_ms": 1.1961063548213065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3927200, "timers": {"sample_time_ms": 1161.833, "sample_throughput": 6541.385, "learn_time_ms": 304.223, "learn_throughput": 24981.679, "update_time_ms": 2.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1986725672294305e-140, "cur_lr": 0.001, "total_loss": 0.7586838603019714, "policy_loss": -0.01061732741072774, "vf_loss": 0.7693012058734894, "vf_explained_var": 0.988560140132904, "kl": 0.0010643105488270521, "entropy": -7.120577096939087, "entropy_coeff": 0.0}}, "num_steps_sampled": 3927200, "num_steps_trained": 3927200}, "done": false, "episodes_total": 3924, "training_iteration": 520, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-17-47", "timestamp": 1617635867, "time_this_iter_s": 1.5344171524047852, "time_total_s": 861.8953154087067, "pid": 8986, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f55344b0290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 697.1088509559631, "timesteps_since_restore": 0, "iterations_since_restore": 470, "perf": {"cpu_util_percent": 80.9, "ram_util_percent": 62.1}, "trial_id": "6c840_00000"}
