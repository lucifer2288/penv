{"episode_reward_max": 76.346671807541, "episode_reward_min": 40.33161186713107, "episode_reward_mean": 53.720397877953225, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.201097581484536, "MDD_min": 16.637099509091534, "MDD_max": 40.44279758335485}, "hist_stats": {"episode_reward": [76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12824996645044046, "mean_inference_ms": 0.7516477794516168, "mean_action_processing_ms": 0.03154204459133779, "mean_env_wait_ms": 0.7114650159236566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 665600, "timers": {"sample_time_ms": 2945.908, "sample_throughput": 4345.01, "learn_time_ms": 3404.965, "learn_throughput": 3759.216, "update_time_ms": 1.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.4742786134779453, "policy_loss": -0.029293082617223264, "vf_loss": 0.4853426636755466, "vf_explained_var": 0.9794157147407532, "kl": 0.01822903361171484, "entropy": -4.235543446540833, "entropy_coeff": 0.0}}, "num_steps_sampled": 665600, "num_steps_trained": 665600}, "done": false, "episodes_total": 640, "training_iteration": 52, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-12", "timestamp": 1617651312, "time_this_iter_s": 6.355947732925415, "time_total_s": 393.3343098163605, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.355947732925415, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.05, "ram_util_percent": 55.0}, "trial_id": "036aa_00000"}
{"episode_reward_max": 108.82462194415402, "episode_reward_min": 33.54697376944391, "episode_reward_mean": 56.590060079193826, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.49196415047638, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14219203071899908, "mean_inference_ms": 0.754687207390714, "mean_action_processing_ms": 0.03163753352502882, "mean_env_wait_ms": 0.6976132875390529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 678400, "timers": {"sample_time_ms": 2906.708, "sample_throughput": 4403.608, "learn_time_ms": 3463.644, "learn_throughput": 3695.53, "update_time_ms": 1.778}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 1.828094590306282, "policy_loss": -0.025108177647925913, "vf_loss": 1.830562853217125, "vf_explained_var": 0.954883873462677, "kl": 0.022639909107238055, "entropy": -4.311537728309632, "entropy_coeff": 0.0}}, "num_steps_sampled": 678400, "num_steps_trained": 678400}, "done": false, "episodes_total": 656, "training_iteration": 53, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-19", "timestamp": 1617651319, "time_this_iter_s": 6.396648645401001, "time_total_s": 399.7309584617615, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.752596378326416, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.78888888888889, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 108.82462194415402, "episode_reward_min": 32.64925442076783, "episode_reward_mean": 59.29382523739813, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.703610777808233, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715, 94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14218839972688932, "mean_inference_ms": 0.7634567286976304, "mean_action_processing_ms": 0.03163985044830793, "mean_env_wait_ms": 0.6936438357878865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 691200, "timers": {"sample_time_ms": 2893.659, "sample_throughput": 4423.465, "learn_time_ms": 3507.903, "learn_throughput": 3648.904, "update_time_ms": 1.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 1.1357377833127975, "policy_loss": -0.02680230583064258, "vf_loss": 1.13901520550251, "vf_explained_var": 0.9662803411483765, "kl": 0.015683258306235074, "entropy": -4.2624032688140865, "entropy_coeff": 0.0}}, "num_steps_sampled": 691200, "num_steps_trained": 691200}, "done": false, "episodes_total": 664, "training_iteration": 54, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-25", "timestamp": 1617651325, "time_this_iter_s": 6.470874547958374, "time_total_s": 406.20183300971985, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.22347092628479, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.555555555555557, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 108.82462194415402, "episode_reward_min": 24.75822049496258, "episode_reward_mean": 57.04872675908796, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.238259081166035, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715, 94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14454205938246736, "mean_inference_ms": 0.7692698461349702, "mean_action_processing_ms": 0.03163673286201666, "mean_env_wait_ms": 0.688128400524254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 704000, "timers": {"sample_time_ms": 2859.763, "sample_throughput": 4475.895, "learn_time_ms": 3495.021, "learn_throughput": 3662.353, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 1.2305514311790466, "policy_loss": -0.02795800124295056, "vf_loss": 1.2345012301206588, "vf_explained_var": 0.9677900075912476, "kl": 0.01600547818467021, "entropy": -4.312965421676636, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 680, "training_iteration": 55, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-31", "timestamp": 1617651331, "time_this_iter_s": 6.220908164978027, "time_total_s": 412.4227411746979, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.444379091262817, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.91111111111111, "ram_util_percent": 55.111111111111114}, "trial_id": "036aa_00000"}
{"episode_reward_max": 121.72637316135716, "episode_reward_min": 24.75822049496258, "episode_reward_mean": 58.43656918515966, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.887109072359163, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715, 94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1467231177735427, "mean_inference_ms": 0.7709592568141101, "mean_action_processing_ms": 0.0316375277724157, "mean_env_wait_ms": 0.6847263861418279, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 716800, "timers": {"sample_time_ms": 2837.211, "sample_throughput": 4511.472, "learn_time_ms": 3479.473, "learn_throughput": 3678.718, "update_time_ms": 1.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 2.2549377328157423, "policy_loss": -0.023511517895385622, "vf_loss": 2.2487944626808165, "vf_explained_var": 0.9493445754051208, "kl": 0.01976984436623752, "entropy": -4.421729683876038, "entropy_coeff": 0.0}}, "num_steps_sampled": 716800, "num_steps_trained": 716800}, "done": false, "episodes_total": 696, "training_iteration": 56, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-38", "timestamp": 1617651338, "time_this_iter_s": 6.171622276306152, "time_total_s": 418.594363451004, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.61600136756897, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.955555555555556, "ram_util_percent": 55.111111111111114}, "trial_id": "036aa_00000"}
{"episode_reward_max": 121.72637316135716, "episode_reward_min": 23.292146708821747, "episode_reward_mean": 58.939612953041305, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.742254341782907, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715, 94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14699300362315912, "mean_inference_ms": 0.7712675215560005, "mean_action_processing_ms": 0.031641598051632185, "mean_env_wait_ms": 0.6835510300448733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 729600, "timers": {"sample_time_ms": 2818.158, "sample_throughput": 4541.974, "learn_time_ms": 3476.256, "learn_throughput": 3682.122, "update_time_ms": 1.719}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 1.1686457800865173, "policy_loss": -0.020214863289147615, "vf_loss": 1.1635512399673462, "vf_explained_var": 0.9600925445556641, "kl": 0.016872944561764597, "entropy": -4.257471327781677, "entropy_coeff": 0.0}}, "num_steps_sampled": 729600, "num_steps_trained": 729600}, "done": false, "episodes_total": 704, "training_iteration": 57, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-44", "timestamp": 1617651344, "time_this_iter_s": 6.190410614013672, "time_total_s": 424.7847740650177, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.80641198158264, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.111111111111107, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 121.72637316135716, "episode_reward_min": 23.292146708821747, "episode_reward_mean": 58.742552527291416, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.8488697146916, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715, 94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1478996656809004, "mean_inference_ms": 0.7711360625595538, "mean_action_processing_ms": 0.031643230628985594, "mean_env_wait_ms": 0.6815040493908676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 742400, "timers": {"sample_time_ms": 2807.778, "sample_throughput": 4558.764, "learn_time_ms": 3483.543, "learn_throughput": 3674.42, "update_time_ms": 1.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 1.2097912687063217, "policy_loss": -0.024198941625654696, "vf_loss": 1.2058422327041627, "vf_explained_var": 0.9733264446258545, "kl": 0.018765315795317292, "entropy": -4.345354251861572, "entropy_coeff": 0.0}}, "num_steps_sampled": 742400, "num_steps_trained": 742400}, "done": false, "episodes_total": 720, "training_iteration": 58, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-50", "timestamp": 1617651350, "time_this_iter_s": 6.2803795337677, "time_total_s": 431.0651535987854, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b97a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.08679151535034, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.33333333333333, "ram_util_percent": 55.111111111111114}, "trial_id": "036aa_00000"}
{"episode_reward_max": 121.72637316135716, "episode_reward_min": 23.292146708821747, "episode_reward_mean": 58.23975172637142, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.91724897039752, "MDD_min": 15.483533046769184, "MDD_max": 42.32149822346812}, "hist_stats": {"episode_reward": [56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 76.346671807541, 44.57787656710793, 59.377625695496775, 40.33161186713107, 46.9534339059127, 43.756465170930724, 64.23022476918842, 54.18927324031715, 94.22489344879197, 46.31829808574573, 55.71745067956177, 42.22409437809221, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14801580622909524, "mean_inference_ms": 0.770999301155153, "mean_action_processing_ms": 0.03164691142499056, "mean_env_wait_ms": 0.6807312868616795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 755200, "timers": {"sample_time_ms": 2803.419, "sample_throughput": 4565.854, "learn_time_ms": 3487.271, "learn_throughput": 3670.491, "update_time_ms": 1.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 0.589153998196125, "policy_loss": -0.029387342683039604, "vf_loss": 0.5985264205932617, "vf_explained_var": 0.9827744960784912, "kl": 0.013343279175460339, "entropy": -4.3178324890136714, "entropy_coeff": 0.0}}, "num_steps_sampled": 755200, "num_steps_trained": 755200}, "done": false, "episodes_total": 728, "training_iteration": 59, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-35-57", "timestamp": 1617651357, "time_this_iter_s": 6.292717456817627, "time_total_s": 437.357871055603, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d0b8cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.37950897216797, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.211111111111112, "ram_util_percent": 55.12222222222223}, "trial_id": "036aa_00000"}
{"episode_reward_max": 121.72637316135716, "episode_reward_min": 23.292146708821747, "episode_reward_mean": 61.208112257629054, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.777436092318016, "MDD_min": 14.10249754581515, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 37.80542400085466, 108.82462194415402, 55.62071216141668, 40.56198298739219, 52.59362364080882, 98.17536389575235, 62.421179794595666, 65.48237879909735, 39.838976742058364, 57.853337053536, 37.18894749572425, 33.54697376944391, 62.407021798004436, 52.9599927413173, 52.48919659078556, 96.040491063439, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15009257218368172, "mean_inference_ms": 0.7727123036416104, "mean_action_processing_ms": 0.031650843241257824, "mean_env_wait_ms": 0.6767309473775192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 768000, "timers": {"sample_time_ms": 2803.997, "sample_throughput": 4564.912, "learn_time_ms": 3490.697, "learn_throughput": 3666.89, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 2.6786538940668105, "policy_loss": -0.01622236960567534, "vf_loss": 2.6629258024692537, "vf_explained_var": 0.9484308362007141, "kl": 0.02130030927248299, "entropy": -4.352995023727417, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 744, "training_iteration": 60, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-03", "timestamp": 1617651363, "time_this_iter_s": 6.334223508834839, "time_total_s": 443.69209456443787, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.71373248100281, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.68888888888889, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 121.72637316135716, "episode_reward_min": 23.292146708821747, "episode_reward_mean": 62.83670635385539, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.723500155820705, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 91.6291768202105, 32.64925442076783, 66.58814850358442, 84.47768375797948, 93.96087315528474, 57.55667737980411, 49.09541727508099, 43.040927280489015, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1510581363644502, "mean_inference_ms": 0.7732595191941798, "mean_action_processing_ms": 0.031675179957213896, "mean_env_wait_ms": 0.674001836034646, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 780800, "timers": {"sample_time_ms": 2802.89, "sample_throughput": 4566.716, "learn_time_ms": 3500.903, "learn_throughput": 3656.199, "update_time_ms": 1.7}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 2.209036637544632, "policy_loss": -0.013693439532071352, "vf_loss": 2.1829239141941073, "vf_explained_var": 0.9561472535133362, "kl": 0.017691626865416765, "entropy": -4.455658559799194, "entropy_coeff": 0.0}}, "num_steps_sampled": 780800, "num_steps_trained": 780800}, "done": false, "episodes_total": 760, "training_iteration": 61, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-09", "timestamp": 1617651369, "time_this_iter_s": 6.393618583679199, "time_total_s": 450.08571314811707, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089452c4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 63.10735106468201, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.188888888888886, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 126.23263613412445, "episode_reward_min": 23.292146708821747, "episode_reward_mean": 63.38730025973371, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.011088251826767, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 24.75822049496258, 32.49609447483662, 66.46108877694427, 37.46226541125192, 56.691755035564874, 46.53965105625421, 55.96075427308469, 37.08350561236999, 100.72496885003324, 50.68693378280482, 35.81093464620725, 52.60640933450843, 41.11408942891294, 68.88307841595368, 65.89923523345512, 55.24357653017543, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1514742598510136, "mean_inference_ms": 0.7717281973680364, "mean_action_processing_ms": 0.031666301088942334, "mean_env_wait_ms": 0.6734710350611632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 793600, "timers": {"sample_time_ms": 2782.324, "sample_throughput": 4600.47, "learn_time_ms": 3512.046, "learn_throughput": 3644.599, "update_time_ms": 1.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.316581043303013, "policy_loss": -0.01575317093171179, "vf_loss": 1.2988254165649413, "vf_explained_var": 0.9641459584236145, "kl": 0.014892796594649553, "entropy": -4.3004461145401, "entropy_coeff": 0.0}}, "num_steps_sampled": 793600, "num_steps_trained": 793600}, "done": false, "episodes_total": 768, "training_iteration": 62, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-16", "timestamp": 1617651376, "time_this_iter_s": 6.263540983200073, "time_total_s": 456.34925413131714, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 69.37089204788208, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.433333333333334, "ram_util_percent": 55.17777777777778}, "trial_id": "036aa_00000"}
{"episode_reward_max": 126.23263613412445, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 64.45876985229394, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.343533174504824, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 95.9387991153416, 82.41960516433818, 61.124845472213124, 38.34690709371341, 121.72637316135716, 49.401616183965366, 60.71178663149326, 25.450546442448655, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15184622102879422, "mean_inference_ms": 0.7695173653112366, "mean_action_processing_ms": 0.031685911224702, "mean_env_wait_ms": 0.6726591638410194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 806400, "timers": {"sample_time_ms": 2775.59, "sample_throughput": 4611.632, "learn_time_ms": 3499.392, "learn_throughput": 3657.778, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.7101188009977342, "policy_loss": -0.01930725560989231, "vf_loss": 1.6996547389030456, "vf_explained_var": 0.9684115648269653, "kl": 0.013231696346774697, "entropy": -4.379404921531677, "entropy_coeff": 0.0}}, "num_steps_sampled": 806400, "num_steps_trained": 806400}, "done": false, "episodes_total": 784, "training_iteration": 63, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-22", "timestamp": 1617651382, "time_this_iter_s": 6.203967571258545, "time_total_s": 462.5532217025757, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089452c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 75.57485961914062, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.9, "ram_util_percent": 55.15555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 126.23263613412445, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 64.4192194006736, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.142187631866932, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 73.62705704262305, 59.59415364946407, 73.64416188539177, 28.475711963149543, 23.292146708821747, 87.50465056975509, 55.78277452477107, 36.10263814270319, 90.0811239286068, 70.25931750576845, 54.0974883297686, 86.59156505856112, 66.85811016032571, 47.354943975931945, 76.85608057595923, 60.38883610108324, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15170051979025456, "mean_inference_ms": 0.7686226415634546, "mean_action_processing_ms": 0.03170845850405086, "mean_env_wait_ms": 0.6724176961375771, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 819200, "timers": {"sample_time_ms": 2767.787, "sample_throughput": 4624.634, "learn_time_ms": 3493.268, "learn_throughput": 3664.191, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.2449464428424835, "policy_loss": -0.019384863339364528, "vf_loss": 1.237407592535019, "vf_explained_var": 0.9716687202453613, "kl": 0.011966098751872777, "entropy": -4.342742571830749, "entropy_coeff": 0.0}}, "num_steps_sampled": 819200, "num_steps_trained": 819200}, "done": false, "episodes_total": 792, "training_iteration": 64, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-28", "timestamp": 1617651388, "time_this_iter_s": 6.331618070602417, "time_total_s": 468.8848397731781, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 81.90647768974304, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.56666666666667, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 126.23263613412445, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 65.94771277360978, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.255744850144808, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 65.79909403408908, 65.4962510786144, 40.123231864142234, 72.19991975697742, 56.472366455052885, 36.36506271607339, 74.85772358277144, 56.80101831873382, 52.238731412900805, 66.02746781160977, 48.29337489628604, 39.5602770421192, 56.14434506504978, 44.95819439998649, 48.36343392215764, 53.0217649183714, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1519281675763155, "mean_inference_ms": 0.767610435626047, "mean_action_processing_ms": 0.031727114971277386, "mean_env_wait_ms": 0.672271579674866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 832000, "timers": {"sample_time_ms": 2780.899, "sample_throughput": 4602.827, "learn_time_ms": 3500.748, "learn_throughput": 3656.361, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 2.104969354867935, "policy_loss": -0.012754831770434976, "vf_loss": 2.0827028274536135, "vf_explained_var": 0.9609999656677246, "kl": 0.015565059147775173, "entropy": -4.3768926525115965, "entropy_coeff": 0.0}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 808, "training_iteration": 65, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-35", "timestamp": 1617651395, "time_this_iter_s": 6.4279961585998535, "time_total_s": 475.31283593177795, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089452c4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 88.3344738483429, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 22.200000000000003, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 126.23263613412445, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 65.8789865173377, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.409646212393486, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 71.68960419123584, 34.904605550990304, 40.49327932569724, 72.09631595652219, 67.51162644796871, 106.65977798627132, 77.70891321173036, 67.37551724001099, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15232963347142275, "mean_inference_ms": 0.7670275537576614, "mean_action_processing_ms": 0.031772828609988556, "mean_env_wait_ms": 0.6722825314342508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 844800, "timers": {"sample_time_ms": 2787.295, "sample_throughput": 4592.266, "learn_time_ms": 3495.723, "learn_throughput": 3661.618, "update_time_ms": 1.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.6097541218996048, "policy_loss": -0.017142267813906074, "vf_loss": 1.5947956478595733, "vf_explained_var": 0.9698808789253235, "kl": 0.014266989203169942, "entropy": -4.51825626373291, "entropy_coeff": 0.0}}, "num_steps_sampled": 844800, "num_steps_trained": 844800}, "done": false, "episodes_total": 824, "training_iteration": 66, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-41", "timestamp": 1617651401, "time_this_iter_s": 6.185454368591309, "time_total_s": 481.49829030036926, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 94.5199282169342, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.4, "ram_util_percent": 55.15555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 170.6268588469949, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 66.86351531934233, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.569706172698424, "MDD_min": 13.550748039303018, "MDD_max": 46.67990717553105}, "hist_stats": {"episode_reward": [67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 41.743282030311796, 47.73365626496692, 89.84738264295676, 56.62363024779918, 107.05023701058263, 94.34357954446293, 83.58809617642163, 65.78534361315974, 89.47828154884922, 95.21106746467215, 34.66769351613044, 72.71489470077081, 79.65187857404801, 75.48504292661647, 100.59364226760252, 91.32530301165367, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246738608082816, "mean_inference_ms": 0.7667374212645583, "mean_action_processing_ms": 0.031770037387132195, "mean_env_wait_ms": 0.672343758090483, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 857600, "timers": {"sample_time_ms": 2787.683, "sample_throughput": 4591.626, "learn_time_ms": 3497.097, "learn_throughput": 3660.178, "update_time_ms": 1.741}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 2.0286949667334557, "policy_loss": -0.01223838061094284, "vf_loss": 2.00144260764122, "vf_explained_var": 0.9550217986106873, "kl": 0.017551433546468615, "entropy": -4.336774458885193, "entropy_coeff": 0.0}}, "num_steps_sampled": 857600, "num_steps_trained": 857600}, "done": false, "episodes_total": 832, "training_iteration": 67, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-47", "timestamp": 1617651407, "time_this_iter_s": 6.20854926109314, "time_total_s": 487.7068395614624, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089452c5f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 100.72847747802734, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.4, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 170.6268588469949, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 67.21857053691951, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.532195988354406, "MDD_min": 13.550748039303018, "MDD_max": 45.81867092254468}, "hist_stats": {"episode_reward": [49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 42.96809718203484, 75.61663604029441, 74.43251642082927, 45.951998416630055, 37.88439646026274, 99.01892985071473, 69.8591708443848, 46.68196439343385, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526965850315266, "mean_inference_ms": 0.766312408434103, "mean_action_processing_ms": 0.03178990617783674, "mean_env_wait_ms": 0.6723435065222081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 870400, "timers": {"sample_time_ms": 2791.563, "sample_throughput": 4585.245, "learn_time_ms": 3499.275, "learn_throughput": 3657.901, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 3.026290930509567, "policy_loss": -0.011881676372140645, "vf_loss": 3.000448831319809, "vf_explained_var": 0.9569975137710571, "kl": 0.01676611223258078, "entropy": -4.427986636161804, "entropy_coeff": 0.0}}, "num_steps_sampled": 870400, "num_steps_trained": 870400}, "done": false, "episodes_total": 848, "training_iteration": 68, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-36-53", "timestamp": 1617651413, "time_this_iter_s": 6.340952157974243, "time_total_s": 494.04779171943665, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 107.06942963600159, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.655555555555555, "ram_util_percent": 55.166666666666664}, "trial_id": "036aa_00000"}
{"episode_reward_max": 170.6268588469949, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 67.68162220759562, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.60822989707635, "MDD_min": 15.43442371546803, "MDD_max": 45.81867092254468}, "hist_stats": {"episode_reward": [63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 50.35597582921937, 110.62702875641463, 72.23778323616483, 43.979269890712025, 97.86082249126332, 69.84730318025967, 126.23263613412445, 63.505436443057704, 82.18480945591487, 48.60616697379436, 41.58651377953845, 44.233860723079275, 43.62269717556039, 82.72001670521286, 100.23065217828304, 46.46615903591901, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260236692530613, "mean_inference_ms": 0.765989143385059, "mean_action_processing_ms": 0.031806235684361965, "mean_env_wait_ms": 0.6722905340863283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 883200, "timers": {"sample_time_ms": 2793.04, "sample_throughput": 4582.821, "learn_time_ms": 3500.735, "learn_throughput": 3656.375, "update_time_ms": 1.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.0217177137732505, "policy_loss": -0.018129051316063852, "vf_loss": 1.0111432066559791, "vf_explained_var": 0.9801594018936157, "kl": 0.012757142037153245, "entropy": -4.357610449790955, "entropy_coeff": 0.0}}, "num_steps_sampled": 883200, "num_steps_trained": 883200}, "done": false, "episodes_total": 856, "training_iteration": 69, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-00", "timestamp": 1617651420, "time_this_iter_s": 6.322806119918823, "time_total_s": 500.37059783935547, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a37a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 113.39223575592041, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 21.88888888888889, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 170.6268588469949, "episode_reward_min": 21.737452715873182, "episode_reward_mean": 68.55826841958857, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.00907580367493, "MDD_min": 15.43442371546803, "MDD_max": 45.81867092254468}, "hist_stats": {"episode_reward": [65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 61.830214277821206, 55.58942649304975, 68.41848430577798, 21.737452715873182, 74.16398770075052, 55.5456467284295, 44.412783359617976, 27.904143195406945, 66.48399552222051, 68.716628047113, 47.88160565448823, 69.84562751781966, 68.46679409187651, 58.84192994105183, 103.16052153114758, 56.25935450003315, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527406353199666, "mean_inference_ms": 0.7656932410777695, "mean_action_processing_ms": 0.0318107256190088, "mean_env_wait_ms": 0.6722934336850293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 896000, "timers": {"sample_time_ms": 2797.28, "sample_throughput": 4575.874, "learn_time_ms": 3505.069, "learn_throughput": 3651.854, "update_time_ms": 1.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 3.911034778356552, "policy_loss": -0.006749360649846495, "vf_loss": 3.8755528104305266, "vf_explained_var": 0.9377782940864563, "kl": 0.01876947202719748, "entropy": -4.379247908592224, "entropy_coeff": 0.0}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 872, "training_iteration": 70, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-06", "timestamp": 1617651426, "time_this_iter_s": 6.419840097427368, "time_total_s": 506.79043793678284, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 119.81207585334778, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.18888888888889, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 24.800458642633412, "episode_reward_mean": 69.84824997302847, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.735477978129378, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 68.63521408536872, 33.107614536046086, 70.53049873650406, 72.16350668080823, 97.17235020037792, 61.81707773761774, 82.17004945009614, 92.70422862776458, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15301218500769098, "mean_inference_ms": 0.7653801821588948, "mean_action_processing_ms": 0.031832370382192804, "mean_env_wait_ms": 0.6721758504985226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 908800, "timers": {"sample_time_ms": 2798.22, "sample_throughput": 4574.336, "learn_time_ms": 3494.403, "learn_throughput": 3663.001, "update_time_ms": 1.733}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 4.3120285308361055, "policy_loss": -0.009687247360125184, "vf_loss": 4.284175816774368, "vf_explained_var": 0.9370752573013306, "kl": 0.016684442395344376, "entropy": -4.5533992958068845, "entropy_coeff": 0.0}}, "num_steps_sampled": 908800, "num_steps_trained": 908800}, "done": false, "episodes_total": 888, "training_iteration": 71, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-12", "timestamp": 1617651432, "time_this_iter_s": 6.295271873474121, "time_total_s": 513.085709810257, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d0b8cb0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 126.1073477268219, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.11111111111111, "ram_util_percent": 55.166666666666664}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 24.800458642633412, "episode_reward_mean": 68.70341173254586, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.983352218892218, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 95.03707004650336, 69.55324375465321, 53.13906926310845, 43.47488480776737, 95.51306151083506, 71.58913951892573, 31.396970165179233, 85.29821539424864, 44.328235128624314, 90.26413300933177, 46.72167332221791, 83.18069547905222, 64.41300121047686, 69.81773617019957, 44.33759442065163, 49.50718939756207, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309685584982927, "mean_inference_ms": 0.765233890766725, "mean_action_processing_ms": 0.031823078181683166, "mean_env_wait_ms": 0.6722463653942219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 921600, "timers": {"sample_time_ms": 2801.653, "sample_throughput": 4568.732, "learn_time_ms": 3491.269, "learn_throughput": 3666.289, "update_time_ms": 1.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 0.6345182424783706, "policy_loss": -0.022471393905580044, "vf_loss": 0.6387552981078625, "vf_explained_var": 0.9843878746032715, "kl": 0.008104147920385003, "entropy": -4.417612257003785, "entropy_coeff": 0.0}}, "num_steps_sampled": 921600, "num_steps_trained": 921600}, "done": false, "episodes_total": 896, "training_iteration": 72, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-19", "timestamp": 1617651439, "time_this_iter_s": 6.26663064956665, "time_total_s": 519.3523404598236, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 132.37397837638855, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 22.700000000000003, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 24.800458642633412, "episode_reward_mean": 69.17251745978776, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.24781905969823, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 48.790867627498535, 50.27367317830337, 51.403689142973604, 85.02284113328083, 31.359482193352903, 87.62587850683441, 24.800458642633412, 31.618365865213498, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533514842121172, "mean_inference_ms": 0.7655098248114705, "mean_action_processing_ms": 0.03185791612573651, "mean_env_wait_ms": 0.6727514201847202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 934400, "timers": {"sample_time_ms": 2847.098, "sample_throughput": 4495.806, "learn_time_ms": 3508.567, "learn_throughput": 3648.213, "update_time_ms": 1.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 2.3492198538780213, "policy_loss": -0.01315882199909538, "vf_loss": 2.3327106738090517, "vf_explained_var": 0.9639279246330261, "kl": 0.01318578165024519, "entropy": -4.496245517730713, "entropy_coeff": 0.0}}, "num_steps_sampled": 934400, "num_steps_trained": 934400}, "done": false, "episodes_total": 912, "training_iteration": 73, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-26", "timestamp": 1617651446, "time_this_iter_s": 6.830747604370117, "time_total_s": 526.1830880641937, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 139.20472598075867, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.990000000000002, "ram_util_percent": 55.540000000000006}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 27.093614916957286, "episode_reward_mean": 72.81051234422313, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.948779239274792, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 68.38563974286602, 65.168895743398, 70.23070375552471, 27.093614916957286, 67.44843102437027, 75.55623920721689, 49.37865271570406, 170.6268588469949, 50.9796413864745, 85.39380197082473, 89.11414961135827, 48.39474534794628, 49.27296141085801, 80.52710301149818, 66.6950426258924, 65.20366888668278, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15335372204757938, "mean_inference_ms": 0.7657044844603732, "mean_action_processing_ms": 0.031888787608035284, "mean_env_wait_ms": 0.6731201164233761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 947200, "timers": {"sample_time_ms": 2873.25, "sample_throughput": 4454.886, "learn_time_ms": 3500.833, "learn_throughput": 3656.273, "update_time_ms": 1.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.9682401132583618, "policy_loss": -0.011931715235114097, "vf_loss": 1.9546316784620286, "vf_explained_var": 0.9662306308746338, "kl": 0.011351182139478624, "entropy": -4.431782131195068, "entropy_coeff": 0.0}}, "num_steps_sampled": 947200, "num_steps_trained": 947200}, "done": false, "episodes_total": 920, "training_iteration": 74, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-32", "timestamp": 1617651452, "time_this_iter_s": 6.5158751010894775, "time_total_s": 532.6989631652832, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 145.72060108184814, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 26.38888888888889, "ram_util_percent": 55.56666666666667}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 28.46157563362776, "episode_reward_mean": 72.27199730985679, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.98618214538842, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 134.35954946892946, 79.1861190950756, 124.6428038896558, 64.58381358054574, 76.57392380650543, 53.776724983054216, 80.68502917549468, 66.41990655964976, 46.45878348931847, 117.12706712263014, 78.08839261504866, 77.747643577884, 63.847637003350684, 65.46903539174515, 113.98900557892058, 71.15554396139267, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536137486047347, "mean_inference_ms": 0.7666376073726474, "mean_action_processing_ms": 0.031937122707234734, "mean_env_wait_ms": 0.6741866805040285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 960000, "timers": {"sample_time_ms": 2880.211, "sample_throughput": 4444.119, "learn_time_ms": 3493.304, "learn_throughput": 3664.153, "update_time_ms": 1.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 3.4126417243480685, "policy_loss": -0.009672079524025321, "vf_loss": 3.388185423612595, "vf_explained_var": 0.9490249752998352, "kl": 0.015168167436495423, "entropy": -4.4847695255279545, "entropy_coeff": 0.0}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 936, "training_iteration": 75, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-39", "timestamp": 1617651459, "time_this_iter_s": 6.422136306762695, "time_total_s": 539.1210994720459, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a37a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 152.14273738861084, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.18888888888889, "ram_util_percent": 55.52222222222222}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 28.46157563362776, "episode_reward_mean": 69.86478588135228, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.798877218154033, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 46.26443129825822, 61.75684266769546, 50.67590353568825, 65.56047723914466, 65.65120487119074, 105.97202077801474, 52.48261919719738, 55.14550873208716, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401234220523827, "mean_inference_ms": 0.7676857281440754, "mean_action_processing_ms": 0.032012968870558337, "mean_env_wait_ms": 0.6753393039797814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 972800, "timers": {"sample_time_ms": 2895.532, "sample_throughput": 4420.604, "learn_time_ms": 3508.242, "learn_throughput": 3648.551, "update_time_ms": 1.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 2.566644321680069, "policy_loss": -0.010979517176747323, "vf_loss": 2.545642238855362, "vf_explained_var": 0.9610832929611206, "kl": 0.014214027430862189, "entropy": -4.638104572296142, "entropy_coeff": 0.0}}, "num_steps_sampled": 972800, "num_steps_trained": 972800}, "done": false, "episodes_total": 952, "training_iteration": 76, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-45", "timestamp": 1617651465, "time_this_iter_s": 6.488972425460815, "time_total_s": 545.6100718975067, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 158.63170981407166, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.82, "ram_util_percent": 55.580000000000005}, "trial_id": "036aa_00000"}
{"episode_reward_max": 177.47334853010858, "episode_reward_min": 28.46157563362776, "episode_reward_mean": 70.46425004608373, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.86916853034676, "MDD_min": 12.572348991893197, "MDD_max": 46.345174279720204}, "hist_stats": {"episode_reward": [81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 71.64739454108434, 54.777959384696864, 46.99809367206453, 48.95885193207213, 81.81925537675205, 154.15663693334542, 62.489449890628784, 62.813172377112515, 149.65216280033374, 93.1054241300175, 56.25381357425836, 50.038184996957376, 68.95039671181614, 79.03932680329349, 177.47334853010858, 39.527605106291546, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15418075986196805, "mean_inference_ms": 0.7682711544696791, "mean_action_processing_ms": 0.03203475739363064, "mean_env_wait_ms": 0.6760791255510338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 985600, "timers": {"sample_time_ms": 2903.25, "sample_throughput": 4408.852, "learn_time_ms": 3517.8, "learn_throughput": 3638.638, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.1368954986333848, "policy_loss": -0.01675074835540727, "vf_loss": 1.13325075507164, "vf_explained_var": 0.9737973213195801, "kl": 0.009064664905890822, "entropy": -4.458629279136658, "entropy_coeff": 0.0}}, "num_steps_sampled": 985600, "num_steps_trained": 985600}, "done": false, "episodes_total": 960, "training_iteration": 77, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-52", "timestamp": 1617651472, "time_this_iter_s": 6.380564212799072, "time_total_s": 551.9906361103058, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 165.01227402687073, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.17777777777778, "ram_util_percent": 55.57777777777778}, "trial_id": "036aa_00000"}
{"episode_reward_max": 207.03071083349542, "episode_reward_min": 27.76505626552307, "episode_reward_mean": 70.38846916185453, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.263076691856764, "MDD_min": 13.40892586140557, "MDD_max": 45.46103197224204}, "hist_stats": {"episode_reward": [79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 68.47907320417252, 53.69873526816849, 49.67778606736561, 47.66857871412448, 91.2382749186075, 41.24905618488463, 46.66651705306592, 82.23912240185608, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15449407351797176, "mean_inference_ms": 0.7693048605383954, "mean_action_processing_ms": 0.03209653845035864, "mean_env_wait_ms": 0.6772647522988677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 998400, "timers": {"sample_time_ms": 2911.051, "sample_throughput": 4397.038, "learn_time_ms": 3502.284, "learn_throughput": 3654.758, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 5.487757577896118, "policy_loss": -0.008614160302095115, "vf_loss": 5.453683239221573, "vf_explained_var": 0.9297645092010498, "kl": 0.018972680186852813, "entropy": -4.536927924156189, "entropy_coeff": 0.0}}, "num_steps_sampled": 998400, "num_steps_trained": 998400}, "done": false, "episodes_total": 976, "training_iteration": 78, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-37-58", "timestamp": 1617651478, "time_this_iter_s": 6.263095378875732, "time_total_s": 558.2537314891815, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 171.27536940574646, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.01111111111111, "ram_util_percent": 55.422222222222224}, "trial_id": "036aa_00000"}
{"episode_reward_max": 207.03071083349542, "episode_reward_min": 27.76505626552307, "episode_reward_mean": 71.5219360802204, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.07696618168992, "MDD_min": 13.40892586140557, "MDD_max": 45.46103197224204}, "hist_stats": {"episode_reward": [71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 62.724211086128626, 68.86412690360902, 60.90545391531663, 39.8551380576584, 84.26529101703886, 82.85105747592418, 35.328772521528364, 33.379913023335845, 56.68917273695714, 59.238373772337454, 71.41669242679252, 40.64744303240829, 79.2583247309593, 48.67832962266924, 59.43979902380946, 61.784588826489085, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545465406795907, "mean_inference_ms": 0.76966912249881, "mean_action_processing_ms": 0.03213064064925927, "mean_env_wait_ms": 0.6777673259307286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1011200, "timers": {"sample_time_ms": 2908.058, "sample_throughput": 4401.563, "learn_time_ms": 3492.829, "learn_throughput": 3664.651, "update_time_ms": 1.619}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 0.9614926032721997, "policy_loss": -0.01265194551087916, "vf_loss": 0.952838536798954, "vf_explained_var": 0.9824050664901733, "kl": 0.009469341430813074, "entropy": -4.492421317100525, "entropy_coeff": 0.0}}, "num_steps_sampled": 1011200, "num_steps_trained": 1011200}, "done": false, "episodes_total": 984, "training_iteration": 79, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-04", "timestamp": 1617651484, "time_this_iter_s": 6.19777774810791, "time_total_s": 564.4515092372894, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a6290>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 177.47314715385437, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 55.3}, "trial_id": "036aa_00000"}
{"episode_reward_max": 207.03071083349542, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 72.48640444037517, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.212836042191135, "MDD_min": 13.40892586140557, "MDD_max": 45.27651904185179}, "hist_stats": {"episode_reward": [58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 62.282340282205304, 77.74584953110207, 69.22188532257043, 89.31034592926919, 35.81208298443704, 61.43257808852285, 124.91613535905397, 92.71788993385817, 66.85725282672509, 38.78730425037521, 57.36079422344134, 58.87698438803807, 102.0858422039599, 88.59992728583698, 77.44770589669197, 72.01970832315644, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1547290312432757, "mean_inference_ms": 0.7706325845254325, "mean_action_processing_ms": 0.032174479757203535, "mean_env_wait_ms": 0.6787894887726145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1024000, "timers": {"sample_time_ms": 2905.808, "sample_throughput": 4404.971, "learn_time_ms": 3476.755, "learn_throughput": 3681.593, "update_time_ms": 1.63}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 3.3264905440807344, "policy_loss": -0.013514520893804728, "vf_loss": 3.311820902824402, "vf_explained_var": 0.9481610059738159, "kl": 0.012526275524869561, "entropy": -4.51479169845581, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 1000, "training_iteration": 80, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-10", "timestamp": 1617651490, "time_this_iter_s": 6.236164569854736, "time_total_s": 570.6876738071442, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 183.7093117237091, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.9125, "ram_util_percent": 55.324999999999996}, "trial_id": "036aa_00000"}
{"episode_reward_max": 207.03071083349542, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 74.44471869785889, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.290870237398618, "MDD_min": 9.500983270692705, "MDD_max": 45.27651904185179}, "hist_stats": {"episode_reward": [123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 103.16073908247927, 133.33912286692046, 107.64790615257398, 90.39379292201014, 125.59117743105173, 28.46157563362776, 61.511241687682464, 114.79632194542441, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1549148040472728, "mean_inference_ms": 0.7707619082817359, "mean_action_processing_ms": 0.032199659510333295, "mean_env_wait_ms": 0.6789574281123997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1036800, "timers": {"sample_time_ms": 2905.273, "sample_throughput": 4405.782, "learn_time_ms": 3471.037, "learn_throughput": 3687.658, "update_time_ms": 1.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 3.4060840892791746, "policy_loss": -0.008925435608252883, "vf_loss": 3.376309263706207, "vf_explained_var": 0.9519422054290771, "kl": 0.01720010315068066, "entropy": -4.676462512016297, "entropy_coeff": 0.0}}, "num_steps_sampled": 1036800, "num_steps_trained": 1036800}, "done": false, "episodes_total": 1016, "training_iteration": 81, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-17", "timestamp": 1617651497, "time_this_iter_s": 6.233596563339233, "time_total_s": 576.9212703704834, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a37a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 189.94290828704834, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 23.01111111111111, "ram_util_percent": 55.35555555555555}, "trial_id": "036aa_00000"}
{"episode_reward_max": 207.03071083349542, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 72.49208678380343, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.20333011578693, "MDD_min": 9.500983270692705, "MDD_max": 45.27651904185179}, "hist_stats": {"episode_reward": [74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 52.596465099882096, 39.54348262213832, 117.28646107364452, 68.90811631716267, 53.846504960249085, 36.177321406271716, 51.64222254648114, 45.209827408015556, 66.97756182079952, 47.739078375520776, 54.17702751407122, 111.15426092590907, 71.19764534741626, 125.8694076103798, 58.08116114392394, 51.265895472203695, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15494670045406694, "mean_inference_ms": 0.7707258905847693, "mean_action_processing_ms": 0.03218819581654584, "mean_env_wait_ms": 0.6790448522521183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1049600, "timers": {"sample_time_ms": 2894.655, "sample_throughput": 4421.944, "learn_time_ms": 3461.246, "learn_throughput": 3698.09, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.069010647535324, "policy_loss": -0.013265808904543519, "vf_loss": 1.0591663625836372, "vf_explained_var": 0.9778169393539429, "kl": 0.010271154073998333, "entropy": -4.4667398691177365, "entropy_coeff": 0.0}}, "num_steps_sampled": 1049600, "num_steps_trained": 1049600}, "done": false, "episodes_total": 1024, "training_iteration": 82, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-23", "timestamp": 1617651503, "time_this_iter_s": 6.063401699066162, "time_total_s": 582.9846720695496, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 196.0063099861145, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 21.900000000000002, "ram_util_percent": 55.4}, "trial_id": "036aa_00000"}
{"episode_reward_max": 207.03071083349542, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 74.14617419855243, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.727047061865555, "MDD_min": 9.500983270692705, "MDD_max": 42.782875163051806}, "hist_stats": {"episode_reward": [39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 48.18898829165138, 93.1962108994769, 103.50688324159762, 54.738338949439424, 92.38127413265116, 30.859519736837907, 59.52867881246089, 54.17832258121189, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15496971221279274, "mean_inference_ms": 0.7703564955452694, "mean_action_processing_ms": 0.03217549223349835, "mean_env_wait_ms": 0.6787565467062768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1062400, "timers": {"sample_time_ms": 2846.203, "sample_throughput": 4497.22, "learn_time_ms": 3456.154, "learn_throughput": 3703.539, "update_time_ms": 1.669}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 4.392362631559372, "policy_loss": -0.004640731234103441, "vf_loss": 4.3555515611171725, "vf_explained_var": 0.9451882243156433, "kl": 0.01842300991527736, "entropy": -4.559714875221252, "entropy_coeff": 0.0}}, "num_steps_sampled": 1062400, "num_steps_trained": 1062400}, "done": false, "episodes_total": 1040, "training_iteration": 83, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-29", "timestamp": 1617651509, "time_this_iter_s": 6.295164585113525, "time_total_s": 589.2798366546631, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894530050>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 202.30147457122803, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 21.62222222222222, "ram_util_percent": 55.333333333333336}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 75.92579359444849, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.016599772541273, "MDD_min": 9.500983270692705, "MDD_max": 46.805164218794054}, "hist_stats": {"episode_reward": [67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 72.14900714587357, 60.97175563895392, 39.8639478060304, 57.41279963864076, 81.81945901127486, 49.384848551047824, 70.1820958376318, 50.57496235526817, 92.63237710519971, 101.98375432014156, 72.10286324603256, 44.775064365826005, 79.83373687808526, 137.61641460380727, 47.85807868388543, 73.38753146992696, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15490760199177359, "mean_inference_ms": 0.7699155298926956, "mean_action_processing_ms": 0.032169664515103794, "mean_env_wait_ms": 0.6784160827713746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1075200, "timers": {"sample_time_ms": 2819.684, "sample_throughput": 4539.515, "learn_time_ms": 3463.917, "learn_throughput": 3695.239, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 4.4554037773609165, "policy_loss": -0.006870530936866999, "vf_loss": 4.429998815059662, "vf_explained_var": 0.9360808730125427, "kl": 0.014344677086919546, "entropy": -4.464516391754151, "entropy_coeff": 0.0}}, "num_steps_sampled": 1075200, "num_steps_trained": 1075200}, "done": false, "episodes_total": 1048, "training_iteration": 84, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-35", "timestamp": 1617651515, "time_this_iter_s": 6.328777074813843, "time_total_s": 595.6086137294769, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 208.63025164604187, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.311111111111114, "ram_util_percent": 55.34444444444444}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 76.38733803889048, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.04663527621306, "MDD_min": 9.500983270692705, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 27.76505626552307, 69.99345348487539, 65.02138985141553, 39.46883141466768, 68.92495740399076, 121.32371851400933, 58.93849617847529, 207.03071083349542, 88.45028211466585, 74.19007018997554, 64.80183528619818, 65.51842516491573, 71.30144401109145, 84.08064018730822, 93.00353613038705, 74.06882456924662, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15483461205550048, "mean_inference_ms": 0.7697060823402033, "mean_action_processing_ms": 0.03215212001771375, "mean_env_wait_ms": 0.6782051213525137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1088000, "timers": {"sample_time_ms": 2803.575, "sample_throughput": 4565.599, "learn_time_ms": 3459.26, "learn_throughput": 3700.213, "update_time_ms": 1.683}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 3.4098206305503846, "policy_loss": -0.009283367209136487, "vf_loss": 3.385689514875412, "vf_explained_var": 0.9567840099334717, "kl": 0.014850878664292395, "entropy": -4.485636520385742, "entropy_coeff": 0.0}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 1064, "training_iteration": 85, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-42", "timestamp": 1617651522, "time_this_iter_s": 6.214455604553223, "time_total_s": 601.8230693340302, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a63b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 214.8447072505951, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.133333333333336, "ram_util_percent": 55.3}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 73.59570748415618, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.06211957915471, "MDD_min": 9.500983270692705, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 91.41509038140893, 69.71771582436143, 48.086447403730155, 62.59013714129841, 58.33630210257268, 62.35083347244724, 41.149223207581066, 54.51322266469367, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15483415595797217, "mean_inference_ms": 0.769183224737724, "mean_action_processing_ms": 0.032143880034905266, "mean_env_wait_ms": 0.6776595489374222, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1100800, "timers": {"sample_time_ms": 2792.77, "sample_throughput": 4583.264, "learn_time_ms": 3461.884, "learn_throughput": 3697.408, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 2.438510237932205, "policy_loss": -0.010285948966629804, "vf_loss": 2.421322882771492, "vf_explained_var": 0.9667816162109375, "kl": 0.012210366632789373, "entropy": -4.610786848068237, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100800, "num_steps_trained": 1100800}, "done": false, "episodes_total": 1080, "training_iteration": 86, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-48", "timestamp": 1617651528, "time_this_iter_s": 6.406149625778198, "time_total_s": 608.2292189598083, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 221.2508568763733, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.011111111111113, "ram_util_percent": 55.266666666666666}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 23.09449842740666, "episode_reward_mean": 74.6509733896669, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.110158688606592, "MDD_min": 9.500983270692705, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 112.57829825586886, 93.81621539285679, 103.73351791357021, 23.09449842740666, 45.60770857632113, 68.21141538238221, 51.95021926483292, 50.863414753729636, 64.92648072328598, 39.65110413723686, 44.471333019770114, 126.51973689388493, 123.5182430509483, 106.90875961050983, 90.70096106311928, 77.8185831883817, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15481798303180105, "mean_inference_ms": 0.7690663662473655, "mean_action_processing_ms": 0.03212735937272563, "mean_env_wait_ms": 0.6776519180732099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1113600, "timers": {"sample_time_ms": 2782.566, "sample_throughput": 4600.07, "learn_time_ms": 3444.958, "learn_throughput": 3715.575, "update_time_ms": 1.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 1.8963536411523818, "policy_loss": -0.009046703865751625, "vf_loss": 1.876908114552498, "vf_explained_var": 0.964436948299408, "kl": 0.012663213089108467, "entropy": -4.421800580024719, "entropy_coeff": 0.0}}, "num_steps_sampled": 1113600, "num_steps_trained": 1113600}, "done": false, "episodes_total": 1088, "training_iteration": 87, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-38-54", "timestamp": 1617651534, "time_this_iter_s": 6.10950779914856, "time_total_s": 614.3387267589569, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 227.36036467552185, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 21.211111111111116, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 26.12301557925277, "episode_reward_mean": 73.1996031007387, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 29.38998339425556, "MDD_min": 16.450212267179495, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 105.10757339456417, 135.6652329570343, 47.67958294386154, 68.41634179003736, 87.5273600651297, 73.168235693127, 127.90385893854159, 48.279663678719636, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15477720288726204, "mean_inference_ms": 0.7686129893012483, "mean_action_processing_ms": 0.03210951285233018, "mean_env_wait_ms": 0.6772443226983802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1126400, "timers": {"sample_time_ms": 2770.289, "sample_throughput": 4620.456, "learn_time_ms": 3456.656, "learn_throughput": 3703.001, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0005387588717195657, "total_loss": 4.865705746412277, "policy_loss": -0.004662623684853315, "vf_loss": 4.82308930516243, "vf_explained_var": 0.9410975575447083, "kl": 0.021012945268303156, "entropy": -4.531413631439209, "entropy_coeff": 0.0}}, "num_steps_sampled": 1126400, "num_steps_trained": 1126400}, "done": false, "episodes_total": 1104, "training_iteration": 88, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-00", "timestamp": 1617651540, "time_this_iter_s": 6.25751519203186, "time_total_s": 620.5962419509888, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a6f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 233.6178798675537, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 21.066666666666666, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 26.12301557925277, "episode_reward_mean": 71.81542722220662, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.03028137106836, "MDD_min": 16.450212267179495, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 97.95407480464554, 61.81464669614829, 49.583907341138165, 69.25902736170923, 74.83090076576399, 67.21271151456997, 73.37475424656604, 46.44910509914072, 74.55034723292013, 68.93516287411613, 110.7693435907793, 53.51636099236875, 39.3307048559405, 103.42165236347306, 51.016690786838126, 127.37679564901092, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15469730447471008, "mean_inference_ms": 0.7681243854073196, "mean_action_processing_ms": 0.03210095071874004, "mean_env_wait_ms": 0.6768419992646227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1139200, "timers": {"sample_time_ms": 2764.124, "sample_throughput": 4630.762, "learn_time_ms": 3465.84, "learn_throughput": 3693.188, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.8848993086814883, "policy_loss": -0.004290208104066551, "vf_loss": 2.8457407104969024, "vf_explained_var": 0.9566956162452698, "kl": 0.012873733341693878, "entropy": -4.443472456932068, "entropy_coeff": 0.0}}, "num_steps_sampled": 1139200, "num_steps_trained": 1139200}, "done": false, "episodes_total": 1112, "training_iteration": 89, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-07", "timestamp": 1617651547, "time_this_iter_s": 6.228919744491577, "time_total_s": 626.8251616954803, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a37a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 239.8467996120453, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.822222222222223, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 67.59626459402975, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.94710490218277, "MDD_min": 16.450212267179495, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 60.139772994008005, 80.93874530540715, 77.16644652357601, 71.15572461440948, 67.41670581799045, 64.88066803227765, 69.84900383074348, 66.42509232942685, 175.46215072346146, 69.0120990429454, 32.860524573152205, 60.62840367630856, 67.1387371742717, 81.782686763472, 44.77260703976874, 112.75763249934124, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545915640845368, "mean_inference_ms": 0.7679188495225031, "mean_action_processing_ms": 0.03208171722999437, "mean_env_wait_ms": 0.6766210654069846, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1152000, "timers": {"sample_time_ms": 2766.259, "sample_throughput": 4627.188, "learn_time_ms": 3465.271, "learn_throughput": 3693.795, "update_time_ms": 1.684}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.331524840593338, "policy_loss": -0.011635065907612444, "vf_loss": 1.317054664492607, "vf_explained_var": 0.9762564897537231, "kl": 0.007734889835119247, "entropy": -4.4685869312286375, "entropy_coeff": 0.0}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 1128, "training_iteration": 90, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-13", "timestamp": 1617651553, "time_this_iter_s": 6.251909971237183, "time_total_s": 633.0770716667175, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 246.09870958328247, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.988888888888887, "ram_util_percent": 55.211111111111116}, "trial_id": "036aa_00000"}
{"episode_reward_max": 209.36793153442358, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 63.096487119905284, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.459155677672424, "MDD_min": 16.450212267179495, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 209.36793153442358, 66.15373386317059, 88.6510204458639, 43.91580691462016, 68.24560193000565, 92.92923591601055, 127.83685393852755, 69.69436037771187, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15458355871688642, "mean_inference_ms": 0.7674490754963963, "mean_action_processing_ms": 0.03207529477681896, "mean_env_wait_ms": 0.6761162646144854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1164800, "timers": {"sample_time_ms": 2763.865, "sample_throughput": 4631.196, "learn_time_ms": 3462.903, "learn_throughput": 3696.321, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.6540752571821213, "policy_loss": -0.016267218925058842, "vf_loss": 1.6415925657749175, "vf_explained_var": 0.969373881816864, "kl": 0.008518497101031244, "entropy": -4.622231259346008, "entropy_coeff": 0.0}}, "num_steps_sampled": 1164800, "num_steps_trained": 1164800}, "done": false, "episodes_total": 1144, "training_iteration": 91, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-19", "timestamp": 1617651559, "time_this_iter_s": 6.184857368469238, "time_total_s": 639.2619290351868, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a35f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 252.2835669517517, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.03333333333333, "ram_util_percent": 55.33333333333333}, "trial_id": "036aa_00000"}
{"episode_reward_max": 195.32045898308053, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 59.82530336925916, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.791237369439656, "MDD_min": 12.05421304846766, "MDD_max": 47.85461883363114}, "hist_stats": {"episode_reward": [32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 73.7543578374883, 83.07249570817818, 49.90062089099345, 97.16285250057358, 50.2228637915238, 58.12565078684279, 37.729775390478174, 81.83756725798942, 37.22668392108182, 114.62154702057529, 42.80160215589707, 93.54107167794747, 48.94527714783923, 37.774966557270126, 47.683464760685254, 51.29223801316096, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15455595524702542, "mean_inference_ms": 0.7672970151463148, "mean_action_processing_ms": 0.032056621345422615, "mean_env_wait_ms": 0.6760637143955947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1177600, "timers": {"sample_time_ms": 2763.528, "sample_throughput": 4631.761, "learn_time_ms": 3474.547, "learn_throughput": 3683.934, "update_time_ms": 1.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.939561268389225, "policy_loss": -0.014155240044929088, "vf_loss": 0.9314277704060078, "vf_explained_var": 0.970802366733551, "kl": 0.006604071850888431, "entropy": -4.440030665397644, "entropy_coeff": 0.0}}, "num_steps_sampled": 1177600, "num_steps_trained": 1177600}, "done": false, "episodes_total": 1152, "training_iteration": 92, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-25", "timestamp": 1617651565, "time_this_iter_s": 6.175511837005615, "time_total_s": 645.4374408721924, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a65f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 258.4590787887573, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 22.912499999999998, "ram_util_percent": 55.212500000000006}, "trial_id": "036aa_00000"}
{"episode_reward_max": 195.32045898308053, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 59.48808624285476, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.726095861971004, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 69.48319781839906, 41.27521266150941, 74.49026646582399, 107.32212718175738, 106.15351411449666, 65.41421113254842, 55.742544367603976, 45.06612625088754, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15449905771557806, "mean_inference_ms": 0.766809934847595, "mean_action_processing_ms": 0.032036364857621125, "mean_env_wait_ms": 0.6756140812660951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1190400, "timers": {"sample_time_ms": 2761.093, "sample_throughput": 4635.845, "learn_time_ms": 3471.479, "learn_throughput": 3687.19, "update_time_ms": 1.631}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 4.224864151477814, "policy_loss": -0.00797081895172596, "vf_loss": 4.196609343290329, "vf_explained_var": 0.9236128330230713, "kl": 0.010733520188368857, "entropy": -4.538089489936828, "entropy_coeff": 0.0}}, "num_steps_sampled": 1190400, "num_steps_trained": 1190400}, "done": false, "episodes_total": 1168, "training_iteration": 93, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-32", "timestamp": 1617651572, "time_this_iter_s": 6.241283655166626, "time_total_s": 651.678724527359, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b97a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 264.70036244392395, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 21.6, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 195.32045898308053, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 58.484219929623485, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.226729083064136, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 55.624082534967506, 43.03166912419487, 102.09993202258244, 43.319785973083526, 75.41321286141903, 47.461253377663276, 76.35803134229118, 58.20311425493305, 44.87758956480539, 127.5495160838081, 125.56373890916494, 38.259106355081016, 69.01466956092297, 195.32045898308053, 44.19536352268385, 87.68311853188231, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544257542273504, "mean_inference_ms": 0.7663569956630599, "mean_action_processing_ms": 0.0320287995070355, "mean_env_wait_ms": 0.6752474974812159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1203200, "timers": {"sample_time_ms": 2751.613, "sample_throughput": 4651.818, "learn_time_ms": 3458.96, "learn_throughput": 3700.534, "update_time_ms": 1.622}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.4910385471582412, "policy_loss": -0.011840223651379347, "vf_loss": 1.4752076065540314, "vf_explained_var": 0.965119481086731, "kl": 0.008198865619488061, "entropy": -4.482420883178711, "entropy_coeff": 0.0}}, "num_steps_sampled": 1203200, "num_steps_trained": 1203200}, "done": false, "episodes_total": 1176, "training_iteration": 94, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-38", "timestamp": 1617651578, "time_this_iter_s": 6.108187675476074, "time_total_s": 657.7869122028351, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 270.8085501194, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 21.54444444444444, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 151.2003076517938, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 53.62632886124652, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.9362551619005, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 65.50537403059352, 73.79225219634671, 61.4614940635769, 87.13659941554127, 33.833280796022315, 62.819394388134604, 44.49484185326277, 49.92677919276883, 26.12301557925277, 60.38491250900723, 87.6316631838981, 29.91024295431178, 48.83977700384567, 53.50415417017846, 29.283244133182745, 85.93097299141986, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15432176368737982, "mean_inference_ms": 0.766127503781219, "mean_action_processing_ms": 0.032007728589797835, "mean_env_wait_ms": 0.6749803243062796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1216000, "timers": {"sample_time_ms": 2746.037, "sample_throughput": 4661.264, "learn_time_ms": 3472.913, "learn_throughput": 3685.666, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.2470647031068802, "policy_loss": -0.0153507008170709, "vf_loss": 1.2408424085378646, "vf_explained_var": 0.9685302972793579, "kl": 0.006392003740184009, "entropy": -4.5018030834198, "entropy_coeff": 0.0}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 1192, "training_iteration": 95, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-44", "timestamp": 1617651584, "time_this_iter_s": 6.2988715171813965, "time_total_s": 664.0857837200165, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 277.1074216365814, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.799999999999997, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 151.2003076517938, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 53.042758554266854, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 33.023442871873876, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 80.24085575549543, 151.2003076517938, 53.944939037122765, 52.386010864768224, 34.515043719918616, 31.23860291395775, 72.30022041078911, 25.83974499653508, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15432677677305273, "mean_inference_ms": 0.7656681348689633, "mean_action_processing_ms": 0.03199979311779878, "mean_env_wait_ms": 0.6744649624473078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1228800, "timers": {"sample_time_ms": 2736.755, "sample_throughput": 4677.071, "learn_time_ms": 3461.51, "learn_throughput": 3697.809, "update_time_ms": 1.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.1457856953144074, "policy_loss": -0.014278432866558433, "vf_loss": 2.1265920317173004, "vf_explained_var": 0.9498193264007568, "kl": 0.009917663061060011, "entropy": -4.650221652984619, "entropy_coeff": 0.0}}, "num_steps_sampled": 1228800, "num_steps_trained": 1228800}, "done": false, "episodes_total": 1208, "training_iteration": 96, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-50", "timestamp": 1617651590, "time_this_iter_s": 6.1997175216674805, "time_total_s": 670.285501241684, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 283.3071391582489, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 22.299999999999997, "ram_util_percent": 55.25555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 21.763105484892577, "episode_reward_mean": 53.752497245833744, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.920778435137976, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 68.33461976666395, 41.692185372384806, 39.46939753299088, 57.15865854916009, 21.763105484892577, 37.30346163161363, 45.80875266774837, 51.512970775904435, 58.47603277081116, 25.93356888716119, 75.67254422706598, 60.46101364984328, 69.17085521220659, 35.08117486710076, 39.40253448211459, 62.58761386117944, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543111938315653, "mean_inference_ms": 0.7655655173727303, "mean_action_processing_ms": 0.03198366716321346, "mean_env_wait_ms": 0.6744621001175468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1241600, "timers": {"sample_time_ms": 2738.952, "sample_throughput": 4673.32, "learn_time_ms": 3472.894, "learn_throughput": 3685.687, "update_time_ms": 1.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.3398442173004153, "policy_loss": -0.002157393116503954, "vf_loss": 2.29661242634058, "vf_explained_var": 0.9331228137016296, "kl": 0.013448652578517795, "entropy": -4.4591144895553585, "entropy_coeff": 0.0}}, "num_steps_sampled": 1241600, "num_steps_trained": 1241600}, "done": false, "episodes_total": 1216, "training_iteration": 97, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-39-56", "timestamp": 1617651596, "time_this_iter_s": 6.245164394378662, "time_total_s": 676.5306656360626, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 289.55230355262756, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 20.88888888888889, "ram_util_percent": 55.23333333333333}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 22.80451676330693, "episode_reward_mean": 54.577181066212944, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.0975884601787, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 89.0222698144346, 27.94347681898121, 38.440545820308046, 48.09872980126154, 31.472443746298133, 52.003518217082934, 23.898716025183777, 45.774857706860125, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15428316043540888, "mean_inference_ms": 0.7652209469033744, "mean_action_processing_ms": 0.03196947871481048, "mean_env_wait_ms": 0.6741460429503422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1254400, "timers": {"sample_time_ms": 2745.402, "sample_throughput": 4662.34, "learn_time_ms": 3464.514, "learn_throughput": 3694.602, "update_time_ms": 1.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.7494781798124315, "policy_loss": -0.011311439634300768, "vf_loss": 2.7245499420166017, "vf_explained_var": 0.948596715927124, "kl": 0.010737691912800074, "entropy": -4.561468257904052, "entropy_coeff": 0.0}}, "num_steps_sampled": 1254400, "num_steps_trained": 1254400}, "done": false, "episodes_total": 1232, "training_iteration": 98, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-03", "timestamp": 1617651603, "time_this_iter_s": 6.238313913345337, "time_total_s": 682.768979549408, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a33b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 295.7906174659729, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 22.255555555555553, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 22.80451676330693, "episode_reward_mean": 54.89927200233871, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.930210734607805, "MDD_min": 12.05421304846766, "MDD_max": 47.854305428545544}, "hist_stats": {"episode_reward": [45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 78.63007996459024, 26.22261779921547, 40.94018562666377, 43.71963376463374, 32.40836748796911, 102.48335075822597, 63.27103853590857, 40.710374195857035, 33.10820675666357, 60.157752465395426, 61.89556371100935, 45.641515944692706, 52.349376251187806, 141.37025432113145, 105.68948371642668, 52.76916512508396, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422189327457841, "mean_inference_ms": 0.7647999921375483, "mean_action_processing_ms": 0.0319629740530866, "mean_env_wait_ms": 0.673803528929536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1267200, "timers": {"sample_time_ms": 2744.045, "sample_throughput": 4664.647, "learn_time_ms": 3463.452, "learn_throughput": 3695.734, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.8324645075201988, "policy_loss": -0.01419628130737692, "vf_loss": 0.8254599893093109, "vf_explained_var": 0.9778832197189331, "kl": 0.006281721072737128, "entropy": -4.489494457244873, "entropy_coeff": 0.0}}, "num_steps_sampled": 1267200, "num_steps_trained": 1267200}, "done": false, "episodes_total": 1240, "training_iteration": 99, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-09", "timestamp": 1617651609, "time_this_iter_s": 6.20496678352356, "time_total_s": 688.9739463329315, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 301.99558424949646, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.6, "ram_util_percent": 55.211111111111116}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 22.80451676330693, "episode_reward_mean": 52.73676611119636, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.22199016561608, "MDD_min": 15.964880667822317, "MDD_max": 44.787632169949816}, "hist_stats": {"episode_reward": [25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.72645102274695, 99.11402665104242, 32.54168917038457, 50.91477689391518, 58.4162189686111, 42.197311746274295, 40.20440290094526, 40.65607027661529, 65.2296439992268, 25.326256060571087, 57.22673891202369, 58.23945676189663, 71.8745056401569, 42.8678569083481, 108.74665904998098, 56.28582708213394, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15415336987016778, "mean_inference_ms": 0.7647014227118508, "mean_action_processing_ms": 0.03194757138723356, "mean_env_wait_ms": 0.6736701383521355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1280000, "timers": {"sample_time_ms": 2732.527, "sample_throughput": 4684.309, "learn_time_ms": 3470.415, "learn_throughput": 3688.32, "update_time_ms": 1.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.4714407083392143, "policy_loss": -0.01409547624643892, "vf_loss": 1.4611990553140641, "vf_explained_var": 0.9624846577644348, "kl": 0.007211006321012974, "entropy": -4.541800470352173, "entropy_coeff": 0.0}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 1256, "training_iteration": 100, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-15", "timestamp": 1617651615, "time_this_iter_s": 6.206563949584961, "time_total_s": 695.1805102825165, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 308.2021481990814, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 21.63333333333333, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 50.526504109960776, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.29075278014334, "MDD_min": 15.964880667822317, "MDD_max": 47.6526352301402}, "hist_stats": {"episode_reward": [49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 81.19183306364715, 33.70161907234532, 26.705000442297102, 43.18726741099106, 30.92437540453435, 32.10914674589973, 30.989212819227152, 69.70213105067813, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541747545803874, "mean_inference_ms": 0.7642794843337657, "mean_action_processing_ms": 0.03194195281682015, "mean_env_wait_ms": 0.6731941679580331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1292800, "timers": {"sample_time_ms": 2727.954, "sample_throughput": 4692.161, "learn_time_ms": 3469.158, "learn_throughput": 3689.656, "update_time_ms": 1.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.1589717960357666, "policy_loss": -0.01115854320116341, "vf_loss": 1.1442776811122894, "vf_explained_var": 0.9697936773300171, "kl": 0.0076600437145680185, "entropy": -4.677958946228028, "entropy_coeff": 0.0}}, "num_steps_sampled": 1292800, "num_steps_trained": 1292800}, "done": false, "episodes_total": 1272, "training_iteration": 101, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-21", "timestamp": 1617651621, "time_this_iter_s": 6.12705135345459, "time_total_s": 701.3075616359711, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a54d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 314.329199552536, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.537499999999998, "ram_util_percent": 55.225}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 50.1976012076033, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.28307558087276, "MDD_min": 15.964880667822317, "MDD_max": 47.6526352301402}, "hist_stats": {"episode_reward": [38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 48.28269997322336, 43.21810546489638, 64.3659135075872, 51.24795527944255, 40.594820867205804, 59.31681135505595, 53.820294421270965, 59.39911072875844, 29.747860251030552, 30.81456349186194, 59.93287662158246, 43.71965818261185, 28.146180680931035, 74.7625916624231, 41.37183957450338, 48.978586640293784, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15416935880222385, "mean_inference_ms": 0.764222878662052, "mean_action_processing_ms": 0.031928066925749496, "mean_env_wait_ms": 0.673236401908139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1305600, "timers": {"sample_time_ms": 2736.456, "sample_throughput": 4677.583, "learn_time_ms": 3460.286, "learn_throughput": 3699.116, "update_time_ms": 1.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.6200661890208721, "policy_loss": -0.017037535468116403, "vf_loss": 0.6196577024459838, "vf_explained_var": 0.9729267954826355, "kl": 0.005169191698078066, "entropy": -4.494108180999756, "entropy_coeff": 0.0}}, "num_steps_sampled": 1305600, "num_steps_trained": 1305600}, "done": false, "episodes_total": 1280, "training_iteration": 102, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-28", "timestamp": 1617651628, "time_this_iter_s": 6.17229437828064, "time_total_s": 707.4798560142517, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 320.50149393081665, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 21.244444444444447, "ram_util_percent": 55.22222222222222}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 49.61779964516165, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.30124336912766, "MDD_min": 15.964880667822317, "MDD_max": 47.6526352301402}, "hist_stats": {"episode_reward": [60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.033740658729606, 60.46434740775075, 71.473039338829, 47.75416014310191, 22.80451676330693, 31.598316704274836, 86.67389462390055, 47.94780381413291, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15415954975549545, "mean_inference_ms": 0.7639348143922753, "mean_action_processing_ms": 0.03191584484570949, "mean_env_wait_ms": 0.672970919726205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1318400, "timers": {"sample_time_ms": 2739.6, "sample_throughput": 4672.215, "learn_time_ms": 3450.455, "learn_throughput": 3709.655, "update_time_ms": 1.719}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.552863422036171, "policy_loss": -0.014744944013655186, "vf_loss": 1.5376229563355446, "vf_explained_var": 0.9573764801025391, "kl": 0.008884565499611198, "entropy": -4.6066336870193485, "entropy_coeff": 0.0}}, "num_steps_sampled": 1318400, "num_steps_trained": 1318400}, "done": false, "episodes_total": 1296, "training_iteration": 103, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-34", "timestamp": 1617651634, "time_this_iter_s": 6.174301385879517, "time_total_s": 713.6541574001312, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d85de60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 326.67579531669617, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 22.488888888888894, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 158.27411130183336, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 49.804960728758445, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.16963734483053, "MDD_min": 15.964880667822317, "MDD_max": 47.6526352301402}, "hist_stats": {"episode_reward": [26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 61.822486997631394, 96.192605392854, 56.24654406528384, 39.95031329543026, 79.61573576122531, 68.68924954313223, 53.200546669941254, 33.21534519022396, 50.68820745860711, 158.27411130183336, 29.797855434531087, 99.15854314757638, 33.42718580187635, 103.2797053134606, 41.40197560295176, 47.71329353507706, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15411600334171202, "mean_inference_ms": 0.7635218317561262, "mean_action_processing_ms": 0.03190970553806522, "mean_env_wait_ms": 0.6726330131097521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1331200, "timers": {"sample_time_ms": 2743.57, "sample_throughput": 4665.454, "learn_time_ms": 3460.637, "learn_throughput": 3698.741, "update_time_ms": 1.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.0150446698069573, "policy_loss": -0.015194295602850617, "vf_loss": 1.0083989024162292, "vf_explained_var": 0.9636903405189514, "kl": 0.0064711340051144366, "entropy": -4.520121750831604, "entropy_coeff": 0.0}}, "num_steps_sampled": 1331200, "num_steps_trained": 1331200}, "done": false, "episodes_total": 1304, "training_iteration": 104, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-40", "timestamp": 1617651640, "time_this_iter_s": 6.250997066497803, "time_total_s": 719.905154466629, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 332.92679238319397, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 21.688888888888886, "ram_util_percent": 55.15555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 127.37074604045833, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 47.33348818092591, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.5065988976123, "MDD_min": 19.481522525680532, "MDD_max": 47.6526352301402}, "hist_stats": {"episode_reward": [43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 53.52615959722214, 35.7770133853449, 79.59024723239581, 41.81429765097496, 127.37074604045833, 38.512201115370914, 39.92695306475892, 59.36596919783561, 38.06614415814779, 38.873332120399475, 44.14475230947957, 49.506895651006246, 45.91381037014703, 29.821494734998733, 74.75877112465687, 46.393359594735095, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15405467642493664, "mean_inference_ms": 0.7634895220961779, "mean_action_processing_ms": 0.03189604921073826, "mean_env_wait_ms": 0.6725576257928629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1344000, "timers": {"sample_time_ms": 2751.875, "sample_throughput": 4651.374, "learn_time_ms": 3441.514, "learn_throughput": 3719.293, "update_time_ms": 1.73}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.874425557255745, "policy_loss": -0.012555078379809856, "vf_loss": 1.8561708289384842, "vf_explained_var": 0.9419043660163879, "kl": 0.009128833026625215, "entropy": -4.576818222999573, "entropy_coeff": 0.0}}, "num_steps_sampled": 1344000, "num_steps_trained": 1344000}, "done": false, "episodes_total": 1320, "training_iteration": 105, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-46", "timestamp": 1617651646, "time_this_iter_s": 6.1904284954071045, "time_total_s": 726.0955829620361, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a59e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 339.1172208786011, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 21.91111111111111, "ram_util_percent": 55.18888888888889}, "trial_id": "036aa_00000"}
{"episode_reward_max": 110.9639578151262, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 46.52466424223836, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 33.1210161542062, "MDD_min": 19.481522525680532, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 34.20808756781549, 85.62445133813046, 31.5528532002595, 40.59082363224477, 25.645899264571096, 75.14861421391039, 55.10930851221207, 45.27291281034684, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15407561149002305, "mean_inference_ms": 0.7631215037487672, "mean_action_processing_ms": 0.03189205698861066, "mean_env_wait_ms": 0.6721131713609004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1356800, "timers": {"sample_time_ms": 2744.888, "sample_throughput": 4663.214, "learn_time_ms": 3435.871, "learn_throughput": 3725.401, "update_time_ms": 1.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.4924361324310302, "policy_loss": -0.011688201166689395, "vf_loss": 1.4787548851966859, "vf_explained_var": 0.9559735655784607, "kl": 0.007516875583678484, "entropy": -4.6857792043685915, "entropy_coeff": 0.0}}, "num_steps_sampled": 1356800, "num_steps_trained": 1356800}, "done": false, "episodes_total": 1336, "training_iteration": 106, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-52", "timestamp": 1617651652, "time_this_iter_s": 6.073541164398193, "time_total_s": 732.1691241264343, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b97a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 345.19076204299927, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 21.96666666666667, "ram_util_percent": 55.18888888888889}, "trial_id": "036aa_00000"}
{"episode_reward_max": 110.9639578151262, "episode_reward_min": 19.18633798551864, "episode_reward_mean": 46.40563549351334, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.91549892790933, "MDD_min": 15.128274761399062, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 49.336967304113266, 72.18297205991077, 31.58927384707934, 68.77016675105469, 27.2368893686822, 64.2663327084612, 39.62426904079232, 28.310406607542756, 37.36967224108587, 47.7609757599385, 53.375536449141194, 44.116180371575524, 49.391315871443446, 49.29912741933701, 38.277702625253376, 30.791463412203676, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15406197530468504, "mean_inference_ms": 0.7630641137137928, "mean_action_processing_ms": 0.03187739134285305, "mean_env_wait_ms": 0.6721514047455271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1369600, "timers": {"sample_time_ms": 2740.264, "sample_throughput": 4671.082, "learn_time_ms": 3425.469, "learn_throughput": 3736.715, "update_time_ms": 1.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.6861360576748848, "policy_loss": -0.013774029510095716, "vf_loss": 0.6807660104334354, "vf_explained_var": 0.9679398536682129, "kl": 0.005672315356787294, "entropy": -4.5304653310775755, "entropy_coeff": 0.0}}, "num_steps_sampled": 1369600, "num_steps_trained": 1369600}, "done": false, "episodes_total": 1344, "training_iteration": 107, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-40-58", "timestamp": 1617651658, "time_this_iter_s": 6.094567537307739, "time_total_s": 738.2636916637421, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 351.285329580307, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 23.012499999999996, "ram_util_percent": 55.1875}, "trial_id": "036aa_00000"}
{"episode_reward_max": 110.9639578151262, "episode_reward_min": 18.355397535115035, "episode_reward_mean": 45.39902970368115, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.54968085128289, "MDD_min": 15.128274761399062, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 36.1815750396953, 29.524869327768382, 49.88891714557096, 74.52815960147332, 35.52862164615061, 28.5959098740647, 46.17429001494833, 54.20118572598205, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540434911654474, "mean_inference_ms": 0.7628270229091414, "mean_action_processing_ms": 0.03186685099400818, "mean_env_wait_ms": 0.6719174996699526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1382400, "timers": {"sample_time_ms": 2739.199, "sample_throughput": 4672.899, "learn_time_ms": 3418.918, "learn_throughput": 3743.874, "update_time_ms": 1.766}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.8416348624229432, "policy_loss": -0.014794135014526547, "vf_loss": 0.8346501076221466, "vf_explained_var": 0.9736120700836182, "kl": 0.006453001610934734, "entropy": -4.650470657348633, "entropy_coeff": 0.0}}, "num_steps_sampled": 1382400, "num_steps_trained": 1382400}, "done": false, "episodes_total": 1360, "training_iteration": 108, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-05", "timestamp": 1617651665, "time_this_iter_s": 6.1624205112457275, "time_total_s": 744.4261121749878, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a54d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 357.44775009155273, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 21.977777777777778, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 110.9639578151262, "episode_reward_min": 18.355397535115035, "episode_reward_mean": 45.381643460880824, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 33.066882746674075, "MDD_min": 15.128274761399062, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 59.191373885542646, 21.886588913498077, 55.89425343286527, 19.18633798551864, 38.33576680158094, 35.28675568415342, 45.86094549888197, 73.93452918362779, 48.14084448001349, 23.953230488891585, 22.87894441028973, 27.229279226433125, 60.791306221306925, 68.90677039319478, 35.309683824523525, 29.82591546302442, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400575221145565, "mean_inference_ms": 0.7624668025314763, "mean_action_processing_ms": 0.031862840273376235, "mean_env_wait_ms": 0.6716205085469862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1395200, "timers": {"sample_time_ms": 2740.664, "sample_throughput": 4670.401, "learn_time_ms": 3418.151, "learn_throughput": 3744.715, "update_time_ms": 1.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.5716541782021523, "policy_loss": -0.01756646023131907, "vf_loss": 0.5704451631009578, "vf_explained_var": 0.977020800113678, "kl": 0.005563103053718805, "entropy": -4.564758248329163, "entropy_coeff": 0.0}}, "num_steps_sampled": 1395200, "num_steps_trained": 1395200}, "done": false, "episodes_total": 1368, "training_iteration": 109, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-11", "timestamp": 1617651671, "time_this_iter_s": 6.211122751235962, "time_total_s": 750.6372349262238, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a33b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 363.6588728427887, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 21.355555555555558, "ram_util_percent": 55.2}, "trial_id": "036aa_00000"}
{"episode_reward_max": 110.9639578151262, "episode_reward_min": 18.355397535115035, "episode_reward_mean": 46.81906372694399, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 33.215525987656946, "MDD_min": 15.128274761399062, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 110.9639578151262, 27.26126556234725, 23.89570523405012, 44.42186832365275, 37.86562114982268, 48.57294876478575, 23.974408626530966, 64.67990239823338, 42.16830599036388, 43.56371812160776, 35.93014514529187, 21.608189424651815, 26.76028854019749, 24.758856732331655, 34.79318751198973, 40.93527614604153, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393206463910603, "mean_inference_ms": 0.7624944856104432, "mean_action_processing_ms": 0.03185176630548971, "mean_env_wait_ms": 0.6715898151199435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1408000, "timers": {"sample_time_ms": 2742.68, "sample_throughput": 4666.968, "learn_time_ms": 3412.496, "learn_throughput": 3750.92, "update_time_ms": 1.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.720973842740059, "policy_loss": -0.012512559043243528, "vf_loss": 1.7062079048156737, "vf_explained_var": 0.9414778351783752, "kl": 0.008082513883709907, "entropy": -4.5915188884735105, "entropy_coeff": 0.0}}, "num_steps_sampled": 1408000, "num_steps_trained": 1408000}, "done": false, "episodes_total": 1384, "training_iteration": 110, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-17", "timestamp": 1617651677, "time_this_iter_s": 6.170772552490234, "time_total_s": 756.808007478714, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b97a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 369.82964539527893, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 22.311111111111114, "ram_util_percent": 55.24444444444444}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 17.592239053562974, "episode_reward_mean": 48.36243497759737, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.16727353860058, "MDD_min": 15.128274761399062, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 41.1606432218802, 87.14986090528122, 78.3807835550589, 79.52703120092592, 43.46081828987147, 80.98034681944226, 42.50807931162967, 60.866670370644805, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395088152148578, "mean_inference_ms": 0.7622305461310862, "mean_action_processing_ms": 0.0318517377248843, "mean_env_wait_ms": 0.6712353805642883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1420800, "timers": {"sample_time_ms": 2750.436, "sample_throughput": 4653.807, "learn_time_ms": 3414.36, "learn_throughput": 3748.872, "update_time_ms": 1.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.8446690905094147, "policy_loss": -0.01230462994426489, "vf_loss": 1.830304154753685, "vf_explained_var": 0.9439531564712524, "kl": 0.007902091732248664, "entropy": -4.747791075706482, "entropy_coeff": 0.0}}, "num_steps_sampled": 1420800, "num_steps_trained": 1420800}, "done": false, "episodes_total": 1400, "training_iteration": 111, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-23", "timestamp": 1617651683, "time_this_iter_s": 6.223717451095581, "time_total_s": 763.0317249298096, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3f80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 376.0533628463745, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 21.86666666666667, "ram_util_percent": 55.17777777777778}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 46.81986262352112, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.27844053806725, "MDD_min": 15.128274761399062, "MDD_max": 49.966935582407444}, "hist_stats": {"episode_reward": [49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 33.90014631355164, 20.47194673746792, 58.62709997740487, 61.38065728989883, 24.03137389580659, 57.42831995506777, 31.470077917523817, 94.72547367187964, 52.20603660692863, 70.88277497046394, 45.4882199527596, 27.0984076480403, 38.63771530044614, 44.30311026088008, 39.42217794693821, 30.700085307895222, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539364514267886, "mean_inference_ms": 0.7622239859877624, "mean_action_processing_ms": 0.031839240910034566, "mean_env_wait_ms": 0.6713207855212943, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1433600, "timers": {"sample_time_ms": 2751.126, "sample_throughput": 4652.64, "learn_time_ms": 3417.874, "learn_throughput": 3745.018, "update_time_ms": 1.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.7337877507507801, "policy_loss": -0.01653677056543529, "vf_loss": 0.7315425707399845, "vf_explained_var": 0.962517499923706, "kl": 0.0055650220415554945, "entropy": -4.53752890586853, "entropy_coeff": 0.0}}, "num_steps_sampled": 1433600, "num_steps_trained": 1433600}, "done": false, "episodes_total": 1408, "training_iteration": 112, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-30", "timestamp": 1617651690, "time_this_iter_s": 6.2147297859191895, "time_total_s": 769.2464547157288, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a5d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 382.2680926322937, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 22.000000000000004, "ram_util_percent": 55.13333333333334}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 47.07818390105366, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.160594754228576, "MDD_min": 15.128274761399062, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 32.94467664480318, 49.52910191755259, 99.1464677905738, 34.237568679621944, 64.29627319656701, 21.958093674562058, 61.94422427001003, 20.732484169286572, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15392809912653962, "mean_inference_ms": 0.7620553247472347, "mean_action_processing_ms": 0.031831409033752554, "mean_env_wait_ms": 0.6711472388816404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1446400, "timers": {"sample_time_ms": 2750.888, "sample_throughput": 4653.043, "learn_time_ms": 3426.77, "learn_throughput": 3735.296, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.6512674659490585, "policy_loss": -0.012793018482625484, "vf_loss": 1.6353999251127243, "vf_explained_var": 0.9491301774978638, "kl": 0.00849202027078718, "entropy": -4.646682825088501, "entropy_coeff": 0.0}}, "num_steps_sampled": 1446400, "num_steps_trained": 1446400}, "done": false, "episodes_total": 1424, "training_iteration": 113, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-36", "timestamp": 1617651696, "time_this_iter_s": 6.259861707687378, "time_total_s": 775.5063164234161, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 388.5279543399811, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 21.400000000000002, "ram_util_percent": 55.15555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 48.52314747336466, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.666813646769523, "MDD_min": 15.128274761399062, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 68.95197800781702, 61.2317143281133, 40.303698571072026, 54.140383413037874, 46.16280168563829, 55.12767358323446, 71.60720270403674, 55.86672862176484, 47.988678323004955, 44.85018027836358, 37.63287536268685, 22.013935108258256, 58.82181554683624, 44.487050630239125, 34.87970022159522, 41.24166344510552, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539053025856534, "mean_inference_ms": 0.761740632543143, "mean_action_processing_ms": 0.03182927469703452, "mean_env_wait_ms": 0.6708937482705537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1459200, "timers": {"sample_time_ms": 2747.161, "sample_throughput": 4659.356, "learn_time_ms": 3426.117, "learn_throughput": 3736.008, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.1032540962100028, "policy_loss": -0.012964110858738422, "vf_loss": 1.0964691591262818, "vf_explained_var": 0.9631408452987671, "kl": 0.005851574083790183, "entropy": -4.577101764678955, "entropy_coeff": 0.0}}, "num_steps_sampled": 1459200, "num_steps_trained": 1459200}, "done": false, "episodes_total": 1432, "training_iteration": 114, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-42", "timestamp": 1617651702, "time_this_iter_s": 6.206686019897461, "time_total_s": 781.7130024433136, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d7d4170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 394.73464035987854, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 20.91111111111111, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 47.42859546224523, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.243459663433995, "MDD_min": 18.30273324271955, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 41.85323394043833, 43.63776395926027, 26.36588111727648, 32.58731022862005, 60.21105514166606, 61.03589801504035, 18.355397535115035, 37.658700037765556, 33.87096063710454, 35.02034274445801, 39.46647968979021, 21.545419964086516, 44.06235523623228, 76.55133261164873, 30.24710783467156, 27.495180965374384, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385002310845736, "mean_inference_ms": 0.7618202828851469, "mean_action_processing_ms": 0.031820554710983384, "mean_env_wait_ms": 0.6709118600386031, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1472000, "timers": {"sample_time_ms": 2739.113, "sample_throughput": 4673.046, "learn_time_ms": 3436.686, "learn_throughput": 3724.518, "update_time_ms": 1.746}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.3238161879777908, "policy_loss": -0.015143289263360202, "vf_loss": 1.3186024111509322, "vf_explained_var": 0.958437442779541, "kl": 0.006031721420586109, "entropy": -4.593238463401795, "entropy_coeff": 0.0}}, "num_steps_sampled": 1472000, "num_steps_trained": 1472000}, "done": false, "episodes_total": 1448, "training_iteration": 115, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-48", "timestamp": 1617651708, "time_this_iter_s": 6.216343641281128, "time_total_s": 787.9293460845947, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3830>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 400.95098400115967, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.787499999999998, "ram_util_percent": 55.1125}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 48.96681210942109, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.9793918706779, "MDD_min": 18.30273324271955, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 53.9933764601723, 44.41781807455662, 28.603629683521607, 47.51410322944377, 39.264038743104834, 50.88173363546871, 41.594303737573355, 43.14287679755672, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538783863809911, "mean_inference_ms": 0.7616019081136086, "mean_action_processing_ms": 0.03182264103739803, "mean_env_wait_ms": 0.6706086463224465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1484800, "timers": {"sample_time_ms": 2750.082, "sample_throughput": 4654.407, "learn_time_ms": 3436.542, "learn_throughput": 3724.675, "update_time_ms": 1.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 1.7538356155157089, "policy_loss": -0.00965270054526627, "vf_loss": 1.734238703250885, "vf_explained_var": 0.9504023194313049, "kl": 0.008666548933833838, "entropy": -4.740023307800293, "entropy_coeff": 0.0}}, "num_steps_sampled": 1484800, "num_steps_trained": 1484800}, "done": false, "episodes_total": 1464, "training_iteration": 116, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-41-54", "timestamp": 1617651714, "time_this_iter_s": 6.1806769371032715, "time_total_s": 794.110023021698, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08946345f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 407.13166093826294, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 21.977777777777778, "ram_util_percent": 55.16666666666667}, "trial_id": "036aa_00000"}
{"episode_reward_max": 107.85692318186341, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 48.9914877669271, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.95629682657416, "MDD_min": 18.30273324271955, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 52.57472055635413, 52.77665634660928, 73.25687557063613, 70.90771744392559, 18.496483366806743, 24.66566664530608, 49.500580832449074, 46.508674914005816, 43.62419747310495, 57.17371842182597, 38.1293848330715, 107.85692318186341, 39.344676552345426, 52.40668416088788, 59.79294649212408, 33.9306261023679, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386622257478874, "mean_inference_ms": 0.7616114929789722, "mean_action_processing_ms": 0.03181108127879182, "mean_env_wait_ms": 0.6707088550605672, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1497600, "timers": {"sample_time_ms": 2751.095, "sample_throughput": 4652.692, "learn_time_ms": 3435.04, "learn_throughput": 3726.303, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.66945851624012, "policy_loss": -0.01432091609109193, "vf_loss": 0.6647925899922847, "vf_explained_var": 0.9695042371749878, "kl": 0.005625732382759452, "entropy": -4.572584633827209, "entropy_coeff": 0.0}}, "num_steps_sampled": 1497600, "num_steps_trained": 1497600}, "done": false, "episodes_total": 1472, "training_iteration": 117, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-01", "timestamp": 1617651721, "time_this_iter_s": 6.090821266174316, "time_total_s": 800.2008442878723, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a39e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 413.22248220443726, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 21.811111111111114, "ram_util_percent": 55.17777777777778}, "trial_id": "036aa_00000"}
{"episode_reward_max": 104.80396324974055, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 49.921888817487215, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.840921362322696, "MDD_min": 18.30273324271955, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 88.7524980872728, 51.2441441830705, 17.592239053562974, 84.17671032722447, 47.18552988343533, 69.63467026489701, 73.68725682622983, 28.005867831433974, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538559727178783, "mean_inference_ms": 0.761449187079078, "mean_action_processing_ms": 0.03180395888799191, "mean_env_wait_ms": 0.6705519961554142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1510400, "timers": {"sample_time_ms": 2746.653, "sample_throughput": 4660.217, "learn_time_ms": 3436.543, "learn_throughput": 3724.673, "update_time_ms": 1.659}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.4654943776130676, "policy_loss": -0.010056583480909466, "vf_loss": 2.448315371274948, "vf_explained_var": 0.9403842687606812, "kl": 0.008069790885783731, "entropy": -4.662008299827575, "entropy_coeff": 0.0}}, "num_steps_sampled": 1510400, "num_steps_trained": 1510400}, "done": false, "episodes_total": 1488, "training_iteration": 118, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-07", "timestamp": 1617651727, "time_this_iter_s": 6.132582902908325, "time_total_s": 806.3334271907806, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 419.3550651073456, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 21.98888888888889, "ram_util_percent": 55.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 14.883042517734031, "episode_reward_mean": 50.60683326896297, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.180334655284085, "MDD_min": 18.616796129109638, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 17.91904604406447, 50.88771157457338, 31.907909136137512, 60.0222540327348, 49.292235271016644, 28.77065627869712, 49.89375425907434, 39.79006119693057, 47.116516958194055, 37.56089367384257, 14.883042517734031, 92.46983811162066, 43.3132892645072, 31.13703391345843, 71.16191208276152, 56.04780794524613, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538341893356857, "mean_inference_ms": 0.7611529719795294, "mean_action_processing_ms": 0.0318030446479779, "mean_env_wait_ms": 0.6703245635084811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1523200, "timers": {"sample_time_ms": 2751.326, "sample_throughput": 4652.301, "learn_time_ms": 3434.286, "learn_throughput": 3727.121, "update_time_ms": 1.649}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.1591065841913224, "policy_loss": -0.005494056260213256, "vf_loss": 2.1309812837839126, "vf_explained_var": 0.9381391406059265, "kl": 0.009961295807734132, "entropy": -4.580261807441712, "entropy_coeff": 0.0}}, "num_steps_sampled": 1523200, "num_steps_trained": 1523200}, "done": false, "episodes_total": 1496, "training_iteration": 119, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-13", "timestamp": 1617651733, "time_this_iter_s": 6.235850095748901, "time_total_s": 812.5692772865295, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d85de60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 425.5909152030945, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 21.91111111111111, "ram_util_percent": 55.15555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 17.187815394446748, "episode_reward_mean": 53.28661884865097, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.984438193387664, "MDD_min": 18.616796129109638, "MDD_max": 49.262861374814406}, "hist_stats": {"episode_reward": [63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 26.864535155996126, 34.76203480719435, 41.90396671198721, 24.39071220821997, 94.75481133093544, 43.265311231078606, 81.61373254443728, 35.5602120922083, 31.765849336202642, 63.26642916626966, 46.45255105732003, 30.345562658384804, 62.42956885352281, 61.920818292984094, 73.01438231823651, 55.76153106133761, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378998758370999, "mean_inference_ms": 0.7612947859326679, "mean_action_processing_ms": 0.0317982667422507, "mean_env_wait_ms": 0.6703975540645442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1536000, "timers": {"sample_time_ms": 2767.531, "sample_throughput": 4625.061, "learn_time_ms": 3441.077, "learn_throughput": 3719.766, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.4987313652038576, "policy_loss": -0.007210432663559914, "vf_loss": 2.4738483023643494, "vf_explained_var": 0.9486745595932007, "kl": 0.009509178972803057, "entropy": -4.602397356033325, "entropy_coeff": 0.0}}, "num_steps_sampled": 1536000, "num_steps_trained": 1536000}, "done": false, "episodes_total": 1512, "training_iteration": 120, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-19", "timestamp": 1617651739, "time_this_iter_s": 6.400593996047974, "time_total_s": 818.9698712825775, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 431.99150919914246, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.27777777777778, "ram_util_percent": 55.266666666666666}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 53.49115565818088, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.60071979409194, "MDD_min": 18.616796129109638, "MDD_max": 47.73685597821012}, "hist_stats": {"episode_reward": [15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 75.1259893200128, 63.775091029466225, 53.64957157171469, 83.60829512680266, 31.83759354848778, 19.764611020906393, 73.25969688675052, 67.57598667045205, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538573247244276, "mean_inference_ms": 0.7612951965939871, "mean_action_processing_ms": 0.03181277451014272, "mean_env_wait_ms": 0.6703082653051382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1548800, "timers": {"sample_time_ms": 2802.103, "sample_throughput": 4567.997, "learn_time_ms": 3476.554, "learn_throughput": 3681.806, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 2.4874698519706726, "policy_loss": -0.009692040989175438, "vf_loss": 2.469224427938461, "vf_explained_var": 0.9488958716392517, "kl": 0.008277774970047176, "entropy": -4.722280836105346, "entropy_coeff": 0.0}}, "num_steps_sampled": 1548800, "num_steps_trained": 1548800}, "done": false, "episodes_total": 1528, "training_iteration": 121, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-26", "timestamp": 1617651746, "time_this_iter_s": 6.924386024475098, "time_total_s": 825.8942573070526, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089453d4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 438.91589522361755, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 29.910000000000004, "ram_util_percent": 55.58}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 52.11036726353743, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.771482257404834, "MDD_min": 18.616796129109638, "MDD_max": 47.73685597821012}, "hist_stats": {"episode_reward": [49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 53.978328666667714, 20.13548227674371, 39.34302788908319, 34.47982066085678, 42.329834025642725, 57.80483246133184, 53.7528180762704, 42.864755815215524, 25.623257595715586, 56.24761323711919, 24.826498533813854, 32.02872135380302, 34.638436099243734, 51.529436915158435, 45.20462342062373, 17.646764639224454, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388720517961896, "mean_inference_ms": 0.7615523291362868, "mean_action_processing_ms": 0.03181388865766246, "mean_env_wait_ms": 0.6706577221328712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1561600, "timers": {"sample_time_ms": 2867.272, "sample_throughput": 4464.174, "learn_time_ms": 3490.677, "learn_throughput": 3666.911, "update_time_ms": 1.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0005387588717195657, "total_loss": 0.41617265962064265, "policy_loss": -0.017201806157827376, "vf_loss": 0.41681631676852704, "vf_explained_var": 0.9855924248695374, "kl": 0.004906120414379984, "entropy": -4.562561945915222, "entropy_coeff": 0.0}}, "num_steps_sampled": 1561600, "num_steps_trained": 1561600}, "done": false, "episodes_total": 1536, "training_iteration": 122, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-33", "timestamp": 1617651753, "time_this_iter_s": 7.006708860397339, "time_total_s": 832.90096616745, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 445.9226040840149, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 26.43, "ram_util_percent": 56.17}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 53.718062087618364, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.8150902829497, "MDD_min": 20.185424278445325, "MDD_max": 46.06224863803723}, "hist_stats": {"episode_reward": [41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 36.19549227493061, 33.2543316286181, 26.11226444345551, 69.01629651388654, 47.464330108019695, 54.75677107601617, 65.69478687965236, 101.0595062693852, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397133178535088, "mean_inference_ms": 0.7619473294462918, "mean_action_processing_ms": 0.03183458760412644, "mean_env_wait_ms": 0.6710590826927166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1574400, "timers": {"sample_time_ms": 2879.436, "sample_throughput": 4445.314, "learn_time_ms": 3488.162, "learn_throughput": 3669.554, "update_time_ms": 1.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.4121534949541092, "policy_loss": -0.012886890517547727, "vf_loss": 1.4064263117313385, "vf_explained_var": 0.9722098708152771, "kl": 0.011030559651553631, "entropy": -4.683529911041259, "entropy_coeff": 0.0}}, "num_steps_sampled": 1574400, "num_steps_trained": 1574400}, "done": false, "episodes_total": 1552, "training_iteration": 123, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-40", "timestamp": 1617651760, "time_this_iter_s": 6.357495069503784, "time_total_s": 839.2584612369537, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d7d4170>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 452.2800991535187, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.37777777777778, "ram_util_percent": 56.1}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 52.79410117249007, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 33.116247703124266, "MDD_min": 21.323249982884636, "MDD_max": 46.06224863803723}, "hist_stats": {"episode_reward": [64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 59.35182969969561, 71.99283748042056, 45.67886432945858, 24.18951259834499, 17.187815394446748, 27.390837964796578, 35.01640110811404, 69.22794250045244, 64.28558568834931, 57.79628308653085, 33.440137397396484, 47.53444297191379, 63.860512942648185, 44.35352299230301, 25.16736173741423, 57.77565223437682, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399429360599012, "mean_inference_ms": 0.7618911766114291, "mean_action_processing_ms": 0.03184579384312903, "mean_env_wait_ms": 0.6710750777708206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1587200, "timers": {"sample_time_ms": 2880.121, "sample_throughput": 4444.258, "learn_time_ms": 3489.668, "learn_throughput": 3667.971, "update_time_ms": 1.592}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 0.6029193140566349, "policy_loss": -0.017644229126162828, "vf_loss": 0.6052034026384354, "vf_explained_var": 0.9835785031318665, "kl": 0.009102309592999519, "entropy": -4.616007127761841, "entropy_coeff": 0.0}}, "num_steps_sampled": 1587200, "num_steps_trained": 1587200}, "done": false, "episodes_total": 1560, "training_iteration": 124, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-46", "timestamp": 1617651766, "time_this_iter_s": 6.228297710418701, "time_total_s": 845.4867589473724, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 458.5083968639374, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 21.54444444444444, "ram_util_percent": 56.01111111111111}, "trial_id": "036aa_00000"}
{"episode_reward_max": 152.40500391292022, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 54.89847765205286, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.52330508968571, "MDD_min": 18.362413533403025, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 75.21870761004483, 23.81117477229281, 75.59828339064374, 54.15152622180157, 59.73506492410478, 47.68046969865373, 24.027499249497815, 37.232408908519524, 37.00309514064296, 104.80396324974055, 99.87589280619149, 83.6915020708193, 43.2007955439585, 39.24666590573926, 152.40500391292022, 44.71738491348267, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15403275028511706, "mean_inference_ms": 0.7625068544876519, "mean_action_processing_ms": 0.031864256268343154, "mean_env_wait_ms": 0.6716329005989309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1600000, "timers": {"sample_time_ms": 2882.505, "sample_throughput": 4440.582, "learn_time_ms": 3481.979, "learn_throughput": 3676.07, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.895886665582657, "policy_loss": -0.00883931843098253, "vf_loss": 1.8816534399986267, "vf_explained_var": 0.9502660632133484, "kl": 0.013672604458406568, "entropy": -4.667724585533142, "entropy_coeff": 0.0}}, "num_steps_sampled": 1600000, "num_steps_trained": 1600000}, "done": false, "episodes_total": 1576, "training_iteration": 125, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-52", "timestamp": 1617651772, "time_this_iter_s": 6.1629509925842285, "time_total_s": 851.6497099399567, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089453d9e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 464.6713478565216, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 21.766666666666666, "ram_util_percent": 55.955555555555556}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 54.81280363736928, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.799983723728054, "MDD_min": 18.362413533403025, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 63.34163104164068, 45.88072438441729, 69.19297205236788, 70.78818385017543, 63.50582079465869, 76.92064183261036, 56.043831288859046, 90.3073623556569, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15414219051732736, "mean_inference_ms": 0.7628383481074921, "mean_action_processing_ms": 0.03189365861941096, "mean_env_wait_ms": 0.6718821743714639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1612800, "timers": {"sample_time_ms": 2886.344, "sample_throughput": 4434.676, "learn_time_ms": 3484.645, "learn_throughput": 3673.258, "update_time_ms": 1.533}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 4.365884512662888, "policy_loss": -0.008343073367141187, "vf_loss": 4.347260531187057, "vf_explained_var": 0.9125257134437561, "kl": 0.015980503326281904, "entropy": -4.845776019096374, "entropy_coeff": 0.0}}, "num_steps_sampled": 1612800, "num_steps_trained": 1612800}, "done": false, "episodes_total": 1592, "training_iteration": 126, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-42-58", "timestamp": 1617651778, "time_this_iter_s": 6.246383428573608, "time_total_s": 857.8960933685303, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b97a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 470.9177312850952, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 21.533333333333335, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 15.86886512724448, "episode_reward_mean": 54.099788978605496, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.72512288096377, "MDD_min": 18.30630071784907, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 24.319306010816103, 45.2607444847304, 42.643982220298234, 42.283338181166336, 78.8956833717974, 38.752524114552834, 82.08665420433674, 51.006615589367, 74.22294721109876, 94.28505187103512, 63.42752087812758, 66.19049582028254, 15.86886512724448, 52.58971506260766, 68.29105511275414, 30.177548030840825, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15416946369459786, "mean_inference_ms": 0.7630909757243343, "mean_action_processing_ms": 0.03189421656406568, "mean_env_wait_ms": 0.6722310746342791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1625600, "timers": {"sample_time_ms": 2887.583, "sample_throughput": 4432.773, "learn_time_ms": 3495.05, "learn_throughput": 3662.322, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 0.7127787313610315, "policy_loss": -0.014465754916891456, "vf_loss": 0.7156716412305832, "vf_explained_var": 0.9787949323654175, "kl": 0.006857982305809855, "entropy": -4.707119565010071, "entropy_coeff": 0.0}}, "num_steps_sampled": 1625600, "num_steps_trained": 1625600}, "done": false, "episodes_total": 1600, "training_iteration": 127, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-05", "timestamp": 1617651785, "time_this_iter_s": 6.207090616226196, "time_total_s": 864.1031839847565, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894611440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 477.1248219013214, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.55, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 55.74312371672814, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.074788945389244, "MDD_min": 18.03088873195085, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 60.63621698637318, 37.618840248345236, 77.8019242258525, 100.8215630496136, 76.13952917385535, 48.5791458663279, 27.021601182387744, 31.22484556833122, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542301909009935, "mean_inference_ms": 0.7634278235400564, "mean_action_processing_ms": 0.031911046634033505, "mean_env_wait_ms": 0.6725882209944313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1638400, "timers": {"sample_time_ms": 2906.232, "sample_throughput": 4404.329, "learn_time_ms": 3499.767, "learn_throughput": 3657.386, "update_time_ms": 1.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 3.177600277662277, "policy_loss": -0.005798750903923064, "vf_loss": 3.161519385576248, "vf_explained_var": 0.9474257826805115, "kl": 0.012965701213106513, "entropy": -4.798967790603638, "entropy_coeff": 0.0}}, "num_steps_sampled": 1638400, "num_steps_trained": 1638400}, "done": false, "episodes_total": 1616, "training_iteration": 128, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-11", "timestamp": 1617651791, "time_this_iter_s": 6.3674561977386475, "time_total_s": 870.4706401824951, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089453d4d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 483.49227809906006, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 21.689999999999998, "ram_util_percent": 55.79}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 55.59601154333246, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.878785614254795, "MDD_min": 18.03088873195085, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 52.53007303994644, 88.2538434355556, 29.641148470378273, 31.329775198892342, 49.65211808567798, 52.527931086856796, 47.355870807645005, 35.63882456890557, 33.21932385832449, 41.99200987754954, 33.16518089922179, 36.966736526065844, 41.742469066289125, 85.19442827980971, 49.703020793937746, 35.28564095860367, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542324356308562, "mean_inference_ms": 0.7632830054405713, "mean_action_processing_ms": 0.031917281079645095, "mean_env_wait_ms": 0.672523761443181, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1651200, "timers": {"sample_time_ms": 2906.655, "sample_throughput": 4403.688, "learn_time_ms": 3501.484, "learn_throughput": 3655.593, "update_time_ms": 1.568}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 0.5286180710792542, "policy_loss": -0.017184118605218828, "vf_loss": 0.5321015340089797, "vf_explained_var": 0.9881912469863892, "kl": 0.008118900819681585, "entropy": -4.680742177963257, "entropy_coeff": 0.0}}, "num_steps_sampled": 1651200, "num_steps_trained": 1651200}, "done": false, "episodes_total": 1624, "training_iteration": 129, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-17", "timestamp": 1617651797, "time_this_iter_s": 6.257408380508423, "time_total_s": 876.7280485630035, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a39e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 489.7496864795685, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 21.61111111111111, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 57.02810530503501, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.613584036665426, "MDD_min": 18.03088873195085, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 53.9207407972837, 35.937136643034336, 52.745268740953904, 48.35823029513788, 92.86152779638884, 21.132132774458004, 67.71819755585975, 32.71105282237808, 51.94109230123716, 43.32257957134749, 32.81613351334642, 47.8140821645426, 64.51511575941602, 33.60305501974728, 30.240714886424588, 31.994554845419728, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15419744030599833, "mean_inference_ms": 0.7635488517722936, "mean_action_processing_ms": 0.03191763691353131, "mean_env_wait_ms": 0.6727364957453277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1664000, "timers": {"sample_time_ms": 2898.46, "sample_throughput": 4416.138, "learn_time_ms": 3505.948, "learn_throughput": 3650.939, "update_time_ms": 1.564}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 2.590388933420181, "policy_loss": -0.012535085370764136, "vf_loss": 2.5849248373508456, "vf_explained_var": 0.948808491230011, "kl": 0.010666179871186614, "entropy": -4.739474115371704, "entropy_coeff": 0.0}}, "num_steps_sampled": 1664000, "num_steps_trained": 1664000}, "done": false, "episodes_total": 1640, "training_iteration": 130, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-24", "timestamp": 1617651804, "time_this_iter_s": 6.3638951778411865, "time_total_s": 883.0919437408447, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b97a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 496.11358165740967, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 22.855555555555554, "ram_util_percent": 55.788888888888884}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 58.7344400895575, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.024918881756225, "MDD_min": 17.227822292092046, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 30.796268740065155, 32.768561729925615, 66.37187100413847, 50.867545695995545, 78.76419790481745, 74.03174383263067, 60.81706024181168, 74.58272292185036, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542189021603478, "mean_inference_ms": 0.7633921776100843, "mean_action_processing_ms": 0.03192292638203638, "mean_env_wait_ms": 0.6725030864447811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1676800, "timers": {"sample_time_ms": 2860.614, "sample_throughput": 4474.564, "learn_time_ms": 3467.407, "learn_throughput": 3691.519, "update_time_ms": 2.766}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 2.263640682697296, "policy_loss": -0.010409918162040413, "vf_loss": 2.2524901103973387, "vf_explained_var": 0.959891140460968, "kl": 0.012776572620496154, "entropy": -4.902869157791137, "entropy_coeff": 0.0}}, "num_steps_sampled": 1676800, "num_steps_trained": 1676800}, "done": false, "episodes_total": 1656, "training_iteration": 131, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-30", "timestamp": 1617651810, "time_this_iter_s": 6.1729512214660645, "time_total_s": 889.2648949623108, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 502.28653287887573, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 57.9891929736058, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 30.873792993789625, "MDD_min": 17.227822292092046, "MDD_max": 47.614990893282176}, "hist_stats": {"episode_reward": [27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 35.716180899127565, 78.86542739381161, 39.08879727072246, 51.27577783727062, 33.03314700456631, 33.1122143934728, 46.79541175583238, 87.47484002008727, 44.37532125385755, 53.70437620014296, 61.783599815490746, 101.26636933744996, 60.70427706669639, 41.64447284889785, 37.48933429535626, 111.33598441325566, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542088587837421, "mean_inference_ms": 0.7634448245870761, "mean_action_processing_ms": 0.03191351062750433, "mean_env_wait_ms": 0.6726441218634491, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1689600, "timers": {"sample_time_ms": 2789.439, "sample_throughput": 4588.736, "learn_time_ms": 3449.019, "learn_throughput": 3711.201, "update_time_ms": 2.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 0.8950824996829033, "policy_loss": -0.014598971866071224, "vf_loss": 0.8951848894357681, "vf_explained_var": 0.9733456969261169, "kl": 0.008590561677701771, "entropy": -4.6959003782272335, "entropy_coeff": 0.0}}, "num_steps_sampled": 1689600, "num_steps_trained": 1689600}, "done": false, "episodes_total": 1664, "training_iteration": 132, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-36", "timestamp": 1617651816, "time_this_iter_s": 6.111823320388794, "time_total_s": 895.3767182826996, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089453dd40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 508.3983561992645, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 21.166666666666668, "ram_util_percent": 55.77777777777778}, "trial_id": "036aa_00000"}
{"episode_reward_max": 172.57411642428445, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 58.130081629128846, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.005109804815316, "MDD_min": 17.227822292092046, "MDD_max": 45.75175123852876}, "hist_stats": {"episode_reward": [59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 62.9854099089952, 63.97356111509288, 172.57411642428445, 26.14112128495808, 38.72023354504264, 46.53653733972453, 85.10016050805416, 37.33668987004343, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542059962217645, "mean_inference_ms": 0.7633635337510305, "mean_action_processing_ms": 0.031910453409533204, "mean_env_wait_ms": 0.67256969509339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1702400, "timers": {"sample_time_ms": 2775.514, "sample_throughput": 4611.758, "learn_time_ms": 3448.041, "learn_throughput": 3712.253, "update_time_ms": 2.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.5037696158885956, "policy_loss": -0.007848636382259428, "vf_loss": 1.4910425120592117, "vf_explained_var": 0.9716058373451233, "kl": 0.012193042496219277, "entropy": -4.852240853309631, "entropy_coeff": 0.0}}, "num_steps_sampled": 1702400, "num_steps_trained": 1702400}, "done": false, "episodes_total": 1680, "training_iteration": 133, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-42", "timestamp": 1617651822, "time_this_iter_s": 6.207779407501221, "time_total_s": 901.5844976902008, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 514.6061356067657, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.31111111111111, "ram_util_percent": 55.766666666666666}, "trial_id": "036aa_00000"}
{"episode_reward_max": 118.08572724029341, "episode_reward_min": 18.82820702408234, "episode_reward_mean": 57.3217527448761, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.061650128374552, "MDD_min": 17.227822292092046, "MDD_max": 45.50809876703553}, "hist_stats": {"episode_reward": [37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 94.07773808339095, 18.82820702408234, 38.989115057798344, 57.3950780650228, 88.5044652244165, 39.916121352510835, 59.451181537944365, 70.11743547260285, 53.51076371975671, 50.78690412492517, 47.802836821060126, 54.58999347079053, 58.3320596498546, 118.08572724029341, 66.55706636875988, 63.917811260280615, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541898188992759, "mean_inference_ms": 0.7630648367402277, "mean_action_processing_ms": 0.03190916925137928, "mean_env_wait_ms": 0.6723411727394611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1715200, "timers": {"sample_time_ms": 2773.241, "sample_throughput": 4615.538, "learn_time_ms": 3437.359, "learn_throughput": 3723.789, "update_time_ms": 2.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 0.9045074796676635, "policy_loss": -0.012327935704961419, "vf_loss": 0.9019960102438926, "vf_explained_var": 0.9775940179824829, "kl": 0.008793717748485506, "entropy": -4.76946729183197, "entropy_coeff": 0.0}}, "num_steps_sampled": 1715200, "num_steps_trained": 1715200}, "done": false, "episodes_total": 1688, "training_iteration": 134, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-48", "timestamp": 1617651828, "time_this_iter_s": 6.099254131317139, "time_total_s": 907.683751821518, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d85de60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 520.7053897380829, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 21.56666666666667, "ram_util_percent": 55.711111111111116}, "trial_id": "036aa_00000"}
{"episode_reward_max": 115.02579052574163, "episode_reward_min": 19.12062046686124, "episode_reward_mean": 58.93984277991603, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.330239236103726, "MDD_min": 17.227822292092046, "MDD_max": 46.91715604147312}, "hist_stats": {"episode_reward": [83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 34.569819343099866, 105.43840716916836, 32.76965609672336, 39.99849475637205, 30.379304977968662, 44.96881685017156, 61.738409184535385, 45.15504153095571, 106.86984122762264, 90.38030905050312, 63.048552053104245, 72.42620434390876, 38.0783346361263, 66.4619751735982, 47.10630159120153, 46.37081708151781, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15415373234128457, "mean_inference_ms": 0.7632501752379325, "mean_action_processing_ms": 0.03190636357350781, "mean_env_wait_ms": 0.672461879179243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1728000, "timers": {"sample_time_ms": 2791.577, "sample_throughput": 4585.222, "learn_time_ms": 3441.759, "learn_throughput": 3719.029, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 2.9613625913858415, "policy_loss": -0.010047775423154236, "vf_loss": 2.952079030275345, "vf_explained_var": 0.9439108967781067, "kl": 0.01145560476463288, "entropy": -4.807822027206421, "entropy_coeff": 0.0}}, "num_steps_sampled": 1728000, "num_steps_trained": 1728000}, "done": false, "episodes_total": 1704, "training_iteration": 135, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-43-55", "timestamp": 1617651835, "time_this_iter_s": 6.390298366546631, "time_total_s": 914.0740501880646, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a3d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 527.0956881046295, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 23.63333333333334, "ram_util_percent": 55.833333333333336}, "trial_id": "036aa_00000"}
{"episode_reward_max": 115.02579052574163, "episode_reward_min": 19.12062046686124, "episode_reward_mean": 60.017842800220954, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.974316519528365, "MDD_min": 17.227822292092046, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 58.12917894070291, 60.89966914565998, 60.71603658039331, 67.37013581231754, 57.87971566652231, 69.59310669550808, 37.46513652296777, 78.68265775660254, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417674024016376, "mean_inference_ms": 0.76308012681295, "mean_action_processing_ms": 0.031911313220969205, "mean_env_wait_ms": 0.6722096332052652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1740800, "timers": {"sample_time_ms": 2783.047, "sample_throughput": 4599.276, "learn_time_ms": 3457.949, "learn_throughput": 3701.616, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.9887189710140227, "policy_loss": -0.00540911566466093, "vf_loss": 1.9746694242954255, "vf_explained_var": 0.9639386534690857, "kl": 0.01153107211459428, "entropy": -4.9668221855163575, "entropy_coeff": 0.0}}, "num_steps_sampled": 1740800, "num_steps_trained": 1740800}, "done": false, "episodes_total": 1720, "training_iteration": 136, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-01", "timestamp": 1617651841, "time_this_iter_s": 6.322706937789917, "time_total_s": 920.3967571258545, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 533.4183950424194, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 23.333333333333332, "ram_util_percent": 55.83333333333333}, "trial_id": "036aa_00000"}
{"episode_reward_max": 115.02579052574163, "episode_reward_min": 19.12062046686124, "episode_reward_mean": 59.82600712089372, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.923569071530565, "MDD_min": 17.227822292092046, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 40.27555212398348, 19.12062046686124, 53.0485525650851, 115.02579052574163, 58.579179074059155, 38.661719564323725, 55.31970613209551, 27.47698268094511, 42.2209887832478, 50.216955195365365, 87.1184965798705, 56.72261079073769, 30.039116321571292, 38.3057052386346, 77.01213907561115, 66.32409239547943, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417026078483936, "mean_inference_ms": 0.7631431775844026, "mean_action_processing_ms": 0.03190232735421435, "mean_env_wait_ms": 0.6723567347858154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1753600, "timers": {"sample_time_ms": 2786.518, "sample_throughput": 4593.546, "learn_time_ms": 3451.7, "learn_throughput": 3708.318, "update_time_ms": 2.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.7593219330906869, "policy_loss": -0.009193622055463493, "vf_loss": 1.752327895462513, "vf_explained_var": 0.9556896686553955, "kl": 0.009592688619159162, "entropy": -4.764405980110168, "entropy_coeff": 0.0}}, "num_steps_sampled": 1753600, "num_steps_trained": 1753600}, "done": false, "episodes_total": 1728, "training_iteration": 137, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-07", "timestamp": 1617651847, "time_this_iter_s": 6.17920184135437, "time_total_s": 926.5759589672089, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a33b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 539.5975968837738, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 22.32222222222222, "ram_util_percent": 55.92222222222222}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 25.940155572066097, "episode_reward_mean": 61.63367542376042, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.709605483916402, "MDD_min": 17.227822292092046, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 95.9489959418548, 39.624079667813675, 37.27614822278327, 67.72086086863341, 61.52831232806094, 43.08543091705674, 90.58601097392486, 53.57338549819298, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15416612846493166, "mean_inference_ms": 0.7630756953174186, "mean_action_processing_ms": 0.0318999228205514, "mean_env_wait_ms": 0.6722927395852955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1766400, "timers": {"sample_time_ms": 2772.434, "sample_throughput": 4616.882, "learn_time_ms": 3451.471, "learn_throughput": 3708.564, "update_time_ms": 2.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 3.6026727187633516, "policy_loss": -0.008470149766653777, "vf_loss": 3.588371193408966, "vf_explained_var": 0.9461511373519897, "kl": 0.013494308171793819, "entropy": -4.886210408210754, "entropy_coeff": 0.0}}, "num_steps_sampled": 1766400, "num_steps_trained": 1766400}, "done": false, "episodes_total": 1744, "training_iteration": 138, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-14", "timestamp": 1617651854, "time_this_iter_s": 6.2230141162872314, "time_total_s": 932.7989730834961, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 545.820611000061, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 21.500000000000004, "ram_util_percent": 55.84444444444444}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 25.940155572066097, "episode_reward_mean": 61.78337676601022, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.189472763847775, "MDD_min": 17.308675930542915, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 87.74737710404854, 30.437037855071072, 49.51146704579395, 43.544934484691076, 27.04092004849544, 62.757913627279606, 51.30757510394672, 57.1631028860665, 30.768026953802455, 58.536236355337614, 29.862207583788617, 77.039277917349, 59.33484344599987, 53.78026774432229, 84.25688184901114, 43.84782332167547, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15415155993512722, "mean_inference_ms": 0.7627837572402366, "mean_action_processing_ms": 0.03189890980766318, "mean_env_wait_ms": 0.672073520724432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1779200, "timers": {"sample_time_ms": 2773.863, "sample_throughput": 4614.503, "learn_time_ms": 3442.12, "learn_throughput": 3718.638, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.5241665929555892, "policy_loss": -0.011114862281829119, "vf_loss": 1.5210224068164826, "vf_explained_var": 0.9691278338432312, "kl": 0.00844981512054801, "entropy": -4.820256729125976, "entropy_coeff": 0.0}}, "num_steps_sampled": 1779200, "num_steps_trained": 1779200}, "done": false, "episodes_total": 1752, "training_iteration": 139, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-20", "timestamp": 1617651860, "time_this_iter_s": 6.17814302444458, "time_total_s": 938.9771161079407, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d85de60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 551.9987540245056, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 21.511111111111113, "ram_util_percent": 55.84444444444444}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 25.940155572066097, "episode_reward_mean": 65.69948602922284, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.321199876653374, "MDD_min": 17.308675930542915, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 41.020495511803624, 47.02868999801391, 56.65168542375399, 58.93258038453343, 77.97254180657805, 42.75428260950011, 36.13673730509179, 82.63802543318465, 63.93294323831249, 74.73324329357119, 54.35818637155211, 54.37516962143884, 37.48043603933626, 68.90055203875306, 81.4656103542433, 57.52899696715123, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15411226767527056, "mean_inference_ms": 0.7629703562440979, "mean_action_processing_ms": 0.03189608034175503, "mean_env_wait_ms": 0.6721898918500233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1792000, "timers": {"sample_time_ms": 2767.934, "sample_throughput": 4624.388, "learn_time_ms": 3443.709, "learn_throughput": 3716.922, "update_time_ms": 2.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 3.159719104766846, "policy_loss": -0.002279981872998178, "vf_loss": 3.1350902831554412, "vf_explained_var": 0.9526383876800537, "kl": 0.015945945624262093, "entropy": -4.865691518783569, "entropy_coeff": 0.0}}, "num_steps_sampled": 1792000, "num_steps_trained": 1792000}, "done": false, "episodes_total": 1768, "training_iteration": 140, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-26", "timestamp": 1617651866, "time_this_iter_s": 6.319870471954346, "time_total_s": 945.296986579895, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634e60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 558.31862449646, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 22.37777777777778, "ram_util_percent": 55.82222222222222}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 20.045359343187464, "episode_reward_mean": 64.1603942535659, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.682559520852145, "MDD_min": 17.308675930542915, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 55.44064082716265, 77.86002149682544, 32.91305389328803, 40.94562995416172, 83.15442575614448, 48.7542347630702, 72.20931390964753, 101.51323878015434, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15413156869213204, "mean_inference_ms": 0.762814385388166, "mean_action_processing_ms": 0.031901669212881185, "mean_env_wait_ms": 0.6719569639234783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1804800, "timers": {"sample_time_ms": 2772.351, "sample_throughput": 4617.02, "learn_time_ms": 3448.972, "learn_throughput": 3711.251, "update_time_ms": 1.631}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.4219524383544921, "policy_loss": -0.01041455020196736, "vf_loss": 1.4141772836446762, "vf_explained_var": 0.976776123046875, "kl": 0.010779089867137373, "entropy": -4.99090087890625, "entropy_coeff": 0.0}}, "num_steps_sampled": 1804800, "num_steps_trained": 1804800}, "done": false, "episodes_total": 1784, "training_iteration": 141, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-32", "timestamp": 1617651872, "time_this_iter_s": 6.2572972774505615, "time_total_s": 951.5542838573456, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945304d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 564.5759217739105, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 22.688888888888886, "ram_util_percent": 55.855555555555554}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 20.045359343187464, "episode_reward_mean": 64.4524336897692, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.71417889845489, "MDD_min": 17.308675930542915, "MDD_max": 51.40574783819908}, "hist_stats": {"episode_reward": [53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221, 34.51449546579503, 47.41763423430369, 55.90159432322241, 102.84072612375154, 42.20284194761412, 68.34254159209534, 109.17894415453392, 89.72941660793867, 73.3023859669403, 69.30357580714333, 73.91030410090737, 70.39583444422068, 110.15794031385464, 62.07161305965952, 65.61843767961, 65.3166080836893, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541257201266983, "mean_inference_ms": 0.7628932014888421, "mean_action_processing_ms": 0.03189373605704675, "mean_env_wait_ms": 0.6721190996136411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1817600, "timers": {"sample_time_ms": 2775.66, "sample_throughput": 4611.515, "learn_time_ms": 3451.456, "learn_throughput": 3708.579, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 1.1863812291622162, "policy_loss": -0.0075093740131706, "vf_loss": 1.175005325973034, "vf_explained_var": 0.9725024700164795, "kl": 0.01119128534104675, "entropy": -4.7527691888809205, "entropy_coeff": 0.0}}, "num_steps_sampled": 1817600, "num_steps_trained": 1817600}, "done": false, "episodes_total": 1792, "training_iteration": 142, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-39", "timestamp": 1617651879, "time_this_iter_s": 6.170930624008179, "time_total_s": 957.7252144813538, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9710>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 570.7468523979187, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.525, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 20.045359343187464, "episode_reward_mean": 61.51478023712808, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.88145035017003, "MDD_min": 17.308675930542915, "MDD_max": 45.532842930693526}, "hist_stats": {"episode_reward": [34.31797351625767, 62.69063994229357, 65.85656936618844, 55.101084669899834, 54.31153965381213, 48.59085863147381, 93.76911241398604, 27.265582105944322, 34.32450621286043, 35.52340028361408, 31.281793704560712, 85.38678263383679, 57.22823838444796, 22.542726363634667, 98.62474893605669, 39.623991822301335, 108.6487956838063, 56.274077745525005, 73.88798838803952, 55.227059512001645, 68.31846099149821, 25.940155572066097, 48.06047440211023, 97.10171930213176, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15412626504430085, "mean_inference_ms": 0.7628216482839068, "mean_action_processing_ms": 0.031891859144389946, "mean_env_wait_ms": 0.672050250602223, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1830400, "timers": {"sample_time_ms": 2777.047, "sample_throughput": 4609.212, "learn_time_ms": 3446.478, "learn_throughput": 3713.937, "update_time_ms": 1.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 2.4841517996788025, "policy_loss": -0.01024627543753013, "vf_loss": 2.469609828591347, "vf_explained_var": 0.9628579020500183, "kl": 0.014689327767118811, "entropy": -4.863135161399842, "entropy_coeff": 0.0}}, "num_steps_sampled": 1830400, "num_steps_trained": 1830400}, "done": false, "episodes_total": 1808, "training_iteration": 143, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-45", "timestamp": 1617651885, "time_this_iter_s": 6.171473503112793, "time_total_s": 963.8966879844666, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945a33b0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 576.9183259010315, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.822222222222223, "ram_util_percent": 55.81111111111111}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 20.045359343187464, "episode_reward_mean": 60.38748699561152, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.71856101710311, "MDD_min": 17.308675930542915, "MDD_max": 45.532842930693526}, "hist_stats": {"episode_reward": [78.90963215757516, 59.16666950435249, 25.243752350064447, 58.214150559050026, 49.79556722211586, 60.70966036229574, 37.632466966920944, 51.057508323148646, 47.63608148472974, 60.44121133809607, 51.140161247018405, 37.719502293232274, 91.95054075919244, 41.8591730038094, 37.412062010727595, 26.187220970249626, 72.42103045678725, 90.2211674493706, 70.85585514052337, 40.64501939729269, 52.064024598249034, 68.48093144027733, 50.2328021953862, 62.045877787280475, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221, 34.31797351625767, 62.69063994229357, 65.85656936618844, 55.101084669899834, 54.31153965381213, 48.59085863147381, 93.76911241398604, 27.265582105944322, 34.32450621286043, 35.52340028361408, 31.281793704560712, 85.38678263383679, 57.22823838444796, 22.542726363634667, 98.62474893605669, 39.623991822301335], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15411463776883466, "mean_inference_ms": 0.7625317573676714, "mean_action_processing_ms": 0.031891294153496945, "mean_env_wait_ms": 0.671837759609748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1843200, "timers": {"sample_time_ms": 2780.491, "sample_throughput": 4603.504, "learn_time_ms": 3444.017, "learn_throughput": 3716.59, "update_time_ms": 1.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 0.8932444562017917, "policy_loss": -0.014957088655792176, "vf_loss": 0.8935345289111137, "vf_explained_var": 0.9812238216400146, "kl": 0.008691559513099491, "entropy": -4.800799279212952, "entropy_coeff": 0.0}}, "num_steps_sampled": 1843200, "num_steps_trained": 1843200}, "done": false, "episodes_total": 1816, "training_iteration": 144, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-51", "timestamp": 1617651891, "time_this_iter_s": 6.108415842056274, "time_total_s": 970.0051038265228, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f08945b9680>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 583.0267417430878, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 21.75555555555556, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 160.06137398776661, "episode_reward_min": 16.183301687311005, "episode_reward_mean": 60.24928176139686, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 32.17939230846301, "MDD_min": 17.308675930542915, "MDD_max": 45.532842930693526}, "hist_stats": {"episode_reward": [39.08750598325851, 39.83738080887345, 18.123415659040997, 114.9773758150909, 26.43239519309076, 44.93103380255633, 77.78310158831573, 84.14313691252701, 82.52772583892396, 16.183301687311005, 51.565642960710655, 70.21276865643311, 52.0568113209702, 62.72903875836178, 51.528486212063825, 55.373016953226845, 44.55243093210323, 30.82421764645257, 70.9697433799332, 81.5477080843855, 48.67857482185727, 43.323289915621274, 34.447716661512736, 35.694478800792915, 66.30799015625193, 83.31088244186886, 103.69299495054257, 160.06137398776661, 117.83850360334378, 73.72927867417941, 42.21675223597076, 47.77882596031102, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221, 34.31797351625767, 62.69063994229357, 65.85656936618844, 55.101084669899834, 54.31153965381213, 48.59085863147381, 93.76911241398604, 27.265582105944322, 34.32450621286043, 35.52340028361408, 31.281793704560712, 85.38678263383679, 57.22823838444796, 22.542726363634667, 98.62474893605669, 39.623991822301335, 78.90963215757516, 59.16666950435249, 25.243752350064447, 58.214150559050026, 49.79556722211586, 60.70966036229574, 37.632466966920944, 51.057508323148646], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408362284932794, "mean_inference_ms": 0.7627336424798845, "mean_action_processing_ms": 0.03188998523750267, "mean_env_wait_ms": 0.6719695225921022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1856000, "timers": {"sample_time_ms": 2780.645, "sample_throughput": 4603.249, "learn_time_ms": 3455.599, "learn_throughput": 3704.134, "update_time_ms": 1.593}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 3.0051141428947448, "policy_loss": -0.007609336976893246, "vf_loss": 2.992758039236069, "vf_explained_var": 0.9409551024436951, "kl": 0.01183137399610132, "entropy": -4.827087774276733, "entropy_coeff": 0.0}}, "num_steps_sampled": 1856000, "num_steps_trained": 1856000}, "done": false, "episodes_total": 1832, "training_iteration": 145, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-44-57", "timestamp": 1617651897, "time_this_iter_s": 6.507779598236084, "time_total_s": 976.5128834247589, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894530a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 589.5345213413239, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 22.933333333333334, "ram_util_percent": 55.87777777777778}, "trial_id": "036aa_00000"}
{"episode_reward_max": 129.11211826334576, "episode_reward_min": 16.183301687311005, "episode_reward_mean": 59.15571715734487, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.85441695655699, "MDD_min": 18.360844702932333, "MDD_max": 45.532842930693526}, "hist_stats": {"episode_reward": [64.3538808960077, 82.78272210804333, 36.239401606259676, 42.15610004797945, 33.77221007613842, 65.73357288811832, 46.11511416095629, 39.411197461263825, 31.220056764752343, 75.04412125884228, 98.68011852422, 74.86036723776066, 68.2968632154824, 22.915309581101685, 98.23149522746186, 95.8057707933093, 45.426218970745566, 44.517064129344114, 68.60556531576513, 64.20114975364095, 104.24145670064459, 77.14073591413208, 57.38806165257825, 53.652336166980284, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221, 34.31797351625767, 62.69063994229357, 65.85656936618844, 55.101084669899834, 54.31153965381213, 48.59085863147381, 93.76911241398604, 27.265582105944322, 34.32450621286043, 35.52340028361408, 31.281793704560712, 85.38678263383679, 57.22823838444796, 22.542726363634667, 98.62474893605669, 39.623991822301335, 78.90963215757516, 59.16666950435249, 25.243752350064447, 58.214150559050026, 49.79556722211586, 60.70966036229574, 37.632466966920944, 51.057508323148646, 39.08750598325851, 39.83738080887345, 18.123415659040997, 114.9773758150909, 26.43239519309076, 44.93103380255633, 77.78310158831573, 84.14313691252701, 82.52772583892396, 16.183301687311005, 51.565642960710655, 70.21276865643311, 52.0568113209702, 62.72903875836178, 51.528486212063825, 55.373016953226845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541138289738615, "mean_inference_ms": 0.7626271060438412, "mean_action_processing_ms": 0.0318968522772171, "mean_env_wait_ms": 0.6717595074267999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1868800, "timers": {"sample_time_ms": 2806.965, "sample_throughput": 4560.086, "learn_time_ms": 3449.375, "learn_throughput": 3710.817, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 3.186571304798126, "policy_loss": -0.008755481340922416, "vf_loss": 3.1741237378120424, "vf_explained_var": 0.9434377551078796, "kl": 0.01256476815789938, "entropy": -4.985636568069458, "entropy_coeff": 0.0}}, "num_steps_sampled": 1868800, "num_steps_trained": 1868800}, "done": false, "episodes_total": 1848, "training_iteration": 146, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-45-04", "timestamp": 1617651904, "time_this_iter_s": 6.524111270904541, "time_total_s": 983.0369946956635, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894634560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 596.0586326122284, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 22.479999999999997, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
{"episode_reward_max": 129.11211826334576, "episode_reward_min": 16.183301687311005, "episode_reward_mean": 59.565779740152884, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.21313371922528, "MDD_min": 14.851357157561907, "MDD_max": 45.532842930693526}, "hist_stats": {"episode_reward": [56.798749878592986, 78.93491800166585, 44.95433860756307, 100.58197426330175, 55.74895197673821, 122.08280407438248, 56.683213027655306, 40.39389705473047, 93.37338697816122, 91.11305206678233, 68.52599103013745, 82.79501467640469, 65.52900840559512, 67.47969367303281, 52.07964940610578, 41.160031346730406, 129.11211826334576, 81.20180678411525, 97.44963631061016, 76.30484027258528, 53.19124759177667, 58.05161714638609, 20.045359343187464, 45.070673364055054, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221, 34.31797351625767, 62.69063994229357, 65.85656936618844, 55.101084669899834, 54.31153965381213, 48.59085863147381, 93.76911241398604, 27.265582105944322, 34.32450621286043, 35.52340028361408, 31.281793704560712, 85.38678263383679, 57.22823838444796, 22.542726363634667, 98.62474893605669, 39.623991822301335, 78.90963215757516, 59.16666950435249, 25.243752350064447, 58.214150559050026, 49.79556722211586, 60.70966036229574, 37.632466966920944, 51.057508323148646, 39.08750598325851, 39.83738080887345, 18.123415659040997, 114.9773758150909, 26.43239519309076, 44.93103380255633, 77.78310158831573, 84.14313691252701, 82.52772583892396, 16.183301687311005, 51.565642960710655, 70.21276865643311, 52.0568113209702, 62.72903875836178, 51.528486212063825, 55.373016953226845, 64.3538808960077, 82.78272210804333, 36.239401606259676, 42.15610004797945, 33.77221007613842, 65.73357288811832, 46.11511416095629, 39.411197461263825, 31.220056764752343, 75.04412125884228, 98.68011852422, 74.86036723776066, 68.2968632154824, 22.915309581101685, 98.23149522746186, 95.8057707933093], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410985294656307, "mean_inference_ms": 0.7627204445080765, "mean_action_processing_ms": 0.03188926504899768, "mean_env_wait_ms": 0.671923772070359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1881600, "timers": {"sample_time_ms": 2808.12, "sample_throughput": 4558.21, "learn_time_ms": 3457.827, "learn_throughput": 3701.746, "update_time_ms": 1.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 2.3481100258231162, "policy_loss": -0.005435015419498086, "vf_loss": 2.3304872632026674, "vf_explained_var": 0.9476746916770935, "kl": 0.013663883609697223, "entropy": -4.787947039604187, "entropy_coeff": 0.0}}, "num_steps_sampled": 1881600, "num_steps_trained": 1881600}, "done": false, "episodes_total": 1856, "training_iteration": 147, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-45-10", "timestamp": 1617651910, "time_this_iter_s": 6.275838375091553, "time_total_s": 989.312833070755, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f0894530dd0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 602.33447098732, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.322222222222223, "ram_util_percent": 55.855555555555554}, "trial_id": "036aa_00000"}
{"episode_reward_max": 136.13588731993872, "episode_reward_min": 16.183301687311005, "episode_reward_mean": 58.60258067238782, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 31.83289177306722, "MDD_min": 14.851357157561907, "MDD_max": 46.438653866888224}, "hist_stats": {"episode_reward": [51.936126377280054, 66.20702454077315, 136.13588731993872, 70.23036804533653, 75.68533047249608, 46.7062443751103, 66.55542625384871, 88.60027353451103, 47.51431627355108, 51.35402016827512, 87.64383273828462, 35.18793060376091, 44.13082112641368, 35.79169044194493, 49.89687471325386, 72.5870528977273, 82.39362006437548, 26.26912629221281, 47.56794312368406, 49.504304405937525, 48.17031763837728, 32.82268097219208, 44.57607811895183, 76.22363897341178, 44.931562130665505, 59.03436186897178, 48.59943151759983, 45.549036279338026, 53.643804627333644, 102.19755262015953, 44.69638893913011, 64.50903794611138, 106.5596749838363, 56.58836017351477, 66.20583940506597, 47.59384430563221, 34.31797351625767, 62.69063994229357, 65.85656936618844, 55.101084669899834, 54.31153965381213, 48.59085863147381, 93.76911241398604, 27.265582105944322, 34.32450621286043, 35.52340028361408, 31.281793704560712, 85.38678263383679, 57.22823838444796, 22.542726363634667, 98.62474893605669, 39.623991822301335, 78.90963215757516, 59.16666950435249, 25.243752350064447, 58.214150559050026, 49.79556722211586, 60.70966036229574, 37.632466966920944, 51.057508323148646, 39.08750598325851, 39.83738080887345, 18.123415659040997, 114.9773758150909, 26.43239519309076, 44.93103380255633, 77.78310158831573, 84.14313691252701, 82.52772583892396, 16.183301687311005, 51.565642960710655, 70.21276865643311, 52.0568113209702, 62.72903875836178, 51.528486212063825, 55.373016953226845, 64.3538808960077, 82.78272210804333, 36.239401606259676, 42.15610004797945, 33.77221007613842, 65.73357288811832, 46.11511416095629, 39.411197461263825, 31.220056764752343, 75.04412125884228, 98.68011852422, 74.86036723776066, 68.2968632154824, 22.915309581101685, 98.23149522746186, 95.8057707933093, 56.798749878592986, 78.93491800166585, 44.95433860756307, 100.58197426330175, 55.74895197673821, 122.08280407438248, 56.683213027655306, 40.39389705473047], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15412698767505575, "mean_inference_ms": 0.7627612487868071, "mean_action_processing_ms": 0.031890782896021916, "mean_env_wait_ms": 0.6719448740028855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1894400, "timers": {"sample_time_ms": 2817.281, "sample_throughput": 4543.388, "learn_time_ms": 3464.978, "learn_throughput": 3694.107, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6875, "cur_lr": 0.0005387588717195657, "total_loss": 2.977604479789734, "policy_loss": -0.0032220467599108817, "vf_loss": 2.9503315806388857, "vf_explained_var": 0.9576904773712158, "kl": 0.018071084199473262, "entropy": -4.911936936378479, "entropy_coeff": 0.0}}, "num_steps_sampled": 1894400, "num_steps_trained": 1894400}, "done": false, "episodes_total": 1872, "training_iteration": 148, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-45-17", "timestamp": 1617651917, "time_this_iter_s": 6.386828184127808, "time_total_s": 995.6996612548828, "pid": 28021, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7f089d84ef80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 608.7212991714478, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.28888888888889, "ram_util_percent": 55.8}, "trial_id": "036aa_00000"}
