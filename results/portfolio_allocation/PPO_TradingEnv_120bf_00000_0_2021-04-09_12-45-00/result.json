{"episode_reward_max": 73.13546750880667, "episode_reward_min": 25.692018752684643, "episode_reward_mean": 41.7012927042814, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.57995510508731, "MDD_min": 22.260233635230893, "MDD_max": 31.98774508536663}, "hist_stats": {"episode_reward": [56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1493251194664084, "mean_inference_ms": 0.7500982751060188, "mean_action_processing_ms": 0.03149239447194273, "mean_env_wait_ms": 0.7115360054743478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 2250.478, "sample_throughput": 4265.76, "learn_time_ms": 2492.294, "learn_throughput": 3851.873, "update_time_ms": 1.497}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.45675228496392567, "policy_loss": -0.04074136576304833, "vf_loss": 0.47491033871968585, "vf_explained_var": 0.9656175971031189, "kl": 0.02258331706126531, "entropy": -4.290925165812174, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 368, "training_iteration": 40, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-10", "timestamp": 1617997510, "time_this_iter_s": 4.762059211730957, "time_total_s": 218.5090410709381, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8192440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.762059211730957, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.142857142857142, "ram_util_percent": 70.65714285714286}, "trial_id": "120bf_00000"}
{"episode_reward_max": 84.41344819216462, "episode_reward_min": 25.692018752684643, "episode_reward_mean": 46.691113805727205, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.909556817364606, "MDD_min": 19.204096022205665, "MDD_max": 31.98774508536663}, "hist_stats": {"episode_reward": [39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14800993540515017, "mean_inference_ms": 0.7540746392435319, "mean_action_processing_ms": 0.03168565470910662, "mean_env_wait_ms": 0.7032748425858906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 393600, "timers": {"sample_time_ms": 2165.295, "sample_throughput": 4433.576, "learn_time_ms": 2515.179, "learn_throughput": 3816.826, "update_time_ms": 1.742}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.9325174796581268, "policy_loss": -0.03510658064236243, "vf_loss": 0.9386354708671569, "vf_explained_var": 0.9448421001434326, "kl": 0.019325728565454482, "entropy": -4.33255028406779, "entropy_coeff": 0.0}}, "num_steps_sampled": 393600, "num_steps_trained": 393600}, "done": false, "episodes_total": 376, "training_iteration": 41, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-14", "timestamp": 1617997514, "time_this_iter_s": 4.624230861663818, "time_total_s": 223.13327193260193, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5ed37c8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.386290073394775, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.11428571428571, "ram_util_percent": 70.72857142857143}, "trial_id": "120bf_00000"}
{"episode_reward_max": 84.41344819216462, "episode_reward_min": 24.207352487241764, "episode_reward_mean": 44.99688520768115, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.315615748997896, "MDD_min": 19.204096022205665, "MDD_max": 40.52039364229567}, "hist_stats": {"episode_reward": [37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14701655799603608, "mean_inference_ms": 0.7549299549006122, "mean_action_processing_ms": 0.03172060444715311, "mean_env_wait_ms": 0.6969767084818175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 403200, "timers": {"sample_time_ms": 2120.171, "sample_throughput": 4527.937, "learn_time_ms": 2527.18, "learn_throughput": 3798.701, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.35648788839578627, "policy_loss": -0.04383871390794714, "vf_loss": 0.3762661987543106, "vf_explained_var": 0.9763967990875244, "kl": 0.01604026901225249, "entropy": -4.342677561442057, "entropy_coeff": 0.0}}, "num_steps_sampled": 403200, "num_steps_trained": 403200}, "done": false, "episodes_total": 384, "training_iteration": 42, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-19", "timestamp": 1617997519, "time_this_iter_s": 4.587250232696533, "time_total_s": 227.72052216529846, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.973540306091309, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.21428571428572, "ram_util_percent": 70.71428571428571}, "trial_id": "120bf_00000"}
{"episode_reward_max": 84.41344819216462, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 45.00057051699467, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.183338940919676, "MDD_min": 18.378087904564858, "MDD_max": 40.52039364229567}, "hist_stats": {"episode_reward": [83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1463709489263499, "mean_inference_ms": 0.7639080298173487, "mean_action_processing_ms": 0.03174627361623328, "mean_env_wait_ms": 0.6927187226285367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 412800, "timers": {"sample_time_ms": 2140.552, "sample_throughput": 4484.825, "learn_time_ms": 2558.98, "learn_throughput": 3751.495, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.7438185807069143, "policy_loss": -0.045513074398040775, "vf_loss": 0.7590243097146352, "vf_explained_var": 0.9617064595222473, "kl": 0.020204892096420127, "entropy": -4.376447474161784, "entropy_coeff": 0.0}}, "num_steps_sampled": 412800, "num_steps_trained": 412800}, "done": false, "episodes_total": 392, "training_iteration": 43, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-24", "timestamp": 1617997524, "time_this_iter_s": 4.86244010925293, "time_total_s": 232.5829622745514, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5ed37ce60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.83598041534424, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.33333333333334, "ram_util_percent": 70.73333333333333}, "trial_id": "120bf_00000"}
{"episode_reward_max": 96.50830194136319, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 49.60754651336807, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.614677849213734, "MDD_min": 17.919111090131718, "MDD_max": 40.52039364229567}, "hist_stats": {"episode_reward": [51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14954415925746628, "mean_inference_ms": 0.7715246748137671, "mean_action_processing_ms": 0.03181426902428324, "mean_env_wait_ms": 0.6884839117353859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 422400, "timers": {"sample_time_ms": 2141.634, "sample_throughput": 4482.56, "learn_time_ms": 2578.715, "learn_throughput": 3722.784, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 1.4768441541989645, "policy_loss": -0.033239667223145565, "vf_loss": 1.4710326059659322, "vf_explained_var": 0.9445205926895142, "kl": 0.017356096245348455, "entropy": -4.486168142954509, "entropy_coeff": 0.0}}, "num_steps_sampled": 422400, "num_steps_trained": 422400}, "done": false, "episodes_total": 408, "training_iteration": 44, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-29", "timestamp": 1617997529, "time_this_iter_s": 4.810304164886475, "time_total_s": 237.39326643943787, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.646284580230713, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.657142857142855, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 102.10535911338329, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 50.19049286026618, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 26.954213945049435, "MDD_min": 17.693734843527473, "MDD_max": 47.294303478753434}, "hist_stats": {"episode_reward": [39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1501634459274562, "mean_inference_ms": 0.7732508799439116, "mean_action_processing_ms": 0.03184079559136888, "mean_env_wait_ms": 0.6872752683123109, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 432000, "timers": {"sample_time_ms": 2138.39, "sample_throughput": 4489.36, "learn_time_ms": 2593.588, "learn_throughput": 3701.436, "update_time_ms": 1.607}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 0.8321880714098613, "policy_loss": -0.03413555557529131, "vf_loss": 0.8382378683487575, "vf_explained_var": 0.9614420533180237, "kl": 0.012482557147741317, "entropy": -4.418232116699219, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 416, "training_iteration": 45, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-33", "timestamp": 1617997533, "time_this_iter_s": 4.796501398086548, "time_total_s": 242.1897678375244, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5ed37c8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.44278597831726, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.657142857142855, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 102.10535911338329, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 50.27776903682523, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.61379589938594, "MDD_min": 17.693734843527473, "MDD_max": 47.294303478753434}, "hist_stats": {"episode_reward": [54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1504287528522843, "mean_inference_ms": 0.7740938056135552, "mean_action_processing_ms": 0.031856326957638396, "mean_env_wait_ms": 0.6861625737734143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 441600, "timers": {"sample_time_ms": 2125.858, "sample_throughput": 4515.823, "learn_time_ms": 2586.826, "learn_throughput": 3711.112, "update_time_ms": 1.603}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 0.5922727298736572, "policy_loss": -0.035428753097852074, "vf_loss": 0.5986213628451029, "vf_explained_var": 0.9721691608428955, "kl": 0.01292449386169513, "entropy": -4.42002805074056, "entropy_coeff": 0.0}}, "num_steps_sampled": 441600, "num_steps_trained": 441600}, "done": false, "episodes_total": 424, "training_iteration": 46, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-38", "timestamp": 1617997538, "time_this_iter_s": 4.603363275527954, "time_total_s": 246.79313111305237, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.046149253845215, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.74285714285714, "ram_util_percent": 70.78571428571429}, "trial_id": "120bf_00000"}
{"episode_reward_max": 137.06163731588296, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 51.707143092396215, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.95983225155643, "MDD_min": 17.693734843527473, "MDD_max": 47.294303478753434}, "hist_stats": {"episode_reward": [137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15053264638099376, "mean_inference_ms": 0.7746597197698518, "mean_action_processing_ms": 0.03187498040432976, "mean_env_wait_ms": 0.6853917618591139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 451200, "timers": {"sample_time_ms": 2130.292, "sample_throughput": 4506.424, "learn_time_ms": 2590.014, "learn_throughput": 3706.544, "update_time_ms": 1.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 1.5692650254567464, "policy_loss": -0.030745723582804203, "vf_loss": 1.5660044185320536, "vf_explained_var": 0.9339704513549805, "kl": 0.015113937643667062, "entropy": -4.446876837412517, "entropy_coeff": 0.0}}, "num_steps_sampled": 451200, "num_steps_trained": 451200}, "done": false, "episodes_total": 432, "training_iteration": 47, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-43", "timestamp": 1617997543, "time_this_iter_s": 4.7804248332977295, "time_total_s": 251.5735559463501, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8194d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.826574087142944, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.91428571428571, "ram_util_percent": 70.75714285714287}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 53.433075424562546, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.971742030685412, "MDD_min": 17.693734843527473, "MDD_max": 47.294303478753434}, "hist_stats": {"episode_reward": [84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15051280829786715, "mean_inference_ms": 0.7748435619167536, "mean_action_processing_ms": 0.03188635510132394, "mean_env_wait_ms": 0.6846265988588228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 460800, "timers": {"sample_time_ms": 2120.769, "sample_throughput": 4526.661, "learn_time_ms": 2596.666, "learn_throughput": 3697.048, "update_time_ms": 1.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 1.486042143503825, "policy_loss": -0.03093322624762853, "vf_loss": 1.4837149000167846, "vf_explained_var": 0.9517492651939392, "kl": 0.01478241704404354, "entropy": -4.438176256815592, "entropy_coeff": 0.0}}, "num_steps_sampled": 460800, "num_steps_trained": 460800}, "done": false, "episodes_total": 440, "training_iteration": 48, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-48", "timestamp": 1617997548, "time_this_iter_s": 4.700832843780518, "time_total_s": 256.2743887901306, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8192440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.52740693092346, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.96666666666667, "ram_util_percent": 70.76666666666667}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 55.360521616331226, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.423680275696082, "MDD_min": 13.43947187006211, "MDD_max": 47.294303478753434}, "hist_stats": {"episode_reward": [48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 56.728017420374606, 27.302254761952927, 40.22029370621758, 73.13546750880667, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1512738382991078, "mean_inference_ms": 0.7748033020265349, "mean_action_processing_ms": 0.031901784656610706, "mean_env_wait_ms": 0.6833238185427435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 470400, "timers": {"sample_time_ms": 2120.41, "sample_throughput": 4527.427, "learn_time_ms": 2601.207, "learn_throughput": 3690.594, "update_time_ms": 1.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 2.378093859354655, "policy_loss": -0.026668184362351896, "vf_loss": 2.3617508220672607, "vf_explained_var": 0.9423307180404663, "kl": 0.01911609829713901, "entropy": -4.557247905731201, "entropy_coeff": 0.0}}, "num_steps_sampled": 470400, "num_steps_trained": 470400}, "done": false, "episodes_total": 456, "training_iteration": 49, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-52", "timestamp": 1617997552, "time_this_iter_s": 4.766742706298828, "time_total_s": 261.04113149642944, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e81807a0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.29414963722229, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.72857142857143, "ram_util_percent": 70.84285714285714}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 55.775921920910534, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.862180229806544, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 35.69748788272115, 36.56912029715302, 25.692018752684643, 38.26568130434063, 39.629474217172515, 54.88245818910982, 84.41344819216462, 29.013899511577307, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1516795082403809, "mean_inference_ms": 0.7753107483818156, "mean_action_processing_ms": 0.03192007563401715, "mean_env_wait_ms": 0.6814941526542158, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 480000, "timers": {"sample_time_ms": 2102.04, "sample_throughput": 4566.991, "learn_time_ms": 2616.926, "learn_throughput": 3668.426, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 0.8842779990037283, "policy_loss": -0.03401889647046725, "vf_loss": 0.8912746095657349, "vf_explained_var": 0.9721736907958984, "kl": 0.012009900224705538, "entropy": -4.465239454905192, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 464, "training_iteration": 50, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-45-57", "timestamp": 1617997557, "time_this_iter_s": 4.7231786251068115, "time_total_s": 265.76431012153625, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e81d5a70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.0173282623291, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.814285714285713, "ram_util_percent": 71.01428571428572}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 56.95577673719607, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.368535101629874, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 75.11938606038791, 37.58128303297629, 33.7066793821107, 59.100850671884906, 37.26482900858992, 55.54429400600882, 25.90347471392018, 52.65179760910256, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15202965554001077, "mean_inference_ms": 0.7769863447497136, "mean_action_processing_ms": 0.03194677816707427, "mean_env_wait_ms": 0.6794588814787786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 489600, "timers": {"sample_time_ms": 2100.91, "sample_throughput": 4569.449, "learn_time_ms": 2617.546, "learn_throughput": 3667.557, "update_time_ms": 1.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 0.9227083977063497, "policy_loss": -0.030151909204820793, "vf_loss": 0.9206648035844167, "vf_explained_var": 0.9718059301376343, "kl": 0.014309121494491895, "entropy": -4.490347105662028, "entropy_coeff": 0.0}}, "num_steps_sampled": 489600, "num_steps_trained": 489600}, "done": false, "episodes_total": 472, "training_iteration": 51, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-02", "timestamp": 1617997562, "time_this_iter_s": 4.619729280471802, "time_total_s": 270.38403940200806, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.6370575428009, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.057142857142857, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 58.159900546108666, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.687799100423923, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 47.795555656828036, 24.207352487241764, 46.654749049070425, 42.84537156195078, 83.57500505223952, 43.46029288031671, 45.43270238037615, 46.02231832311851, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15251737815220065, "mean_inference_ms": 0.7780360383705529, "mean_action_processing_ms": 0.031954874157028634, "mean_env_wait_ms": 0.6782312536769468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 499200, "timers": {"sample_time_ms": 2105.706, "sample_throughput": 4559.042, "learn_time_ms": 2627.12, "learn_throughput": 3654.191, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 1.0565743652979533, "policy_loss": -0.034625367621580756, "vf_loss": 1.0561865282058716, "vf_explained_var": 0.9671112298965454, "kl": 0.015561426058411598, "entropy": -4.484494222005209, "entropy_coeff": 0.0}}, "num_steps_sampled": 499200, "num_steps_trained": 499200}, "done": false, "episodes_total": 480, "training_iteration": 52, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-07", "timestamp": 1617997567, "time_this_iter_s": 4.731292247772217, "time_total_s": 275.1153316497803, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8194d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 61.36834979057312, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.466666666666665, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 23.55981472695969, "episode_reward_mean": 60.02184036282075, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.359309268440256, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 29.94537792086807, 33.09922629418314, 23.55981472695969, 54.998273981419985, 51.75950592617614, 52.32953287201043, 30.849621742079297, 94.34067382872296, 60.161874242005766, 39.74976872182516, 95.39320330919104, 96.50830194136319, 78.18729512337872, 64.03704857909311, 47.43581587442709, 53.37273017728368, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305147119850063, "mean_inference_ms": 0.777654116101102, "mean_action_processing_ms": 0.03196276215361224, "mean_env_wait_ms": 0.6775310436144082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 508800, "timers": {"sample_time_ms": 2093.355, "sample_throughput": 4585.939, "learn_time_ms": 2627.837, "learn_throughput": 3653.195, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 1.0776383423805236, "policy_loss": -0.02942325865228971, "vf_loss": 1.0757153956095378, "vf_explained_var": 0.9724204540252686, "kl": 0.013931647588809331, "entropy": -4.5292582766215, "entropy_coeff": 0.0}}, "num_steps_sampled": 508800, "num_steps_trained": 508800}, "done": false, "episodes_total": 488, "training_iteration": 53, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-11", "timestamp": 1617997571, "time_this_iter_s": 4.7463884353637695, "time_total_s": 279.86172008514404, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 66.11473822593689, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.45714285714286, "ram_util_percent": 70.89999999999999}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 63.930909304472515, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.955340718654817, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 40.11355712968164, 32.624192194796024, 55.64302655763865, 48.637827878165226, 39.61400121903241, 62.3075008902582, 49.72272909934349, 102.10535911338329, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15354760920006721, "mean_inference_ms": 0.7749302876240246, "mean_action_processing_ms": 0.03197605161243213, "mean_env_wait_ms": 0.6767503448643728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 518400, "timers": {"sample_time_ms": 2104.869, "sample_throughput": 4560.854, "learn_time_ms": 2632.043, "learn_throughput": 3647.357, "update_time_ms": 1.641}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.0006692369891822996, "total_loss": 3.2521524302164715, "policy_loss": -0.01947421957893918, "vf_loss": 3.2236992216110227, "vf_explained_var": 0.9429615139961243, "kl": 0.021301095883051555, "entropy": -4.661671848297119, "entropy_coeff": 0.0}}, "num_steps_sampled": 518400, "num_steps_trained": 518400}, "done": false, "episodes_total": 504, "training_iteration": 54, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-16", "timestamp": 1617997576, "time_this_iter_s": 4.967697858810425, "time_total_s": 284.82941794395447, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180d40>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 71.08243608474731, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.22857142857143, "ram_util_percent": 70.81428571428572}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 64.78421076486, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.5739721468014, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749, 60.44910789404271, 41.886875844167925, 35.10826486476222, 38.31152860824832, 54.2443890577503, 32.79740423048905, 30.868718432482705, 68.22837130044687, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15358445488701858, "mean_inference_ms": 0.7735976832786872, "mean_action_processing_ms": 0.03196462713355709, "mean_env_wait_ms": 0.6763571230563434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 528000, "timers": {"sample_time_ms": 2100.331, "sample_throughput": 4570.708, "learn_time_ms": 2629.832, "learn_throughput": 3650.423, "update_time_ms": 1.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 1.0660487246513366, "policy_loss": -0.025463061978419622, "vf_loss": 1.0527950060367584, "vf_explained_var": 0.9749213457107544, "kl": 0.01147163864225149, "entropy": -4.53668088277181, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 512, "training_iteration": 55, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-21", "timestamp": 1617997581, "time_this_iter_s": 4.729702711105347, "time_total_s": 289.5591206550598, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180200>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 75.81213879585266, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.5, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 66.3746833358727, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.086719044972813, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [46.74527839577555, 71.36090301633868, 71.1441236209181, 74.47790360512099, 56.6867347336468, 53.99573603915009, 66.51636322808521, 80.01487469462487, 78.04546633669344, 35.82281807609371, 37.90988631292122, 69.19256443503116, 137.06163731588296, 43.37616022427287, 39.97419910714616, 102.74936279356015, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371992370341378, "mean_inference_ms": 0.7725366160224694, "mean_action_processing_ms": 0.03196083592423543, "mean_env_wait_ms": 0.6759572521137304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 537600, "timers": {"sample_time_ms": 2101.436, "sample_throughput": 4568.304, "learn_time_ms": 2637.733, "learn_throughput": 3639.489, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 0.8119250822067261, "policy_loss": -0.024963979069143535, "vf_loss": 0.802456077337265, "vf_explained_var": 0.9812312722206116, "kl": 0.010202362922330697, "entropy": -4.584604244232178, "entropy_coeff": 0.0}}, "num_steps_sampled": 537600, "num_steps_trained": 537600}, "done": false, "episodes_total": 520, "training_iteration": 56, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-26", "timestamp": 1617997586, "time_this_iter_s": 4.693647623062134, "time_total_s": 294.25276827812195, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 80.5057864189148, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.585714285714285, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 138.93236745660604, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 67.77893503621394, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.15602443277044, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [76.89913067440047, 129.6089373951057, 69.16241245197179, 111.68992052805316, 96.75631184430613, 55.16656160911856, 73.1613556329569, 72.1126344998116, 30.132609211025162, 45.383939262149326, 71.62395643349512, 34.83521994818117, 84.49832750714629, 47.86211951148847, 40.582892525808425, 138.93236745660604, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749, 46.74527839577555, 71.36090301633868, 71.1441236209181, 74.47790360512099, 56.6867347336468, 53.99573603915009, 66.51636322808521, 80.01487469462487], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15392737857616529, "mean_inference_ms": 0.7717341756265399, "mean_action_processing_ms": 0.031959760851338136, "mean_env_wait_ms": 0.6756851925626886, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 547200, "timers": {"sample_time_ms": 2100.022, "sample_throughput": 4571.381, "learn_time_ms": 2631.644, "learn_throughput": 3647.909, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 1.5588575760523478, "policy_loss": -0.026640751684705418, "vf_loss": 1.5453935885429382, "vf_explained_var": 0.9667535424232483, "kl": 0.011882888587812583, "entropy": -4.541429093678793, "entropy_coeff": 0.0}}, "num_steps_sampled": 547200, "num_steps_trained": 547200}, "done": false, "episodes_total": 528, "training_iteration": 57, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-30", "timestamp": 1617997590, "time_this_iter_s": 4.705334901809692, "time_total_s": 298.95810317993164, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5ed37c8c0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 85.21112132072449, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.08571428571429, "ram_util_percent": 71.0}, "trial_id": "120bf_00000"}
{"episode_reward_max": 213.35389657277688, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 68.53288253538963, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.446224733447963, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [56.15995938965565, 47.842331875061035, 43.675438385535685, 48.357233478227194, 51.863797693872264, 74.951014032218, 213.35389657277688, 33.042510346123386, 59.235874801955546, 50.27278448787046, 85.3080187864046, 45.0393462351961, 48.5766285490846, 86.6899817682595, 91.74363400434841, 37.680168258094795, 63.45885479290408, 38.51162279264182, 54.2767081988235, 62.96314661216536, 43.43568283703322, 90.9509047228561, 28.09755166493891, 45.15855954836727, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749, 46.74527839577555, 71.36090301633868, 71.1441236209181, 74.47790360512099, 56.6867347336468, 53.99573603915009, 66.51636322808521, 80.01487469462487, 76.89913067440047, 129.6089373951057, 69.16241245197179, 111.68992052805316, 96.75631184430613, 55.16656160911856, 73.1613556329569, 72.1126344998116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541582963013036, "mean_inference_ms": 0.7710706453696398, "mean_action_processing_ms": 0.03195785467603059, "mean_env_wait_ms": 0.6754652441993106, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 556800, "timers": {"sample_time_ms": 2109.121, "sample_throughput": 4551.66, "learn_time_ms": 2624.742, "learn_throughput": 3657.503, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 3.7637850213050843, "policy_loss": -0.01760794789530337, "vf_loss": 3.7225659839312235, "vf_explained_var": 0.9372564554214478, "kl": 0.017430217290918034, "entropy": -4.582462851206461, "entropy_coeff": 0.0}}, "num_steps_sampled": 556800, "num_steps_trained": 556800}, "done": false, "episodes_total": 536, "training_iteration": 58, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-35", "timestamp": 1617997595, "time_this_iter_s": 4.722677707672119, "time_total_s": 303.68078088760376, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8180b00>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 89.9337990283966, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.08333333333333, "ram_util_percent": 70.81666666666668}, "trial_id": "120bf_00000"}
{"episode_reward_max": 213.35389657277688, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 69.2286988674202, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.978933816942053, "MDD_min": 13.43947187006211, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [126.05320184746012, 81.16365776576451, 57.36467069560728, 44.58883836430023, 44.93906745309824, 27.997958410316897, 72.06217081109833, 52.36455106687108, 56.247086071862135, 75.62317471170196, 32.2960441596518, 44.25258270161708, 96.34716832933942, 64.34296464386935, 85.11245901289742, 40.22550521854581, 62.43043782484496, 125.36972860388795, 86.97639313329333, 73.64403789125045, 49.42745574517068, 43.79935960074797, 51.77580886095874, 88.85546025047937, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749, 46.74527839577555, 71.36090301633868, 71.1441236209181, 74.47790360512099, 56.6867347336468, 53.99573603915009, 66.51636322808521, 80.01487469462487, 76.89913067440047, 129.6089373951057, 69.16241245197179, 111.68992052805316, 96.75631184430613, 55.16656160911856, 73.1613556329569, 72.1126344998116, 56.15995938965565, 47.842331875061035, 43.675438385535685, 48.357233478227194, 51.863797693872264, 74.951014032218, 213.35389657277688, 33.042510346123386], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448516348386854, "mean_inference_ms": 0.7700932189515265, "mean_action_processing_ms": 0.03196215603915553, "mean_env_wait_ms": 0.6750774339949025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 566400, "timers": {"sample_time_ms": 2106.586, "sample_throughput": 4557.137, "learn_time_ms": 2628.113, "learn_throughput": 3652.811, "update_time_ms": 1.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 2.6346731646855672, "policy_loss": -0.019822687817116578, "vf_loss": 2.6123526827494303, "vf_explained_var": 0.9595265984535217, "kl": 0.012486858206490675, "entropy": -4.696011149088542, "entropy_coeff": 0.0}}, "num_steps_sampled": 566400, "num_steps_trained": 566400}, "done": false, "episodes_total": 552, "training_iteration": 59, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-40", "timestamp": 1617997600, "time_this_iter_s": 4.774795293807983, "time_total_s": 308.45557618141174, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e81935f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 94.70859432220459, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.957142857142856, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 213.35389657277688, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 68.80032374890982, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 28.0496656115263, "MDD_min": 13.731745846484243, "MDD_max": 50.87523199966436}, "hist_stats": {"episode_reward": [68.72169841069226, 56.76729599919114, 68.64795866902966, 42.514063065345134, 39.613563365931505, 59.173798580589136, 95.25749985018368, 108.74529211863366, 31.387134626699357, 107.7905942886202, 34.66594654111203, 52.666390406818174, 27.547127789523923, 90.22005849733387, 59.937976243547844, 63.44888765543132, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749, 46.74527839577555, 71.36090301633868, 71.1441236209181, 74.47790360512099, 56.6867347336468, 53.99573603915009, 66.51636322808521, 80.01487469462487, 76.89913067440047, 129.6089373951057, 69.16241245197179, 111.68992052805316, 96.75631184430613, 55.16656160911856, 73.1613556329569, 72.1126344998116, 56.15995938965565, 47.842331875061035, 43.675438385535685, 48.357233478227194, 51.863797693872264, 74.951014032218, 213.35389657277688, 33.042510346123386, 126.05320184746012, 81.16365776576451, 57.36467069560728, 44.58883836430023, 44.93906745309824, 27.997958410316897, 72.06217081109833, 52.36455106687108, 56.247086071862135, 75.62317471170196, 32.2960441596518, 44.25258270161708, 96.34716832933942, 64.34296464386935, 85.11245901289742, 40.22550521854581], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15456518541713304, "mean_inference_ms": 0.7695339706461006, "mean_action_processing_ms": 0.0319548401821819, "mean_env_wait_ms": 0.6749386020240002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 576000, "timers": {"sample_time_ms": 2102.336, "sample_throughput": 4566.349, "learn_time_ms": 2630.551, "learn_throughput": 3649.425, "update_time_ms": 1.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 1.0367523380120596, "policy_loss": -0.025127961269269385, "vf_loss": 1.0327815004189809, "vf_explained_var": 0.9787020683288574, "kl": 0.008621865964184204, "entropy": -4.56972562789917, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 560, "training_iteration": 60, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-45", "timestamp": 1617997605, "time_this_iter_s": 4.704842805862427, "time_total_s": 313.16041898727417, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5e8192440>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 99.41343712806702, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 21.62857142857143, "ram_util_percent": 70.8}, "trial_id": "120bf_00000"}
{"episode_reward_max": 213.35389657277688, "episode_reward_min": 26.301427931294945, "episode_reward_mean": 71.77787635963443, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"sharpe_mean": NaN, "sharpe_min": NaN, "sharpe_max": NaN, "MDD_mean": 27.911040203674638, "MDD_min": 13.63698196490861, "MDD_max": 47.53449590486326}, "hist_stats": {"episode_reward": [91.39962212583518, 75.28326665812153, 79.8436972688362, 64.74241366469732, 78.93913668330596, 102.90322918554895, 136.10256164905067, 136.2054498861511, 41.38005234446089, 49.57071479688294, 48.62702467666757, 81.41722797162937, 33.75172869100192, 58.88148067800219, 60.99510057060444, 42.263362461730004, 26.301427931294945, 118.8726504679294, 81.04705687278468, 75.17216770289457, 50.65771174978444, 85.99061582908904, 80.77767366791085, 93.10168533941943, 35.354879374396276, 62.555480454308615, 95.06636397797011, 62.68291866947014, 55.05790956142185, 70.76460570033898, 102.73206861011319, 55.90939536974974, 135.99407659641653, 92.92913192745645, 89.11819325357132, 106.58217427939887, 54.27073225406251, 42.82050177803667, 112.57868319037034, 52.80102521810626, 115.72610637646788, 67.01006341702112, 84.31195821559075, 58.02833367804135, 31.02715270394976, 59.574847982742156, 85.01795563883806, 76.75923202456515, 36.457136376034036, 58.850720662122534, 119.47751722217897, 48.93377751061749, 46.74527839577555, 71.36090301633868, 71.1441236209181, 74.47790360512099, 56.6867347336468, 53.99573603915009, 66.51636322808521, 80.01487469462487, 76.89913067440047, 129.6089373951057, 69.16241245197179, 111.68992052805316, 96.75631184430613, 55.16656160911856, 73.1613556329569, 72.1126344998116, 56.15995938965565, 47.842331875061035, 43.675438385535685, 48.357233478227194, 51.863797693872264, 74.951014032218, 213.35389657277688, 33.042510346123386, 126.05320184746012, 81.16365776576451, 57.36467069560728, 44.58883836430023, 44.93906745309824, 27.997958410316897, 72.06217081109833, 52.36455106687108, 56.247086071862135, 75.62317471170196, 32.2960441596518, 44.25258270161708, 96.34716832933942, 64.34296464386935, 85.11245901289742, 40.22550521854581, 68.72169841069226, 56.76729599919114, 68.64795866902966, 42.514063065345134, 39.613563365931505, 59.173798580589136, 95.25749985018368, 108.74529211863366], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15467033687339415, "mean_inference_ms": 0.7691297428502294, "mean_action_processing_ms": 0.03195516802708822, "mean_env_wait_ms": 0.6748049829962764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 585600, "timers": {"sample_time_ms": 2096.206, "sample_throughput": 4579.702, "learn_time_ms": 2642.273, "learn_throughput": 3633.235, "update_time_ms": 1.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.0006692369891822996, "total_loss": 1.8815387845039369, "policy_loss": -0.022073240565756956, "vf_loss": 1.8647919217745463, "vf_explained_var": 0.9673377275466919, "kl": 0.011502250985552867, "entropy": -4.585433603922526, "entropy_coeff": 0.0}}, "num_steps_sampled": 585600, "num_steps_trained": 585600}, "done": true, "episodes_total": 568, "training_iteration": 61, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-46-49", "timestamp": 1617997609, "time_this_iter_s": 4.675523519515991, "time_total_s": 317.83594250679016, "pid": 12989, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7fc5ea482560>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 104.08896064758301, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 21.400000000000006, "ram_util_percent": 70.87142857142855}, "trial_id": "120bf_00000"}
